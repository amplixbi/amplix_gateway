"use strict";if(!jSuites&&"function"==typeof require)var jSuites=require("jsuites");!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.formula=t()}(this,(function(){var e;return function(){var t={765:function(e,t){var n;n=function(e){e.version="1.0.2";var t=Math;function n(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function r(e,t,n,r,o){if(0===t)return n;if(1===t)return r;for(var s=2/e,l=r,i=1;i<t;++i)l=r*i*s+o*n,n=r,r=l;return l}function o(e,t,n,o,s){return function(n,l){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}return 0===l?e(n):1===l?t(n):l<0?NaN:r(n,l|=0,e(n),t(n),s)}}var s,l,i,a,c,u,f,d,p,h,g,m,y,C=function(){var e=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function a(r){var a=0,c=0,u=0,f=r*r;if(r<8)a=(c=n(o,f))/(u=n(s,f));else{var d=r-.785398164;c=n(l,f=64/f),u=n(i,f),a=t.sqrt(e/r)*(t.cos(d)*c-t.sin(d)*u*8/r)}return a}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(r){var o=0,s=0,l=0,i=r*r,a=t.abs(r)-2.356194491;return Math.abs(r)<8?o=(s=r*n(c,i))/(l=n(u,i)):(s=n(f,i=64/i),l=n(d,i),o=t.sqrt(e/t.abs(r))*(t.cos(a)*s-t.sin(a)*l*8/t.abs(r)),r<0&&(o=-o)),o}return function e(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*e(n,-o);if(n<0)return(o%2?-1:1)*e(-n,o);if(0===o)return a(n);if(1===o)return p(n);if(0===n)return 0;var s=0;if(n>o)s=r(n,o,a(n),p(n),-1);else{for(var l=!1,i=0,c=0,u=1,f=0,d=2/n,h=2*t.floor((o+t.floor(t.sqrt(40*o)))/2);h>0;h--)f=h*d*u-i,i=u,u=f,t.abs(u)>1e10&&(u*=1e-10,i*=1e-10,s*=1e-10,c*=1e-10),l&&(c+=u),l=!l,h==o&&(s=i);s/=c=2*c-u}return s}}(),b=(s=.636619772,l=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),i=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),u=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(e){var r=0,o=0,u=0,f=e*e,d=e-.785398164;return e<8?r=(o=n(l,f))/(u=n(i,f))+s*C(e,0)*t.log(e):(o=n(a,f=64/f),u=n(c,f),r=t.sqrt(s/e)*(t.sin(d)*o+t.cos(d)*u*8/e)),r}),(function(e){var r=0,o=0,l=0,i=e*e,a=e-2.356194491;return e<8?r=(o=e*n(u,i))/(l=n(f,i))+s*(C(e,1)*t.log(e)-1/e):(o=n(d,i=64/i),l=n(p,i),r=t.sqrt(s/e)*(t.sin(a)*o+t.cos(a)*l*8/e)),r}),0,1,-1)),w=(h=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),g=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),m=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),y=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(r,o){if(0===(o=Math.round(o)))return function(e){return e<=3.75?n(h,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(g,3.75/t.abs(e))}(r);if(1===o)return function(e){return e<3.75?e*n(m,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(y,3.75/t.abs(e))}(r);if(o<0)return NaN;if(0===t.abs(r))return 0;if(r==1/0)return 1/0;var s,l=0,i=2/t.abs(r),a=0,c=1,u=0;for(s=2*t.round((o+t.round(t.sqrt(40*o)))/2);s>0;s--)u=s*i*c+a,a=c,c=u,t.abs(c)>1e10&&(c*=1e-10,a*=1e-10,l*=1e-10),s==o&&(l=a);return l*=e(r,0)/c,r<0&&o%2?-l:l}),E=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),s=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-t.log(o/2)*w(o,0)+n(e,o*o/4):t.exp(-o)/t.sqrt(o)*n(r,2/o)}),(function(e){return e<=2?t.log(e/2)*w(e,1)+1/e*n(s,e*e/4):t.exp(-e)/t.sqrt(e)*n(l,2/e)}),0,2,1)}();e.besselj=C,e.bessely=b,e.besseli=w,e.besselk=E},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var t;e.exports=(t=function(e,t){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function s(t,n){var r=t>n?t:n;return e.pow(10,17-~~(e.log(r>0?r:-r)*e.LOG10E))}var l=Array.isArray||function(e){return"[object Array]"===o.call(e)};function i(e){return"[object Function]"===o.call(e)}function a(e){return"number"==typeof e&&e-e==0}function c(){return new c._init(arguments)}function u(){return 0}function f(){return 1}function d(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(l(e[0]))if(l(e[0][0])){i(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=i(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(a(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:s,isArray:l,isFunction:i,isNumber:a,toVector:function(e){return n.apply([],e)}},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,n;if(1===arguments.length){for(n in e)c[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return l(t)?t.map((function(t){return c.row(e,t)})):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(l(t)){var n=c.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,r){c.arange(e.length).forEach((function(o){n[o][r]=e[o][t]}))})),n}for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=[e[o][t]];return r},c.cola=function(e,t){return c.col(e,t).map((function(e){return e[0]}))},c.diag=function(e){for(var t=c.rows(e),n=new Array(t),r=0;r<t;r++)n[r]=[e[r][r]];return n},c.antidiag=function(e){for(var t=c.rows(e)-1,n=new Array(t),r=0;t>=0;t--,r++)n[r]=[e[r][t]];return n},c.transpose=function(e){var t,n,r,o,s,i=[];for(l(e[0])||(e=[e]),n=e.length,r=e[0].length,s=0;s<r;s++){for(t=new Array(n),o=0;o<n;o++)t[o]=e[o][s];i.push(t)}return 1===i.length?i[0]:i},c.map=function(e,t,n){var r,o,s,i,a;for(l(e[0])||(e=[e]),o=e.length,s=e[0].length,i=n?e:new Array(o),r=0;r<o;r++)for(i[r]||(i[r]=new Array(s)),a=0;a<s;a++)i[r][a]=t(e[r][a],r,a);return 1===i.length?i[0]:i},c.cumreduce=function(e,t,n){var r,o,s,i,a;for(l(e[0])||(e=[e]),o=e.length,s=e[0].length,i=n?e:new Array(o),r=0;r<o;r++)for(i[r]||(i[r]=new Array(s)),s>0&&(i[r][0]=e[r][0]),a=1;a<s;a++)i[r][a]=t(i[r][a-1],e[r][a]);return 1===i.length?i[0]:i},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,n){var r,o,s=new Array(e);for(i(t)&&(n=t,t=e),r=0;r<e;r++)for(s[r]=new Array(t),o=0;o<t;o++)s[r][o]=n(r,o);return s},c.zeros=function(e,t){return a(t)||(t=e),c.create(e,t,u)},c.ones=function(e,t){return a(t)||(t=e),c.create(e,t,f)},c.rand=function(e,t){return a(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return a(t)||(t=e),c.create(e,t,d)},c.symmetric=function(e){var t,n,r=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<r;t++)for(n=0;n<r;n++)if(e[n][t]!==e[t][n])return!1;return!0},c.clear=function(e){return c.alter(e,u)},c.seq=function(e,t,n,r){i(r)||(r=!1);var o,l=[],a=s(e,t),c=(t*a-e*a)/((n-1)*a),u=e;for(o=0;u<=t&&o<n;u=(e*a+c*a*++o)/a)l.push(r?r(u,o):u);return l},c.arange=function(e,n,r){var o,s=[];if(r=r||1,n===t&&(n=e,e=0),e===n||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(o=e;o<n;o+=r)s.push(o);else for(o=e;o>n;o+=r)s.push(o);return s},c.slice=function(){function e(e,n,r,o){var s,l=[],i=e.length;if(n===t&&r===t&&o===t)return c.copy(e);if(o=o||1,(n=(n=n||0)>=0?n:i+n)===(r=(r=r||e.length)>=0?r:i+r)||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(s=n;s<r;s+=o)l.push(e[s]);else for(s=n;s>r;s+=o)l.push(e[s]);return l}return function(t,n){var r,o;return a((n=n||{}).row)?a(n.col)?t[n.row][n.col]:e(c.rowa(t,n.row),(r=n.col||{}).start,r.end,r.step):a(n.col)?e(c.cola(t,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},r=n.col||{},e(t,o.start,o.end,o.step).map((function(t){return e(t,r.start,r.end,r.step)})))}}(),c.sliceAssign=function(n,r,o){var s,l;if(a(r.row)){if(a(r.col))return n[r.row][r.col]=o;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,s=c.arange(r.col.start,e.min(n.length,r.col.end),r.col.step);var i=r.row;return s.forEach((function(e,t){n[i][e]=o[t]})),n}if(a(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,l=c.arange(r.row.start,e.min(n[0].length,r.row.end),r.row.step);var u=r.col;return l.forEach((function(e,t){n[e][u]=o[t]})),n}return o[0].length===t&&(o=[o]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1,l=c.arange(r.row.start,e.min(n.length,r.row.end),r.row.step),s=c.arange(r.col.start,e.min(n[0].length,r.col.end),r.col.step),l.forEach((function(e,t){s.forEach((function(r,s){n[e][r]=o[t][s]}))})),n},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach((function(e,n){t[n][n]=e})),t},c.copy=function(e){return e.map((function(e){return a(e)?e:e.map((function(e){return e}))}))};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},p.map=function(e,t){return c(c.map(this,e,t))},p.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},p.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var n,r=this;return t?(setTimeout((function(){t.call(r,p[e].call(r))})),this):(n=c[e](this),l(n)?c(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,n){var r=this;return n?(setTimeout((function(){n.call(r,p[e].call(r,t))})),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),function(e,t){var n=e.utils.isFunction;function r(e,t){return e-t}function o(e,n,r){return t.max(n,t.min(e,r))}e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,r=e.mean(t),o=0,s=t.length;--s>=0;)o+=(n=t[s]-r)*n;return o},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){var r=n.map(t.log),o=e.mean(r);return t.exp(o)},e.median=function(e){var t=e.length,n=e.slice().sort(r);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,n=[],r=e.length;for(t=1;t<r;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){var t,n=[],o={};for(t=0;t<e.length;t++)o[a=e[t]]?o[a]++:(o[a]=1,n.push(a));var s=n.sort(r),l={},i=1;for(t=0;t<s.length;t++){var a,c=o[a=s[t]],u=(i+(i+c-1))/2;l[a]=u,i+=c}return e.map((function(e){return l[e]}))},e.mode=function(e){var t,n=e.length,o=e.slice().sort(r),s=1,l=0,i=0,a=[];for(t=0;t<n;t++)o[t]===o[t+1]?s++:(s>l?(a=[o[t]],l=s,i=0):s===l&&(a.push(o[t]),i++),s=1);return 0===i?a[0]:a},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,n){return t+e.sumsqerr(n)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),r=t.length,o=new Array(r),s=0;s<r;s++)o[s]=t[s]-n;return o},e.stdev=function(n,r){return t.sqrt(e.variance(n,r))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var r=e.mean(n),o=[],s=n.length-1;s>=0;s--)o.push(t.abs(n[s]-r));return e.mean(o)},e.meddev=function(n){for(var r=e.median(n),o=[],s=n.length-1;s>=0;s--)o.push(t.abs(n[s]-r));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var n=e.length,o=e.slice().sort(r);return[o[t.round(n/4)-1],o[t.round(n/2)-1],o[t.round(3*n/4)-1]]},e.quantiles=function(e,n,s,l){var i,a,c,u,f,d=e.slice().sort(r),p=[n.length],h=e.length;for(void 0===s&&(s=3/8),void 0===l&&(l=3/8),i=0;i<n.length;i++)c=h*(a=n[i])+(s+a*(1-s-l)),u=t.floor(o(c,1,h-1)),f=o(c-u,0,1),p[i]=(1-f)*d[u-1]+f*d[u];return p},e.percentile=function(e,t,n){var o=e.slice().sort(r),s=t*(o.length+(n?1:-1))+(n?0:1),l=parseInt(s),i=s-l;return l+1<o.length?o[l-1]+i*(o[l]-o[l-1]):o[l-1]},e.percentileOfScore=function(e,t,n){var r,o,s=0,l=e.length,i=!1;for("strict"===n&&(i=!0),o=0;o<l;o++)r=e[o],(i&&r<t||!i&&r<=t)&&s++;return s/l},e.histogram=function(n,r){r=r||4;var o,s=e.min(n),l=(e.max(n)-s)/r,i=n.length,a=[];for(o=0;o<r;o++)a[o]=0;for(o=0;o<i;o++)a[t.min(t.floor((n[o]-s)/l),r-1)]+=1;return a},e.covariance=function(t,n){var r,o=e.mean(t),s=e.mean(n),l=t.length,i=new Array(l);for(r=0;r<l;r++)i[r]=(t[r]-o)*(n[r]-s);return e.sum(i)/(l-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,r){for(var o=e.mean(n),s=e.stdev(n),l=n.length,i=0,a=0;a<l;a++)i+=t.pow((n[a]-o)/s,r);return i/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var s=e.prototype;!function(t){for(var r=0;r<t.length;r++)!function(t){s[t]=function(r,o){var l=[],i=0,a=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(a,s[t].call(a,r))})),this;if(this.length>1){for(a=!0===r?this:this.transpose();i<a.length;i++)l[i]=e[t](a[i]);return l}return e[t](this[0],r)}}(t[r])}("cumsum cumprod".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){s[t]=function(r,o){var l=[],i=0,a=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(a,s[t].call(a,r))})),this;if(this.length>1){for("sumrow"!==t&&(a=!0===r?this:this.transpose());i<a.length;i++)l[i]=e[t](a[i]);return!0===r?e[t](e.utils.toVector(l)):l}return e[t](this[0],r)}}(t[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){s[t]=function(){var r,o=[],l=0,i=this,a=Array.prototype.slice.call(arguments);if(n(a[a.length-1])){r=a[a.length-1];var c=a.slice(0,a.length-1);return setTimeout((function(){r.call(i,s[t].apply(i,c))})),this}r=void 0;var u=function(n){return e[t].apply(i,[n].concat(a))};if(this.length>1){for(i=i.transpose();l<i.length;l++)o[l]=u(i[l]);return o}return u(this[0])}}(t[r])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var n,r,o,s=0,l=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015;for(o=(r=n=e)+5.5,o-=(n+.5)*t.log(o);s<6;s++)i+=l[s]/++r;return t.log(2.5066282746310007*i/n)-o},e.loggam=function(e){var n,r,o,s,l,i,a,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=e,a=0,1==e||2==e)return 0;for(e<=7&&(n=e+(a=t.floor(7-e))),r=1/(n*n),o=2*t.PI,l=c[9],i=8;i>=0;i--)l*=r,l+=c[i];if(s=l/n+.5*t.log(o)+(n-.5)*t.log(n)-n,e<=7)for(i=1;i<=a;i++)s-=t.log(n-1),n-=1;return s},e.gammafn=function(e){var n,r,o,s,l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],a=!1,c=0,u=0,f=0,d=e;if(e>171.6243769536076)return 1/0;if(d<=0){if(!(s=d%1+36e-17))return 1/0;a=(1&d?-1:1)*t.PI/t.sin(t.PI*s),d=1-d}for(o=d,r=d<1?d++:(d-=c=(0|d)-1)-1,n=0;n<8;++n)f=(f+l[n])*r,u=u*r+i[n];if(s=f/u+1,o<d)s/=o;else if(o>d)for(n=0;n<c;++n)s*=d,d++;return a&&(s=a/s),s},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,r){var o,s=e.gammaln(n),l=n,i=1/n,a=i,c=r+1-n,u=1/1e-30,f=1/c,d=f,p=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;p<=h;p++)i+=a*=r/++l;return i*t.exp(-r+n*t.log(r)-s)}for(;p<=h;p++)d*=(f=1/(f=(o=-p*(p-n))*f+(c+=2)))*(u=c+o/u);return 1-d*t.exp(-r+n*t.log(r)-s)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,r){return n>170||r>170?t.exp(e.combinationln(n,r)):e.factorial(n)/e.factorial(r)/e.factorial(n-r)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?t.exp(e.betaln(n,r)):e.gammafn(n)*e.gammafn(r)/e.gammafn(n+r)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,r){var o,s,l,i,a=1e-30,c=1,u=n+r,f=n+1,d=n-1,p=1,h=1-u*e/f;for(t.abs(h)<a&&(h=a),i=h=1/h;c<=100&&(h=1+(s=c*(r-c)*e/((d+(o=2*c))*(n+o)))*h,t.abs(h)<a&&(h=a),p=1+s/p,t.abs(p)<a&&(p=a),i*=(h=1/h)*p,h=1+(s=-(n+c)*(u+c)*e/((n+o)*(f+o)))*h,t.abs(h)<a&&(h=a),p=1+s/p,t.abs(p)<a&&(p=a),i*=l=(h=1/h)*p,!(t.abs(l-1)<3e-7));c++);return i},e.gammapinv=function(n,r){var o,s,l,i,a,c,u=0,f=r-1,d=e.gammaln(r);if(n>=1)return t.max(100,r+100*t.sqrt(r));if(n<=0)return 0;for(r>1?(a=t.log(f),c=t.exp(f*(a-1)-d),i=n<.5?n:1-n,o=(2.30753+.27061*(s=t.sqrt(-2*t.log(i))))/(1+s*(.99229+.04481*s))-s,n<.5&&(o=-o),o=t.max(.001,r*t.pow(1-1/(9*r)-o/(3*t.sqrt(r)),3))):o=n<(s=1-r*(.253+.12*r))?t.pow(n/s,1/r):1-t.log(1-(n-s)/(1-s));u<12;u++){if(o<=0)return 0;if((o-=s=(l=(e.lowRegGamma(r,o)-n)/(s=r>1?c*t.exp(-(o-f)+f*(t.log(o)-a)):t.exp(-o+f*t.log(o)-d)))/(1-.5*t.min(1,l*((r-1)/o-1))))<=0&&(o=.5*(o+s)),t.abs(s)<1e-8*o)break}return o},e.erf=function(e){var n,r,o,s,l=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=l.length-1,a=!1,c=0,u=0;for(e<0&&(e=-e,a=!0),r=4*(n=2/(2+e))-2;i>0;i--)o=c,c=r*c-u+l[i],u=o;return s=n*t.exp(-e*e+.5*(l[0]+r*c)-u),a?s-1:1-s},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var r,o,s,l,i=0;if(n>=2)return-100;if(n<=0)return 100;for(l=n<1?n:2-n,r=-.70711*((2.30753+.27061*(s=t.sqrt(-2*t.log(l/2))))/(1+s*(.99229+.04481*s))-s);i<2;i++)r+=(o=e.erfc(r)-l)/(1.1283791670955126*t.exp(-r*r)-r*o);return n<1?r:-r},e.ibetainv=function(n,r,o){var s,l,i,a,c,u,f,d,p,h,g=r-1,m=o-1,y=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(i=n<.5?n:1-n,u=(2.30753+.27061*(a=t.sqrt(-2*t.log(i))))/(1+a*(.99229+.04481*a))-a,n<.5&&(u=-u),f=(u*u-3)/6,d=2/(1/(2*r-1)+1/(2*o-1)),p=u*t.sqrt(f+d)/d-(1/(2*o-1)-1/(2*r-1))*(f+5/6-2/(3*d)),u=r/(r+o*t.exp(2*p))):(s=t.log(r/(r+o)),l=t.log(o/(r+o)),u=n<(a=t.exp(r*s)/r)/(p=a+(c=t.exp(o*l)/o))?t.pow(r*p*n,1/r):1-t.pow(o*p*(1-n),1/o)),h=-e.gammaln(r)-e.gammaln(o)+e.gammaln(r+o);y<10;y++){if(0===u||1===u)return u;if((u-=a=(c=(e.ibeta(u,r,o)-n)/(a=t.exp(g*t.log(u)+m*t.log(1-u)+h)))/(1-.5*t.min(1,c*(g/u-m/(1-u)))))<=0&&(u=.5*(u+a)),u>=1&&(u=.5*(u+a+1)),t.abs(a)<1e-8*u&&y>0)break}return u},e.ibeta=function(n,r,o){var s=0===n||1===n?0:t.exp(e.gammaln(r+o)-e.gammaln(r)-e.gammaln(o)+r*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?s*e.betacf(n,r,o)/r:1-s*e.betacf(1-n,o,r)/o)},e.randn=function(n,r){var o,s,l,i,a;if(r||(r=n),n)return e.create(n,r,(function(){return e.randn()}));do{o=e._random_fn(),s=1.7156*(e._random_fn()-.5),a=(l=o-.449871)*l+(i=t.abs(s)+.386595)*(.196*i-.25472*l)}while(a>.27597&&(a>.27846||s*s>-4*t.log(o)*o*o));return s/o},e.randg=function(n,r,o){var s,l,i,a,c,u,f=n;if(o||(o=r),n||(n=1),r)return(u=e.zeros(r,o)).alter((function(){return e.randg(n)})),u;n<1&&(n+=1),s=n-1/3,l=1/t.sqrt(9*s);do{do{a=1+l*(c=e.randn())}while(a<=0);a*=a*a,i=e._random_fn()}while(i>1-.331*t.pow(c,4)&&t.log(i)>.5*c*c+s*(1-a+t.log(a)));if(n==f)return s*a;do{i=e._random_fn()}while(0===i);return t.pow(i,1/f)*s*a},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(n){return e[t](n)})))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(t,Math),function(e,t){function n(e,n,r,o){for(var s,l=0,i=1,a=1,c=1,u=0,f=0;t.abs((a-f)/a)>o;)f=a,i=c+(s=-(n+u)*(n+r+u)*e/(n+2*u)/(n+2*u+1))*i,a=(l=a+s*l)+(s=(u+=1)*(r-u)*e/(n+2*u-1)/(n+2*u))*a,l/=c=i+s*c,i/=c,a/=c,c=1;return a/n}function r(n,r,o){var s=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],l=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],i=.5*n;if(i>=8)return 1;var a,c=2*e.normal.cdf(i,0,1,1,0)-1;c=c>=t.exp(-50/o)?t.pow(c,o):0;for(var u=i,f=(8-i)/(a=n>3?2:3),d=u+f,p=0,h=o-1,g=1;g<=a;g++){for(var m=0,y=.5*(d+u),C=.5*(d-u),b=1;b<=12;b++){var w,E=y+C*(6<b?s[(w=12-b+1)-1]:-s[(w=b)-1]),v=E*E;if(v>60)break;var A=2*e.normal.cdf(E,0,1,1,0)*.5-2*e.normal.cdf(E,n,1,1,0)*.5;A>=t.exp(-30/h)&&(m+=A=l[w-1]*t.exp(-.5*v)*t.pow(A,h))}p+=m*=2*C*o/t.sqrt(2*t.PI),u=d,d+=f}return(c+=p)<=t.exp(-30/r)?0:(c=t.pow(c,r))>=1?1:c}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function e(t,n,r){return this instanceof e?(this._a=t,this._b=n,this._c=r,this):new e(t,n,r)},e.fn[t]=function(n,r,o){var s=e[t](n,r,o);return s.data=this,s},e[t].prototype.sample=function(n){var r=this._a,o=this._b,s=this._c;return n?e.alter(n,(function(){return e[t].sample(r,o,s)})):e[t].sample(r,o,s)},function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(r){var o=this._a,s=this._b,l=this._c;return r||0===r||(r=this.data),"number"!=typeof r?e.fn.map.call(r,(function(r){return e[t][n](r,o,s,l)})):e[t][n](r,o,s,l)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?t.pow(n,r-1)*t.pow(1-n,o-1)/e.betafn(r,o):t.exp((r-1)*t.log(n)+(o-1)*t.log(1-n)-e.betaln(r,o))},cdf:function(t,n,r){return t>1||t<0?1*(t>1):e.ibeta(t,n,r)},inv:function(t,n,r){return e.ibetainv(t,n,r)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var r=e.randg(t);return r/(r+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,r,o){var s;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/e.betafn(r/2,o/2)*t.pow(r/o,r/2)*t.pow(n,r/2-1)*t.pow(1+r/o*n,-(r+o)/2):(s=r*n/(o+n*r),r*(o/(o+n*r))/2*e.binomial.pdf((r-2)/2,(r+o-2)/2,s))},cdf:function(t,n,r){return t<0?0:e.ibeta(n*t/(n*t+r),n/2,r/2)},inv:function(t,n,r){return r/(n*(1/e.ibetainv(t,n/2,r/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,r){return r<0?0:r/(t.pow(e-n,2)+t.pow(r,2))/t.PI},cdf:function(e,n,r){return t.atan((e-n)/r)/t.PI+.5},inv:function(e,n,r){return n+r*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(n,r){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*r+n}}),e.extend(e.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:t.exp((r/2-1)*t.log(n)-n/2-r/2*t.log(2)-e.gammaln(r/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:t.exp((r-1)*t.log(n)-n/o-e.gammaln(r)-r*t.log(o))},cdf:function(t,n,r){return t<0?0:e.lowRegGamma(n,t/r)},inv:function(t,n,r){return e.gammapinv(t,n)*r},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,r,o){return n<=0?0:t.exp(-(r+1)*t.log(n)-o/n-e.gammaln(r)+r*t.log(o))},cdf:function(t,n,r){return t<=0?0:1-e.lowRegGamma(n,r/t)},inv:function(t,n,r){return r/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,r){return 0===e&&1===n?r:1===e&&1===r?n:t.exp(t.log(n)+t.log(r)+(n-1)*t.log(e)+(r-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,r){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),r)},inv:function(e,n,r){return t.pow(1-t.pow(1-e,1/r),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,r){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(e)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*e.erf((t.log(n)-r)/t.sqrt(2*o*o))},inv:function(n,r,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*n)+r)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,r){return t.exp(e.randn()*r+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,r,o){return t.abs(o)<1e-14?e.studentt.pdf(n,r):t.abs(n)<1e-14?t.exp(e.gammaln((r+1)/2)-o*o/2-.5*t.log(t.PI*r)-e.gammaln(r/2)):r/n*(e.noncentralt.cdf(n*t.sqrt(1+2/r),r+2,o)-e.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){var s=1e-14;if(t.abs(o)<s)return e.studentt.cdf(n,r);var l=!1;n<0&&(l=!0,o=-o);for(var i=e.normal.cdf(-o,0,1),a=s+1,c=a,u=n*n/(n*n+r),f=0,d=t.exp(-o*o/2),p=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;f<200||c>s||a>s;)c=a,f>0&&(d*=o*o/(2*f),p*=o*o/(2*(f+.5))),i+=.5*(a=d*e.beta.cdf(u,f+.5,r/2)+p*e.beta.cdf(u,f+1,r/2)),f++;return l?1-i:i}}),e.extend(e.normal,{pdf:function(e,n,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(e-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+e.erf((n-r)/t.sqrt(2*o*o)))},inv:function(t,n,r){return-1.4142135623730951*r*e.erfcinv(2*t)+n},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,r){return e<n?0:r*t.pow(n,r)/t.pow(e,r+1)},cdf:function(e,n,r){return e<n?0:1-t.pow(n/e,r)},inv:function(e,n,r){return n/t.pow(1-e,1/r)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*e.betafn(.5,r/2))*t.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return e.ibeta((n+t.sqrt(n*n+r))/(2*t.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=e.ibetainv(2*t.min(n,1-n),.5*r,.5);return o=t.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,r){return e<0||n<0||r<0?0:r/n*t.pow(e/n,r-1)*t.exp(-t.pow(e/n,r))},cdf:function(e,n,r){return e<0?0:1-t.exp(-t.pow(e/n,r))},inv:function(e,n,r){return n*t.pow(-t.log(1-e),1/r)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(n,r){return n*t.pow(-t.log(e._random_fn()),1/r)},variance:function(n,r){return n*n*e.gammafn(1+2/r)-t.pow(e.weibull.mean(n,r),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e._random_fn()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:e.combination(r,n)*t.pow(o,n)*t.pow(1-o,r-n)},cdf:function(r,o,s){var l,i=1e-10;if(r<0)return 0;if(r>=o)return 1;if(s<0||s>1||o<=0)return NaN;var a=s,c=(r=t.floor(r))+1,u=o-r,f=c+u,d=t.exp(e.gammaln(f)-e.gammaln(u)-e.gammaln(c)+c*t.log(a)+u*t.log(1-a));return l=a<(c+1)/(f+2)?d*n(a,c,u,i):1-d*n(1-a,u,c,i),t.round(1/i*(1-l))/(1/i)}}),e.extend(e.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:e.combination(n+r-1,r-1)*t.pow(1-o,n)*t.pow(o,r))},cdf:function(t,n,r){var o=0,s=0;if(t<0)return 0;for(;s<=t;s++)o+=e.negbin.pdf(s,n,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,r,o,s){if(n!=n|0)return!1;if(n<0||n<o-(r-s))return 0;if(n>s||n>o)return 0;if(2*o>r)return 2*s>r?e.hypgeom.pdf(r-o-s+n,r,r-o,r-s):e.hypgeom.pdf(s-n,r,r-o,s);if(2*s>r)return e.hypgeom.pdf(o-n,r,o,r-s);if(o<s)return e.hypgeom.pdf(n,r,s,o);for(var l=1,i=0,a=0;a<n;a++){for(;l>1&&i<s;)l*=1-o/(r-i),i++;l*=(s-a)*(o-a)/((a+1)*(r-o-s+a+1))}for(;i<s;i++)l*=1-o/(r-i);return t.min(1,t.max(0,l))},cdf:function(n,r,o,s){if(n<0||n<o-(r-s))return 0;if(n>=s||n>=o)return 1;if(2*o>r)return 2*s>r?e.hypgeom.cdf(r-o-s+n,r,r-o,r-s):1-e.hypgeom.cdf(s-n-1,r,r-o,s);if(2*s>r)return 1-e.hypgeom.cdf(o-n-1,r,o,r-s);if(o<s)return e.hypgeom.cdf(n,r,s,o);for(var l=1,i=1,a=0,c=0;c<n;c++){for(;l>1&&a<s;){var u=1-o/(r-a);i*=u,l*=u,a++}l+=i*=(s-c)*(o-c)/((c+1)*(r-o-s+c+1))}for(;a<s;a++)l*=1-o/(r-a);return t.min(1,t.max(0,l))}}),e.extend(e.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:t.pow(r,n)*t.exp(-r)/e.factorial(n)},cdf:function(t,n){var r=[],o=0;if(t<0)return 0;for(;o<=t;o++)r.push(e.poisson.pdf(o,n));return e.sum(r)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(n){var r=1,o=0,s=t.exp(-n);do{o++,r*=e._random_fn()}while(r>s);return o-1},sampleLarge:function(n){var r,o,s,l,i,a,c,u,f,d,p=n;for(l=t.sqrt(p),i=t.log(p),a=.02483*(c=.931+2.53*l)-.059,u=1.1239+1.1328/(c-3.4),f=.9277-3.6224/(c-2);;){if(o=t.random()-.5,s=t.random(),d=.5-t.abs(o),r=t.floor((2*a/d+c)*o+p+.43),d>=.07&&s<=f)return r;if(!(r<0||d<.013&&s>d)&&t.log(s)+t.log(u)-t.log(a/(d*d)+c)<=r*i-p-e.loggam(r+1))return r}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,n,r){return n<=t||r<t||r>n?NaN:e<t||e>n?0:e<r?2*(e-t)/((n-t)*(r-t)):e===r?2/(n-t):2*(n-e)/((n-t)*(n-r))},cdf:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=n?0:e>=r?1:e<=o?t.pow(e-n,2)/((r-n)*(o-n)):1-t.pow(r-e,2)/((r-n)*(r-o))},inv:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=(o-n)/(r-n)?n+(r-n)*t.sqrt(e*((o-n)/(r-n))):n+(r-n)*(1-t.sqrt((1-e)*(1-(o-n)/(r-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,r){return r<=(e+n)/2?n-t.sqrt((n-e)*(n-r))/t.sqrt(2):r>(e+n)/2?e+t.sqrt((n-e)*(r-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(n,r,o){var s=e._random_fn();return s<(o-n)/(r-n)?n+t.sqrt(s*(r-n)*(o-n)):r-t.sqrt((1-s)*(r-n)*(r-o))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,r){return r<=n?NaN:e<=n||e>=r?0:2/t.PI*t.pow(t.pow(r-n,2)-t.pow(2*e-n-r,2),-.5)},cdf:function(e,n,r){return e<n?0:e<r?2/t.PI*t.asin(t.sqrt((e-n)/(r-n))):1},inv:function(e,n,r){return n+(.5-.5*t.cos(t.PI*e))*(r-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,r){return r<=0?0:t.exp(-t.abs(e-n)/r)/(2*r)},cdf:function(e,n,r){return r<=0?0:e<n?.5*t.exp((e-n)/r):1-.5*t.exp(-(e-n)/r)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(n,r){var o,s=e._random_fn()-.5;return n-r*((o=s)/t.abs(o))*t.log(1-2*t.abs(s))}}),e.extend(e.tukey,{cdf:function(n,o,s){var l=o,i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],a=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(s<2||l<2)return NaN;if(!Number.isFinite(n))return 1;if(s>25e3)return r(n,1,l);var c,u=.5*s,f=u*t.log(s)-s*t.log(2)-e.gammaln(u),d=u-1,p=.25*s;c=s<=100?1:s<=800?.5:s<=5e3?.25:.125,f+=t.log(c);for(var h=0,g=1;g<=50;g++){for(var m=0,y=(2*g-1)*c,C=1;C<=16;C++){var b,w;8<C?(b=C-8-1,w=f+d*t.log(y+i[b]*c)-(i[b]*c+y)*p):(b=C-1,w=f+d*t.log(y-i[b]*c)+(i[b]*c-y)*p),w>=-30&&(m+=r(8<C?n*t.sqrt(.5*(i[b]*c+y)):n*t.sqrt(.5*(-i[b]*c+y)),1,l)*a[b]*t.exp(w))}if(g*c>=1&&m<=1e-14)break;h+=m}if(m>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var s,l=function(e,n,r){var o=.5-.5*e,s=t.sqrt(t.log(1/(o*o))),l=s+((((-453642210148e-16*s-.204231210125)*s-.342242088547)*s-1)*s+.322232421088)/((((.0038560700634*s+.10353775285)*s+.531103462366)*s+.588581570495)*s+.099348462606);r<120&&(l+=(l*l*l+l)/r/4);var i=.8832-.2368*l;return r<120&&(i+=-1.214/r+1.208*l/r),l*(i*t.log(n-1)+1.4142)}(n,r,o),i=e.tukey.cdf(l,r,o)-n;s=i>0?t.max(0,l-1):l+1;for(var a,c=e.tukey.cdf(s,r,o)-n,u=1;u<50;u++)if(a=s-c*(s-l)/(c-i),i=c,l=s,a<0&&(a=0,c=-n),c=e.tukey.cdf(a,r,o)-n,s=a,t.abs(s-l)<1e-4)return a;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var n,r,o=Array.prototype.push,s=e.utils.isArray;function l(t){return s(t)||t instanceof e}e.extend({add:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,(function(e,t,r){return e+n[t][r]}))):e.map(t,(function(e){return e+n}))},subtract:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,(function(e,t,r){return e-n[t][r]||0}))):e.map(t,(function(e){return e-n}))},divide:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.multiply(t,e.inv(n))):e.map(t,(function(e){return e/n}))},multiply:function(t,n){var r,o,s,i,a,c,u,f;if(void 0===t.length&&void 0===n.length)return t*n;if(a=t.length,c=t[0].length,u=e.zeros(a,s=l(n)?n[0].length:c),f=0,l(n)){for(;f<s;f++)for(r=0;r<a;r++){for(i=0,o=0;o<c;o++)i+=t[r][o]*n[o][f];u[r][f]=i}return 1===a&&1===f?u[0][0]:u}return e.map(t,(function(e){return e*n}))},outer:function(t,n){return e.multiply(t.map((function(e){return[e]})),[n])},dot:function(t,n){l(t[0])||(t=[t]),l(n[0])||(n=[n]);for(var r,o,s=1===t[0].length&&1!==t.length?e.transpose(t):t,i=1===n[0].length&&1!==n.length?e.transpose(n):n,a=[],c=0,u=s.length,f=s[0].length;c<u;c++){for(a[c]=[],r=0,o=0;o<f;o++)r+=s[c][o]*i[c][o];a[c]=r}return 1===a.length?a[0]:a},pow:function(n,r){return e.map(n,(function(e){return t.pow(e,r)}))},exp:function(n){return e.map(n,(function(e){return t.exp(e)}))},log:function(n){return e.map(n,(function(e){return t.log(e)}))},abs:function(n){return e.map(n,(function(e){return t.abs(e)}))},norm:function(e,n){var r=0,o=0;for(isNaN(n)&&(n=2),l(e[0])&&(e=e[0]);o<e.length;o++)r+=t.pow(t.abs(e[o]),n);return t.pow(r,1/n)},angle:function(n,r){return t.acos(e.dot(n,r)/(e.norm(n)*e.norm(r)))},aug:function(e,t){var n,r=[];for(n=0;n<e.length;n++)r.push(e[n].slice());for(n=0;n<r.length;n++)o.apply(r[n],t[n]);return r},inv:function(t){for(var n,r=t.length,o=t[0].length,s=e.identity(r,o),l=e.gauss_jordan(t,s),i=[],a=0;a<r;a++)for(i[a]=[],n=o;n<l[0].length;n++)i[a][n-o]=l[a][n];return i},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,r=0;r<t.length;r++){for(var o=[],s=1;s<t.length;s++){o[s-1]=[];for(var l=0;l<t.length;l++)l<r?o[s-1][l]=t[s][l]:l>r&&(o[s-1][l-1]=t[s][l])}var i=r%2?-1:1;n+=e(o)*t[0][r]*i}return n},gauss_elimination:function(n,r){var o,s,l,i,a=0,c=0,u=n.length,f=n[0].length,d=1,p=0,h=[];for(o=(n=e.aug(n,r))[0].length,a=0;a<u;a++){for(s=n[a][a],c=a,i=a+1;i<f;i++)s<t.abs(n[i][a])&&(s=n[i][a],c=i);if(c!=a)for(i=0;i<o;i++)l=n[a][i],n[a][i]=n[c][i],n[c][i]=l;for(c=a+1;c<u;c++)for(d=n[c][a]/n[a][a],i=a;i<o;i++)n[c][i]=n[c][i]-d*n[a][i]}for(a=u-1;a>=0;a--){for(p=0,c=a+1;c<=u-1;c++)p+=h[c]*n[a][c];h[a]=(n[a][o-1]-p)/n[a][a]}return h},gauss_jordan:function(n,r){var o,s,l,i=e.aug(n,r),a=i.length,c=i[0].length,u=0;for(s=0;s<a;s++){var f=s;for(l=s+1;l<a;l++)t.abs(i[l][s])>t.abs(i[f][s])&&(f=l);var d=i[s];for(i[s]=i[f],i[f]=d,l=s+1;l<a;l++)for(u=i[l][s]/i[s][s],o=s;o<c;o++)i[l][o]-=i[s][o]*u}for(s=a-1;s>=0;s--){for(u=i[s][s],l=0;l<s;l++)for(o=c-1;o>s-1;o--)i[l][o]-=i[s][o]*i[l][s]/u;for(i[s][s]/=u,o=a;o<c;o++)i[s][o]/=u}return i},triaUpSolve:function(t,n){var r,o=t[0].length,s=e.zeros(1,o)[0],l=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),l=!0),e.arange(o-1,-1,-1).forEach((function(l){r=e.arange(l+1,o).map((function(e){return s[e]*t[l][e]})),s[l]=(n[l]-e.sum(r))/t[l][l]})),l?s.map((function(e){return[e]})):s},triaLowSolve:function(t,n){var r,o=t[0].length,s=e.zeros(1,o)[0],l=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),l=!0),e.arange(o).forEach((function(o){r=e.arange(o).map((function(e){return t[o][e]*s[e]})),s[o]=(n[o]-e.sum(r))/t[o][o]})),l?s.map((function(e){return[e]})):s},lu:function(t){var n,r=t.length,o=e.identity(r),s=e.zeros(t.length,t[0].length);return e.arange(r).forEach((function(e){s[0][e]=t[0][e]})),e.arange(1,r).forEach((function(l){e.arange(l).forEach((function(r){n=e.arange(r).map((function(e){return o[l][e]*s[e][r]})),o[l][r]=(t[l][r]-e.sum(n))/s[r][r]})),e.arange(l,r).forEach((function(r){n=e.arange(l).map((function(e){return o[l][e]*s[e][r]})),s[l][r]=t[n.length][r]-e.sum(n)}))})),[o,s]},cholesky:function(n){var r,o=n.length,s=e.zeros(n.length,n[0].length);return e.arange(o).forEach((function(l){r=e.arange(l).map((function(e){return t.pow(s[l][e],2)})),s[l][l]=t.sqrt(n[l][l]-e.sum(r)),e.arange(l+1,o).forEach((function(t){r=e.arange(l).map((function(e){return s[l][e]*s[t][e]})),s[t][l]=(n[l][t]-e.sum(r))/s[l][l]}))})),s},gauss_jacobi:function(n,r,o,s){for(var l,i,a,c,u=0,f=0,d=n.length,p=[],h=[],g=[];u<d;u++)for(p[u]=[],h[u]=[],g[u]=[],f=0;f<d;f++)u>f?(p[u][f]=n[u][f],h[u][f]=g[u][f]=0):u<f?(h[u][f]=n[u][f],p[u][f]=g[u][f]=0):(g[u][f]=n[u][f],p[u][f]=h[u][f]=0);for(a=e.multiply(e.multiply(e.inv(g),e.add(p,h)),-1),i=e.multiply(e.inv(g),r),l=o,c=e.add(e.multiply(a,o),i),u=2;t.abs(e.norm(e.subtract(c,l)))>s;)l=c,c=e.add(e.multiply(a,l),i),u++;return c},gauss_seidel:function(n,r,o,s){for(var l,i,a,c,u,f=0,d=n.length,p=[],h=[],g=[];f<d;f++)for(p[f]=[],h[f]=[],g[f]=[],l=0;l<d;l++)f>l?(p[f][l]=n[f][l],h[f][l]=g[f][l]=0):f<l?(h[f][l]=n[f][l],p[f][l]=g[f][l]=0):(g[f][l]=n[f][l],p[f][l]=h[f][l]=0);for(c=e.multiply(e.multiply(e.inv(e.add(g,p)),h),-1),a=e.multiply(e.inv(e.add(g,p)),r),i=o,u=e.add(e.multiply(c,o),a),f=2;t.abs(e.norm(e.subtract(u,i)))>s;)i=u,u=e.add(e.multiply(c,i),a),f+=1;return u},SOR:function(n,r,o,s,l){for(var i,a,c,u,f,d=0,p=n.length,h=[],g=[],m=[];d<p;d++)for(h[d]=[],g[d]=[],m[d]=[],i=0;i<p;i++)d>i?(h[d][i]=n[d][i],g[d][i]=m[d][i]=0):d<i?(g[d][i]=n[d][i],h[d][i]=m[d][i]=0):(m[d][i]=n[d][i],h[d][i]=g[d][i]=0);for(u=e.multiply(e.inv(e.add(m,e.multiply(h,l))),e.subtract(e.multiply(m,1-l),e.multiply(g,l))),c=e.multiply(e.multiply(e.inv(e.add(m,e.multiply(h,l))),r),l),a=o,f=e.add(e.multiply(u,o),c),d=2;t.abs(e.norm(e.subtract(f,a)))>s;)a=f,f=e.add(e.multiply(u,a),c),d++;return f},householder:function(n){for(var r,o,s,l,i=n.length,a=n[0].length,c=0,u=[],f=[];c<i-1;c++){for(r=0,l=c+1;l<a;l++)r+=n[l][c]*n[l][c];for(r=(n[c+1][c]>0?-1:1)*t.sqrt(r),o=t.sqrt((r*r-n[c+1][c]*r)/2),(u=e.zeros(i,1))[c+1][0]=(n[c+1][c]-r)/(2*o),s=c+2;s<i;s++)u[s][0]=n[s][c]/(2*o);f=e.subtract(e.identity(i,a),e.multiply(e.multiply(u,e.transpose(u)),2)),n=e.multiply(f,e.multiply(n,f))}return n},QR:(n=e.sum,r=e.arange,function(o){var s,l,i,a=o.length,c=o[0].length,u=e.zeros(c,c);for(o=e.copy(o),l=0;l<c;l++){for(u[l][l]=t.sqrt(n(r(a).map((function(e){return o[e][l]*o[e][l]})))),s=0;s<a;s++)o[s][l]=o[s][l]/u[l][l];for(i=l+1;i<c;i++)for(u[l][i]=n(r(a).map((function(e){return o[e][l]*o[e][i]}))),s=0;s<a;s++)o[s][i]=o[s][i]-o[s][l]*u[l][i]}return[o,u]}),lstsq:function(t,n){var r=!1;void 0===n[0].length&&(n=n.map((function(e){return[e]})),r=!0);var o=e.QR(t),s=o[0],l=o[1],i=t[0].length,a=e.slice(s,{col:{end:i}}),c=function(t){var n=(t=e.copy(t)).length,r=e.identity(n);return e.arange(n-1,-1,-1).forEach((function(n){e.sliceAssign(r,{row:n},e.divide(e.slice(r,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach((function(o){var s=e.multiply(t[o][n],-1),l=e.slice(t,{row:o}),i=e.multiply(e.slice(t,{row:n}),s);e.sliceAssign(t,{row:o},e.add(l,i));var a=e.slice(r,{row:o}),c=e.multiply(e.slice(r,{row:n}),s);e.sliceAssign(r,{row:o},e.add(a,c))}))})),r}(e.slice(l,{row:{end:i}})),u=e.transpose(a);void 0===u[0].length&&(u=[u]);var f=e.multiply(e.multiply(c,u),n);return void 0===f.length&&(f=[[f]]),r?f.map((function(e){return e[0]})):f},jacobi:function(n){for(var r,o,s,l,i,a,c,u=1,f=n.length,d=e.identity(f,f),p=[];1===u;){for(i=n[0][1],s=0,l=1,r=0;r<f;r++)for(o=0;o<f;o++)r!=o&&i<t.abs(n[r][o])&&(i=t.abs(n[r][o]),s=r,l=o);for(a=n[s][s]===n[l][l]?n[s][l]>0?t.PI/4:-t.PI/4:t.atan(2*n[s][l]/(n[s][s]-n[l][l]))/2,(c=e.identity(f,f))[s][s]=t.cos(a),c[s][l]=-t.sin(a),c[l][s]=t.sin(a),c[l][l]=t.cos(a),d=e.multiply(d,c),n=e.multiply(e.multiply(e.inv(c),n),c),u=0,r=1;r<f;r++)for(o=1;o<f;o++)r!=o&&t.abs(n[r][o])>.001&&(u=1)}for(r=0;r<f;r++)p.push(n[r][r]);return[d,p]},rungekutta:function(e,t,n,r,o,s){var l,i,a;if(2===s)for(;r<=n;)o+=((l=t*e(r,o))+(i=t*e(r+t,o+l)))/2,r+=t;if(4===s)for(;r<=n;)o+=((l=t*e(r,o))+2*(i=t*e(r+t/2,o+l/2))+2*(a=t*e(r+t/2,o+i/2))+t*e(r+t,o+a))/6,r+=t;return o},romberg:function(e,n,r,o){for(var s,l,i,a,c,u=0,f=(r-n)/2,d=[],p=[],h=[];u<o/2;){for(c=e(n),i=n,a=0;i<=r;i+=f,a++)d[a]=i;for(s=d.length,i=1;i<s-1;i++)c+=(i%2!=0?4:2)*e(d[i]);c=f/3*(c+e(r)),h[u]=c,f/=2,u++}for(l=h.length,s=1;1!==l;){for(i=0;i<l-1;i++)p[i]=(t.pow(4,s)*h[i+1]-h[i])/(t.pow(4,s)-1);l=p.length,h=p,p=[],s++}return h},richardson:function(e,n,r,o){function s(e,t){for(var n,r=0,o=e.length;r<o;r++)e[r]===t&&(n=r);return n}for(var l,i,a,c,u,f=t.abs(r-e[s(e,r)+1]),d=0,p=[],h=[];o>=f;)l=s(e,r+o),i=s(e,r),p[d]=(n[l]-2*n[i]+n[2*i-l])/(o*o),o/=2,d++;for(c=p.length,a=1;1!=c;){for(u=0;u<c-1;u++)h[u]=(t.pow(4,a)*p[u+1]-p[u])/(t.pow(4,a)-1);c=h.length,p=h,h=[],a++}return p},simpson:function(e,t,n,r){for(var o,s=(n-t)/r,l=e(t),i=[],a=t,c=0,u=1;a<=n;a+=s,c++)i[c]=a;for(o=i.length;u<o-1;u++)l+=(u%2!=0?4:2)*e(i[u]);return s/3*(l+e(n))},hermite:function(e,t,n,r){for(var o,s=e.length,l=0,i=0,a=[],c=[],u=[],f=[];i<s;i++){for(a[i]=1,o=0;o<s;o++)i!=o&&(a[i]*=(r-e[o])/(e[i]-e[o]));for(c[i]=0,o=0;o<s;o++)i!=o&&(c[i]+=1/(e[i]-e[o]));u[i]=(1-2*(r-e[i])*c[i])*(a[i]*a[i]),f[i]=(r-e[i])*(a[i]*a[i]),l+=u[i]*t[i]+f[i]*n[i]}return l},lagrange:function(e,t,n){for(var r,o,s=0,l=0,i=e.length;l<i;l++){for(o=t[l],r=0;r<i;r++)l!=r&&(o*=(n-e[r])/(e[l]-e[r]));s+=o}return s},cubic_spline:function(t,n,r){for(var o,s,l=t.length,i=0,a=[],c=[],u=[],f=[],d=[],p=[];i<l-1;i++)f[i]=t[i+1]-t[i];for(u[0]=0,i=1;i<l-1;i++)u[i]=3/f[i]*(n[i+1]-n[i])-3/f[i-1]*(n[i]-n[i-1]);for(i=1;i<l-1;i++)a[i]=[],c[i]=[],a[i][i-1]=f[i-1],a[i][i]=2*(f[i-1]+f[i]),a[i][i+1]=f[i],c[i][0]=u[i];for(s=e.multiply(e.inv(a),c),o=0;o<l-1;o++)d[o]=(n[o+1]-n[o])/f[o]-f[o]*(s[o+1][0]+2*s[o][0])/3,p[o]=(s[o+1][0]-s[o][0])/(3*f[o]);for(o=0;o<l&&!(t[o]>r);o++);return n[o-=1]+(r-t[o])*d[o]+e.sq(r-t[o])*s[o]+(r-t[o])*e.sq(r-t[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,r,o,s,l,i=t.length,a=t[0].length,c=0,u=[],f=[],d=[],p=[],h=[],g=[],m=[];for(c=0;c<i;c++)u[c]=e.sum(t[c])/a;for(c=0;c<a;c++)for(h[c]=[],n=0;n<i;n++)h[c][n]=t[n][c]-u[n];for(h=e.transpose(h),c=0;c<i;c++)for(g[c]=[],n=0;n<i;n++)g[c][n]=e.dot([h[c]],[h[n]])/(a-1);for(l=(o=e.jacobi(g))[0],f=o[1],m=e.transpose(l),c=0;c<f.length;c++)for(n=c;n<f.length;n++)f[c]<f[n]&&(r=f[c],f[c]=f[n],f[n]=r,d=m[c],m[c]=m[n],m[n]=d);for(s=e.transpose(h),c=0;c<i;c++)for(p[c]=[],n=0;n<s.length;n++)p[c][n]=e.dot([m[c]],[s[n]]);return[t,f,m,p]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,r){var o=this;return r?(setTimeout((function(){r.call(o,e.fn[t].call(o,n))}),15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var n=[].slice,r=e.utils.isNumber,o=e.utils.isArray;function s(e,n,r,o){if(e>1||r>1||e<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var s=(e*n+r*o)/(n+o);return(e-r)/t.sqrt(s*(1-s)*(1/n+1/o))}e.extend({zscore:function(){var t=n.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var r,s=n.call(arguments);return o(s[1])?(r=e.zscore(s[0],s[1],s[3]),1===s[2]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):s.length>2?(r=e.zscore(s[0],s[1],s[2]),1===s[3]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1)):(r=s[0],1===s[1]?e.normal.cdf(-t.abs(r),0,1):2*e.normal.cdf(-t.abs(r),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,r,o){var s=t.abs(this.zscore(n,o));return 1===r?e.normal.cdf(-s,0,1):2*e.normal.cdf(-s,0,1)}}),e.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-e.mean(r[1]))/(e.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var o,s=n.call(arguments);return 5===s.length?(o=t.abs(e.tscore(s[0],s[1],s[2],s[3])),1===s[4]?e.studentt.cdf(-o,s[3]-1):2*e.studentt.cdf(-o,s[3]-1)):r(s[1])?(o=t.abs(s[0]),1==s[2]?e.studentt.cdf(-o,s[1]-1):2*e.studentt.cdf(-o,s[1]-1)):(o=t.abs(e.tscore(s[0],s[1])),1==s[2]?e.studentt.cdf(-o,s[1].length-1):2*e.studentt.cdf(-o,s[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var r,o,s,l,i,a,c,u,f=n.call(arguments);if(1===f.length){for(i=new Array(f[0].length),c=0;c<f[0].length;c++)i[c]=f[0][c];f=i}for(o=new Array,c=0;c<f.length;c++)o=o.concat(f[c]);for(s=e.mean(o),r=0,c=0;c<f.length;c++)r+=f[c].length*t.pow(e.mean(f[c])-s,2);for(r/=f.length-1,a=0,c=0;c<f.length;c++)for(l=e.mean(f[c]),u=0;u<f[c].length;u++)a+=t.pow(f[c][u]-l,2);return r/(a/(o.length-f.length))},anovaftest:function(){var t,o,s,l,i=n.call(arguments);if(r(i[0]))return 1-e.centralF.cdf(i[0],i[1],i[2]);var a=e.anovafscore(i);for(t=i.length-1,s=0,l=0;l<i.length;l++)s+=i[l].length;return o=s-t-1,1-e.centralF.cdf(a,t,o)},ftest:function(t,n,r){return 1-e.centralF.cdf(t,n,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var o,s,l,i,a,c=n.call(arguments);return r(c[0])?(o=c[0],s=c[1],l=c[2],i=c[3],a=c[4]):(o=e.mean(c[0]),s=e.mean(c[1]),l=c[0].length,i=c[1].length,a=c[2]),t.abs(o-s)/(a*t.sqrt((1/l+1/i)/2))},qtest:function(){var t,r=n.call(arguments);3===r.length?(t=r[0],r=r.slice(1)):7===r.length?(t=e.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(t=e.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],s=r[1];return 1-e.tukey.cdf(t,s,o-s)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),r=t.map((function(t){return e.mean(t)})),o=t.reduce((function(e,t){return e+t.length}),0),s=[],l=0;l<t.length;++l)for(var i=l+1;i<t.length;++i){var a=e.qtest(r[l],r[i],t[l].length,t[i].length,n,o,t.length);s.push([[l,i],a])}return s}}),e.extend({normalci:function(){var r,o=n.call(arguments),s=new Array(2);return r=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),s[0]=o[0]-r,s[1]=o[0]+r,s},tci:function(){var r,o=n.call(arguments),s=new Array(2);return r=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),s[0]=o[0]-r,s[1]=o[0]+r,s},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,n,r,o){var l=s(t,n,r,o);return e.ztest(l,1)},twoSidedDifferenceOfProportions:function(t,n,r,o){var l=s(t,n,r,o);return e.ztest(l,2)}})}(t,Math),t.models=function(){function e(e,n){var r=e.length,o=n[0].length-1,s=r-o-1,l=t.lstsq(n,e),i=t.multiply(n,l.map((function(e){return[e]}))).map((function(e){return e[0]})),a=t.subtract(e,i),c=t.mean(e),u=t.sum(i.map((function(e){return Math.pow(e-c,2)}))),f=t.sum(e.map((function(e,t){return Math.pow(e-i[t],2)}))),d=u+f;return{exog:n,endog:e,nobs:r,df_model:o,df_resid:s,coef:l,predict:i,resid:a,ybar:c,SST:d,SSE:u,SSR:f,R2:u/d}}return{ols:function(n,r){var o=e(n,r),s=function(n){var r,o,s=(r=n.exog,o=r[0].length,t.arange(o).map((function(n){var s=t.arange(o).filter((function(e){return e!==n}));return e(t.col(r,n).map((function(e){return e[0]})),t.col(r,s))}))),l=Math.sqrt(n.SSR/n.df_resid),i=s.map((function(e){var t=e.SST,n=e.R2;return l/Math.sqrt(t*(1-n))})),a=n.coef.map((function(e,t){return(e-0)/i[t]})),c=a.map((function(e){var r=t.studentt.cdf(e,n.df_resid);return 2*(r>.5?1-r:r)})),u=t.studentt.inv(.975,n.df_resid),f=n.coef.map((function(e,t){var n=u*i[t];return[e-n,e+n]}));return{se:i,t:a,p:c,sigmaHat:l,interval95:f}}(o),l=function(e){var n,r,o,s=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:s,pvalue:1-(n=s,r=e.df_model,o=e.df_resid,t.beta.cdf(n/(o/r+n),r/2,o/2))}}(o),i=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=s,o.f=l,o.adjust_R2=i,o}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=[1].concat(arguments[n]);return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++)e[n]=[1].concat(arguments[0][n]);return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,n){var r,o,s,l,i;if(e.cols()==n.rows()){if(n.rows()>1){for(l=[],r=0;r<e.rows();r++)for(l[r]=[],o=0;o<n.cols();o++){for(i=0,s=0;s<e.cols();s++)i+=e.toArray()[r][s]*n.toArray()[s][o];l[r][o]=i}return t(l)}for(l=[],r=0;r<e.rows();r++)for(l[r]=[],o=0;o<n.cols();o++){for(i=0,s=0;s<e.cols();s++)i+=e.toArray()[r][s]*n.toArray()[o];l[r][o]=i}return t(l)}},regress:function(e,n){var r=t.xtranspxinv(e),o=e.transpose(),s=t.matrixmult(t(r),o);return t.matrixmult(s,n)},regresst:function(e,n,r){var o=t.regress(e,n),s={anova:{}},l=t.jMatYBar(e,o);s.yBar=l;var i=n.mean();s.anova.residuals=t.residuals(n,l),s.anova.ssr=t.ssr(l,i),s.anova.msr=s.anova.ssr/(e[0].length-1),s.anova.sse=t.sse(n,l),s.anova.mse=s.anova.sse/(n.length-(e[0].length-1)-1),s.anova.sst=t.sst(n,i),s.anova.mst=s.anova.sst/(n.length-1),s.anova.r2=1-s.anova.sse/s.anova.sst,s.anova.r2<0&&(s.anova.r2=0),s.anova.fratio=s.anova.msr/s.anova.mse,s.anova.pvalue=t.anovaftest(s.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),s.anova.rmse=Math.sqrt(s.anova.mse),s.anova.r2adj=1-s.anova.mse/s.anova.mst,s.anova.r2adj<0&&(s.anova.r2adj=0),s.stats=new Array(e[0].length);for(var a,c,u,f=t.xtranspxinv(e),d=0;d<o.length;d++)a=Math.sqrt(s.anova.mse*Math.abs(f[d][d])),c=Math.abs(o[d]/a),u=t.ttest(c,n.length-e[0].length-1,r),s.stats[d]=[o[d],a,c,u];return s.regress=o,s},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e);return t.inv(n)},jMatYBar:function(e,n){var r=t.matrixmult(e,n);return new t(r)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},sse:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},sst:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},matrixsubtract:function(e,n){for(var r=new Array(e.length),o=0;o<e.length;o++){r[o]=new Array(e[o].length);for(var s=0;s<e[o].length;s++)r[o][s]=e[o][s]-n[o][s]}return t(r)}}),t.jStat=t,t)},960:function(e,t,n){const r=n(592);e.exports=function(e){function t(e,t){const n=t.split(".");let r=e;for(const e of n){if(null==r)return;r=r[e]}return r}for(let n=0;n<Object.keys(r).length;n++){let o,s=Object.keys(r)[n],l=[];if("object"==typeof r[s]){l=Object.keys(r[s]),o=Object.values(r[s]);for(let e=0;e<o.length;e++)if("object"==typeof o[e]){let t=l[e];r[s][t]&&(l=[...l,...Object.keys(r[s][t]).map((e=>t+"."+e))],l.splice(l.indexOf(t),1))}}if(l.length<1)e[s]=r[s];else for(let n=0;n<l.length;n++)"function"==typeof t(r[s],l[n])&&(e[s]=t(r[s],l[n]))}let n=function(e){return"number"==typeof e&&(e=parseInt(e)),e},o=null,s=null,l=null;e.TABLE=function(){return l},e.COLUMN=e.COL=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(o),n(s))),n(o)+1},e.ROW=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(o),n(s))),n(s)+1},e.CELL=function(){return c.getColumnNameFromCoords(o,s)},e.VALUE=function(e,t,r){return l.getValueFromCoords(n(e)-1,n(t)-1,r)},e.THISROWCELL=function(e){return l.getValueFromCoords(n(e)-1,n(s))};const i=function(e,t){for(let n=0;n<e.length;n++){let r=c.getTokensFromRange(e[n]);t=t.replace(e[n],"["+r.join(",")+"]")}return t},a=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},c=function(e,t,n,r,c){l=c,o=n,s=r;let u="",f={};if(t)if(t.size){let e,n=null;t.forEach((function(t,n){e=n.replace(/!/g,"."),-1!==e.indexOf(".")&&(e=e.split("."),f[e[0]]=!0)})),e=Object.keys(f);for(let t=0;t<e.length;t++)u+="var "+e[t]+" = {};";t.forEach((function(r,o){e=o.replace(/!/g,"."),null===r||a(r)||(n=r.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),n&&n.length&&(r=updateRanges(n,r))),e.indexOf(".")>0?u+=e+" = "+t.get(o)+";\n":u+="var "+e+" = "+r+";\n"}))}else{let e=Object.keys(t);if(e.length){let n,r={};for(let t=0;t<e.length;t++)if(n=e[t].replace(/\!/g,"."),n.indexOf(".")>0){let e=e.split(".");r[e[0]]={}}n=Object.keys(r);for(let e=0;e<n.length;e++)u+="var "+n[e]+" = {};";for(let r=0;r<e.length;r++){if(n=e[r].replace(/!/g,"."),null!==t[e[r]]&&!a(t[e[r]])){let n=t[e[r]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);n&&n.length&&(t[e[r]]=i(n,t[e[r]]))}n.indexOf(".")>0?u+=n+" = "+t[e[r]]+";\n":u+="var "+n+" = "+t[e[r]]+";\n"}}}let d=(e=function(e,t){let n="",r=0,o=["=","!",">","<"];for(let t=0;t<e.length;t++)'"'===e[t]&&(r=0===r?1:0),1===r?n+=e[t]:(n+=e[t].toUpperCase(),t>0&&"="===e[t]&&-1===o.indexOf(e[t-1])&&-1===o.indexOf(e[t+1])&&(n+="="));return n=n.replace(/\^/g,"**"),n=n.replace(/<>/g,"!="),n=n.replace(/&/g,"+"),n=n.replace(/\$/g,""),n}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);d&&d.length&&(e=i(d,e));let p=new Function(u+"; return "+e)();return null===p&&(p=0),p};return c.getColumnNameFromCoords=function(e,t){return r="",(n=parseInt(e))>701?(r+=String.fromCharCode(64+parseInt(n/676)),r+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(r+=String.fromCharCode(64+parseInt(n/26))),r+String.fromCharCode(65+n%26)+(parseInt(t)+1);var n,r},c.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,r=0;r<t[0].length;r++)n+=parseInt(t[0].charCodeAt(r)-64)*Math.pow(26,t[0].length-1-r);--n<0&&(n=0);var o=parseInt(/[0-9]+$/.exec(e))||null;return o>0&&o--,[n,o]}},c.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",r=0;r<e.length;r++)e[r].indexOf(".")>=0?t=".":e[r].indexOf("!")>=0&&(t="!"),t&&(n=e[r].split(t),e[r]=n[1],n=n[0]+t);return e.sort((function(e,t){var n=Helpers.getCoordsFromColumnName(e),r=Helpers.getCoordsFromColumnName(t);return n[1]>r[1]?1:n[1]<r[1]?-1:n[0]>r[0]?1:n[0]<r[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},c.getTokensFromRange=function(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=c.getCoordsFromColumnName(e[0]),r=c.getCoordsFromColumnName(e[1]);if(n[0]<=r[0])var o=n[0],s=r[0];else o=r[0],s=n[0];if(null===n[1]&&null==r[1])for(var l=null,i=null,a=Object.keys(vars),u=0;u<a.length;u++){var f=c.getCoordsFromColumnName(a[u]);f[0]===n[0]&&(null===l||f[1]<l)&&(l=f[1]),f[0]===r[0]&&(null===i||f[1]>i)&&(i=f[1])}else n[1]<=r[1]?(l=n[1],i=r[1]):(l=r[1],i=n[1]);for(var d=[],p=l;p<=i;p++){var h=[];for(u=o;u<=s;u++)h.push(t+c.getColumnNameFromCoords(u,p));d.push(h)}return d},c.setFormula=function(t){let n=Object.keys(t);for(let r=0;r<n.length;r++)"function"==typeof t[n[r]]&&(e[n[r]]=t[n[r]])},c.basic=!0,c}("undefined"==typeof window?n.g:window)},592:function(e,t,n){var r=n(162),o=n(765);const s=new Error("#NULL!"),l=new Error("#DIV/0!"),i=new Error("#VALUE!"),a=new Error("#REF!"),c=new Error("#NAME?"),u=new Error("#NUM!"),f=new Error("#N/A"),d=new Error("#ERROR!"),p=new Error("#GETTING_DATA");var h=Object.freeze({__proto__:null,data:p,div0:l,error:d,na:f,name:c,nil:s,num:u,ref:a,value:i});function g(e){const t=[];return m(e,(e=>{t.push(e)})),t}function m(e,t){let n=-1;const r=e.length;for(;++n<r&&!1!==t(e[n],n,e););return e}function y(e){let t,n=e.length;for(;n--;)if(t=e[n],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const r=T(t);e[n]=r instanceof Error?0:r}}else e[n]=0;else e[n]=1;return e}function C(e,t){if(!e)return i;e.every((e=>Array.isArray(e)))&&0!==e.length||(e=[[...e]]),e.map(((t,n)=>{t.map(((t,r)=>{t||(e[n][r]=0)}))}));const n=e.reduce(((t,n,r)=>n.length>e[t].length?r:t),0),r=e[n].length;return e.map((e=>[...e,...Array(r-e.length).fill(t||0)]))}function b(){let e;if(1===arguments.length){const n=arguments[0];e=null!=(t=n)&&"number"==typeof t.length&&"string"!=typeof t?g.apply(null,arguments):[n]}else e=Array.from(arguments);for(var t;!E(e);)e=w(e);return e}function w(e){return e&&e.reduce?e.reduce(((e,t)=>{const n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]})):[e]}function E(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function v(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function A(e){return e?e[0].map(((t,n)=>e.map((e=>e[n])))):i}function j(e,t){let n=null;return m(e,((e,r)=>{if(e[0]===t)return n=r,!1})),null==n?i:n}function M(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function _(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function I(e){const t=1e14;return Math.round(e*t)/t}function x(){return b.apply(null,arguments).filter((e=>"number"==typeof e))}function D(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||i}function N(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?u:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),n=new Date(86400*t*1e3),r=e-Math.floor(e)+1e-7;let o=Math.floor(86400*r);const s=o%60;o-=s;const l=Math.floor(o/3600),i=Math.floor(o/60)%60;let a=n.getUTCDate(),c=n.getUTCMonth();return e>=60&&e<61&&(a=29,c=1),new Date(n.getUTCFullYear(),c,a,l,i,s)}(t)}return"string"!=typeof e||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?i:e}function S(e){let t,n=e.length;for(;n--;){if(t=N(e[n]),t===i)return t;e[n]=t}return e}function T(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?i:parseFloat(e))}function L(e){let t,n;if(!e||0===(t=e.length))return i;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=T(e[t]),n instanceof Error)return n;e[t]=n}return e}function O(e){return e instanceof Error?e:null==e?"":e.toString()}function R(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function F(e){return null!=e}const k="=",B=[">",">=","<","<=","=","<>"],P="operator",H="literal",q=[P,H],V=P,U=H;function W(e,t){if(-1===q.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function z(e){return function(e){let t="";const n=[];for(let r=0;r<e.length;r++){const o=e[r];0===r&&B.indexOf(o)>=0?n.push(W(o,V)):t+=o}return t.length>0&&n.push(W(function(e){return"string"!=typeof e||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e}(t),U)),n.length>0&&n[0].type!==V&&n.unshift(W(k,V)),n}(function(e){const t=e.length,n=[];let r=0,o="",s="";for(;r<t;){const t=e.charAt(r);switch(t){case">":case"<":case"=":s+=t,o.length>0&&(n.push(o),o="");break;default:s.length>0&&(n.push(s),s=""),o+=t}r++}return o.length>0&&n.push(o),s.length>0&&n.push(s),n}(e))}const Y=function(e){const t=[];let n;for(let r=0;r<e.length;r++){const o=e[r];switch(o.type){case V:n=o.value;break;case U:t.push(o.value)}}return function(e,t){let n=!1;switch(t){case">":n=e[0]>e[1];break;case">=":n=e[0]>=e[1];break;case"<":n=e[0]<e[1];break;case"<=":n=e[0]<=e[1];break;case"=":n=e[0]==e[1];break;case"<>":n=e[0]!=e[1]}return n}(t,n)},K={};function X(e){return[i,a,l,u,c,s].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function G(e){return X(e)||e===f}function Z(e){return!0===e||!1===e}function $(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function J(e){return"string"==typeof e}function Q(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const r=arguments[t];for(let t=0;t<e.length&&(n=e[t]===r,!n);++t);n||e.push(r)}return e}function ee(e,t,n,r){if(!t||!n)return f;r=!(0===r||!1===r);let o=f;const s="number"==typeof e;let l=!1;for(let i=0;i<t.length;i++){const c=t[i];if(c[0]===e){o=n<c.length+1?c[n-1]:a;break}!l&&(s&&r&&c[0]<=e||r&&"string"==typeof c[0]&&c[0].localeCompare(e)<0)&&(o=n<c.length+1?c[n-1]:a),s&&c[0]>e&&(l=!0)}return o}function te(){const e=b(arguments).filter(F);if(0===e.length)return l;const t=M.apply(void 0,e);if(t)return t;const n=x(e),r=n.length;let o,s=0,i=0;for(let e=0;e<r;e++)s+=n[e],i+=1;return o=s/i,isNaN(o)&&(o=u),o}function ne(){const e=b(arguments).filter(F);if(0===e.length)return l;const t=M.apply(void 0,e);if(t)return t;const n=e,r=n.length;let o,s=0,i=0;for(let e=0;e<r;e++){const t=n[e];"number"==typeof t&&(s+=t),!0===t&&s++,null!==t&&i++}return o=s/i,isNaN(o)&&(o=u),o}K.TYPE=e=>{switch(e){case s:return 1;case l:return 2;case i:return 3;case a:return 4;case c:return 5;case u:return 6;case f:return 7;case p:return 8}return f};const re={DIST:function(e,t,n,o,s,l){return arguments.length<4?i:(s=void 0===s?0:s,l=void 0===l?1:l,_(e=T(e),t=T(t),n=T(n),s=T(s),l=T(l))?i:(e=(e-s)/(l-s),o?r.beta.cdf(e,t,n):r.beta.pdf(e,t,n)))},INV:(e,t,n,o,s)=>(o=void 0===o?0:o,s=void 0===s?1:s,_(e=T(e),t=T(t),n=T(n),o=T(o),s=T(s))?i:r.beta.inv(e,t,n)*(s-o)+o)},oe={DIST:(e,t,n,o)=>_(e=T(e),t=T(t),n=T(n),o=T(o))?i:o?r.binomial.cdf(e,t,n):r.binomial.pdf(e,t,n)};oe.DIST.RANGE=(e,t,n,r)=>{if(r=void 0===r?n:r,_(e=T(e),t=T(t),n=T(n),r=T(r)))return i;let o=0;for(let s=n;s<=r;s++)o+=Ve(e,s)*Math.pow(t,s)*Math.pow(1-t,e-s);return o},oe.INV=(e,t,n)=>{if(_(e=T(e),t=T(t),n=T(n)))return i;let o=0;for(;o<=e;){if(r.binomial.cdf(o,e,t)>=n)return o;o++}};const se={DIST:(e,t,n)=>_(e=T(e),t=T(t))?i:n?r.chisquare.cdf(e,t):r.chisquare.pdf(e,t)};se.DIST.RT=(e,t)=>!e|!t?f:e<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?i:1-r.chisquare.cdf(e,t),se.INV=(e,t)=>_(e=T(e),t=T(t))?i:r.chisquare.inv(e,t),se.INV.RT=(e,t)=>!e|!t?f:e<0||e>1||t<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?i:r.chisquare.inv(1-e,t),se.TEST=function(e,t){if(2!==arguments.length)return f;if(!(e instanceof Array&&t instanceof Array))return i;if(e.length!==t.length)return i;if(e[0]&&t[0]&&e[0].length!==t[0].length)return i;const n=e.length;let r,o,s;for(o=0;o<n;o++)e[o]instanceof Array||(r=e[o],e[o]=[],e[o].push(r)),t[o]instanceof Array||(r=t[o],t[o]=[],t[o].push(r));const l=e[0].length,a=1===l?n-1:(n-1)*(l-1);let c=0;const u=Math.PI;for(o=0;o<n;o++)for(s=0;s<l;s++)c+=Math.pow(e[o][s]-t[o][s],2)/t[o][s];return Math.round(1e6*function(e,t){let n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));let r=t;for(;r>=2;)n=n*e/r,r-=2;let o=n,s=t;for(;o>1e-10*n;)s+=2,o=o*e/s,n+=o;return 1-n}(c,a))/1e6};const le={};function ie(){return x(b(arguments)).length}function ae(){const e=b(arguments);return e.length-ce(e)}function ce(){const e=b(arguments);let t,n=0;for(let r=0;r<e.length;r++)t=e[r],null!=t&&""!==t||n++;return n}le.NORM=(e,t,n)=>_(e=T(e),t=T(t),n=T(n))?i:r.normalci(1,e,t,n)[1]-1,le.T=(e,t,n)=>_(e=T(e),t=T(t),n=T(n))?i:r.tci(1,e,t,n)[1]-1;const ue={P:(e,t)=>{if(_(e=L(b(e)),t=L(b(t))))return i;const n=r.mean(e),o=r.mean(t);let s=0;const l=e.length;for(let r=0;r<l;r++)s+=(e[r]-n)*(t[r]-o);return s/l},S:(e,t)=>_(e=L(b(e)),t=L(b(t)))?i:r.covariance(e,t)},fe={DIST:(e,t,n)=>_(e=T(e),t=T(t))?i:n?r.exponential.cdf(e,t):r.exponential.pdf(e,t)},de={};function pe(e,t,n){if(_(e=T(e),t=L(b(t)),n=L(b(n))))return i;const o=r.mean(n),s=r.mean(t),l=n.length;let a=0,c=0;for(let e=0;e<l;e++)a+=(n[e]-o)*(t[e]-s),c+=Math.pow(n[e]-o,2);const u=a/c;return s-u*o+u*e}function he(e){return(e=T(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?u:r.gammafn(e)}function ge(e){return(e=T(e))instanceof Error?e:r.gammaln(e)}de.DIST=(e,t,n,o)=>_(e=T(e),t=T(t),n=T(n))?i:o?r.centralF.cdf(e,t,n):r.centralF.pdf(e,t,n),de.DIST.RT=function(e,t,n){return 3!==arguments.length?f:e<0||t<1||n<1?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?i:1-r.centralF.cdf(e,t,n)},de.INV=(e,t,n)=>_(e=T(e),t=T(t),n=T(n))?i:e<=0||e>1?u:r.centralF.inv(e,t,n),de.INV.RT=function(e,t,n){return 3!==arguments.length?f:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?i:r.centralF.inv(1-e,t,n)},de.TEST=(e,t)=>{if(!e||!t)return f;if(!(e instanceof Array&&t instanceof Array))return f;if(e.length<2||t.length<2)return l;const n=(e,t)=>{let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},r=Ze(e)/e.length,o=Ze(t)/t.length;return n(e,r)/(e.length-1)/(n(t,o)/(t.length-1))},he.DIST=function(e,t,n,o){return 4!==arguments.length?f:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?i:o?r.gamma.cdf(e,t,n,!0):r.gamma.pdf(e,t,n,!1)},he.INV=function(e,t,n){return 3!==arguments.length?f:e<0||e>1||t<=0||n<=0?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?i:r.gamma.inv(e,t,n)},ge.PRECISE=function(e){return 1!==arguments.length?f:e<=0?u:"number"!=typeof e?i:r.gammaln(e)};const me={};function ye(e,t){return _(e=L(b(e)),t=T(t))?e:t<0||e.length<t?i:e.sort(((e,t)=>t-e))[t-1]}function Ce(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;const n=r.mean(e),o=r.mean(t),s=t.length;let l=0,a=0;for(let r=0;r<s;r++)l+=(t[r]-o)*(e[r]-n),a+=Math.pow(t[r]-o,2);const c=l/a;return[c,n-c*o]}me.DIST=(e,t,n,r,o)=>{if(_(e=T(e),t=T(t),n=T(n),r=T(r)))return i;function s(e,t,n,r){return Ve(n,e)*Ve(r-n,t-e)/Ve(r,t)}return o?function(e,t,n,r){let o=0;for(let l=0;l<=e;l++)o+=s(l,t,n,r);return o}(e,t,n,r):s(e,t,n,r)};const be={};function we(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;const n=x(e);return 0===n.length?0:Math.max.apply(Math,n)}function Ee(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;const n=y(e);let o=r.median(n);return isNaN(o)&&(o=u),o}function ve(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;const n=x(e);return 0===n.length?0:Math.min.apply(Math,n)}be.DIST=(e,t,n,o)=>_(e=T(e),t=T(t),n=T(n))?i:o?r.lognormal.cdf(e,t,n):r.lognormal.pdf(e,t,n),be.INV=(e,t,n)=>_(e=T(e),t=T(t),n=T(n))?i:r.lognormal.inv(e,t,n);const Ae={MULT:function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=e.length,n={};let r,o=[],s=0;for(let l=0;l<t;l++)r=e[l],n[r]=n[r]?n[r]+1:1,n[r]>s&&(s=n[r],o=[]),n[r]===s&&(o[o.length]=r);return o},SNGL:function(){const e=L(b(arguments));return e instanceof Error?e:Ae.MULT(e).sort(((e,t)=>e-t))[0]}},je={DIST:(e,t,n,o)=>_(e=T(e),t=T(t),n=T(n))?i:o?r.negbin.cdf(e,t,n):r.negbin.pdf(e,t,n)},Me={};function _e(e,t){if(_(t=L(b(t)),e=L(b(e))))return i;const n=r.mean(e),o=r.mean(t),s=e.length;let l=0,a=0,c=0;for(let r=0;r<s;r++)l+=(e[r]-n)*(t[r]-o),a+=Math.pow(e[r]-n,2),c+=Math.pow(t[r]-o,2);return l/Math.sqrt(a*c)}Me.DIST=(e,t,n,o)=>_(e=T(e),t=T(t),n=T(n))?i:n<=0?u:o?r.normal.cdf(e,t,n):r.normal.pdf(e,t,n),Me.INV=(e,t,n)=>_(e=T(e),t=T(t),n=T(n))?i:r.normal.inv(e,t,n),Me.S={},Me.S.DIST=(e,t)=>(e=T(e))instanceof Error?i:t?r.normal.cdf(e,0,1):r.normal.pdf(e,0,1),Me.S.INV=e=>(e=T(e))instanceof Error?i:r.normal.inv(e,0,1);const Ie={EXC:(e,t)=>{if(_(e=L(b(e)),t=T(t)))return i;const n=(e=e.sort(((e,t)=>e-t))).length;if(t<1/(n+1)||t>1-1/(n+1))return u;const r=t*(n+1)-1,o=Math.floor(r);return I(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},INC:(e,t)=>{if(_(e=L(b(e)),t=T(t)))return i;const n=t*((e=e.sort(((e,t)=>e-t))).length-1),r=Math.floor(n);return I(n===r?e[n]:e[r]+(n-r)*(e[r+1]-e[r]))}},xe={EXC:(e,t,n)=>{if(n=void 0===n?3:n,_(e=L(b(e)),t=T(t),n=T(n)))return i;e=e.sort(((e,t)=>e-t));const r=Q.apply(null,e),o=e.length,s=r.length,l=Math.pow(10,n);let a=0,c=!1,u=0;for(;!c&&u<s;)t===r[u]?(a=(e.indexOf(r[u])+1)/(o+1),c=!0):t>=r[u]&&(t<r[u+1]||u===s-1)&&(a=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(o+1),c=!0),u++;return Math.floor(a*l)/l},INC:(e,t,n)=>{if(n=void 0===n?3:n,_(e=L(b(e)),t=T(t),n=T(n)))return i;e=e.sort(((e,t)=>e-t));const r=Q.apply(null,e),o=e.length,s=r.length,l=Math.pow(10,n);let a=0,c=!1,u=0;for(;!c&&u<s;)t===r[u]?(a=e.indexOf(r[u])/(o-1),c=!0):t>=r[u]&&(t<r[u+1]||u===s-1)&&(a=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(o-1),c=!0),u++;return Math.floor(a*l)/l}},De={DIST:(e,t,n)=>_(e=T(e),t=T(t))?i:n?r.poisson.cdf(e,t):r.poisson.pdf(e,t)},Ne={EXC:(e,t)=>{if(_(e=L(b(e)),t=T(t)))return i;switch(t){case 1:return Ie.EXC(e,.25);case 2:return Ie.EXC(e,.5);case 3:return Ie.EXC(e,.75);default:return u}},INC:(e,t)=>{if(_(e=L(b(e)),t=T(t)))return i;switch(t){case 1:return Ie.INC(e,.25);case 2:return Ie.INC(e,.5);case 3:return Ie.INC(e,.75);default:return u}}},Se={};function Te(){const e=L(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0;for(let r=0;r<n;r++)o+=Math.pow(e[r]-t,3);return n*o/((n-1)*(n-2)*Math.pow(r.stdev(e,!0),3))}function Le(e,t){return _(e=L(b(e)),t=T(t))?e:e.sort(((e,t)=>e-t))[t-1]}Se.AVG=(e,t,n)=>{if(_(e=T(e),t=L(b(t))))return i;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,o=(t=(t=b(t)).sort(r)).length;let s=0;for(let n=0;n<o;n++)t[n]===e&&s++;return s>1?(2*t.indexOf(e)+s+1)/2:t.indexOf(e)+1},Se.EQ=(e,t,n)=>{if(_(e=T(e),t=L(b(t))))return i;const r=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(r)).indexOf(e)+1},Te.P=function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0,s=0;for(let r=0;r<n;r++)s+=Math.pow(e[r]-t,3),o+=Math.pow(e[r]-t,2);return s/=n,o/=n,s/Math.pow(o,1.5)};const Oe={P:function(){const e=Fe.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},S:function(){const e=Fe.S.apply(this,arguments);return Math.sqrt(e)}},Re={DIST:(e,t,n)=>1!==n&&2!==n?u:1===n?Re.DIST.RT(e,t):Re.DIST["2T"](e,t)};Re.DIST["2T"]=function(e,t){return 2!==arguments.length?f:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?i:2*(1-r.studentt.cdf(e,t))},Re.DIST.RT=function(e,t){return 2!==arguments.length?f:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?i:1-r.studentt.cdf(e,t)},Re.INV=(e,t)=>_(e=T(e),t=T(t))?i:r.studentt.inv(e,t),Re.INV["2T"]=(e,t)=>(e=T(e),t=T(t),e<=0||e>1||t<1?u:_(e,t)?i:Math.abs(r.studentt.inv(e/2,t))),Re.TEST=(e,t)=>{if(_(e=L(b(e)),t=L(b(t))))return i;const n=r.mean(e),o=r.mean(t);let s,l=0,a=0;for(s=0;s<e.length;s++)l+=Math.pow(e[s]-n,2);for(s=0;s<t.length;s++)a+=Math.pow(t[s]-o,2);l/=e.length-1,a/=t.length-1;const c=Math.abs(n-o)/Math.sqrt(l/e.length+a/t.length);return Re.DIST["2T"](c,e.length+t.length-2)};const Fe={};function ke(){const e=b(arguments),t=e.length;let n=0,r=0;const o=ne(e);for(let s=0;s<t;s++){const t=e[s];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return n/(r-1)}function Be(){const e=b(arguments),t=e.length;let n=0,r=0;const o=ne(e);let s;for(let s=0;s<t;s++){const t=e[s];n+="number"==typeof t?Math.pow(t-o,2):!0===t?Math.pow(1-o,2):Math.pow(0-o,2),null!==t&&r++}return s=n/r,isNaN(s)&&(s=u),s}Fe.P=function(){const e=x(b(arguments)),t=e.length;let n=0;const r=te(e);let o;for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return o=n/t,isNaN(o)&&(o=u),o},Fe.S=function(){const e=x(b(arguments)),t=e.length;let n=0;const r=te(e);for(let o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)};const Pe={DIST:(e,t,n,r)=>_(e=T(e),t=T(t),n=T(n))?i:r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},He={};function qe(e,t,n){const r=M(e=T(e),t=T(t),n=T(n));if(r)return r;if(0===t)return 0;t=Math.abs(t);const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.ceil(e/t)*t,o):0===n?-Ge(Math.floor(Math.abs(e)/t)*t,o):-Ge(Math.ceil(Math.abs(e)/t)*t,o)}function Ve(e,t){return M(e=T(e),t=T(t))||(e<t?u:We(e)/(We(t)*We(e-t)))}He.TEST=(e,t,n)=>{if(_(e=L(b(e)),t=T(t)))return i;n=n||Oe.S(e);const r=e.length;return 1-Me.S.DIST((te(e)-t)/(n/Math.sqrt(r)),!0)},qe.MATH=qe,qe.PRECISE=qe;const Ue=[];function We(e){if((e=T(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(Ue[t]>0||(Ue[t]=We(t-1)*t),Ue[t])}function ze(e,t){const n=M(e=T(e),t=T(t));if(n)return n;if(0===t)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return u;t=Math.abs(t);const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,r):-Ge(Math.ceil(Math.abs(e)/t),r)}ze.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const r=M(e=T(e),t=T(t),n=T(n));if(r)return r;if(0===t)return 0;t=t?Math.abs(t):1;const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,o):0===n||void 0===n?-Ge(Math.ceil(Math.abs(e)/t)*t,o):-Ge(Math.floor(Math.abs(e)/t)*t,o)},ze.PRECISE=ze.MATH;const Ye={CEILING:qe};function Ke(e,t){const n=M(e=T(e),t=T(t));if(n)return n;if(0===e&&0===t)return u;const r=Math.pow(e,t);return isNaN(r)?u:r}function Xe(){const e=b(arguments).filter((e=>null!=e));if(0===e.length)return 0;const t=L(e);if(t instanceof Error)return t;let n=1;for(let e=0;e<t.length;e++)n*=t[e];return n}function Ge(e,t){return M(e=T(e),t=T(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Ze(){let e=0;return m(g(arguments),(t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if("string"==typeof t){const n=parseFloat(t);!isNaN(n)&&(e+=n)}else if(Array.isArray(t)){const n=Ze.apply(null,t);n instanceof Error?e=n:e+=n}})),e}var $e=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?f:M(e=T(e),t=T(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?f:M(e=T(e),t=T(t))||(0===t?l:e/t)},EQ:function(e,t){return 2!==arguments.length?f:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)},GT:function(e,t){return 2!==arguments.length?f:e instanceof Error?e:t instanceof Error?t:(R(e,t)?(e=O(e),t=O(t)):(e=T(e),t=T(t)),M(e,t)||e>t)},GTE:function(e,t){return 2!==arguments.length?f:(R(e,t)?(e=O(e),t=O(t)):(e=T(e),t=T(t)),M(e,t)||e>=t)},LT:function(e,t){return 2!==arguments.length?f:(R(e,t)?(e=O(e),t=O(t)):(e=T(e),t=T(t)),M(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?f:(R(e,t)?(e=O(e),t=O(t)):(e=T(e),t=T(t)),M(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?f:M(e=T(e),t=T(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?f:M(e=T(e),t=T(t))||e*t},NE:function(e,t){return 2!==arguments.length?f:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)},POW:function(e,t){return 2!==arguments.length?f:Ke(e,t)}});const Je=new Date(Date.UTC(1900,0,1)),Qe=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],et=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],tt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function nt(e,t,n){n=n.toUpperCase(),e=N(e),t=N(t);const r=e.getFullYear(),o=e.getMonth(),s=e.getDate(),l=t.getFullYear(),i=t.getMonth(),a=t.getDate();let c;switch(n){case"Y":c=Math.floor(ft(e,t));break;case"D":c=ot(t,e);break;case"M":c=i-o+12*(l-r),a<s&&c--;break;case"MD":s<=a?c=a-s:(0===i?(e.setFullYear(l-1),e.setMonth(12)):(e.setFullYear(l),e.setMonth(i-1)),c=ot(t,e));break;case"YM":c=i-o+12*(l-r),a<s&&c--,c%=12;break;case"YD":i>o||i===o&&a<s?e.setFullYear(l):e.setFullYear(l-1),c=ot(t,e)}return c}function rt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function ot(e,t){return e=N(e),t=N(t),e instanceof Error?e:t instanceof Error?t:dt(rt(e))-dt(rt(t))}function st(e,t,n){if(n=D(n||"false"),e=N(e),t=N(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;const r=e.getMonth();let o,s,l=t.getMonth();if(n)o=31===e.getDate()?30:e.getDate(),s=31===t.getDate()?30:t.getDate();else{const n=new Date(e.getFullYear(),r+1,0).getDate(),i=new Date(t.getFullYear(),l+1,0).getDate();o=e.getDate()===n?30:e.getDate(),t.getDate()===i?o<30?(l++,s=1):s=30:s=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(l-r)+(s-o)}function lt(e){if((e=N(e))instanceof Error)return e;(e=rt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function it(e,t,n){return it.INTL(e,t,1,n)}function at(e,t,n){return at.INTL(e,t,1,n)}function ct(e){return 1===new Date(e,1,29).getMonth()}function ut(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ft(e,t,n){if((e=N(e))instanceof Error)return e;if((t=N(t))instanceof Error)return t;n=n||0;let r=e.getDate();const o=e.getMonth()+1,s=e.getFullYear();let l=t.getDate();const i=t.getMonth()+1,a=t.getFullYear();switch(n){case 0:return 31===r&&31===l?(r=30,l=30):31===r?r=30:30===r&&31===l&&(l=30),(l+30*i+360*a-(r+30*o+360*s))/360;case 1:{const n=(e,t)=>{const n=e.getFullYear(),r=new Date(n,2,1);if(ct(n)&&e<r&&t>=r)return!0;const o=t.getFullYear(),s=new Date(o,2,1);return ct(o)&&t>=s&&e<s};let c=365;if(s===a||s+1===a&&(o>i||o===i&&r>=l))return(s===a&&ct(s)||n(e,t)||1===i&&29===l)&&(c=366),ut(e,t)/c;const u=a-s+1,f=(new Date(a+1,0,1)-new Date(s,0,1))/1e3/60/60/24/u;return ut(e,t)/f}case 2:return ut(e,t)/360;case 3:return ut(e,t)/365;case 4:return(l+30*i+360*a-(r+30*o+360*s))/360}}function dt(e){const t=e>-22038912e5?2:1;return Math.ceil((e-Je)/864e5)+t}function pt(e){return 0===(e=T(e))?i:e instanceof Error?e:String.fromCharCode(e)}function ht(e){if(_(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=i),t}function gt(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let r=0;for(;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")}it.INTL=(e,t,n,r)=>{if((e=N(e))instanceof Error)return e;if((t=N(t))instanceof Error)return t;let o=!1;const s=[],l=[1,2,3,4,5,6,0],a=new RegExp("^[0|1]{7}$");if(void 0===n)n=tt[1];else if("string"==typeof n&&a.test(n)){o=!0,n=n.split("");for(let e=0;e<n.length;e++)"1"===n[e]&&s.push(l[e])}else n=tt[n];if(!(n instanceof Array))return i;void 0===r?r=[]:r instanceof Array||(r=[r]);for(let e=0;e<r.length;e++){const t=N(r[e]);if(t instanceof Error)return t;r[e]=t}const c=Math.round((t-e)/864e5)+1;let u=c;const f=e;for(let e=0;e<c;e++){const e=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay();let t=o?s.includes(e):e===n[0]||e===n[1];for(let e=0;e<r.length;e++){const n=r[e];if(n.getDate()===f.getDate()&&n.getMonth()===f.getMonth()&&n.getFullYear()===f.getFullYear()){t=!0;break}}t&&u--,f.setDate(f.getDate()+1)}return u},at.INTL=(e,t,n,r)=>{if((e=N(e))instanceof Error)return e;if((t=T(t))instanceof Error)return t;if(t<0)return u;if(!((n=void 0===n?tt[1]:tt[n])instanceof Array))return i;void 0===r?r=[]:r instanceof Array||(r=[r]);for(let e=0;e<r.length;e++){const t=N(r[e]);if(t instanceof Error)return t;r[e]=t}let o=0;for(;o<t;){e.setDate(e.getDate()+1);const t=e.getDay();if(t!==n[0]&&t!==n[1]){for(let t=0;t<r.length;t++){const n=r[t];if(n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()){o--;break}}o++}}return e};const mt=gt;function yt(e,t=2,n=!1){if(e=T(e),isNaN(e))return i;if(t=T(t),isNaN(t))return i;if(t<0){const n=Math.pow(10,-t);e=Math.round(e/n)*n}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function Ct(e,t){return M(e,t)||(e=O(e),(t=T(t))instanceof Error?t:new Array(t+1).join(e))}const bt=pt,wt=ht;function Et(e){return/^[01]{1,10}$/.test(e)}function vt(e,t,n){if(_(e=T(e),t=T(t)))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return i;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();{const r=t>0?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)}}function At(e,t){return t=void 0===t?0:t,_(e=T(e),t=T(t))?i:r.erf(e)}function jt(e){return isNaN(e)?i:r.erfc(e)}function Mt(e){const t=St(e),n=_t(e);return _(t,n)?i:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function _t(e){if(void 0===e||!0===e||!1===e)return i;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:-Number(e.substring(n+1,e.length-1)):u:o?isNaN(e.substring(0,e.length-1))?u:e.substring(0,e.length-1):isNaN(e)?u:0}function It(e){const t=St(e),n=_t(e);return _(t,n)?i:0===t&&0===n?l:0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function xt(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function Dt(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function Nt(e,t){const n=St(e),r=_t(e),o=St(t),s=_t(t);if(_(n,r,o,s))return i;const l=e.substring(e.length-1),a=t.substring(t.length-1);let c="i";if(("j"===l||"j"===a)&&(c="j"),0===o&&0===s)return u;const f=o*o+s*s;return vt((n*o+r*s)/f,(r*o-n*s)/f,c)}function St(e){if(void 0===e||!0===e||!1===e)return i;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return t>=0||n>=0?o?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:Number(e.substring(0,n)):u:o?isNaN(e.substring(0,e.length-1))?u:0:isNaN(e)?u:e}function Tt(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function Lt(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,r)}At.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},jt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Ot=re.DIST,Rt=re.INV,Ft=oe.DIST,kt=qe.MATH,Bt=qe.PRECISE,Pt=se.DIST,Ht=se.DIST.RT,qt=se.INV,Vt=se.INV.RT,Ut=se.TEST,Wt=ue.P,zt=ue.P,Yt=ue.S,Kt=oe.INV,Xt=jt.PRECISE,Gt=At.PRECISE,Zt=fe.DIST,$t=de.DIST,Jt=de.DIST.RT,Qt=de.INV,en=de.INV.RT,tn=ze.MATH,nn=ze.PRECISE,rn=de.TEST,on=he.DIST,sn=he.INV,ln=ge.PRECISE,an=me.DIST,cn=be.INV,un=be.DIST,fn=be.INV,dn=Ae.MULT,pn=Ae.SNGL,hn=je.DIST,gn=it.INTL,mn=Me.DIST,yn=Me.INV,Cn=Me.S.DIST,bn=Me.S.INV,wn=Ie.EXC,En=Ie.INC,vn=xe.EXC,An=xe.INC,jn=De.DIST,Mn=Ne.EXC,_n=Ne.INC,In=Se.AVG,xn=Se.EQ,Dn=Te.P,Nn=Oe.P,Sn=Oe.S,Tn=Re.DIST,Ln=Re.DIST.RT,On=Re.INV,Rn=Re.TEST,Fn=Fe.P,kn=Fe.S,Bn=Pe.DIST,Pn=at.INTL,Hn=He.TEST;function qn(e){const t=[];return m(e,(e=>{e&&t.push(e)})),t}function Vn(e,t){const n={};for(let t=1;t<e[0].length;++t)n[t]=!0;let r=t[0].length;for(let e=1;e<t.length;++e)t[e].length>r&&(r=t[e].length);for(let o=1;o<e.length;++o)for(let s=1;s<e[o].length;++s){let l=!1,i=!1;for(let n=0;n<t.length;++n){const a=t[n];if(a.length<r)continue;const c=a[0];if(e[o][0]===c){i=!0;for(let t=1;t<a.length;++t)if(!l)if(void 0===a[t]||"*"===a[t])l=!0;else{const n=z(a[t]+""),r=[W(e[o][s],U)].concat(n);l=Y(r)}}}i&&(n[s]=n[s]&&l)}const o=[];for(let t=0;t<e[0].length;++t)n[t]&&o.push(t-1);return o}function Un(e){return e&&e.getTime&&!isNaN(e.getTime())}function Wn(e){return e instanceof Date?e:new Date(e)}function zn(e,t,n,r,o){if(r=r||0,o=o||0,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o)))return i;let s;if(0===e)s=r+n*t;else{const l=Math.pow(1+e,t);s=1===o?r*l+n*(1+e)*(l-1)/e:r*l+n*(l-1)/e}return-s}function Yn(e,t,n,r,o,s){if(o=o||0,s=s||0,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o),s=T(s)))return i;const l=Xn(e,n,r,o,s);return(1===t?1===s?0:-r:1===s?zn(e,t-2,l,r,1)-l:zn(e,t-1,l,r,0))*e}function Kn(){const e=L(b(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n}function Xn(e,t,n,r,o){if(r=r||0,o=o||0,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o)))return i;let s;if(0===e)s=(n+r)/t;else{const l=Math.pow(1+e,t);s=1===o?(r*e/(l-1)+n*e/(1-1/l))/(1+e):r*e/(l-1)+n*e/(1-1/l)}return-s}const Gn={errors:h,symbols:$e};t.ABS=function(e){return(e=T(e))instanceof Error?e:Math.abs(e)},t.ACCRINT=function(e,t,n,r,o,s,l){return e=Wn(e),t=Wn(t),n=Wn(n),Un(e)&&Un(t)&&Un(n)?r<=0||o<=0||-1===[1,2,4].indexOf(s)||-1===[0,1,2,3,4].indexOf(l)||n<=e?u:(o=o||0)*r*ft(e,n,l=l||0):i},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.ACOS=function(e){if((e=T(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=u),t},t.ACOSH=function(e){if((e=T(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=u),t},t.ACOT=function(e){return(e=T(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=T(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=u),t},t.AGGREGATE=function(e,t,n,r){if(_(e=T(e),T(e)))return i;switch(e){case 1:return te(n);case 2:return ie(n);case 3:return ae(n);case 4:return we(n);case 5:return ve(n);case 6:return Xe(n);case 7:return Oe.S(n);case 8:return Oe.P(n);case 9:return Ze(n);case 10:return Fe.S(n);case 11:return Fe.P(n);case 12:return Ee(n);case 13:return Ae.SNGL(n);case 14:return ye(n,r);case 15:return Le(n,r);case 16:return Ie.INC(n,r);case 17:return Ne.INC(n,r);case 18:return Ie.EXC(n,r);case 19:return Ne.EXC(n,r)}},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.AND=function(){const e=b(arguments);let t=i;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===i&&(t=!0),e[n]||(t=!1))}return t},t.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return i;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},t.ASC=function(){throw new Error("ASC is not implemented")},t.ASIN=function(e){if((e=T(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=u),t},t.ASINH=function(e){return(e=T(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=T(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return M(e=T(e),t=T(t))||Math.atan2(e,t)},t.ATANH=function(e){if((e=T(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=u),t},t.AVEDEV=function(){const e=b(arguments).filter(F);if(0===e.length)return u;const t=L(e);return t instanceof Error?t:r.sum(r(t).subtract(r.mean(t)).abs()[0])/t.length},t.AVERAGE=te,t.AVERAGEA=ne,t.AVERAGEIF=function(e,t,n){if(arguments.length<=1)return f;if(n=L(b(n=n||e).filter(F)),e=b(e),n instanceof Error)return n;let r=0,o=0;const s=void 0===t||"*"===t,l=s?null:z(t+"");for(let t=0;t<e.length;t++){const i=e[t];if(s)o+=n[t],r++;else{const e=[W(i,U)].concat(l);Y(e)&&(o+=n[t],r++)}}return o/r},t.AVERAGEIFS=function(){const e=g(arguments),t=(e.length-1)/2,n=b(e[0]);let r=0,o=0;for(let s=0;s<n.length;s++){let l=!1;for(let n=0;n<t;n++){const t=e[2*n+1][s],r=e[2*n+2];let o=!1;if(void 0===r||"*"===r)o=!0;else{const e=z(r+""),n=[W(t,U)].concat(e);o=Y(n)}if(!o){l=!1;break}l=!0}l&&(o+=n[s],r++)}const s=o/r;return isNaN(s)?0:s},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.BASE=function(e,t,n){const r=M(e=T(e),t=T(t),n=T(n));if(r)return r;if(0===t)return u;const o=e.toString(t);return new Array(Math.max(n+1-o.length,0)).join("0")+o},t.BESSELI=function(e,t){return _(e=T(e),t=T(t))?i:o.besseli(e,t)},t.BESSELJ=function(e,t){return _(e=T(e),t=T(t))?i:o.besselj(e,t)},t.BESSELK=function(e,t){return _(e=T(e),t=T(t))?i:o.besselk(e,t)},t.BESSELY=function(e,t){return _(e=T(e),t=T(t))?i:o.bessely(e,t)},t.BETA=re,t.BETADIST=Ot,t.BETAINV=Rt,t.BIN2DEC=function(e){if(!Et(e))return u;const t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!Et(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const r=parseInt(e,2).toString(16);return void 0===t?r:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=r.length?Ct("0",t-r.length)+r:u},t.BIN2OCT=function(e,t){if(!Et(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);const r=parseInt(e,2).toString(8);return void 0===t?r:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=r.length?Ct("0",t-r.length)+r:u},t.BINOM=oe,t.BINOMDIST=Ft,t.BITAND=function(e,t){return _(e=T(e),t=T(t))?i:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e&t},t.BITLSHIFT=function(e,t){return _(e=T(e),t=T(t))?i:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return _(e=T(e),t=T(t))?i:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e|t},t.BITRSHIFT=function(e,t){return _(e=T(e),t=T(t))?i:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return _(e=T(e),t=T(t))?i:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e^t},t.CEILING=qe,t.CEILINGMATH=kt,t.CEILINGPRECISE=Bt,t.CELL=function(){throw new Error("CELL is not implemented")},t.CHAR=pt,t.CHIDIST=Pt,t.CHIDISTRT=Ht,t.CHIINV=qt,t.CHIINVRT=Vt,t.CHISQ=se,t.CHITEST=Ut,t.CHOOSE=function(){if(arguments.length<2)return f;const e=arguments[0];return e<1||e>254||arguments.length<e+1?i:arguments[e]},t.CLEAN=function(e){return _(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=ht,t.COLUMN=function(e,t){return 2!==arguments.length?f:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?r.col(e,t):void 0:i},t.COLUMNS=function(e){return 1!==arguments.length?f:e instanceof Array?0===e.length?0:r.cols(e):i},t.COMBIN=Ve,t.COMBINA=function(e,t){return M(e=T(e),t=T(t))||(e<t?u:0===e&&0===t?1:Ve(e+t-1,e-1))},t.COMPLEX=vt,t.CONCAT=mt,t.CONCATENATE=gt,t.CONFIDENCE=le,t.CONVERT=function(e,t,n){if((e=T(e))instanceof Error)return e;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let l,i=null,a=null,c=t,u=n,d=1,p=1;for(let e=0;e<r.length;e++)l=null===r[e][2]?[]:r[e][2],(r[e][1]===c||l.indexOf(c)>=0)&&(i=r[e]),(r[e][1]===u||l.indexOf(u)>=0)&&(a=r[e]);if(null===i){const e=o[t.substring(0,2)];let n=s[t.substring(0,1)];"da"===t.substring(0,2)&&(n=["dekao",10,"da"]),e?(d=e[2],c=t.substring(2)):n&&(d=n[1],c=t.substring(n[2].length));for(let e=0;e<r.length;e++)l=null===r[e][2]?[]:r[e][2],(r[e][1]===c||l.indexOf(c)>=0)&&(i=r[e])}if(null===a){const e=o[n.substring(0,2)];let t=s[n.substring(0,1)];"da"===n.substring(0,2)&&(t=["dekao",10,"da"]),e?(p=e[2],u=n.substring(2)):t&&(p=t[1],u=n.substring(t[2].length));for(let e=0;e<r.length;e++)l=null===r[e][2]?[]:r[e][2],(r[e][1]===u||l.indexOf(u)>=0)&&(a=r[e])}return null===i||null===a||i[3]!==a[3]?f:e*i[6]*d/(a[6]*p)},t.CORREL=function(e,t){return _(e=L(b(e)),t=L(b(t)))?i:r.corrcoeff(e,t)},t.COS=function(e){return(e=T(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=T(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=T(e))instanceof Error?e:0===e?l:1/Math.tan(e)},t.COTH=function(e){if((e=T(e))instanceof Error)return e;if(0===e)return l;const t=Math.exp(2*e);return(t+1)/(t-1)},t.COUNT=ie,t.COUNTA=ae,t.COUNTBLANK=ce,t.COUNTIF=function(e,t){if(e=b(e),void 0===t||"*"===t)return e.length;let n=0;const r=z(t+"");for(let t=0;t<e.length;t++){const o=[W(e[t],U)].concat(r);Y(o)&&n++}return n},t.COUNTIFS=function(){const e=g(arguments),t=new Array(b(e[0]).length);for(let e=0;e<t.length;e++)t[e]=!0;for(let n=0;n<e.length;n+=2){const r=b(e[n]),o=e[n+1];if(void 0!==o&&"*"!==o){const e=z(o+"");for(let n=0;n<r.length;n++){const o=[W(r[n],U)].concat(e);t[n]=t[n]&&Y(o)}}}let n=0;for(let e=0;e<t.length;e++)t[e]&&n++;return n},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.COVAR=Wt,t.COVARIANCE=ue,t.COVARIANCEP=zt,t.COVARIANCES=Yt,t.CRITBINOM=Kt,t.CSC=function(e){return(e=T(e))instanceof Error?e:0===e?l:1/Math.sin(e)},t.CSCH=function(e){return(e=T(e))instanceof Error?e:0===e?l:2/(Math.exp(e)-Math.exp(-e))},t.CUMIPMT=function(e,t,n,r,o,s){if(_(e=T(e),t=T(t),n=T(n)))return i;if(e<=0||t<=0||n<=0)return u;if(r<1||o<1||r>o)return u;if(0!==s&&1!==s)return u;const l=Xn(e,t,n,0,s);let a=0;1===r&&(0===s&&(a=-n),r++);for(let t=r;t<=o;t++)a+=1===s?zn(e,t-2,l,n,1)-l:zn(e,t-1,l,n,0);return a*=e,a},t.CUMPRINC=function(e,t,n,r,o,s){if(_(e=T(e),t=T(t),n=T(n)))return i;if(e<=0||t<=0||n<=0)return u;if(r<1||o<1||r>o)return u;if(0!==s&&1!==s)return u;const l=Xn(e,t,n,0,s);let a=0;1===r&&(a=0===s?l+n*e:l,r++);for(let t=r;t<=o;t++)a+=s>0?l-(zn(e,t-2,l,n,1)-l)*e:l-zn(e,t-1,l,n,0)*e;return a},t.DATE=function(e,t,n){let r;return _(e=T(e),t=T(t),n=T(n))?r=i:(r=new Date(e,t-1,n),r.getFullYear()<0&&(r=u)),r},t.DATEDIF=nt,t.DATEVALUE=function(e){if("string"!=typeof e)return i;const t=Date.parse(e);return isNaN(t)?i:new Date(e)},t.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=0;return m(r,(e=>{s+=o[e]})),0===r.length?l:s/r.length},t.DAY=function(e){const t=N(e);return t instanceof Error?t:t.getDate()},t.DAYS=ot,t.DAYS360=st,t.DB=function(e,t,n,r,o){if(o=void 0===o?12:o,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o)))return i;if(e<0||t<0||n<0||r<0)return u;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return u;if(r>n)return u;if(t>=e)return 0;const s=(1-Math.pow(t/e,1/n)).toFixed(3),l=e*s*o/12;let a=l,c=0;const f=r===n?n-1:r;for(let t=2;t<=f;t++)c=(e-a)*s,a+=c;return 1===r?l:r===n?(e-a)*s:c},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);const s=[];return m(r,(e=>{s.push(o[e])})),ie(s)},t.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);const s=[];return m(r,(e=>{s.push(o[e])})),ae(s)},t.DDB=function(e,t,n,r,o){if(o=void 0===o?2:o,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o)))return i;if(e<0||t<0||n<0||r<0||o<=0)return u;if(r>n)return u;if(t>=e)return 0;let s=0,l=0;for(let i=1;i<=r;i++)l=Math.min(o/n*(e-s),e-t-s),s+=l;return l},t.DEC2BIN=function(e,t){if((e=T(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return u;if(e<0)return"1"+Ct("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=n.length?Ct("0",t-n.length)+n:u},t.DEC2HEX=function(e,t){if((e=T(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return u;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=n.length?Ct("0",t-n.length)+n:u},t.DEC2OCT=function(e,t){if((e=T(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return u;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=n.length?Ct("0",t-n.length)+n:u},t.DECIMAL=function(e,t){return arguments.length<1?i:M(e=T(e),t=T(t))||(0===t?u:parseInt(e,t))},t.DEGREES=function(e){return(e=T(e))instanceof Error?e:180*e/Math.PI},t.DELTA=function(e,t){return t=void 0===t?0:t,_(e=T(e),t=T(t))?i:e===t?1:0},t.DEVSQ=function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=r.mean(e);let n=0;for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},t.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];return o=v("string"==typeof t?e[j(e,t)]:e[t]),0===r.length?i:r.length>1?u:o[r[0]]},t.DISC=function(e,t,n,r,o){if(_(e=N(e),t=N(t),n=T(n),r=T(r),o=(o=T(o))||0))return i;if(n<=0||r<=0)return u;if(e>=t)return i;let s,l;switch(o){case 0:s=360,l=st(e,t,!1);break;case 1:case 3:s=365,l=nt(e,t,"D");break;case 2:s=360,l=nt(e,t,"D");break;case 4:s=360,l=st(e,t,!0);break;default:return u}return(r-n)/r*s/l},t.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=o[r[0]];return m(r,(e=>{s<o[e]&&(s=o[e])})),s},t.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=o[r[0]];return m(r,(e=>{s>o[e]&&(s=o[e])})),s},t.DOLLAR=function(e,t=2){if(e=T(e),isNaN(e))return i;const n={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},r=(e=Ge(e,t)).toLocaleString("en-US",n);return e<0?"$("+r.slice(2)+")":r},t.DOLLARDE=function(e,t){if(_(e=T(e),t=T(t)))return i;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r,n},t.DOLLARFR=function(e,t){if(_(e=T(e),t=T(t)))return i;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n},t.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=[];m(r,(e=>{s.push(o[e])})),s=qn(s);let l=1;return m(s,(e=>{l*=e})),l},t.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=[];return m(r,(e=>{s.push(o[e])})),s=qn(s),Oe.S(s)},t.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);let s=[];return m(r,(e=>{s.push(o[e])})),s=qn(s),Oe.P(s)},t.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);const s=[];return m(r,(e=>{s.push(o[e])})),Ze(s)},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);const s=[];return m(r,(e=>{s.push(o[e])})),Fe.S(s)},t.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return i;const r=Vn(e,n);let o=[];if("string"==typeof t){const n=j(e,t);o=v(e[n])}else o=v(e[t]);const s=[];return m(r,(e=>{s.push(o[e])})),Fe.P(s)},t.EDATE=function(e,t){return(e=N(e))instanceof Error?e:isNaN(t)?i:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},t.EFFECT=function(e,t){return _(e=T(e),t=T(t))?i:e<=0||t<1?u:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.EOMONTH=function(e,t){return(e=N(e))instanceof Error?e:isNaN(t)?i:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},t.ERF=At,t.ERFC=jt,t.ERFCPRECISE=Xt,t.ERFPRECISE=Gt,t.ERROR=K,t.EVEN=function(e){return(e=T(e))instanceof Error?e:qe(e,-2,-1)},t.EXACT=function(e,t){return 2!==arguments.length?f:M(e,t)||(e=O(e))===O(t)},t.EXP=function(e){return arguments.length<1?f:arguments.length>1?d:(e=T(e))instanceof Error?e:e=Math.exp(e)},t.EXPON=fe,t.EXPONDIST=Zt,t.F=de,t.FACT=We,t.FACTDOUBLE=function e(t){if((t=T(t))instanceof Error)return t;const n=Math.floor(t);return n<=0?1:n*e(n-2)},t.FALSE=function(){return!1},t.FDIST=$t,t.FDISTRT=Jt,t.FIND=function(e,t,n){if(arguments.length<2)return f;e=O(e),n=void 0===n?0:n;const r=(t=O(t)).indexOf(e,n-1);return-1===r?i:r+1},t.FINV=Qt,t.FINVRT=en,t.FISHER=function(e){return(e=T(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=T(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.FIXED=yt,t.FLOOR=ze,t.FLOORMATH=tn,t.FLOORPRECISE=nn,t.FORECAST=pe,t.FREQUENCY=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;const n=e.length,r=t.length,o=[];for(let s=0;s<=r;s++){o[s]=0;for(let l=0;l<n;l++)0===s?e[l]<=t[0]&&(o[0]+=1):s<r?e[l]>t[s-1]&&e[l]<=t[s]&&(o[s]+=1):s===r&&e[l]>t[r-1]&&(o[r]+=1)}return o},t.FTEST=rn,t.FV=zn,t.FVSCHEDULE=function(e,t){if(_(e=T(e),t=L(b(t))))return i;const n=t.length;let r=e;for(let e=0;e<n;e++)r*=1+t[e];return r},t.GAMMA=he,t.GAMMADIST=on,t.GAMMAINV=sn,t.GAMMALN=ge,t.GAMMALNPRECISE=ln,t.GAUSS=function(e){return(e=T(e))instanceof Error?e:r.normal.cdf(e,0,1)-.5},t.GCD=function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let r=n<0?-n:n;for(let n=1;n<t;n++){const t=e[n];let o=t<0?-t:t;for(;r&&o;)r>o?r%=o:o%=r;r+=o}return r},t.GEOMEAN=function(){const e=L(b(arguments));return e instanceof Error?e:r.geomean(e)},t.GESTEP=function(e,t){return _(t=t||0,e=T(e))?e:e>=t?1:0},t.GROWTH=function(e,t,n,r){if((e=L(e))instanceof Error)return e;let o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);if(_(t=L(t),n=L(n)))return i;void 0===r&&(r=!0);const s=e.length;let l,a,c=0,u=0,f=0,d=0;for(o=0;o<s;o++){const n=t[o],r=Math.log(e[o]);c+=n,u+=r,f+=n*r,d+=n*n}c/=s,u/=s,f/=s,d/=s,r?(l=(f-c*u)/(d-c*c),a=u-l*c):(l=f/d,a=0);const p=[];for(o=0;o<n.length;o++)p.push(Math.exp(a+l*n[o]));return p},t.HARMEAN=function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let r=0;r<t;r++)n+=1/e[r];return t/n},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return u;if(n)return"1"+Ct("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=o.length?Ct("0",t-o.length)+o:u},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return u;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const r=n.toString(8);return void 0===t?r:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=r.length?Ct("0",t-r.length)+r:u},t.HLOOKUP=function(e,t,n,r){return ee(e,A(t),n,r)},t.HOUR=function(e){return(e=N(e))instanceof Error?e:e.getHours()},t.HYPGEOM=me,t.HYPGEOMDIST=an,t.IF=function(e,t,n){return e instanceof Error?e:(null==(t=!(arguments.length>=2)||t)&&(t=0),null==(n=3===arguments.length&&n)&&(n=0),e?t:n)},t.IFERROR=function(e,t){return G(e)?t:e},t.IFNA=function(e,t){return e===f?t:e},t.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return f},t.IMABS=Mt,t.IMAGINARY=_t,t.IMARGUMENT=It,t.IMCONJUGATE=function(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",0!==n?vt(t,-n,r):e},t.IMCOS=xt,t.IMCOSH=Dt,t.IMCOT=function(e){return _(St(e),_t(e))?i:Nt(xt(e),Tt(e))},t.IMCSC=function(e){return!0===e||!1===e?i:_(St(e),_t(e))?u:Nt("1",Tt(e))},t.IMCSCH=function(e){return!0===e||!1===e?i:_(St(e),_t(e))?u:Nt("1",Lt(e))},t.IMDIV=Nt,t.IMEXP=function(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);r="i"===r||"j"===r?r:"i";const o=Math.exp(t);return vt(o*Math.cos(n),o*Math.sin(n),r)},t.IMLN=function(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),r)},t.IMLOG10=function(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),r)},t.IMLOG2=function(e){const t=St(e),n=_t(e);if(_(t,n))return i;let r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",vt(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),r)},t.IMPOWER=function(e,t){if(_(t=T(t),St(e),_t(e)))return i;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const r=Math.pow(Mt(e),t),o=It(e);return vt(r*Math.cos(t*o),r*Math.sin(t*o),n)},t.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return i;for(let t=1;t<arguments.length;t++){const n=St(e),r=_t(e),o=St(arguments[t]),s=_t(arguments[t]);if(_(n,r,o,s))return i;e=vt(n*o-r*s,n*s+r*o)}return e},t.IMREAL=St,t.IMSEC=function(e){return!0===e||!1===e||_(St(e),_t(e))?i:Nt("1",xt(e))},t.IMSECH=function(e){return _(St(e),_t(e))?i:Nt("1",Dt(e))},t.IMSIN=Tt,t.IMSINH=Lt,t.IMSQRT=function(e){if(_(St(e),_t(e)))return i;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const n=Math.sqrt(Mt(e)),r=It(e);return vt(n*Math.cos(r/2),n*Math.sin(r/2),t)},t.IMSUB=function(e,t){const n=St(e),r=_t(e),o=St(t),s=_t(t);if(_(n,r,o,s))return i;const l=e.substring(e.length-1),a=t.substring(t.length-1);let c="i";return("j"===l||"j"===a)&&(c="j"),vt(n-o,r-s,c)},t.IMSUM=function(){if(!arguments.length)return i;const e=b(arguments);let t=e[0];for(let n=1;n<e.length;n++){const r=St(t),o=_t(t),s=St(e[n]),l=_t(e[n]);if(_(r,o,s,l))return i;t=vt(r+s,o+l)}return t},t.IMTAN=function(e){return!0===e||!1===e||_(St(e),_t(e))?i:Nt(Tt(e),xt(e))},t.INDEX=function(e,t,n){const r=M(e,t,n);if(r)return r;if(!Array.isArray(e))return i;const o=e.length>0&&!Array.isArray(e[0]);return o&&!n?(n=t,t=1):(n=n||1,t=t||1),n<0||t<0?i:o&&1===t&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:a},t.INFO=function(){throw new Error("INFO is not implemented")},t.INT=function(e){return(e=T(e))instanceof Error?e:Math.floor(e)},t.INTERCEPT=function(e,t){return _(e=L(e),t=L(t))?i:e.length!==t.length?f:pe(0,e,t)},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=Yn,t.IRR=function(e,t){if(t=t||0,_(e=L(b(e)),t=T(t)))return i;const n=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,(t[n]-t[0])/365);return o},r=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const s=(t[n]-t[0])/365;o-=s*e[n]/Math.pow(r,s+1)}return o},o=[];let s=!1,l=!1;for(let t=0;t<e.length;t++)o[t]=0===t?0:o[t-1]+365,e[t]>0&&(s=!0),e[t]<0&&(l=!0);if(!s||!l)return u;let a,c,f,d=t=void 0===t?.1:t,p=!0;do{f=n(e,o,d),a=d-f/r(e,o,d),c=Math.abs(a-d),d=a,p=c>1e-10&&Math.abs(f)>1e-10}while(p);return d},t.ISBLANK=function(e){return null===e},t.ISERR=X,t.ISERROR=G,t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=Z,t.ISNA=function(e){return e===f},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=$,t.ISO=Ye,t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISOWEEKNUM=lt,t.ISPMT=function(e,t,n,r){return _(e=T(e),t=T(t),n=T(n),r=T(r))?i:r*e*(t/n-1)},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=J,t.KURT=function(){const e=L(b(arguments));if(e instanceof Error)return e;const t=r.mean(e),n=e.length;let o=0;for(let r=0;r<n;r++)o+=Math.pow(e[r]-t,4);return o/=Math.pow(r.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*o-3*(n-1)*(n-1)/((n-2)*(n-3))},t.LARGE=ye,t.LCM=function(){const e=L(b(arguments));if(e instanceof Error)return e;for(var t,n,r,o,s=1;void 0!==(r=e.pop());){if(0===r)return 0;for(;r>1;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);o=t<=n?t:r}else o=2;for(r/=o,s*=o,t=e.length;t;e[--t]%o==0&&1==(e[t]/=o)&&e.splice(t,1));}}return s},t.LEFT=function(e,t){return M(e,t)||(e=O(e),(t=T(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?i:e.substring(0,t))},t.LEN=function(e){return 0===arguments.length?d:e instanceof Error?e:Array.isArray(e)?i:O(e).length},t.LINEST=Ce,t.LN=function(e){return(e=T(e))instanceof Error?e:0===e?u:Math.log(e)},t.LOG=function(e,t){return M(e=T(e),t=T(t))||(0===e||0===t?u:Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=T(e))instanceof Error?e:0===e?u:Math.log(e)/Math.log(10)},t.LOGEST=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;if(e.length!==t.length)return i;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const n=Ce(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},t.LOGINV=cn,t.LOGNORM=be,t.LOGNORMDIST=un,t.LOGNORMINV=fn,t.LOOKUP=function(e,t,n){t=b(t),n=n?b(n):t;const r="number"==typeof e;let o=f;for(let s=0;s<t.length;s++){if(t[s]===e)return n[s];if(r&&t[s]<=e||"string"==typeof t[s]&&t[s].localeCompare(e)<0)o=n[s];else if(r&&t[s]>e)return o}return o},t.LOWER=function(e){return 1!==arguments.length?i:_(e=O(e))?e:e.toLowerCase()},t.MATCH=function(e,t,n){if(!e||!t)return f;if(2===arguments.length&&(n=1),!((t=b(t))instanceof Array))return f;if(-1!==n&&0!==n&&1!==n)return f;let r,o;for(let s=0;s<t.length;s++)if(1===n){if(t[s]===e)return s+1;t[s]<e&&(o?t[s]>o&&(r=s+1,o=t[s]):(r=s+1,o=t[s]))}else if(0===n){if("string"==typeof e&&"string"==typeof t[s]){const n=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+n+"$").test(t[s].toLowerCase()))return s+1}else if(t[s]===e)return s+1}else if(-1===n){if(t[s]===e)return s+1;t[s]>e&&(o?t[s]<o&&(r=s+1,o=t[s]):(r=s+1,o=t[s]))}return r||f},t.MAX=we,t.MAXA=function(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;let n=y(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.max.apply(Math,n)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MEDIAN=Ee,t.MID=function(e,t,n){if(null==t)return i;if(_(t=T(t),n=T(n))||"string"!=typeof e)return n;const r=t-1,o=r+n;return e.substring(r,o)},t.MIN=ve,t.MINA=function(){const e=b(arguments),t=M.apply(void 0,e);if(t)return t;let n=y(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.min.apply(Math,n)},t.MINUTE=function(e){return(e=N(e))instanceof Error?e:e.getMinutes()},t.MIRR=function(e,t,n){if(_(e=L(b(e)),t=T(t),n=T(n)))return i;const r=e.length,o=[],s=[];for(let t=0;t<r;t++)e[t]<0?o.push(e[t]):s.push(e[t]);const l=-Kn(n,s)*Math.pow(1+n,r-1),a=Kn(t,o)*(1+t);return Math.pow(l/a,1/(r-1))-1},t.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some((e=>!e.length))||t.some((e=>!e.length))||w(e).some((e=>"number"!=typeof e))||w(t).some((e=>"number"!=typeof e))||e[0].length!==t.length?i:Array(e.length).fill(0).map((()=>Array(t[0].length).fill(0))).map(((n,r)=>n.map(((n,o)=>e[r].reduce(((e,n,r)=>e+n*t[r][o]),0)))))},t.MOD=function(e,t){const n=M(e=T(e),t=T(t));if(n)return n;if(0===t)return l;let r=Math.abs(e%t);return r=e<0?t-r:r,t>0?r:-r},t.MODE=Ae,t.MODEMULT=dn,t.MODESNGL=pn,t.MONTH=function(e){return(e=N(e))instanceof Error?e:e.getMonth()+1},t.MROUND=function(e,t){return M(e=T(e),t=T(t))||(e*t==0?0:e*t<0?u:Math.round(e/t)*t)},t.MULTINOMIAL=function(){const e=L(b(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let r=0;r<e.length;r++)t+=e[r],n*=We(e[r]);return We(t)/n},t.MUNIT=function(e){return arguments.length>1?f:!(e=parseInt(e))||e<=0?i:Array(e).fill(0).map((()=>Array(e).fill(0))).map(((e,t)=>(e[t]=1,e)))},t.N=function(e){return $(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:G(e)?e:0},t.NA=function(){return f},t.NEGBINOM=je,t.NEGBINOMDIST=hn,t.NETWORKDAYS=it,t.NETWORKDAYSINTL=gn,t.NOMINAL=function(e,t){return _(e=T(e),t=T(t))?i:e<=0||t<1?u:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NORM=Me,t.NORMDIST=mn,t.NORMINV=yn,t.NORMSDIST=Cn,t.NORMSINV=bn,t.NOT=function(e){return"string"==typeof e?i:e instanceof Error?e:!e},t.NOW=function(){return new Date},t.NPER=function(e,t,n,r,o){if(o=void 0===o?0:o,r=void 0===r?0:r,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o)))return i;if(0===e)return-(n+r)/t;{const s=t*(1+e*o)-r*e,l=n*e+t*(1+e*o);return Math.log(s/l)/Math.log(1+e)}},t.NPV=Kn,t.NUMBERVALUE=function(e,t,n){return"number"==typeof(e=F(e)?e:"")?e:"string"!=typeof e?f:(t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,"")))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=!(10!==e.length||"7"!==e.substring(0,1)),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return u;if(n)return"1"+Ct("0",9-(512+r).toString(2).length)+(512+r).toString(2);const o=r.toString(2);return void 0===t?o:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=o.length?Ct("0",t-o.length)+o:u},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return u;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const r=n.toString(16);return void 0===t?r:isNaN(t)?i:t<0?u:(t=Math.floor(t))>=r.length?Ct("0",t-r.length)+r:u},t.ODD=function(e){if((e=T(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.OR=function(){const e=b(arguments);let t=i;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===i&&(t=!1),e[n]&&(t=!0))}return t},t.PDURATION=function(e,t,n){return _(e=T(e),t=T(t),n=T(n))?i:e<=0?u:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PEARSON=_e,t.PERCENTILE=Ie,t.PERCENTILEEXC=wn,t.PERCENTILEINC=En,t.PERCENTRANK=xe,t.PERCENTRANKEXC=vn,t.PERCENTRANKINC=An,t.PERMUT=function(e,t){return _(e=T(e),t=T(t))?i:We(e)/We(e-t)},t.PERMUTATIONA=function(e,t){return _(e=T(e),t=T(t))?i:Math.pow(e,t)},t.PHI=function(e){return(e=T(e))instanceof Error?i:Math.exp(-.5*e*e)/2.5066282746310002},t.PI=function(){return Math.PI},t.PMT=Xn,t.POISSON=De,t.POISSONDIST=jn,t.POWER=Ke,t.PPMT=function(e,t,n,r,o,s){return o=o||0,s=s||0,_(e=T(e),n=T(n),r=T(r),o=T(o),s=T(s))?i:Xn(e,n,r,o,s)-Yn(e,t,n,r,o,s)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(e,t,n,r,o){if(_(e=N(e),t=N(t),n=T(n),r=T(r),o=(o=T(o))||0))return i;if(n<=0||r<=0)return u;if(e>=t)return i;let s,l;switch(o){case 0:s=360,l=st(e,t,!1);break;case 1:case 3:s=365,l=nt(e,t,"D");break;case 2:s=360,l=nt(e,t,"D");break;case 4:s=360,l=st(e,t,!0);break;default:return u}return r-n*r*l/s},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PROB=function(e,t,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,_(e=L(b(e)),t=L(b(t)),n=T(n),r=T(r)))return i;if(n===r)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const o=e.sort(((e,t)=>e-t)),s=o.length;let l=0;for(let i=0;i<s;i++)o[i]>=n&&o[i]<=r&&(l+=t[e.indexOf(o[i])]);return l},t.PRODUCT=Xe,t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return _(e)?e:isNaN(e)&&"number"==typeof e?i:(e=O(e)).replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))},t.PV=function(e,t,n,r,o){return r=r||0,o=o||0,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o))?i:0===e?-n*t-r:((1-Math.pow(1+e,t))/e*n*(1+e*o)-r)/Math.pow(1+e,t)},t.QUARTILE=Ne,t.QUARTILEEXC=Mn,t.QUARTILEINC=_n,t.QUOTIENT=function(e,t){return M(e=T(e),t=T(t))||parseInt(e/t,10)},t.RADIANS=function(e){return(e=T(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return M(e=T(e),t=T(t))||e+Math.ceil((t-e+1)*Math.random())-1},t.RANK=Se,t.RANKAVG=In,t.RANKEQ=xn,t.RATE=function(e,t,n,r,o,s){if(s=void 0===s?.01:s,r=void 0===r?0:r,o=void 0===o?0:o,_(e=T(e),t=T(t),n=T(n),r=T(r),o=T(o),s=T(s)))return i;const l=1e-10;let a=s;o=o?1:0;for(let s=0;s<20;s++){if(a<=-1)return u;let s,i,c;if(Math.abs(a)<l?s=n*(1+e*a)+t*(1+a*o)*e+r:(i=Math.pow(1+a,e),s=n*i+t*(1/a+o)*(i-1)+r),Math.abs(s)<l)return a;if(Math.abs(a)<l)c=n*e+t*o*e;else{i=Math.pow(1+a,e);const r=e*Math.pow(1+a,e-1);c=n*r+t*(1/a+o)*r+t*(-1/(a*a))*(i-1)}a-=s/c}return a},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.REPLACE=function(e,t,n,r){return _(t=T(t),n=T(n))||"string"!=typeof e||"string"!=typeof r?i:e.substr(0,t-1)+r+e.substr(t-1+n)},t.REPT=Ct,t.RIGHT=function(e,t){return M(e,t)||(e=O(e),(t=T(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},t.ROMAN=function(e){if((e=T(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",o=3;for(;o--;)r=(n[+t.pop()+10*o]||"")+r;return new Array(+t.join("")+1).join("M")+r},t.ROUND=Ge,t.ROUNDDOWN=function(e,t){return M(e=T(e),t=T(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return M(e=T(e),t=T(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROW=function(e,t){return 2!==arguments.length?f:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?r.row(e,t):void 0:i},t.ROWS=function(e){return 1!==arguments.length?f:e instanceof Array?0===e.length?0:r.rows(e):i},t.RRI=function(e,t,n){return _(e=T(e),t=T(t),n=T(n))?i:0===e||0===t?u:Math.pow(n/t,1/e)-1},t.RSQ=function(e,t){return _(e=L(b(e)),t=L(b(t)))?i:Math.pow(_e(e,t),2)},t.SEARCH=function(e,t,n){let r;return"string"!=typeof e||"string"!=typeof t?i:(n=void 0===n?0:n,r=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===r?i:r)},t.SEC=function(e){return(e=T(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=T(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SECOND=function(e){return(e=N(e))instanceof Error?e:e.getSeconds()},t.SERIESSUM=function(e,t,n,r){if(_(e=T(e),t=T(t),n=T(n),r=L(r)))return i;let o=r[0]*Math.pow(e,t);for(let s=1;s<r.length;s++)o+=r[s]*Math.pow(e,t+s*n);return o},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.SIGN=function(e){return(e=T(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=T(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=T(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SKEW=Te,t.SKEWP=Dn,t.SLN=function(e,t,n){return _(e=T(e),t=T(t),n=T(n))?i:0===n?u:(e-t)/n},t.SLOPE=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;const n=r.mean(t),o=r.mean(e),s=t.length;let l=0,a=0;for(let r=0;r<s;r++)l+=(t[r]-n)*(e[r]-o),a+=Math.pow(t[r]-n,2);return l/a},t.SMALL=Le,t.SORT=function(e,t=1,n=1,r=!1){if(!e||!Array.isArray(e))return f;if(0===e.length)return 0;if(!(t=T(t))||t<1)return i;if(1!==(n=T(n))&&-1!==n)return i;if("boolean"!=typeof(r=D(r)))return c;const o=e=>e.sort(((e,r)=>(e=O(e[t-1]),r=O(r[t-1]),1===n?e<r?-1*n:n:e>r?n:-1*n))),s=C(e),l=r?A(s):s;return t>=1&&t<=l[0].length?r?A(o(l)):o(l):i},t.SQRT=function(e){return(e=T(e))instanceof Error?e:e<0?u:Math.sqrt(e)},t.SQRTPI=function(e){return(e=T(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.STANDARDIZE=function(e,t,n){return _(e=T(e),t=T(t),n=T(n))?i:(e-t)/n},t.STDEV=Oe,t.STDEVA=function(){const e=ke.apply(this,arguments);return Math.sqrt(e)},t.STDEVP=Nn,t.STDEVPA=function(){const e=Be.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},t.STDEVS=Sn,t.STEYX=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;const n=r.mean(t),o=r.mean(e),s=t.length;let l=0,a=0,c=0;for(let r=0;r<s;r++)l+=Math.pow(e[r]-o,2),a+=(t[r]-n)*(e[r]-o),c+=Math.pow(t[r]-n,2);return Math.sqrt((l-a*a/c)/(s-2))},t.SUBSTITUTE=function(e,t,n,r){if(arguments.length<3)return f;if(e&&t){if(void 0===r)return e.split(t).join(n);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return i;let o=0,s=0;for(;o>-1&&e.indexOf(t,o)>-1;)if(o=e.indexOf(t,o+1),s++,o>-1&&s===r)return e.substring(0,o)+n+e.substring(o+t.length);return e}}return e},t.SUBTOTAL=function(e,t){if((e=T(e))instanceof Error)return e;switch(e){case 1:case 101:return te(t);case 2:case 102:return ie(t);case 3:case 103:return ae(t);case 4:case 104:return we(t);case 5:case 105:return ve(t);case 6:case 106:return Xe(t);case 7:case 107:return Oe.S(t);case 8:case 108:return Oe.P(t);case 9:case 109:return Ze(t);case 10:case 110:return Fe.S(t);case 11:case 111:return Fe.P(t)}},t.SUM=Ze,t.SUMIF=function(e,t,n){if(e=b(e),n=n?b(n):e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let r=0;const o="*"===t,s=o?null:z(t+"");for(let t=0;t<e.length;t++){const l=e[t],i=n[t];if(o)r+=l;else{const e=[W(l,U)].concat(s);r+=Y(e)?i:0}}return r},t.SUMIFS=function(){const e=g(arguments),t=L(b(e.shift()));if(t instanceof Error)return t;const n=e,r=n.length/2;for(let e=0;e<r;e++)n[2*e]=b(n[2*e]);let o=0;for(let e=0;e<t.length;e++){let s=!1;for(let t=0;t<r;t++){const r=n[2*t][e],o=n[2*t+1];let l=!1;if(void 0===o||"*"===o)l=!0;else{const e=z(o+""),t=[W(r,U)].concat(e);l=Y(t)}if(!l){s=!1;break}s=!0}s&&(o+=t[e])}return o},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return i;const e=arguments.length+1;let t,n,r,o,s=0;for(let l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(let r=0;r<arguments[0][l].length;r++){for(t=1,n=1;n<e;n++){const e=arguments[n-1][l][r];if(e instanceof Error)return e;if(o=T(e),o instanceof Error)return o;t*=o}s+=t}else{for(t=1,n=1;n<e;n++){const e=arguments[n-1][l];if(e instanceof Error)return e;if(r=T(e),r instanceof Error)return r;t*=r}s+=t}return s},t.SUMSQ=function(){const e=L(b(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let r=0;r<n;r++)t+=$(e[r])?e[r]*e[r]:0;return t},t.SUMX2MY2=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;let n=0;for(let r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n},t.SUMX2PY2=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;let n=0;e=L(b(e)),t=L(b(t));for(let r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n},t.SUMXMY2=function(e,t){if(_(e=L(b(e)),t=L(b(t))))return i;let n=0;e=b(e),t=b(t);for(let r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},t.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,r=Math.floor(n/2);let o=!1;const s=n%2!=0,l=n%2==0?null:arguments[arguments.length-1];if(r)for(let n=0;n<r;n++)if(t===arguments[2*n+1]){e=arguments[2*n+2],o=!0;break}o||(e=s?l:f)}else e=i;return e},t.SYD=function(e,t,n,r){return _(e=T(e),t=T(t),n=T(n),r=T(r))?i:0===n||r<1||r>n?u:(e-t)*(n-(r=parseInt(r,10))+1)*2/(n*(n+1))},t.T=function(e){return e instanceof Error||"string"==typeof e?e:""},t.TAN=function(e){return(e=T(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=T(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.TBILLEQ=function(e,t,n){return _(e=N(e),t=N(t),n=T(n))?i:n<=0||e>t||t-e>31536e6?u:365*n/(360-n*st(e,t,!1))},t.TBILLPRICE=function(e,t,n){return _(e=N(e),t=N(t),n=T(n))?i:n<=0||e>t||t-e>31536e6?u:100*(1-n*st(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return _(e=N(e),t=N(t),n=T(n))?i:n<=0||e>t||t-e>31536e6?u:360*(100-n)/(n*st(e,t,!1))},t.TDIST=Tn,t.TDISTRT=Ln,t.TEXT=function(e,t){if(void 0===e||e instanceof Error||t instanceof Error)return f;if(null==t)return"";if("number"==typeof t)return String(t);if("string"!=typeof t)return i;const n=t.startsWith("$")?"$":"",r=t.endsWith("%");return r&&(e*=100),e=(e=yt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+(e=e.replace("-","")):n+e,r&&(e+="%"),e},t.TEXTJOIN=function(e,t,...n){if("boolean"!=typeof t&&(t=D(t)),arguments.length<3)return f;e=null!=e?e:"";let r=b(n),o=t?r.filter((e=>e)):r;if(Array.isArray(e)){e=b(e);let t=o.map((e=>[e])),n=0;for(let r=0;r<t.length-1;r++)t[r].push(e[n]),n++,n===e.length&&(n=0);return o=b(t),o.join("")}return o.join(e)},t.TIME=function(e,t,n){return _(e=T(e),t=T(t),n=T(n))?i:e<0||t<0||n<0?u:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return(e=N(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TINV=On,t.TODAY=function(){return rt(new Date)},t.TRANSPOSE=function(e){return e?A(C(e)):f},t.TREND=function(e,t,n){if(_(e=L(b(e)),t=L(b(t)),n=L(b(n))))return i;const r=Ce(e,t),o=r[0],s=r[1],l=[];return n.forEach((e=>{l.push(o*e+s)})),l},t.TRIM=function(e){return(e=O(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},t.TRIMMEAN=function(e,t){if(_(e=L(b(e)),t=T(t)))return i;const n=ze(e.length*t,2)/2;return r.mean((s=(s=n)||1,(o=v(e.sort(((e,t)=>e-t)),n))&&"function"==typeof o.slice?o.slice(0,o.length-s):o));var o,s},t.TRUE=function(){return!0},t.TRUNC=function(e,t){return M(e=T(e),t=T(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.TTEST=Rn,t.TYPE=function(e){return $(e)?1:J(e)?2:Z(e)?4:G(e)?16:Array.isArray(e)?64:void 0},t.UNICHAR=bt,t.UNICODE=wt,t.UNIQUE=Q,t.UPPER=function(e){return(e=O(e))instanceof Error?e:e.toUpperCase()},t.VALUE=function(e){const t=M(e);if(t)return t;if("number"==typeof e)return e;if(F(e)||(e=""),"string"!=typeof e)return i;const n=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let r=Number(e);return isNaN(r)?i:(r=r||0,n&&(r*=.01),r)},t.VAR=Fe,t.VARA=ke,t.VARP=Fn,t.VARPA=Be,t.VARS=kn,t.VDB=function(){throw new Error("VDB is not implemented")},t.VLOOKUP=ee,t.WEEKDAY=function(e,t){if((e=N(e))instanceof Error)return e;void 0===t&&(t=1);const n=e.getDay();return et[t][n]},t.WEEKNUM=function(e,t){if((e=N(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return lt(e);const n=Qe[t];let r=new Date(e.getFullYear(),0,1);const o=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((e-r)/864e5/7+1)+o},t.WEIBULL=Pe,t.WEIBULLDIST=Bn,t.WORKDAY=at,t.WORKDAYINTL=Pn,t.XIRR=function(e,t,n){if(_(e=L(b(e)),t=S(b(t)),n=T(n)))return i;const r=(e,t,n)=>{const r=n+1;let o=e[0];for(let n=1;n<e.length;n++)o+=e[n]/Math.pow(r,ot(t[n],t[0])/365);return o},o=(e,t,n)=>{const r=n+1;let o=0;for(let n=1;n<e.length;n++){const s=ot(t[n],t[0])/365;o-=s*e[n]/Math.pow(r,s+1)}return o};let s=!1,l=!1;for(let t=0;t<e.length;t++)e[t]>0&&(s=!0),e[t]<0&&(l=!0);if(!s||!l)return u;let a,c,f,d=n=n||.1,p=!0;do{f=r(e,t,d),a=d-f/o(e,t,d),c=Math.abs(a-d),d=a,p=c>1e-10&&Math.abs(f)>1e-10}while(p);return d},t.XNPV=function(e,t,n){if(_(e=T(e),t=L(b(t)),n=S(b(n))))return i;let r=0;for(let o=0;o<t.length;o++)r+=t[o]/Math.pow(1+e,ot(n[o],n[0])/365);return r},t.XOR=function(){const e=b(arguments);let t=i;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===i&&(t=0),e[n]&&t++)}return t===i?t:!!(1&Math.floor(Math.abs(t)))},t.YEAR=function(e){return(e=N(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=ft,t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.Z=He,t.ZTEST=Hn,t.utils=Gn}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var s=n[e]={exports:{}};return t[e].call(s.exports,s,s.exports,r),s.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var o=r(960);e=o}(),e})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jspreadsheet=t()}(this,(function(){var jspreadsheet;return function(){var __webpack_modules__={100:function(e,t){const n=function(e){const t=this,n=[];for(let r=0;r<e.length;r++){const o=e[r].x,s=e[r].y,l=t.options.columns[o].name?t.options.columns[o].name:o;n[s]||(n[s]={row:s,data:{}}),n[s].data[l]=e[r].value}return n.filter((function(e){return null!=e}))},r=function(e,t){const n=this,r=o.call(n.parent,"onbeforesave",n.parent,n,t);if(r)t=r;else if(!1===r)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){o.call(n,"onsave",n.parent,n,t)}})},o=function(e){const t=this;let o=null,s=t.parent?t.parent:t;if(!s.ignoreEvents&&("function"==typeof s.config.onevent&&(o=s.config.onevent.apply(this,arguments)),"function"==typeof s.config[e]&&(o=s.config[e].apply(this,Array.prototype.slice.call(arguments,1))),"object"==typeof s.plugins)){const e=Object.keys(s.plugins);for(let t=0;t<e.length;t++){const n=e[t],r=s.plugins[n];"function"==typeof r.onevent&&(o=r.onevent.apply(this,arguments))}}if("onafterchanges"==e){const e=arguments;if("object"==typeof s.plugins&&Object.entries(s.plugins).forEach((function([,n]){"function"==typeof n.persistence&&n.persistence(t,"setValue",{data:e[2]})})),t.options.persistence){const e=1==t.options.persistence?t.options.url:t.options.persistence,o=n.call(t,arguments[2]);r.call(t,e,o)}}return o};t.Z=o},456:function(e,t,n){n.d(t,{B4:function(){return s},aw:function(){return i},ql:function(){return l}});var r=n(992),o=n(366);const s=function(e){const t=this;if(t.options.filters){e=parseInt(e),t.resetSelection();let n=[];if("checkbox"==t.options.columns[e].type)n.push({id:"true",name:"True"}),n.push({id:"false",name:"False"});else{const r=[];let o=!1;for(let n=0;n<t.options.data.length;n++){const s=t.options.data[n][e],l=t.records[n][e].element.innerHTML;s&&l?r[s]=l:o=!0}const s=Object.keys(r);n=[];for(let e=0;e<s.length;e++)n.push({id:s[e],name:r[s[e]]});o&&n.push({value:"",id:"",name:"(Blanks)"})}const r=document.createElement("div");t.filter.children[e+1].innerHTML="",t.filter.children[e+1].appendChild(r),t.filter.children[e+1].style.paddingLeft="0px",t.filter.children[e+1].style.paddingRight="0px",t.filter.children[e+1].style.overflow="initial";const s={data:n,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==t.filters[e]?t.filters[e]:null,width:"100%",position:1==t.options.tableOverflow||1==t.parent.config.fullscreen,onclose:function(n){i.call(t),t.filters[e]=n.dropdown.getValue(!0),t.filter.children[e+1].innerHTML=n.dropdown.getText(),t.filter.children[e+1].style.paddingLeft="",t.filter.children[e+1].style.paddingRight="",t.filter.children[e+1].style.overflow="",l.call(t,e),o.E.call(t)}};jSuites.dropdown(r,s)}},l=function(e){const t=this;if(!e)for(let n=0;n<t.filter.children.length;n++)t.filters[n]&&(e=n);const n=function(e,n,r){for(let o=0;o<e.length;o++){const s=""+t.options.data[r][n],l=""+t.records[r][n].element.innerHTML;if(e[o]==s||e[o]==l)return!0}return!1},o=t.filters[e];t.results=[];for(let r=0;r<t.options.data.length;r++)n(o,e,r)&&t.results.push(r);t.results.length||(t.results=null),r.cW.call(t)},i=function(){const e=this;if(e.options.filters)for(let t=0;t<e.filter.children.length;t++)e.filter.children[t].innerHTML="&nbsp;",e.filters[t]=null;e.results=null,r.cW.call(e)}},427:function(e,t,n){n.d(t,{i:function(){return o}});var r=n(992);const o=function(e){const t=this;if(e&&(t.options.footers=e),t.options.footers){t.tfoot||(t.tfoot=document.createElement("tfoot"),t.table.appendChild(t.tfoot));for(let e=0;e<t.options.footers.length;e++){let n;if(t.tfoot.children[e])n=t.tfoot.children[e];else{n=document.createElement("tr");const e=document.createElement("td");n.appendChild(e),t.tfoot.appendChild(n)}for(let o=0;o<t.headers.length;o++){let s;if(t.options.footers[e][o]||(t.options.footers[e][o]=""),t.tfoot.children[e].children[o+1])s=t.tfoot.children[e].children[o+1];else{s=document.createElement("td"),n.appendChild(s);const e=t.options.columns[o].align||t.options.defaultColAlign||"center";s.style.textAlign=e}s.textContent=r.H2.call(t,+t.records.length+o,e,t.options.footers[e][o]),s.style.display=t.cols[o].colElement.style.display}}}}},157:function(e,t,n){n.d(t,{I:function(){return r}});const r=function(){const e=this;let t=0;if(e.options.freezeColumns>0)for(let n=0;n<e.options.freezeColumns;n++){let r;r=e.options.columns&&e.options.columns[n]&&void 0!==e.options.columns[n].width?parseInt(e.options.columns[n].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100,t+=r}return t}},650:function(e,t,n){n.r(t),n.d(t,{createFromTable:function(){return f},getCaretIndex:function(){return o},getCellNameFromCoords:function(){return i},getColumnName:function(){return l},getCoordsFromCellName:function(){return a},getCoordsFromRange:function(){return c},invert:function(){return s},parseCSV:function(){return u}});var r=n(323);const o=function(e){let t;t=this.config.root?this.config.root:window;let n=0;const r=t.getSelection();if(r&&0!==r.rangeCount){const t=r.getRangeAt(0),o=t.cloneRange();o.selectNodeContents(e),o.setEnd(t.endContainer,t.endOffset),n=o.toString().length}return n},s=function(e){const t=[],n=Object.keys(e);for(let r=0;r<n.length;r++)t[e[n[r]]]=n[r];return t},l=function(e){let t="";return e>701?(t+=String.fromCharCode(64+parseInt(e/676)),t+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(t+=String.fromCharCode(64+parseInt(e/26))),t+=String.fromCharCode(65+e%26),t},i=function(e,t){return l(parseInt(e))+(parseInt(t)+1)},a=function(e){const t=/^[a-zA-Z]+/.exec(e);if(t){let n=0;for(let e=0;e<t[0].length;e++)n+=parseInt(t[0].charCodeAt(e)-64)*Math.pow(26,t[0].length-1-e);n--,n<0&&(n=0);let r=parseInt(/[0-9]+$/.exec(e))||null;return r>0&&r--,[n,r]}},c=function(e){const[t,n]=e.split(":");return[...a(t),...a(n)]},u=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";const n=[];let r=!1;for(let o=0,s=0,l=0;l<e.length;l++){const i=e[l],a=e[l+1];n[o]=n[o]||[],n[o][s]=n[o][s]||"",'"'==i&&r&&'"'==a?(n[o][s]+=i,++l):'"'!=i?i!=t||r?"\r"!=i||"\n"!=a||r?"\n"==i&&!r||"\r"==i&&!r?(++o,s=0):n[o][s]+=i:(++o,s=0,++l):++s:r=!r}return n},f=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];const n=e.querySelectorAll("colgroup > col");if(n.length)for(let e=0;e<n.length;e++){let r=n[e].style.width;r||(r=n[e].getAttribute("width")),r&&(t.columns[e]||(t.columns[e]={}),t.columns[e].width=r)}const o=function(e,n){let r=e.getBoundingClientRect();const o=r.width>50?r.width:50;t.columns[n]||(t.columns[n]={}),e.getAttribute("data-celltype")?t.columns[n].type=e.getAttribute("data-celltype"):t.columns[n].type="text",t.columns[n].width=o+"px",t.columns[n].title=e.innerHTML,e.style.textAlign&&(t.columns[n].align=e.style.textAlign),(r=e.getAttribute("name"))&&(t.columns[n].name=r),(r=e.getAttribute("id"))&&(t.columns[n].id=r),(r=e.getAttribute("data-mask"))&&(t.columns[n].mask=r)},s=[];let l=e.querySelectorAll(":scope > thead > tr");if(l.length){for(let e=0;e<l.length-1;e++){const t=[];for(let n=0;n<l[e].children.length;n++){const r={title:l[e].children[n].textContent,colspan:l[e].children[n].getAttribute("colspan")||1};t.push(r)}s.push(t)}l=l[l.length-1].children;for(let e=0;e<l.length;e++)o(l[e],e)}let i=0;const a={},c={},u={},f={};let d=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let e=0;e<d.length;e++)if(t.data[i]=[],1!=t.parseTableFirstRowAsHeader||l.length||0!=e){for(let n=0;n<d[e].children.length;n++){let o=d[e].children[n].getAttribute("data-formula");o?"="!=o.substr(0,1)&&(o="="+o):o=d[e].children[n].innerHTML,t.data[i].push(o);const s=(0,r.Ar)([n,e]),l=d[e].children[n].getAttribute("class");l&&(f[s]=l);const c=parseInt(d[e].children[n].getAttribute("colspan"))||0,p=parseInt(d[e].children[n].getAttribute("rowspan"))||0;(c||p)&&(a[s]=[c||1,p||1]),d[e].children[n].style&&"none"==d[e].children[n].style.display&&(d[e].children[n].style.display="");const h=d[e].children[n].getAttribute("style");h&&(u[s]=h),d[e].children[n].classList.contains("styleBold")&&(u[s]?u[s]+="; font-weight:bold;":u[s]="font-weight:bold;")}d[e].style&&d[e].style.height&&(c[e]={height:d[e].style.height}),i++}else for(let t=0;t<d[e].children.length;t++)o(d[e].children[t],t);if(Object.keys(s).length>0&&(t.nestedHeaders=s),Object.keys(u).length>0&&(t.style=u),Object.keys(a).length>0&&(t.mergeCells=a),Object.keys(c).length>0&&(t.rows=c),Object.keys(f).length>0&&(t.classes=f),d=e.querySelectorAll("tfoot tr"),d.length){const e=[];for(let t=0;t<d.length;t++){let n=[];for(let e=0;e<d[t].children.length;e++)n.push(d[t].children[e].textContent);e.push(n)}Object.keys(e).length>0&&(t.footers=e)}if(1==t.parseTableAutoCellType){const e=[];for(let n=0;n<t.columns.length;n++){let r=!0,o=!0;e[n]=[];for(let s=0;s<t.data.length;s++){const l=t.data[s][n];e[n][l]||(e[n][l]=0),e[n][l]++,l.length>25&&(r=!1),10==l.length&&"-"==l.substr(4,1)&&"-"==l.substr(7,1)||(o=!1)}const s=Object.keys(e[n]).length;o?t.columns[n].type="calendar":1==r&&s>1&&s<=parseInt(.1*t.data.length)&&(t.columns[n].type="dropdown",t.columns[n].source=Object.keys(e[n]))}}return t}}},923:function(e,t,n){n.d(t,{JB:function(){return c},KX:function(){return p},Yw:function(){return d}});var r=n(100),o=n(323),s=n(992),l=n(49),i=n(54),a=n(366);const c=function(e){const t=this;if(1!=t.ignoreHistory){const n=++t.historyIndex;t.history=t.history=t.history.slice(0,n+1),t.history[n]=e}},u=function(e,t){const n=this,r=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==n.options.search&&n.results&&n.results.length!=n.rows.length&&n.resetSearch(),1==e){const e=t.numOfRows;for(let t=r;t<e+r;t++)n.rows[t].element.parentNode.removeChild(n.rows[t].element);n.records.splice(r,e),n.options.data.splice(r,e),n.rows.splice(r,e),a.Uv.call(n,1,r,e+r-1)}else{n.records=(0,o.Wc)(n.records,r,t.rowRecords),n.options.data=(0,o.Wc)(n.options.data,r,t.rowData),n.rows=(0,o.Wc)(n.rows,r,t.rowNode);let e=0;for(let o=r;o<t.numOfRows+r;o++)n.tbody.insertBefore(t.rowNode[e].element,n.tbody.children[o]),e++}for(let e=r;e<n.rows.length;e++)n.rows[e].y=e;for(let e=r;e<n.records.length;e++)for(let t=0;t<n.records[e].length;t++)n.records[e][t].y=e;n.options.pagination>0&&n.page(n.pageNumber),s.ec.call(n)},f=function(e,t){const n=this,r=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){const e=t.numOfColumns;n.options.columns.splice(r,e);for(let t=r;t<e+r;t++)n.headers[t].parentNode.removeChild(n.headers[t]),n.cols[t].colElement.parentNode.removeChild(n.cols[t].colElement);n.headers.splice(r,e),n.cols.splice(r,e);for(let o=0;o<t.data.length;o++){for(let t=r;t<e+r;t++)n.records[o][t].element.parentNode.removeChild(n.records[o][t].element);n.records[o].splice(r,e),n.options.data[o].splice(r,e)}if(n.options.footers)for(let t=0;t<n.options.footers.length;t++)n.options.footers[t].splice(r,e)}else{n.options.columns=(0,o.Wc)(n.options.columns,r,t.columns),n.headers=(0,o.Wc)(n.headers,r,t.headers),n.cols=(0,o.Wc)(n.cols,r,t.cols);let e=0;for(let o=r;o<t.numOfColumns+r;o++)n.headerContainer.insertBefore(t.headers[e],n.headerContainer.children[o+1]),n.colgroupContainer.insertBefore(t.cols[e].colElement,n.colgroupContainer.children[o+1]),e++;for(let e=0;e<t.data.length;e++){n.options.data[e]=(0,o.Wc)(n.options.data[e],r,t.data[e]),n.records[e]=(0,o.Wc)(n.records[e],r,t.records[e]);let s=0;for(let o=r;o<t.numOfColumns+r;o++)n.rows[e].element.insertBefore(t.records[e][s].element,n.rows[e].element.children[o+1]),s++}if(n.options.footers)for(let e=0;e<n.options.footers.length;e++)n.options.footers[e]=(0,o.Wc)(n.options.footers[e],r,t.footers[e])}for(let e=r;e<n.cols.length;e++)n.cols[e].x=e;for(let e=0;e<n.records.length;e++)for(let t=r;t<n.records[e].length;t++)n.records[e][t].x=t;if(n.options.nestedHeaders&&n.options.nestedHeaders.length>0&&n.options.nestedHeaders[0]&&n.options.nestedHeaders[0][0])for(let r=0;r<n.options.nestedHeaders.length;r++){let o;o=1==e?parseInt(n.options.nestedHeaders[r][n.options.nestedHeaders[r].length-1].colspan)-t.numOfColumns:parseInt(n.options.nestedHeaders[r][n.options.nestedHeaders[r].length-1].colspan)+t.numOfColumns,n.options.nestedHeaders[r][n.options.nestedHeaders[r].length-1].colspan=o,n.thead.children[r].children[n.thead.children[r].children.length-1].setAttribute("colspan",o)}s.ec.call(n)},d=function(){const e=this,t=!!e.parent.ignoreEvents,n=!!e.ignoreHistory;e.parent.ignoreEvents=!0,e.ignoreHistory=!0;const o=[];let s;if(e.historyIndex>=0)if(s=e.history[e.historyIndex--],"insertRow"==s.action)u.call(e,1,s);else if("deleteRow"==s.action)u.call(e,0,s);else if("insertColumn"==s.action)f.call(e,1,s);else if("deleteColumn"==s.action)f.call(e,0,s);else if("moveRow"==s.action)e.moveRow(s.newValue,s.oldValue);else if("moveColumn"==s.action)e.moveColumn(s.newValue,s.oldValue);else if("setMerge"==s.action)e.removeMerge(s.column,s.data);else if("setStyle"==s.action)e.setStyle(s.oldValue,null,null,1);else if("setWidth"==s.action)e.setWidth(s.column,s.oldValue);else if("setHeight"==s.action)e.setHeight(s.row,s.oldValue);else if("setHeader"==s.action)e.setHeader(s.column,s.oldValue);else if("setComments"==s.action)e.setComments(s.oldValue);else if("orderBy"==s.action){let t=[];for(let e=0;e<s.rows.length;e++)t[s.rows[e]]=e;i.SV.call(e,s.column,s.order?0:1),i.Cs.call(e,t)}else if("setValue"==s.action){for(let t=0;t<s.records.length;t++)o.push({x:s.records[t].x,y:s.records[t].y,value:s.records[t].oldValue}),s.oldStyle&&e.resetStyle(s.oldStyle);e.setValue(o),s.selection&&e.updateSelectionFromCoords(s.selection[0],s.selection[1],s.selection[2],s.selection[3])}e.parent.ignoreEvents=t,e.ignoreHistory=n,r.Z.call(e,"onundo",e,s)},p=function(){const e=this,t=!!e.parent.ignoreEvents,n=!!e.ignoreHistory;let o;if(e.parent.ignoreEvents=!0,e.ignoreHistory=!0,e.historyIndex<e.history.length-1)if(o=e.history[++e.historyIndex],"insertRow"==o.action)u.call(e,0,o);else if("deleteRow"==o.action)u.call(e,1,o);else if("insertColumn"==o.action)f.call(e,0,o);else if("deleteColumn"==o.action)f.call(e,1,o);else if("moveRow"==o.action)e.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)e.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)l.mt.call(e,o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)e.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)e.setWidth(o.column,o.newValue);else if("setHeight"==o.action)e.setHeight(o.row,o.newValue);else if("setHeader"==o.action)e.setHeader(o.column,o.newValue);else if("setComments"==o.action)e.setComments(o.newValue);else if("orderBy"==o.action)i.SV.call(e,o.column,o.order),i.Cs.call(e,o.rows);else if("setValue"==o.action){e.setValue(o.records);for(let t=0;t<o.records.length;t++)o.oldStyle&&e.resetStyle(o.newStyle);o.selection&&e.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}e.parent.ignoreEvents=t,e.ignoreHistory=n,r.Z.call(e,"onredo",e,o)}},992:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$S:function(){return getCell},E2:function(){return updateFormula},Gr:function(){return fullscreen},H2:function(){return parseValue},Hf:function(){return getWorksheetInstance},Of:function(){return updateScroll},Sl:function(){return getCellFromCoords},T0:function(){return updateTable},TO:function(){return hideIndex},UI:function(){return showIndex},UQ:function(){return createNestedHeader},Vi:function(){return getMask},X0:function(){return getWorksheetActive},Zz:function(){return updateFormulaChain},cW:function(){return updateResult},ec:function(){return updateTableReferences},id:function(){return getLabel},jr:function(){return isFormula},kE:function(){return createCell},pX:function(){return executeFormula},wW:function(){return updateCell}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(100),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(366),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(650),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(272),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(157),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(673),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(427),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(323);const updateTable=function(){const e=this;if(e.options.minSpareRows>0){let t=0;for(let n=e.rows.length-1;n>=0;n--){let r=!1;for(let t=0;t<e.headers.length;t++)e.options.data[n][t]&&(r=!0);if(r)break;t++}e.options.minSpareRows-t>0&&e.insertRow(e.options.minSpareRows-t)}if(e.options.minSpareCols>0){let t=0;for(let n=e.headers.length-1;n>=0;n--){let r=!1;for(let t=0;t<e.rows.length;t++)e.options.data[t][n]&&(r=!0);if(r)break;t++}e.options.minSpareCols-t>0&&e.insertColumn(e.options.minSpareCols-t)}e.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.i.call(e),setTimeout((function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(e)}),0)},parseNumber=function(e,t){const n=t&&this.options.columns[t].decimal?this.options.columns[t].decimal:".";let r=""+e;return r=r.split(n),r[0]=r[0].match(/[+-]?[0-9]/g),r[0]&&(r[0]=r[0].join("")),r[1]&&(r[1]=r[1].match(/[0-9]*/g).join("")),r[0]&&Number.isInteger(Number(r[0]))?r[1]?Number(r[0]+"."+r[1]):Number(r[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([x,y]);if(formulaLoopProtection[parentId])return"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(e){for(let t=0;t<e.length;t++){const n=[],r=e[t].split(":"),o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r[0],!0),s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r[1],!0);let l,i,a,c;o[0]<=s[0]?(l=o[0],i=s[0]):(l=s[0],i=o[0]),o[1]<=s[1]?(a=o[1],c=s[1]):(a=s[1],c=o[1]);for(let e=a;e<=c;e++)for(let t=l;t<=i;t++)n.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([t,e]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return"#ERROR";{const formulaExpressions={};if(tokens)for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(tokens[i],1);let t;if(t=void 0!==obj.options.data[e[1]]&&void 0!==obj.options.data[e[1]][e[0]]?obj.options.data[e[1]][e[0]]:"","="==(""+t).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?t=formulaResults[tokens[i]]:(t=execute(t,e[0],e[1]),formulaResults[tokens[i]]=t)),""==(""+t).trim())formulaExpressions[tokens[i]]=null;else if(t==Number(t)&&0!=obj.parent.config.autoCasting)formulaExpressions[tokens[i]]=Number(t);else{const n=parseNumber.call(obj,t,e[0]);0!=obj.parent.config.autoCasting&&n?formulaExpressions[tokens[i]]=n:formulaExpressions[tokens[i]]='"'+t+'"'}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(obj,"onbeforeformula",obj,expression,x,y);if(!1===ret)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),"function"==typeof res&&(res="#ERROR")}catch(e){res="#ERROR",obj.parent.config.debugFormulas}return res}};return execute(expression,x,y)},parseValue=function(e,t,n,r){const o=this;"="==(""+n).substr(0,1)&&0!=o.parent.config.parseFormulas&&(n=executeFormula.call(o,n,e,t));const s=o.options.columns&&o.options.columns[e];if(s&&!isFormula(n)){let e=null;if(e=getMask(s)){n&&n==Number(n)&&(n=Number(n));let t=jSuites.mask.render(n,e,!0);if(r&&e.mask){const o=e.mask.split(";");o[1]&&(o[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?r.classList.add("red"):r.classList.remove("red")),o[1].match(new RegExp("\\(","gi"))&&n<0&&(t="("+t+")"))}t&&(n=t)}}return n},getDropDownValue=function(e,t){const n=this,r=[];if(n.options.columns&&n.options.columns[e]&&n.options.columns[e].source){const o=[],s=n.options.columns[e].source;for(let e=0;e<s.length;e++)"object"==typeof s[e]?o[s[e].id]=s[e].name:o[s[e]]=s[e];const l=Array.isArray(t)?t:(""+t).split(";");for(let e=0;e<l.length;e++)"object"==typeof l[e]?r.push(o[l[e].id]):o[l[e]]&&r.push(o[l[e]])}return r.length>0?r.join("; "):""},validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])},stripScript=function(e){const t=new Option;t.innerHTML=e;let n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML},createCell=function(e,t,n){const r=this;let o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==r.options.secureFormulas){const e=secureFormula(n);e!=n&&(n=e)}if(r.options.columns&&r.options.columns[e]&&"object"==typeof r.options.columns[e].type)!0===r.parent.config.parseHTML?o.innerHTML=n:o.textContent=n,"function"==typeof r.options.columns[e].type.createCell&&r.options.columns[e].type.createCell(o,n,parseInt(e),parseInt(t),r,r.options.columns[e]);else if(r.options.columns&&r.options.columns[e]&&"hidden"==r.options.columns[e].type)o.style.display="none",o.textContent=n;else if(r.options.columns&&r.options.columns[e]&&("checkbox"==r.options.columns[e].type||"radio"==r.options.columns[e].type)){const s=document.createElement("input");s.type=r.options.columns[e].type,s.name="c"+e,s.checked=1==n||1==n||"true"==n,s.onclick=function(){r.setValue(o,this.checked)},1!=r.options.columns[e].readOnly&&0!=r.options.editable||s.setAttribute("disabled","disabled"),o.appendChild(s),r.options.data[t][e]=s.checked}else if(r.options.columns&&r.options.columns[e]&&"calendar"==r.options.columns[e].type){let t=null;if(!validDate(n)){const o=jSuites.calendar.extractDateFromString(n,r.options.columns[e].options&&r.options.columns[e].options.format||"YYYY-MM-DD");o&&(t=o)}o.textContent=jSuites.calendar.getDateString(t||n,r.options.columns[e].options&&r.options.columns[e].options.format)}else if(r.options.columns&&r.options.columns[e]&&"dropdown"==r.options.columns[e].type)o.classList.add("jss_dropdown"),o.textContent=getDropDownValue.call(r,e,n);else if(r.options.columns&&r.options.columns[e]&&"color"==r.options.columns[e].type)if("square"==r.options.columns[e].render){const e=document.createElement("div");e.className="color",e.style.backgroundColor=n,o.appendChild(e)}else o.style.color=n,o.textContent=n;else if(r.options.columns&&r.options.columns[e]&&"image"==r.options.columns[e].type){if(n&&"data:image"==n.substr(0,10)){const e=document.createElement("img");e.src=n,o.appendChild(e)}}else r.options.columns&&r.options.columns[e]&&"html"==r.options.columns[e].type||!0===r.parent.config.parseHTML?o.innerHTML=stripScript(parseValue.call(this,e,t,n,o)):o.textContent=parseValue.call(this,e,t,n,o);r.options.columns&&r.options.columns[e]&&1==r.options.columns[e].readOnly&&(o.className="readonly");const s=r.options.columns&&r.options.columns[e]&&r.options.columns[e].align||r.options.defaultColAlign||"center";return o.style.textAlign=s,r.options.columns&&r.options.columns[e]&&0==r.options.columns[e].wordWrap||!(1==r.options.wordWrap||r.options.columns&&r.options.columns[e]&&1==r.options.columns[e].wordWrap||o.innerHTML.length>200)||(o.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||o.innerHTML?r.records[t][e-1].element.style.overflow="hidden":e==r.options.columns.length-1&&(o.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(r,"oncreatecell",r,o,e,t,n),o},updateCell=function(e,t,n,r){const o=this;let s;if(1!=o.records[t][e].element.classList.contains("readonly")||r){if("="==(""+n).substr(0,1)&&1==o.options.secureFormulas){const e=secureFormula(n);e!=n&&(n=e)}const r=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(o,"onbeforechange",o,o.records[t][e].element,e,t,n);if(null!=r&&(n=r),o.options.columns&&o.options.columns[e]&&"object"==typeof o.options.columns[e].type&&"function"==typeof o.options.columns[e].type.updateCell){const r=o.options.columns[e].type.updateCell(o.records[t][e].element,n,parseInt(e),parseInt(t),o,o.options.columns[e]);void 0!==r&&(n=r)}s={x:e,y:t,col:e,row:t,value:n,oldValue:o.options.data[t][e]};let l=o.options.columns&&o.options.columns[e]&&"object"==typeof o.options.columns[e].type?o.options.columns[e].type:null;if(l)o.options.data[t][e]=n,"function"==typeof l.setValue&&l.setValue(o.records[t][e].element,n);else if(o.options.columns&&o.options.columns[e]&&("checkbox"==o.options.columns[e].type||"radio"==o.options.columns[e].type)){if("radio"==o.options.columns[e].type)for(let t=0;t<o.options.data.length;t++)o.options.data[t][e]=!1;o.records[t][e].element.children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,o.options.data[t][e]=o.records[t][e].element.children[0].checked}else if(o.options.columns&&o.options.columns[e]&&"dropdown"==o.options.columns[e].type)o.options.data[t][e]=n,o.records[t][e].element.textContent=getDropDownValue.call(o,e,n);else if(o.options.columns&&o.options.columns[e]&&"calendar"==o.options.columns[e].type){let r=null;if(!validDate(n)){const t=jSuites.calendar.extractDateFromString(n,o.options.columns[e].options&&o.options.columns[e].options.format||"YYYY-MM-DD");t&&(r=t)}o.options.data[t][e]=n,o.records[t][e].element.textContent=jSuites.calendar.getDateString(r||n,o.options.columns[e].options&&o.options.columns[e].options.format)}else if(o.options.columns&&o.options.columns[e]&&"color"==o.options.columns[e].type)if(o.options.data[t][e]=n,"square"==o.options.columns[e].render){const r=document.createElement("div");r.className="color",r.style.backgroundColor=n,o.records[t][e].element.textContent="",o.records[t][e].element.appendChild(r)}else o.records[t][e].element.style.color=n,o.records[t][e].element.textContent=n;else if(o.options.columns&&o.options.columns[e]&&"image"==o.options.columns[e].type){if(n=""+n,o.options.data[t][e]=n,o.records[t][e].element.innerHTML="",n&&"data:image"==n.substr(0,10)){const r=document.createElement("img");r.src=n,o.records[t][e].element.appendChild(r)}}else o.options.data[t][e]=n,o.options.columns&&o.options.columns[e]&&"html"==o.options.columns[e].type?o.records[t][e].element.innerHTML=stripScript(parseValue.call(o,e,t,n)):!0===o.parent.config.parseHTML?o.records[t][e].element.innerHTML=stripScript(parseValue.call(o,e,t,n,o.records[t][e].element)):o.records[t][e].element.textContent=parseValue.call(o,e,t,n,o.records[t][e].element),o.options.columns&&o.options.columns[e]&&0==o.options.columns[e].wordWrap||!(1==o.options.wordWrap||o.options.columns&&o.options.columns[e]&&1==o.options.columns[e].wordWrap||o.records[t][e].element.innerHTML.length>200)?o.records[t][e].element.style.whiteSpace="":o.records[t][e].element.style.whiteSpace="pre-wrap";e>0&&(o.records[t][e-1].element.style.overflow=n?"hidden":""),o.options.columns&&o.options.columns[e]&&"function"==typeof o.options.columns[e].render&&o.options.columns[e].render(o.records[t]&&o.records[t][e]?o.records[t][e].element:null,n,parseInt(e),parseInt(t),o,o.options.columns[e]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.Z.call(o,"onchange",o,o.records[t]&&o.records[t][e]?o.records[t][e].element:null,e,t,n,s.oldValue)}else s={x:e,y:t,col:e,row:t};return s},isFormula=function(e){const t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){const t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},secureFormula=function(e){let t="",n=0;for(let r=0;r<e.length;r++)'"'==e[r]&&(n=0==n?1:0),t+=1==n?e[r]:e[r].toUpperCase();return t};let chainLoopProtection=[];const updateFormulaChain=function(e,t,n){const r=this,o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([e,t]);if(r.formula[o]&&r.formula[o].length>0)if(chainLoopProtection[o])r.records[t][e].element.innerHTML="#ERROR",r.formula[o]="";else{chainLoopProtection[o]=!0;for(let e=0;e<r.formula[o].length;e++){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(r.formula[o][e],!0),s=""+r.options.data[t[1]][t[0]];"="==s.substr(0,1)?n.push(updateCell.call(r,t[0],t[1],s,!0)):Object.keys(r.formula)[e]=null,updateFormulaChain.call(r,t[0],t[1],n)}}chainLoopProtection=[]},updateFormula=function(e,t){const n=/[A-Z]/,r=/[0-9]/;let o="",s=null,l=null,i="";for(let a=0;a<e.length;a++)n.exec(e[a])?(s=1,l=0,i+=e[a]):r.exec(e[a])?(l=s?1:0,i+=e[a]):(s&&l&&(i=t[i]?t[i]:i),o+=i,o+=e[a],s=0,l=0,i="");return i&&(s&&l&&(i=t[i]?t[i]:i),o+=i),o},updateFormulas=function(e){const t=this;for(let n=0;n<t.options.data.length;n++)for(let r=0;r<t.options.data[0].length;r++){const o=""+t.options.data[n][r];if("="==o.substr(0,1)){const s=updateFormula(o,e);s!=o&&(t.options.data[n][r]=s)}}const n=[],r=Object.keys(t.formula);for(let o=0;o<r.length;o++){let s=r[o];const l=t.formula[s];e[s]&&(s=e[s]),n[s]=[];for(let t=0;t<l.length;t++){let r=l[t];e[r]&&(r=e[r]),n[s].push(r)}}t.formula=n},updateTableReferences=function(){const e=this;for(let t=0;t<e.headers.length;t++)e.headers[t].getAttribute("data-x")!=t&&(e.headers[t].setAttribute("data-x",t),e.headers[t].getAttribute("title")||(e.headers[t].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(t)));for(let t=0;t<e.rows.length;t++)e.rows[t]&&e.rows[t].element.getAttribute("data-y")!=t&&(e.rows[t].element.setAttribute("data-y",t),e.rows[t].element.children[0].setAttribute("data-y",t),e.rows[t].element.children[0].innerHTML=t+1);const t=[],n=[],r=function(n,r,o,s){if(n!=o&&e.records[s][o].element.setAttribute("data-x",o),r!=s&&e.records[s][o].element.setAttribute("data-y",s),n!=o||r!=s){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([n,r]),l=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,s]);t[e]=l}};for(let t=0;t<e.records.length;t++)for(let o=0;o<e.records[0].length;o++)if(e.records[t][o]){const s=e.records[t][o].element.getAttribute("data-x"),l=e.records[t][o].element.getAttribute("data-y");if(e.records[t][o].element.getAttribute("data-merged")){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([s,l]),r=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.Ar)([o,t]);if(null==n[e])if(e==r)n[e]=!1;else{const i=parseInt(o-s),a=parseInt(t-l);n[e]=[r,i,a]}}else r(s,l,o,t)}const o=Object.keys(n);if(o.length)for(let t=0;t<o.length;t++)if(n[o[t]]){const s=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(o[t],!0);let l=s[0],i=s[1];r(l,i,l+n[o[t]][1],i+n[o[t]][2]);const a=o[t],c=n[o[t]][0];for(let r=0;r<e.options.mergeCells[a][2].length;r++)l=parseInt(e.options.mergeCells[a][2][r].getAttribute("data-x")),i=parseInt(e.options.mergeCells[a][2][r].getAttribute("data-y")),e.options.mergeCells[a][2][r].setAttribute("data-x",l+n[o[t]][1]),e.options.mergeCells[a][2][r].setAttribute("data-y",i+n[o[t]][2]);e.options.mergeCells[c]=e.options.mergeCells[a],delete e.options.mergeCells[a]}updateFormulas.call(e,t),_meta_js__WEBPACK_IMPORTED_MODULE_5__.Lx.call(e,t),_selection_js__WEBPACK_IMPORTED_MODULE_1__.E.call(e),updateTable.call(e)},updateScroll=function(e){const t=this,n=t.content.getBoundingClientRect(),r=n.left,o=n.top,s=n.width,l=n.height,i=t.records[t.selectedCell[3]][t.selectedCell[2]].element.getBoundingClientRect(),a=i.left,c=i.top,u=i.width,f=i.height;let d,p;0==e||1==e?(d=a-r+t.content.scrollLeft,p=c-o+t.content.scrollTop-2):(d=a-r+t.content.scrollLeft+u,p=c-o+t.content.scrollTop+f),p>t.content.scrollTop+30&&p<t.content.scrollTop+l||(p<t.content.scrollTop+30?t.content.scrollTop=p-f:t.content.scrollTop=p-(l-2));const h=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.I.call(t);d>t.content.scrollLeft+h&&d<t.content.scrollLeft+s||(d<t.content.scrollLeft+30?(t.content.scrollLeft=d,t.content.scrollLeft<50&&(t.content.scrollLeft=0)):d<t.content.scrollLeft+h?t.content.scrollLeft=d-h-1:t.content.scrollLeft=d-(s-20))},updateResult=function(){const e=this;let t=0,n=0;for(t=1==e.options.lazyLoading?100:e.options.pagination>0?e.options.pagination:e.results?e.results.length:e.rows.length;e.tbody.firstChild;)e.tbody.removeChild(e.tbody.firstChild);for(let r=0;r<e.rows.length;r++)!e.results||e.results.indexOf(r)>-1?(n<t&&(e.tbody.appendChild(e.rows[r].element),n++),e.rows[r].element.style.display=""):e.rows[r].element.style.display="none";return e.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.Ik.call(e),_selection_js__WEBPACK_IMPORTED_MODULE_1__.x8.call(e),t},getCell=function(e,t){if("string"==typeof e){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element},getCellFromCoords=function(e,t){return this.records[t][e].element},getLabel=function(e,t){if("string"==typeof e){const n=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.qP)(e,!0);e=n[0],t=n[1]}return this.records[t][e].element.innerHTML},fullscreen=function(e){const t=this;null==e&&(e=!t.config.fullscreen),t.config.fullscreen!=e&&(t.config.fullscreen=e,1==e?t.element.classList.add("fullscreen"):t.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(e){const t=this,n=document.createElement("tr");n.classList.add("jss_nested");const r=document.createElement("td");r.classList.add("jss_selectall"),n.appendChild(r),e.element=n;let o=0;for(let r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].title||(e[r].title=""),e[r].id||(e[r].id="");let s=e[r].colspan;const l=[];for(let e=0;e<s;e++)t.options.columns[o]&&"hidden"==t.options.columns[o].type&&s++,l.push(o),o++;const i=document.createElement("td");i.setAttribute("data-column",l.join(",")),i.setAttribute("colspan",e[r].colspan),i.setAttribute("align",e[r].align||"center"),i.setAttribute("id",e[r].id),i.textContent=e[r].title,n.appendChild(i)}return n},getWorksheetActive=function(){const e=this.parent?this.parent:this;return e.element.tabs?e.element.tabs.getActive():0},getWorksheetInstance=function(e){const t=void 0!==e?e:getWorksheetActive.call(this);return this.worksheets[t]}},323:function(e,t,n){n.d(t,{Ar:function(){return l},Wc:function(){return o},qP:function(){return s}});var r=n(650);const o=function(e,t,n){if(t<=e.length)return e.slice(0,t).concat(n).concat(e.slice(t));const r=e.slice(0,e.length);for(;t>r.length;)r.push(void 0);return r.concat(n)},s=function(e,t){const n=/^[a-zA-Z]+/.exec(e);if(n){let r=0;for(let e=0;e<n[0].length;e++)r+=parseInt(n[0].charCodeAt(e)-64)*Math.pow(26,n[0].length-1-e);r--,r<0&&(r=0);let o=parseInt(/[0-9]+$/.exec(e));o>0&&o--,e=1==t?[r,o]:r+"-"+o}return e},l=function(e){return Array.isArray(e)||(e=e.split("-")),(0,r.getColumnName)(parseInt(e[0]))+(parseInt(e[1])+1)}},665:function(e,t,n){n.d(t,{Kw:function(){return s},VG:function(){return l},ij:function(){return r},iw:function(){return o}});const r=function(e){const t=this;let n;n=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results;const r=100;null!=e&&-1!=e||(e=Math.ceil(n.length/r)-1);let o=e*r,s=e*r+r;s>n.length&&(s=n.length),o=s-100,o<0&&(o=0);for(let e=o;e<s;e++)1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(t.rows[e].element):t.tbody.appendChild(t.rows[n[e]].element),t.tbody.children.length>r&&t.tbody.removeChild(t.tbody.firstChild)},o=function(){const e=this;if(e.selectedCell){const t=parseInt(e.tbody.firstChild.getAttribute("data-y"))/100,n=parseInt(e.selectedCell[3]/100),r=parseInt(e.rows.length/100);if(t!=n&&n<=r&&!Array.prototype.indexOf.call(e.tbody.children,e.rows[e.selectedCell[3]].element))return e.loadPage(n),!0}return!1},s=function(){const e=this;let t;t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows:e.results;let n=0;if(t.length>100){let r=parseInt(e.tbody.firstChild.getAttribute("data-y"));if(1!=e.options.search&&1!=e.options.filters||!e.results||(r=t.indexOf(r)),r>0)for(let o=0;o<30;o++)r-=1,r>-1&&(1!=e.options.search&&1!=e.options.filters||!e.results?e.tbody.insertBefore(e.rows[r].element,e.tbody.firstChild):e.tbody.insertBefore(e.rows[t[r]].element,e.tbody.firstChild),e.tbody.children.length>100&&(e.tbody.removeChild(e.tbody.lastChild),n=1))}return n},l=function(){const e=this;let t;t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows:e.results;let n=0;if(t.length>100){let r=parseInt(e.tbody.lastChild.getAttribute("data-y"));if(1!=e.options.search&&1!=e.options.filters||!e.results||(r=t.indexOf(r)),r<e.rows.length-1)for(let o=0;o<=30;o++)r<t.length&&(1!=e.options.search&&1!=e.options.filters||!e.results?e.tbody.appendChild(e.rows[r].element):e.tbody.appendChild(e.rows[t[r]].element),e.tbody.children.length>100&&(e.tbody.removeChild(e.tbody.firstChild),n=1)),r+=1}return n}},49:function(e,t,n){n.d(t,{D0:function(){return a},D8:function(){return u},Vg:function(){return d},mt:function(){return f},q4:function(){return c},tW:function(){return p}});var r=n(323),o=n(992),s=n(923),l=n(100),i=n(366);const a=function(e,t){const n=this,o=[];if(n.options.mergeCells){const s=Object.keys(n.options.mergeCells);for(let l=0;l<s.length;l++){const i=(0,r.qP)(s[l],!0),a=n.options.mergeCells[s[l]][0],c=i[0],u=i[0]+(a>1?a-1:0);null==t?c<=e&&u>=e&&o.push(s[l]):t?c<e&&u>=e&&o.push(s[l]):c<=e&&u>e&&o.push(s[l])}}return o},c=function(e,t){const n=this,o=[];if(n.options.mergeCells){const s=Object.keys(n.options.mergeCells);for(let l=0;l<s.length;l++){const i=(0,r.qP)(s[l],!0),a=n.options.mergeCells[s[l]][1],c=i[1],u=i[1]+(a>1?a-1:0);null==t?c<=e&&u>=e&&o.push(s[l]):t?c<e&&u>=e&&o.push(s[l]):c<=e&&u>e&&o.push(s[l])}}return o},u=function(e){const t=this;let n={};if(e)n=t.options.mergeCells&&t.options.mergeCells[e]?[t.options.mergeCells[e][0],t.options.mergeCells[e][1]]:null;else if(t.options.mergeCells){t.options.mergeCells;const e=Object.keys(t.options.mergeCells);for(let r=0;r<e.length;r++)n[e[r]]=[t.options.mergeCells[e[r]][0],t.options.mergeCells[e[r]][1]]}return n},f=function(e,t,n,a){const c=this;let u=!1;if(e){if("string"!=typeof e)return null}else{if(!c.highlighted.length)return null;{const o=parseInt(c.highlighted[0].getAttribute("data-x")),s=parseInt(c.highlighted[0].getAttribute("data-y")),l=parseInt(c.highlighted[c.highlighted.length-1].getAttribute("data-x")),i=parseInt(c.highlighted[c.highlighted.length-1].getAttribute("data-y"));e=(0,r.Ar)([o,s]),t=l-o+1,n=i-s+1}}const f=(0,r.qP)(e,!0);if(c.options.mergeCells&&c.options.mergeCells[e])c.records[f[1]][f[0]].element.getAttribute("data-merged")&&(u="Cell already merged");else if((!t||t<2)&&(!n||n<2))u="Invalid merged properties";else for(let e=f[1];e<f[1]+n;e++)for(let n=f[0];n<f[0]+t;n++)(0,r.Ar)([n,e]),c.records[e][n].element.getAttribute("data-merged")&&(u="There is a conflict with another merged cell");if(u);else{t>1?c.records[f[1]][f[0]].element.setAttribute("colspan",t):t=1,n>1?c.records[f[1]][f[0]].element.setAttribute("rowspan",n):n=1,c.options.mergeCells||(c.options.mergeCells={}),c.options.mergeCells[e]=[t,n,[]],c.records[f[1]][f[0]].element.setAttribute("data-merged","true"),c.records[f[1]][f[0]].element.style.overflow="hidden";const r=[];for(let s=f[1];s<f[1]+n;s++)for(let n=f[0];n<f[0]+t;n++)f[0]==n&&f[1]==s||(r.push(c.options.data[s][n]),o.wW.call(c,n,s,"",!0),c.options.mergeCells[e][2].push(c.records[s][n].element),c.records[s][n].element.style.display="none",c.records[s][n].element=c.records[f[1]][f[0]].element);i.e3.call(c,c.records[f[1]][f[0]].element),a||(s.JB.call(c,{action:"setMerge",column:e,colspan:t,rowspan:n,data:r}),l.Z.call(c,"onmerge",c,{[e]:[t,n]}))}},d=function(e,t,n){const s=this;if(s.options.mergeCells&&s.options.mergeCells[e]){const l=(0,r.qP)(e,!0);s.records[l[1]][l[0]].element.removeAttribute("colspan"),s.records[l[1]][l[0]].element.removeAttribute("rowspan"),s.records[l[1]][l[0]].element.removeAttribute("data-merged");const a=s.options.mergeCells[e];let c,u,f=0;for(c=0;c<a[1];c++)for(u=0;u<a[0];u++)(c>0||u>0)&&(s.records[l[1]+c][l[0]+u].element=a[2][f],s.records[l[1]+c][l[0]+u].element.style.display="",t&&t[f]&&o.wW.call(s,l[0]+u,l[1]+c,t[f]),f++);i.e3.call(s,s.records[l[1]][l[0]].element,s.records[l[1]+c-1][l[0]+u-1].element),n||delete s.options.mergeCells[e]}},p=function(e){const t=this;if(t.options.mergeCells){t.options.mergeCells;const n=Object.keys(t.options.mergeCells);for(let r=0;r<n.length;r++)d.call(t,n[r],null,e)}}},272:function(e,t,n){n.d(t,{Lx:function(){return s},US:function(){return l},xZ:function(){return o}});var r=n(100);const o=function(e,t){const n=this;return e?t?n.options.meta&&n.options.meta[e]&&n.options.meta[e][t]?n.options.meta[e][t]:null:n.options.meta&&n.options.meta[e]?n.options.meta[e]:null:n.options.meta},s=function(e){const t=this;if(t.options.meta){const n={},r=Object.keys(t.options.meta);for(let o=0;o<r.length;o++)e[r[o]]?n[e[r[o]]]=t.options.meta[r[o]]:n[r[o]]=t.options.meta[r[o]];t.options.meta=n}},l=function(e,t,n){const o=this;if(o.options.meta||(o.options.meta={}),t&&n)o.options.meta[e]||(o.options.meta[e]={}),o.options.meta[e][t]=n,r.Z.call(o,"onchangemeta",o,{[e]:{[t]:n}});else{const t=Object.keys(e);for(let n=0;n<t.length;n++){o.options.meta[t[n]]||(o.options.meta[t[n]]={});const r=Object.keys(e[t[n]]);for(let s=0;s<r.length;s++)o.options.meta[t[n]][r[s]]=e[t[n]][r[s]]}r.Z.call(o,"onchangemeta",o,e)}}},54:function(e,t,n){n.d(t,{Cs:function(){return c},SV:function(){return a},Xo:function(){return u}});var r=n(923),o=n(100),s=n(992),l=n(665),i=n(456);const a=function(e,t){const n=this;for(let e=0;e<n.headers.length;e++)n.headers[e].classList.remove("arrow-up"),n.headers[e].classList.remove("arrow-down");t?n.headers[e].classList.add("arrow-up"):n.headers[e].classList.add("arrow-down")},c=function(e){const t=this;let n=[];for(let r=0;r<e.length;r++)n[r]=t.options.data[e[r]];t.options.data=n,n=[];for(let r=0;r<e.length;r++){n[r]=t.records[e[r]];for(let e=0;e<n[r].length;e++)n[r][e].y=r}t.records=n,n=[];for(let r=0;r<e.length;r++)n[r]=t.rows[e[r]],n[r].y=r;if(t.rows=n,s.ec.call(t),t.results&&t.results.length)t.searchInput.value?t.search(t.searchInput.value):i.ql.call(t);else if(t.results=null,t.pageNumber=0,t.options.pagination>0)t.page(0);else if(1==t.options.lazyLoading)l.ij.call(t,0);else for(let e=0;e<t.rows.length;e++)t.tbody.appendChild(t.rows[e].element)},u=function(e,t){const n=this;if(e>=0){if(n.options.mergeCells&&Object.keys(n.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;n.destroyMerge()}t=null==t?n.headers[e].classList.contains("arrow-down")?1:0:t?1:0;let s=[];if(n.options.columns&&n.options.columns[e]&&("number"==n.options.columns[e].type||"numeric"==n.options.columns[e].type||"percentage"==n.options.columns[e].type||"autonumber"==n.options.columns[e].type||"color"==n.options.columns[e].type))for(let t=0;t<n.options.data.length;t++)s[t]=[t,Number(n.options.data[t][e])];else if(n.options.columns&&n.options.columns[e]&&("calendar"==n.options.columns[e].type||"checkbox"==n.options.columns[e].type||"radio"==n.options.columns[e].type))for(let t=0;t<n.options.data.length;t++)s[t]=[t,n.options.data[t][e]];else for(let t=0;t<n.options.data.length;t++)s[t]=[t,n.records[t][e].element.textContent.toLowerCase()];"function"!=typeof n.parent.config.sorting&&(n.parent.config.sorting=function(e){return function(t,n){const r=t[1],o=n[1];return e?""===r&&""!==o?1:""!==r&&""===o||r>o?-1:r<o?1:0:""===r&&""!==o?1:""!==r&&""===o?-1:r>o?1:r<o?-1:0}}),s=s.sort(n.parent.config.sorting(t));const l=[];for(let e=0;e<s.length;e++)l[e]=s[e][0];return r.JB.call(n,{action:"orderBy",rows:l,column:e,order:t}),a.call(n,e,t),c.call(n,l),o.Z.call(n,"onsort",n,e,t,l.map((e=>e))),!0}}},673:function(e,t,n){n.d(t,{Ik:function(){return l},Md:function(){return i},an:function(){return s},ur:function(){return a}});var r=n(100),o=n(366);const s=function(e){const t=this;return 1!=t.options.search&&1!=t.options.filters||!t.results||(e=t.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(t.options.pagination))-1},l=function(){const e=this;if(e.pagination.children[0].innerHTML="",e.pagination.children[1].innerHTML="",e.options.pagination){let t;if(t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length,t){const n=Math.ceil(t/e.options.pagination);let r,o;if(e.pageNumber<6?(r=1,o=n<10?n:10):n-e.pageNumber<5?(r=n-9,o=n,r<1&&(r=1)):(r=e.pageNumber-4,o=e.pageNumber+5),r>1){const t=document.createElement("div");t.className="jss_page",t.innerHTML="<",t.title=1,e.pagination.children[1].appendChild(t)}for(let t=r;t<=o;t++){const n=document.createElement("div");n.className="jss_page",n.innerHTML=t,e.pagination.children[1].appendChild(n),e.pageNumber==t-1&&n.classList.add("jss_page_selected")}if(o<n){const t=document.createElement("div");t.className="jss_page",t.innerHTML=">",t.title=n,e.pagination.children[1].appendChild(t)}const s=function(e){const t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))};e.pagination.children[0].innerHTML=s(jSuites.translate("Showing page {0} of {1} entries"),e.pageNumber+1,n)}else e.pagination.children[0].innerHTML=jSuites.translate("No records found")}},i=function(e){const t=this,n=t.pageNumber;let s;s=1!=t.options.search&&1!=t.options.filters||!t.results?t.rows:t.results;const i=parseInt(t.options.pagination);null!=e&&-1!=e||(e=Math.ceil(s.length/i)-1),t.pageNumber=e;let a=e*i,c=e*i+i;for(c>s.length&&(c=s.length),a<0&&(a=0);t.tbody.firstChild;)t.tbody.removeChild(t.tbody.firstChild);for(let e=a;e<c;e++)1!=t.options.search&&1!=t.options.filters||!t.results?t.tbody.appendChild(t.rows[e].element):t.tbody.appendChild(t.rows[s[e]].element);t.options.pagination>0&&l.call(t),o.x8.call(t),r.Z.call(t,"onchangepage",t,e,n,t.options.pagination)},a=function(){const e=this;let t;return t=1!=e.options.search&&1!=e.options.filters||!e.results?e.rows.length:e.results.length,Math.ceil(t/e.options.pagination)}},366:function(e,t,n){n.d(t,{E:function(){return m},Es:function(){return h},F1:function(){return b},H7:function(){return g},Mf:function(){return j},Mt:function(){return y},Uv:function(){return E},VD:function(){return x},VL:function(){return I},Ym:function(){return v},e3:function(){return d},ey:function(){return M},rx:function(){return _},td:function(){return A},vn:function(){return p},vp:function(){return w},x8:function(){return u},yE:function(){return f}});var r=n(100),o=n(157),s=n(650),l=n(923),i=n(992),a=n(323),c=n(898);const u=function(){const e=this;if(e.highlighted&&e.highlighted.length){const t=e.highlighted[e.highlighted.length-1].element,n=t.getAttribute("data-x"),r=e.content.getBoundingClientRect(),s=r.left,l=r.top,i=t.getBoundingClientRect(),a=i.left,c=i.top,u=i.width,f=i.height,d=a-s+e.content.scrollLeft+u-4,p=c-l+e.content.scrollTop+f-4;if(e.corner.style.top=p+"px",e.corner.style.left=d+"px",e.options.freezeColumns){const t=o.I.call(e);n>e.options.freezeColumns-1&&a-s+u<t?e.corner.style.display="none":0!=e.options.selectionCopy&&(e.corner.style.display="")}else 0!=e.options.selectionCopy&&(e.corner.style.display="")}else e.corner.style.top="-2000px",e.corner.style.left="-2000px";(0,c.yf)(e)},f=function(e){const t=this;let n;if(t.highlighted&&t.highlighted.length){n=1;for(let e=0;e<t.highlighted.length;e++){t.highlighted[e].element.classList.remove("highlight"),t.highlighted[e].element.classList.remove("highlight-left"),t.highlighted[e].element.classList.remove("highlight-right"),t.highlighted[e].element.classList.remove("highlight-top"),t.highlighted[e].element.classList.remove("highlight-bottom"),t.highlighted[e].element.classList.remove("highlight-selected");const n=parseInt(t.highlighted[e].element.getAttribute("data-x")),r=parseInt(t.highlighted[e].element.getAttribute("data-y"));let o,s;if(t.highlighted[e].element.getAttribute("data-merged")){const l=parseInt(t.highlighted[e].element.getAttribute("colspan")),i=parseInt(t.highlighted[e].element.getAttribute("rowspan"));o=l>0?n+(l-1):n,s=i>0?r+(i-1):r}else o=n,s=r;for(let e=n;e<=o;e++)t.headers[e]&&t.headers[e].classList.remove("selected");for(let e=r;e<=s;e++)t.rows[e]&&t.rows[e].element.classList.remove("selected")}}else n=0;return t.highlighted=[],t.selectedCell=null,t.corner.style.top="-2000px",t.corner.style.left="-2000px",1==e&&1==n&&r.Z.call(t,"onblur",t),n},d=function(e,t,n){const r=e.getAttribute("data-x"),o=e.getAttribute("data-y");let s,l;t?(s=t.getAttribute("data-x"),l=t.getAttribute("data-y")):(s=r,l=o),h.call(this,r,o,s,l,n)},p=function(){const e=document.querySelectorAll(".jss_worksheet .copying");for(let t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},h=function(e,t,n,o,s){const l=this;if(null==t){if(t=0,o=l.rows.length-1,null==e)return}else null==e&&(e=0,n=l.options.data[0].length-1);null==n&&(n=e),null==o&&(o=t),e>=l.headers.length&&(e=l.headers.length-1),t>=l.rows.length&&(t=l.rows.length-1),n>=l.headers.length&&(n=l.headers.length-1),o>=l.rows.length&&(o=l.rows.length-1);let i,a,c,f,d=null,h=null,g=null,m=null;parseInt(e)<parseInt(n)?(i=parseInt(e),a=parseInt(n)):(i=parseInt(n),a=parseInt(e)),parseInt(t)<parseInt(o)?(c=parseInt(t),f=parseInt(o)):(c=parseInt(o),f=parseInt(t));for(let e=i;e<=a;e++)for(let t=c;t<=f;t++)if(l.records[t][e]&&l.records[t][e].element.getAttribute("data-merged")){const n=parseInt(l.records[t][e].element.getAttribute("data-x")),r=parseInt(l.records[t][e].element.getAttribute("data-y")),o=parseInt(l.records[t][e].element.getAttribute("colspan")),s=parseInt(l.records[t][e].element.getAttribute("rowspan"));o>1&&(n<i&&(i=n),n+o>a&&(a=n+o-1)),s&&(r<c&&(c=r),r+s>f&&(f=r+s-1))}for(let e=c;e<=f;e++)"none"!=l.rows[e].element.style.display&&(null==g&&(g=e),m=e);for(let e=i;e<=a;e++)for(let t=c;t<=f;t++)l.options.columns&&l.options.columns[e]&&"hidden"==l.options.columns[e].type||(null==d&&(d=e),h=e);if(d||(d=0),h||(h=0),!1===r.Z.call(l,"onbeforeselection",l,d,g,h,m,s))return!1;const y=l.resetSelection();l.selectedCell=[e,t,n,o],l.records[t][e]&&l.records[t][e].element.classList.add("highlight-selected");for(let e=i;e<=a;e++)for(let t=c;t<=f;t++)"none"!=l.rows[t].element.style.display&&"none"!=l.records[t][e].element.style.display&&(l.records[t][e].element.classList.add("highlight"),l.highlighted.push(l.records[t][e]));for(let e=d;e<=h;e++)l.options.columns&&l.options.columns[e]&&"hidden"==l.options.columns[e].type||!l.cols[e].colElement.style||"none"==l.cols[e].colElement.style.display||(l.records[g]&&l.records[g][e]&&l.records[g][e].element.classList.add("highlight-top"),l.records[m]&&l.records[m][e]&&l.records[m][e].element.classList.add("highlight-bottom"),l.headers[e].classList.add("selected"));for(let e=g;e<=m;e++)l.rows[e]&&"none"!=l.rows[e].element.style.display&&(l.records[e][d].element.classList.add("highlight-left"),l.records[e][h].element.classList.add("highlight-right"),l.rows[e].element.classList.add("selected"));l.selectedContainer=[d,g,h,m],0==y&&(r.Z.call(l,"onfocus",l),p()),r.Z.call(l,"onselection",l,d,g,h,m,s),u.call(l)},g=function(e){const t=this;if(!t.selectedCell)return[];const n=[];for(let r=Math.min(t.selectedCell[0],t.selectedCell[2]);r<=Math.max(t.selectedCell[0],t.selectedCell[2]);r++)e&&"none"==t.headers[r].style.display||n.push(r);return n},m=function(){const e=this;e.selectedCell&&e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},y=function(){const e=this;for(let t=0;t<e.selection.length;t++)e.selection[t].classList.remove("selection"),e.selection[t].classList.remove("selection-left"),e.selection[t].classList.remove("selection-right"),e.selection[t].classList.remove("selection-top"),e.selection[t].classList.remove("selection-bottom");e.selection=[]},C=function(e){return 1==(e=""+e).length&&(e="0"+e),e},b=function(e,t){const n=this,o=n.getData(!0,!0),s=n.selectedContainer,c=parseInt(e.getAttribute("data-x")),u=parseInt(e.getAttribute("data-y")),f=parseInt(t.getAttribute("data-x")),d=parseInt(t.getAttribute("data-y")),p=[];let h,g,m=!1;s[0]==c?(h=u<s[1]?u-s[1]:1,g=0):(g=c<s[0]?c-s[0]:1,h=0);let y=0,b=0;for(let e=u;e<=d;e++)if(!n.rows[e]||"none"!=n.rows[e].element.style.display){null==o[b]&&(b=0),y=0,s[0]!=c&&(g=c<s[0]?c-s[0]:1);for(let t=c;t<=f;t++){if(n.records[e][t]&&!n.records[e][t].element.classList.contains("readonly")&&"none"!=n.records[e][t].element.style.display&&0==m){if(!n.selection.length&&""!=n.options.data[e][t]){m=!0;continue}(null==o[b]||null==o[b][y])&&(y=0);let r=o[b][y];if(r&&!o[1]&&0!=n.parent.config.autoIncrement)if(!n.options.columns||!n.options.columns[t]||n.options.columns[t].type&&"text"!=n.options.columns[t].type&&"number"!=n.options.columns[t].type){if(n.options.columns&&n.options.columns[t]&&"calendar"==n.options.columns[t].type){const e=new Date(r);e.setDate(e.getDate()+h),r=e.getFullYear()+"-"+C(parseInt(e.getMonth()+1))+"-"+C(e.getDate())+" 00:00:00"}}else if("="==(""+r).substr(0,1)){const e=r.match(/([A-Z]+[0-9]+)/g);if(e){const t=[];for(let n=0;n<e.length;n++){const r=(0,a.qP)(e[n],1);r[0]+=g,r[1]+=h,r[1]<0&&(r[1]=0);const o=(0,a.Ar)([r[0],r[1]]);o!=e[n]&&(t[e[n]]=o)}t&&(r=(0,i.E2)(r,t))}}else r==Number(r)&&(r=Number(r)+h);p.push(i.wW.call(n,t,e,r)),i.Zz.call(n,t,e,p)}y++,s[0]!=c&&g++}b++,h++}l.JB.call(n,{action:"setValue",records:p,selection:n.selectedCell}),i.T0.call(n);const w=p.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));r.Z.call(n,"onafterchanges",n,w)},w=function(e){let t,n,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)n=e.charCodeAt(t),r=(r<<5)-r+n,r|=0;return r},E=function(e,t,n){const r=this;if(1==e){if(r.selectedCell&&(t>=r.selectedCell[1]&&t<=r.selectedCell[3]||n>=r.selectedCell[1]&&n<=r.selectedCell[3]))return void r.resetSelection()}else if(r.selectedCell&&(t>=r.selectedCell[0]&&t<=r.selectedCell[2]||n>=r.selectedCell[0]&&n<=r.selectedCell[2]))return void r.resetSelection()},v=function(e){const t=this;if(!t.selectedCell)return[];const n=[];for(let r=Math.min(t.selectedCell[1],t.selectedCell[3]);r<=Math.max(t.selectedCell[1],t.selectedCell[3]);r++)e&&"none"==t.rows[r].element.style.display||n.push(r);return n},A=function(){const e=this;e.selectedCell||(e.selectedCell=[]),e.selectedCell[0]=0,e.selectedCell[1]=0,e.selectedCell[2]=e.headers.length-1,e.selectedCell[3]=e.records.length-1,e.updateSelectionFromCoords(e.selectedCell[0],e.selectedCell[1],e.selectedCell[2],e.selectedCell[3])},j=function(){const e=this;return e.selectedCell?[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])]:null},M=function(e){const t=this,n=j.call(t);if(!n)return[];const r=[];for(let o=n[1];o<=n[3];o++)for(let l=n[0];l<=n[2];l++)e?r.push((0,s.getCellNameFromCoords)(l,o)):r.push(t.records[o][l]);return r},_=function(){const e=this,t=j.call(e);if(!t)return"";const n=(0,s.getCellNameFromCoords)(t[0],t[1]),r=(0,s.getCellNameFromCoords)(t[2],t[3]);return n===r?e.options.worksheetName+"!"+n:e.options.worksheetName+"!"+n+":"+r},I=function(e,t){const n=j.call(this);return e>=n[0]&&e<=n[2]&&t>=n[1]&&t<=n[3]},x=function(){const e=j.call(this);return e?[e]:[]}},898:function(e,t,n){n.d(t,{bv:function(){return u},iu:function(){return f},yf:function(){return c}});var r=n(650),o=n(992);const s=function(e,t){0!=t.options.editable?e.classList.remove("jtoolbar-disabled"):e.classList.add("jtoolbar-disabled")},l=function(){const e=[],t=this,n=function(){return o.Hf.call(t)};e.push({content:"undo",onclick:function(){n().undo()}}),e.push({content:"redo",onclick:function(){n().redo()}}),e.push({content:"save",onclick:function(){const e=n();e&&e.download()}}),e.push({type:"divisor"}),e.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,r,o,s){const l=n();let i=l.getSelected(!0);if(i){let e=s?o:"";l.setStyle(Object.fromEntries(i.map((function(t){return[t,"font-family: "+e]}))))}},updateState:function(e,t,r){s(r,n())}}),e.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,r,o){const s=n();let l=s.getSelected(!0);l&&s.setStyle(Object.fromEntries(l.map((function(e){return[e,"font-size: "+o]}))))},updateState:function(e,t,r){s(r,n())}}),e.push({type:"select",options:["left","center","right","justify"],render:function(e){return'<i class="material-icons">format_align_'+e+"</i>"},onchange:function(e,t,r,o){const s=n();let l=s.getSelected(!0);l&&s.setStyle(Object.fromEntries(l.map((function(e){return[e,"text-align: "+o]}))))},updateState:function(e,t,r){s(r,n())}}),e.push({content:"format_bold",onclick:function(e,t,r){const o=n();let s=o.getSelected(!0);s&&o.setStyle(Object.fromEntries(s.map((function(e){return[e,"font-weight:bold"]}))))},updateState:function(e,t,r){s(r,n())}}),e.push({type:"color",content:"format_color_text",k:"color",updateState:function(e,t,r){s(r,n())}}),e.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(e,t,r,o){s(r,n())}});let l=["top","middle","bottom"];return e.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(e){return'<i class="material-icons">'+e+"</i>"},value:1,onchange:function(e,t,r,o,s){const i=n();let a=i.getSelected(!0);a&&i.setStyle(Object.fromEntries(a.map((function(e){return[e,"vertical-align: "+l[s]]}))))},updateState:function(e,t,r){s(r,n())}}),e.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const e=n();if(e.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const t=[Math.min(e.selectedCell[0],e.selectedCell[2]),Math.min(e.selectedCell[1],e.selectedCell[3]),Math.max(e.selectedCell[0],e.selectedCell[2]),Math.max(e.selectedCell[1],e.selectedCell[3])];let n=(0,r.getCellNameFromCoords)(t[0],t[1]);if(e.records[t[1]][t[0]].element.getAttribute("data-merged"))e.removeMerge(n);else{let r=t[2]-t[0]+1,o=t[3]-t[1]+1;1===r&&1===o||e.setMerge(n,r,o)}}},updateState:function(e,t,r){s(r,n())}}),e.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(e){return'<i class="material-icons">'+e+"</i>"},right:!0,onchange:function(e,t,o,s){const l=n(),i=[Math.min(l.selectedCell[0],l.selectedCell[2]),Math.min(l.selectedCell[1],l.selectedCell[3]),Math.max(l.selectedCell[0],l.selectedCell[2]),Math.max(l.selectedCell[1],l.selectedCell[3])];let a=s;if(i){let e=t.thickness||1,n=t.color||"black";const o=t.style||"solid";"double"===o&&(e+=2);let s={},c=i[0],u=i[1],f=i[2],d=i[3];const p=function(t,r,l){let i=["","","",""];i[0]=("border_top"===a||"border_outer"===a)&&l===u||("border_inner"===a||"border_horizontal"===a)&&l>u||"border_all"===a?"border-top: "+e+"px "+o+" "+n:"border-top: ",i[1]="border_all"!==a&&"border_right"!==a&&"border_outer"!==a||r!==f?"border-right: ":"border-right: "+e+"px "+o+" "+n,i[2]="border_all"!==a&&"border_bottom"!==a&&"border_outer"!==a||l!==d?"border-bottom: ":"border-bottom: "+e+"px "+o+" "+n,i[3]=("border_left"===a||"border_outer"===a)&&r===c||("border_inner"===a||"border_vertical"===a)&&r>c||"border_all"===a?"border-left: "+e+"px "+o+" "+n:"border-left: ",s[t]=i.join(";")};for(let e=i[1];e<=i[3];e++)for(let t=i[0];t<=i[2];t++)p((0,r.getCellNameFromCoords)(t,e),t,e),l.records[e][t].element.getAttribute("data-merged")&&p((0,r.getCellNameFromCoords)(i[0],i[1]),t,e);Object.keys(s)&&l.setStyle(s)}},onload:function(e,t){let n=document.createElement("div"),r=document.createElement("div");n.appendChild(r);let o=jSuites.color(r,{closeOnChange:!1,onchange:function(e,n){e.parentNode.children[1].style.color=n,t.color=n}}),s=document.createElement("i");s.classList.add("material-icons"),s.innerHTML="color_lens",s.onclick=function(){o.open()},n.appendChild(s),e.children[1].appendChild(n),r=document.createElement("div"),jSuites.picker(r,{type:"select",data:[1,2,3,4,5],render:function(e){return'<div style="height: '+e+'px; width: 30px; background-color: black;"></div>'},onchange:function(e,n,r,o){t.thickness=o},width:"50px"}),e.children[1].appendChild(r);const l=document.createElement("div");jSuites.picker(l,{type:"select",data:["solid","dotted","dashed","double"],render:function(e){return"double"===e?'<div style="width: 30px; border-top: 3px '+e+' black;"></div>':'<div style="width: 30px; border-top: 2px '+e+' black;"></div>'},onchange:function(e,n,r,o){t.style=o},width:"50px"}),e.children[1].appendChild(l),r=document.createElement("div"),r.style.flex="1",e.children[1].appendChild(r)},updateState:function(e,t,r){s(r,n())}}),e.push({type:"divisor"}),e.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(e,n,r){"fullscreen"===r.children[0].textContent?(t.fullscreen(!0),r.children[0].textContent="fullscreen_exit"):(t.fullscreen(!1),r.children[0].textContent="fullscreen")},updateState:function(e,t,n,r){!0===r.parent.config.fullscreen?n.children[0].textContent="fullscreen_exit":n.children[0].textContent="fullscreen"}}),e},i=function(e){const t=this,n=e.items;for(let e=0;e<n.length;e++)n[e].tooltip&&(n[e].title=n[e].tooltip,delete n[e].tooltip),"select"==n[e].type?n[e].options?(n[e].data=n[e].options,delete n[e].options):(n[e].data=n[e].v,delete n[e].v,n[e].k&&!n[e].onchange&&(n[e].onchange=function(r,s,l){const i=o.Hf.call(t),a=i.getSelected(!0);i.setStyle(Object.fromEntries(a.map((function(t){return[t,n[e].k+": "+l]}))))})):"color"==n[e].type&&(n[e].type="i",n[e].onclick=function(r,s,l){l.color||(jSuites.color(l,{onchange:function(r,s){const l=o.Hf.call(t),i=l.getSelected(!0);l.setStyle(Object.fromEntries(i.map((function(t){return[t,n[e].k+": "+s]}))))},onopen:function(e){e.color.select("")}}),l.color.open())})},a=function(e){const t=this,n=document.createElement("div");return n.classList.add("jss_toolbar"),i.call(t,e),"object"==typeof t.plugins&&Object.entries(t.plugins).forEach((function([,t]){if("function"==typeof t.toolbar){const n=t.toolbar(e);n&&(e=n)}})),jSuites.toolbar(n,e),n},c=function(e){e.parent.toolbar&&e.parent.toolbar.toolbar.update(e)},u=function(){const e=this;if(e.config.toolbar&&!e.toolbar){let t;Array.isArray(e.config.toolbar)?t={items:e.config.toolbar}:"object"==typeof e.config.toolbar?t=e.config.toolbar:(t={items:l.call(e)},"function"==typeof e.config.toolbar&&(t=e.config.toolbar(t))),e.toolbar=e.element.insertBefore(a.call(e,t),e.element.children[1])}},f=function(){const e=this;e.toolbar&&(e.toolbar.parentNode.removeChild(e.toolbar),delete e.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){__webpack_require__.d(__webpack_exports__,{default:function(){return ve}});var e={jspreadsheet:{}},t=__webpack_require__(100),n=__webpack_require__(992),r=__webpack_require__(923);const o=function(e,r,o){const l=this,i=e.getAttribute("data-y"),a=e.getAttribute("data-x");t.Z.call(l,"oneditionstart",l,e,parseInt(a),parseInt(i)),a>0&&(l.records[i][a-1].element.style.overflow="hidden");const c=function(t){const n=e.getBoundingClientRect(),r=document.createElement(t);return r.style.width=n.width+"px",r.style.height=n.height-2+"px",r.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(r),r};if(1==e.classList.contains("readonly"));else if(l.edition=[l.records[i][a].element,l.records[i][a].element.innerHTML,a,i],l.options.columns&&l.options.columns[a]&&"object"==typeof l.options.columns[a].type)l.options.columns[a].type.openEditor(e,l.options.data[i][a],parseInt(a),parseInt(i),l,l.options.columns[a],o),t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]);else if(l.options.columns&&l.options.columns[a]&&"hidden"==l.options.columns[a].type);else if(l.options.columns&&l.options.columns[a]&&("checkbox"==l.options.columns[a].type||"radio"==l.options.columns[a].type)){const t=!e.children[0].checked;l.setValue(e,t),l.edition=null}else if(l.options.columns&&l.options.columns[a]&&"dropdown"==l.options.columns[a].type){let n,r=l.options.data[i][a];l.options.columns[a].multiple&&!Array.isArray(r)&&(r=r.split(";")),n="function"==typeof l.options.columns[a].filter?l.options.columns[a].filter(l.element,e,a,i,l.options.columns[a].source):l.options.columns[a].source;const o=[];if(n)for(let e=0;e<n.length;e++)o.push(n[e]);const u=c("div");t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]);const f={data:o,multiple:!!l.options.columns[a].multiple,autocomplete:!!l.options.columns[a].autocomplete,opened:!0,value:r,width:"100%",height:u.style.minHeight,position:1==l.options.tableOverflow||1==l.parent.config.fullscreen,onclose:function(){s.call(l,e,!0)}};l.options.columns[a].options&&l.options.columns[a].options.type&&(f.type=l.options.columns[a].options.type),jSuites.dropdown(u,f)}else if(l.options.columns&&l.options.columns[a]&&("calendar"==l.options.columns[a].type||"color"==l.options.columns[a].type)){const n=l.options.data[i][a],r=c("input");t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]),r.value=n;const o=l.options.columns[a].options?{...l.options.columns[a].options}:{};1!=l.options.tableOverflow&&1!=l.parent.config.fullscreen||(o.position=!0),o.value=l.options.data[i][a],o.opened=!0,o.onclose=function(t,n){s.call(l,e,!0)},"color"==l.options.columns[a].type?jSuites.color(r,o):(o.format||(o.format="YYYY-MM-DD"),jSuites.calendar(r,o)),r.focus()}else if(l.options.columns&&l.options.columns[a]&&"html"==l.options.columns[a].type){const n=l.options.data[i][a],r=c("div");t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]),r.style.position="relative";const o=document.createElement("div");o.classList.add("jss_richtext"),r.appendChild(o),jSuites.editor(o,{focus:!0,value:n});const s=e.getBoundingClientRect(),u=o.getBoundingClientRect();window.innerHeight<s.bottom+u.height?o.style.top=s.top-(u.height+2)+"px":o.style.top=s.top+"px"}else if(l.options.columns&&l.options.columns[a]&&"image"==l.options.columns[a].type){const n=e.children[0],r=c("div");t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]),r.style.position="relative";const o=document.createElement("div");o.classList.add("jclose"),n&&n.src&&o.appendChild(n),r.appendChild(o),jSuites.image(o,l.options.columns[a]);const s=e.getBoundingClientRect(),u=o.getBoundingClientRect();window.innerHeight<s.bottom+u.height?o.style.top=s.top-(u.height+2)+"px":o.style.top=s.top+"px"}else{const o=1==r?"":l.options.data[i][a];let u;u=l.options.columns&&l.options.columns[a]&&0==l.options.columns[a].wordWrap||!(1==l.options.wordWrap||l.options.columns&&l.options.columns[a]&&1==l.options.columns[a].wordWrap)?c("input"):c("textarea"),t.Z.call(l,"oncreateeditor",l,e,parseInt(a),parseInt(i),null,l.options.columns[a]),u.focus(),u.value=o;const f=l.options.columns&&l.options.columns[a];if(!(0,n.jr)(o)&&f){const e=(0,n.Vi)(f);if(e){if(!f.disabledMaskOnEdition)if(f.mask){const e=f.mask.split(";");u.setAttribute("data-mask",e[0])}else f.locale&&u.setAttribute("data-locale",f.locale);e.input=u,u.mask=e,jSuites.mask.render(o,e,!1)}}u.onblur=function(){s.call(l,e,!0)},u.scrollLeft=u.scrollWidth}},s=function(e,r){const o=this,s=parseInt(e.getAttribute("data-x")),l=parseInt(e.getAttribute("data-y"));let i;if(1==r){if(o.options.columns&&o.options.columns[s]&&"object"==typeof o.options.columns[s].type)i=o.options.columns[s].type.closeEditor(e,r,parseInt(s),parseInt(l),o,o.options.columns[s]);else if(o.options.columns&&o.options.columns[s]&&("checkbox"==o.options.columns[s].type||"radio"==o.options.columns[s].type||"hidden"==o.options.columns[s].type));else if(o.options.columns&&o.options.columns[s]&&"dropdown"==o.options.columns[s].type)i=e.children[0].dropdown.close(!0);else if(o.options.columns&&o.options.columns[s]&&"calendar"==o.options.columns[s].type)i=e.children[0].calendar.close(!0);else if(o.options.columns&&o.options.columns[s]&&"color"==o.options.columns[s].type)i=e.children[0].color.close(!0);else if(o.options.columns&&o.options.columns[s]&&"html"==o.options.columns[s].type)i=e.children[0].children[0].editor.getData();else if(o.options.columns&&o.options.columns[s]&&"image"==o.options.columns[s].type){const t=e.children[0].children[0].children[0];i=t&&"IMG"==t.tagName?t.src:""}else if(o.options.columns&&o.options.columns[s]&&"numeric"==o.options.columns[s].type)i=e.children[0].value,"="!=(""+i).substr(0,1)&&""==i&&(i=o.options.columns[s].allowEmpty?"":0),e.children[0].onblur=null;else{i=e.children[0].value,e.children[0].onblur=null;const t=o.options.columns&&o.options.columns[s];if(t){const e=(0,n.Vi)(t);if(e&&""!==i&&!(0,n.jr)(i)&&"number"!=typeof i){const t=jSuites.mask.extract(i,e,!0);t&&""!==t.value&&(i=t.value)}}}o.options.data[l][s]==i?e.innerHTML=o.edition[1]:o.setValue(e,i)}else o.options.columns&&o.options.columns[s]&&"object"==typeof o.options.columns[s].type?o.options.columns[s].type.closeEditor(e,r,parseInt(s),parseInt(l),o,o.options.columns[s]):o.options.columns&&o.options.columns[s]&&"dropdown"==o.options.columns[s].type?e.children[0].dropdown.close(!0):o.options.columns&&o.options.columns[s]&&"calendar"==o.options.columns[s].type?e.children[0].calendar.close(!0):o.options.columns&&o.options.columns[s]&&"color"==o.options.columns[s].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=o.edition&&o.edition[1]?o.edition[1]:"";t.Z.call(o,"oneditionend",o,e,s,l,i,r),e.classList.remove("editor"),o.edition=null},l=function(){const e=this,o=[],s=Object.keys(e.highlighted);for(let t=0;t<s.length;t++){const r=e.highlighted[t].element.getAttribute("data-x"),s=e.highlighted[t].element.getAttribute("data-y");"checkbox"!=e.options.columns[r].type&&"radio"!=e.options.columns[r].type||o.push(n.wW.call(e,r,s,!e.options.data[s][r]))}if(o.length){r.JB.call(e,{action:"setValue",records:o,selection:e.selectedCell});const n=o.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(e,"onafterchanges",e,n)}};var i=__webpack_require__(665);const a=function(e,t){const n=this;e=parseInt(e);for(let r=(t=parseInt(t))-1;r>=0;r--)if("none"!=n.records[r][e].element.style.display&&"none"!=n.rows[r].element.style.display){if(n.records[r][e].element.getAttribute("data-merged")&&n.records[r][e].element==n.records[t][e].element)continue;t=r;break}return t},c=function(e,t){const n=this;let r,o;if(0==e?(r=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(r=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=0;e<o;e++)if("none"!=n.records[e][r].element.style.display&&"none"!=n.rows[e].element.style.display){o=e;break}}else o=a.call(n,r,o);0==e?(n.selectedCell[0]=r,n.selectedCell[1]=o):(n.selectedCell[2]=r,n.selectedCell[3]=o)},u=function(e,t){const r=this;if(e?r.selectedCell[3]>0&&c.call(r,1,t?0:1):(r.selectedCell[1]>0&&c.call(r,0,t?0:1),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),1==r.options.lazyLoading)if(0==r.selectedCell[1]||0==r.selectedCell[3])i.ij.call(r,0),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]);else if(i.iw.call(r))r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]);else{const e=parseInt(r.tbody.firstChild.getAttribute("data-y"));r.selectedCell[1]-e<30&&(i.Kw.call(r),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]))}else if(r.options.pagination>0){const e=r.whichPage(r.selectedCell[3]);e!=r.pageNumber&&r.page(e)}n.Of.call(r,1)},f=function(e,t){const n=this;e=parseInt(e),t=parseInt(t);for(let r=e+1;r<n.headers.length;r++)if("none"!=n.records[t][r].element.style.display){if(n.records[t][r].element.getAttribute("data-merged")&&n.records[t][r].element==n.records[t][e].element)continue;e=r;break}return e},d=function(e,t){const n=this;let r,o;if(0==e?(r=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(r=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=n.headers.length-1;e>r;e--)if("none"!=n.records[o][e].element.style.display){r=e;break}}else r=f.call(n,r,o);0==e?(n.selectedCell[0]=r,n.selectedCell[1]=o):(n.selectedCell[2]=r,n.selectedCell[3]=o)},p=function(e,t){const r=this;e?r.selectedCell[2]<r.headers.length-1&&d.call(r,1,t?0:1):(r.selectedCell[0]<r.headers.length-1&&d.call(r,0,t?0:1),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),n.Of.call(r,2)},h=function(e,t){const n=this;e=parseInt(e);for(let r=(t=parseInt(t))+1;r<n.rows.length;r++)if("none"!=n.records[r][e].element.style.display&&"none"!=n.rows[r].element.style.display){if(n.records[r][e].element.getAttribute("data-merged")&&n.records[r][e].element==n.records[t][e].element)continue;t=r;break}return t},g=function(e,t){const n=this;let r,o;if(0==e?(r=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(r=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=n.rows.length-1;e>o;e--)if("none"!=n.records[e][r].element.style.display&&"none"!=n.rows[e].element.style.display){o=e;break}}else o=h.call(n,r,o);0==e?(n.selectedCell[0]=r,n.selectedCell[1]=o):(n.selectedCell[2]=r,n.selectedCell[3]=o)},m=function(e,t){const r=this;if(e?r.selectedCell[3]<r.records.length-1&&g.call(r,1,t?0:1):(r.selectedCell[1]<r.records.length-1&&g.call(r,0,t?0:1),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),1==r.options.lazyLoading)r.selectedCell[1]==r.records.length-1||r.selectedCell[3]==r.records.length-1?(i.ij.call(r,-1),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3])):i.iw.call(r)?r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]):parseInt(r.tbody.lastChild.getAttribute("data-y"))-r.selectedCell[3]<30&&(i.VG.call(r),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]));else if(r.options.pagination>0){const e=r.whichPage(r.selectedCell[3]);e!=r.pageNumber&&r.page(e)}n.Of.call(r,3)},y=function(e,t){const n=this;e=parseInt(e),t=parseInt(t);for(let r=e-1;r>=0;r--)if("none"!=n.records[t][r].element.style.display){if(n.records[t][r].element.getAttribute("data-merged")&&n.records[t][r].element==n.records[t][e].element)continue;e=r;break}return e},C=function(e,t){const n=this;let r,o;if(0==e?(r=parseInt(n.selectedCell[0]),o=parseInt(n.selectedCell[1])):(r=parseInt(n.selectedCell[2]),o=parseInt(n.selectedCell[3])),0==t){for(let e=0;e<r;e++)if("none"!=n.records[o][e].element.style.display){r=e;break}}else r=y.call(n,r,o);0==e?(n.selectedCell[0]=r,n.selectedCell[1]=o):(n.selectedCell[2]=r,n.selectedCell[3]=o)},b=function(e,t){const r=this;e?r.selectedCell[2]>0&&C.call(r,1,t?0:1):(r.selectedCell[0]>0&&C.call(r,0,t?0:1),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),n.Of.call(r,0)},w=function(e,t){const r=this;if(e?t?r.selectedCell[3]=0:C.call(r,1,0):(t?r.selectedCell[1]=0:C.call(r,0,0),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),1!=r.options.lazyLoading||0!=r.selectedCell[1]&&0!=r.selectedCell[3]){if(r.options.pagination>0){const e=r.whichPage(r.selectedCell[3]);e!=r.pageNumber&&r.page(e)}}else i.ij.call(r,0);r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),n.Of.call(r,1)},E=function(e,t){const r=this;if(e?t?r.selectedCell[3]=r.records.length-1:d.call(r,1,0):(t?r.selectedCell[1]=r.records.length-1:d.call(r,0,0),r.selectedCell[2]=r.selectedCell[0],r.selectedCell[3]=r.selectedCell[1]),1!=r.options.lazyLoading||r.selectedCell[1]!=r.records.length-1&&r.selectedCell[3]!=r.records.length-1){if(r.options.pagination>0){const e=r.whichPage(r.selectedCell[3]);e!=r.pageNumber&&r.page(e)}}else i.ij.call(r,-1);r.updateSelectionFromCoords(r.selectedCell[0],r.selectedCell[1],r.selectedCell[2],r.selectedCell[3]),n.Of.call(r,3)};var v=__webpack_require__(49),A=__webpack_require__(366),j=__webpack_require__(650),M=__webpack_require__(323);const _=function(e,n,r,o,s,l,i){const a=this;n||(n="\t");const c=new RegExp(n,"ig"),u=[];let f=[],d=[];const p=[],h=[],g=a.options.data[0].length,m=a.options.data.length;let y="",C=!1,b="",w="",E=0,v=0,j=0,M=0;for(let t=0;t<m;t++)for(let n=0;n<g;n++)e&&!a.records[t][n].element.classList.contains("highlight")||(j<=n&&(j=n),M<=t&&(M=t));if(s&&(1==a.parent.config.includeHeadersOnDownload||o)){if(a.options.nestedHeaders&&a.options.nestedHeaders.length>0){y=a.options.nestedHeaders;for(let e=0;e<y.length;e++){const t=[];for(let n=0;n<y[e].length;n++){const r=parseInt(y[e][n].colspan);t.push(y[e][n].title);for(let e=0;e<r-1;e++)t.push("")}w+=t.join(n)+"\r\n"}}C=!0}a.style=[];for(let t=0;t<m;t++){f=[],d=[];for(let n=0;n<g;n++)if(!e||a.records[t][n].element.classList.contains("highlight")){1==C&&u.push(a.headers[n].textContent);let e,r=a.options.data[t][n];r.match&&(r.match(c)||r.match(/,/g)||r.match(/\n/)||r.match(/\"/))&&(r=r.replace(new RegExp('"',"g"),'""'),r='"'+r+'"'),f.push(r),a.options.columns&&a.options.columns[n]&&("checkbox"==a.options.columns[n].type||"radio"==a.options.columns[n].type)?e=r:(e=a.records[t][n].element.innerHTML,e.match&&(e.match(c)||e.match(/,/g)||e.match(/\n/)||e.match(/\"/))&&(e=e.replace(new RegExp('"',"g"),'""'),e='"'+e+'"')),d.push(e),y=a.records[t][n].element.getAttribute("style"),y=y.replace("display: none;",""),a.style.push(y||"")}f.length&&(C&&(E=f.length,p.push(u.join(n))),p.push(f.join(n))),d.length&&(v++,C&&(h.push(u.join(n)),C=!1),h.push(d.join(n)))}g==E&&m==v&&(b=w);const _=b+p.join("\r\n");let I=b+h.join("\r\n");if(!r){const e=[Math.min(a.selectedCell[0],a.selectedCell[2]),Math.min(a.selectedCell[1],a.selectedCell[3]),Math.max(a.selectedCell[0],a.selectedCell[2]),Math.max(a.selectedCell[1],a.selectedCell[3])],n=t.Z.call(a,"oncopy",a,e,I,l);if(n)I=n;else if(!1===n)return!1;a.textarea.value=I,a.textarea.select(),document.execCommand("copy")}if(a.data=1==i?I:_,a.hashString=A.vp.call(a,a.data),!r&&(A.vn.call(a),a.highlighted))for(let e=0;e<a.highlighted.length;e++)a.highlighted[e].element.classList.add("copying"),a.highlighted[e].element.classList.contains("highlight-left")&&a.highlighted[e].element.classList.add("copying-left"),a.highlighted[e].element.classList.contains("highlight-right")&&a.highlighted[e].element.classList.add("copying-right"),a.highlighted[e].element.classList.contains("highlight-top")&&a.highlighted[e].element.classList.add("copying-top"),a.highlighted[e].element.classList.contains("highlight-bottom")&&a.highlighted[e].element.classList.add("copying-bottom");return a.data},I=function(e,o,s){const l=this,i=(0,A.vp)(s),a=i==l.hashString?l.style:null;i==l.hashString&&(s=l.data),s=(0,j.parseCSV)(s,"\t");const c=t.Z.call(l,"onbeforepaste",l,s.map((function(e){return e.map((function(e){return{value:e}}))})),e,o);if(!1===c)return!1;if(c&&(s=c),null!=e&&null!=o&&s){let i=0,c=0;const u=[],d={},p={};let g=0,m=parseInt(e),y=parseInt(o),C=null;for(;C=s[c];){for(i=0,m=parseInt(e);null!=C[i];){const e=n.wW.call(l,m,y,C[i]);if(u.push(e),n.Zz.call(l,m,y,u),a&&a[g]){const e=(0,M.Ar)([m,y]);d[e]=a[g],p[e]=l.getStyle(e),l.records[y][m].element.setAttribute("style",a[g]),g++}if(i++,null!=C[i]){if(m>=l.headers.length-1){if(0==l.options.allowInsertColumn)break;l.insertColumn()}m=f.call(l,m,y)}}if(c++,s[c]){if(y>=l.rows.length-1){if(0==l.options.allowInsertRow)break;l.insertRow()}y=h.call(l,e,y)}}A.Es.call(l,e,o,m,y),r.JB.call(l,{action:"setValue",records:u,selection:l.selectedCell,newStyle:d,oldStyle:p}),n.T0.call(l);const b=[];for(let t=0;t<s.length;t++)for(let n=0;n<s[t].length;n++)b.push({x:n+e,y:t+o,value:s[t][n]});t.Z.call(l,"onpaste",l,b);const w=u.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(l,"onafterchanges",l,w)}(0,A.vn)()};var x=__webpack_require__(456),D=__webpack_require__(427);const N=function(){const e=this;let t=e.options.columns&&e.options.columns.length||0;if(e.options.data&&void 0!==e.options.data[0]){const n=Object.keys(e.options.data[0]);n.length>t&&(t=n.length)}return e.options.minDimensions&&e.options.minDimensions[0]>t&&(t=e.options.minDimensions[0]),t},S=function(e){const t=this,n=t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100,r=t.options.columns&&t.options.columns[e]&&t.options.columns[e].align||t.options.defaultColAlign||"center";t.headers[e]=document.createElement("td"),t.headers[e].textContent=t.options.columns&&t.options.columns[e]&&t.options.columns[e].title||(0,j.getColumnName)(e),t.headers[e].setAttribute("data-x",e),t.headers[e].style.textAlign=r,t.options.columns&&t.options.columns[e]&&t.options.columns[e].title&&t.headers[e].setAttribute("title",t.headers[e].innerText),t.options.columns&&t.options.columns[e]&&t.options.columns[e].id&&t.headers[e].setAttribute("id",t.options.columns[e].id);const o=document.createElement("col");o.setAttribute("width",n),t.cols[e]={colElement:o,x:e},t.options.columns&&t.options.columns[e]&&"hidden"==t.options.columns[e].type&&(t.headers[e].style.display="none",o.style.display="none")},T=function(e,n,o){const s=this;if(n){if(Array.isArray(e)){o||(o=[]);for(let t=0;t<e.length;t++){o[t]||(o[t]=parseInt(s.cols[e[t]].colElement.getAttribute("width")));const r=Array.isArray(n)&&n[t]?n[t]:n;s.cols[e[t]].colElement.setAttribute("width",r),s.options.columns||(s.options.columns=[]),s.options.columns[e[t]]||(s.options.columns[e[t]]={}),s.options.columns[e[t]].width=r}}else o||(o=parseInt(s.cols[e].colElement.getAttribute("width"))),s.cols[e].colElement.setAttribute("width",n),s.options.columns||(s.options.columns=[]),s.options.columns[e]||(s.options.columns[e]={}),s.options.columns[e].width=n;r.JB.call(s,{action:"setWidth",column:e,oldValue:o,newValue:n}),t.Z.call(s,"onresizecolumn",s,e,n,o),A.x8.call(s)}},L=function(e,t){const r=this;r.records[e]||(r.records[e]=[]),t||(t=r.options.data[e]);const o={element:document.createElement("tr"),y:e};r.rows[e]=o,o.element.setAttribute("data-y",e);let s=null;r.options.defaultRowHeight&&(o.element.style.height=r.options.defaultRowHeight+"px"),r.options.rows&&r.options.rows[e]&&(r.options.rows[e].height&&(o.element.style.height=r.options.rows[e].height),r.options.rows[e].title&&(s=r.options.rows[e].title)),s||(s=parseInt(e+1));const l=document.createElement("td");l.innerHTML=s,l.setAttribute("data-y",e),l.className="jss_row",o.element.appendChild(l);const i=N.call(r);for(let s=0;s<i;s++)r.records[e][s]={element:n.kE.call(this,s,e,t[s]),x:s,y:e},o.element.appendChild(r.records[e][s].element),r.options.columns&&r.options.columns[s]&&"function"==typeof r.options.columns[s].render&&r.options.columns[s].render(r.records[e][s].element,t[s],parseInt(s),parseInt(e),r,r.options.columns[s]);return o},O=function(e,o,s){const l=this;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0){let t;if(t=e>o?1:0,v.q4.call(l,e).length||v.q4.call(l,o,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}}if(1==l.options.search){if(l.results&&l.results.length!=l.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;l.resetSearch()}l.results=null}s||(Array.prototype.indexOf.call(l.tbody.children,l.rows[o].element)>=0?e>o?l.tbody.insertBefore(l.rows[e].element,l.rows[o].element):l.tbody.insertBefore(l.rows[e].element,l.rows[o].element.nextSibling):l.tbody.removeChild(l.rows[e].element)),l.rows.splice(o,0,l.rows.splice(e,1)[0]),l.records.splice(o,0,l.records.splice(e,1)[0]),l.options.data.splice(o,0,l.options.data.splice(e,1)[0]);const i=Math.min(e,o),a=Math.max(e,o);for(let e=i;e<=a;e++)l.rows[e].y=e;for(let e=i;e<=a;e++)for(let t=0;t<l.records[e].length;t++)l.records[e][t].y=e;l.options.pagination>0&&l.tbody.children.length!=l.options.pagination&&l.page(l.pageNumber),r.JB.call(l,{action:"moveRow",oldValue:e,newValue:o}),n.ec.call(l),t.Z.call(l,"onmoverow",l,parseInt(e),parseInt(o),1)},R=function(e,n,o){const s=this;n>0&&(o||(o=s.rows[e].element.getAttribute("height"))||(o=s.rows[e].element.getBoundingClientRect().height),n=parseInt(n),s.rows[e].element.style.height=n+"px",s.options.rows||(s.options.rows=[]),s.options.rows[e]||(s.options.rows[e]={}),s.options.rows[e].height=n,r.JB.call(s,{action:"setHeight",row:e,oldValue:o,newValue:n}),t.Z.call(s,"onresizerow",s,e,n,o),A.x8.call(s))};var F={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join("\r\n")]}};const k=function(e){let t=0,n=0;return function e(r){r.className&&(r.classList.contains("jss_container")&&(n=r),r.classList.contains("jss_spreadsheet")&&(n=r.querySelector(":scope > .jtabs-content > .jtabs-selected"))),"THEAD"==r.tagName?t=1:"TBODY"==r.tagName&&(t=2),r.parentNode&&(n||e(r.parentNode))}(e),[n,t]},B=function(t){if(e.jspreadsheet.current)if(e.jspreadsheet.current.resizing){if(e.jspreadsheet.current.resizing.column){const t=parseInt(e.jspreadsheet.current.cols[e.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),n=e.jspreadsheet.current.getSelectedColumns();if(n.length>1){const r=[];for(let t=0;t<n.length;t++)r.push(parseInt(e.jspreadsheet.current.cols[n[t]].colElement.getAttribute("width")));r[n.indexOf(parseInt(e.jspreadsheet.current.resizing.column))]=e.jspreadsheet.current.resizing.width,T.call(e.jspreadsheet.current,n,t,r)}else T.call(e.jspreadsheet.current,parseInt(e.jspreadsheet.current.resizing.column),t,e.jspreadsheet.current.resizing.width);e.jspreadsheet.current.headers[e.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][e.jspreadsheet.current.resizing.column]&&e.jspreadsheet.current.records[t][e.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let t=e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.getAttribute("height");R.call(e.jspreadsheet.current,e.jspreadsheet.current.resizing.row,t,e.jspreadsheet.current.resizing.height),e.jspreadsheet.current.resizing.element.classList.remove("resizing")}e.jspreadsheet.current.resizing=null}else if(e.jspreadsheet.current.dragging){if(e.jspreadsheet.current.dragging){if(e.jspreadsheet.current.dragging.column){const n=t.target.getAttribute("data-x");e.jspreadsheet.current.headers[e.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let t=0;t<e.jspreadsheet.current.rows.length;t++)e.jspreadsheet.current.records[t][e.jspreadsheet.current.dragging.column]&&e.jspreadsheet.current.records[t][e.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let t=0;t<e.jspreadsheet.current.headers.length;t++)e.jspreadsheet.current.headers[t].classList.remove("dragging-left"),e.jspreadsheet.current.headers[t].classList.remove("dragging-right");n&&e.jspreadsheet.current.dragging.column!=e.jspreadsheet.current.dragging.destination&&e.jspreadsheet.current.moveColumn(e.jspreadsheet.current.dragging.column,e.jspreadsheet.current.dragging.destination)}else{let t;e.jspreadsheet.current.dragging.element.nextSibling?(t=parseInt(e.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),e.jspreadsheet.current.dragging.row<t&&(t-=1)):t=parseInt(e.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),e.jspreadsheet.current.dragging.row!=e.jspreadsheet.current.dragging.destination&&O.call(e.jspreadsheet.current,e.jspreadsheet.current.dragging.row,t,!0),e.jspreadsheet.current.dragging.element.classList.remove("dragging")}e.jspreadsheet.current.dragging=null}}else e.jspreadsheet.current.selectedCorner&&(e.jspreadsheet.current.selectedCorner=!1,e.jspreadsheet.current.selection.length>0&&(A.F1.call(e.jspreadsheet.current,e.jspreadsheet.current.selection[0],e.jspreadsheet.current.selection[e.jspreadsheet.current.selection.length-1]),A.Mt.call(e.jspreadsheet.current)));e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null),e.jspreadsheet.isMouseAction=!1},P=function(t){let n;n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which;const r=k(t.target);if(r[0]?e.jspreadsheet.current!=r[0].jssWorksheet&&(e.jspreadsheet.current&&(e.jspreadsheet.current.edition&&s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0),e.jspreadsheet.current.resetSelection()),e.jspreadsheet.current=r[0].jssWorksheet):e.jspreadsheet.current&&(e.jspreadsheet.current.edition&&s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0),t.target.classList.contains("jss_object")||(A.yE.call(e.jspreadsheet.current,!0),e.jspreadsheet.current=null)),e.jspreadsheet.current&&1==n){if(t.target.classList.contains("jss_selectall"))e.jspreadsheet.current&&A.td.call(e.jspreadsheet.current);else if(t.target.classList.contains("jss_corner"))0!=e.jspreadsheet.current.options.editable&&(e.jspreadsheet.current.selectedCorner=!0);else{if(1==r[1]){const n=t.target.getAttribute("data-x");if(n){const r=t.target.getBoundingClientRect();if(0!=e.jspreadsheet.current.options.columnResize&&r.width-t.offsetX<6){e.jspreadsheet.current.resizing={mousePosition:t.pageX,column:n,width:r.width},e.jspreadsheet.current.headers[n].classList.add("resizing");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][n]&&e.jspreadsheet.current.records[t][n].element.classList.add("resizing")}else if(0!=e.jspreadsheet.current.options.columnDrag&&r.height-t.offsetY<6)if(v.D0.call(e.jspreadsheet.current,n).length);else{e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current.dragging={element:t.target,column:n,destination:n},e.jspreadsheet.current.headers[n].classList.add("dragging");for(let t=0;t<e.jspreadsheet.current.records.length;t++)e.jspreadsheet.current.records[t][n]&&e.jspreadsheet.current.records[t][n].element.classList.add("dragging")}else{let r,o;e.jspreadsheet.current.selectedHeader&&(t.shiftKey||t.ctrlKey)?(r=e.jspreadsheet.current.selectedHeader,o=n):(e.jspreadsheet.current.selectedHeader==n&&0!=e.jspreadsheet.current.options.allowRenameColumn&&(e.jspreadsheet.timeControl=setTimeout((function(){e.jspreadsheet.current.setHeader(n)}),800)),e.jspreadsheet.current.selectedHeader=n,r=n,o=n),A.Es.call(e.jspreadsheet.current,r,0,o,e.jspreadsheet.current.options.data.length-1,t)}}else if(t.target.parentNode.classList.contains("jss_nested")){let n,r;if(t.target.getAttribute("data-column")){const e=t.target.getAttribute("data-column").split(",");n=parseInt(e[0]),r=parseInt(e[e.length-1])}else n=0,r=e.jspreadsheet.current.options.columns.length-1;A.Es.call(e.jspreadsheet.current,n,0,r,e.jspreadsheet.current.options.data.length-1,t)}}else e.jspreadsheet.current.selectedHeader=!1;if(2==r[1]){const n=parseInt(t.target.getAttribute("data-y"));if(t.target.classList.contains("jss_row")){const r=t.target.getBoundingClientRect();if(0!=e.jspreadsheet.current.options.rowResize&&r.height-t.offsetY<6)e.jspreadsheet.current.resizing={element:t.target.parentNode,mousePosition:t.pageY,row:n,height:r.height},t.target.parentNode.classList.add("resizing");else if(0!=e.jspreadsheet.current.options.rowDrag&&r.width-t.offsetX<6)v.q4.call(e.jspreadsheet.current,n).length||1==e.jspreadsheet.current.options.search&&e.jspreadsheet.current.results||(e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current.dragging={element:t.target.parentNode,row:n,destination:n},t.target.parentNode.classList.add("dragging"));else{let r,o;e.jspreadsheet.current.selectedRow&&(t.shiftKey||t.ctrlKey)?(r=e.jspreadsheet.current.selectedRow,o=n):(e.jspreadsheet.current.selectedRow=n,r=n,o=n),A.Es.call(e.jspreadsheet.current,null,r,null,o,t)}}else if(t.target.classList.contains("jclose")&&t.target.clientWidth-t.offsetX<50&&t.offsetY<50)s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0);else{const n=function(e){const t=e.getAttribute("data-x"),r=e.getAttribute("data-y");return t&&r?[t,r]:e.parentNode?n(e.parentNode):void 0},r=n(t.target);if(r){const n=r[0],o=r[1];e.jspreadsheet.current.edition&&(e.jspreadsheet.current.edition[2]==n&&e.jspreadsheet.current.edition[3]==o||s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0)),e.jspreadsheet.current.edition||(t.shiftKey?A.Es.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],n,o,t):A.Es.call(e.jspreadsheet.current,n,o,void 0,void 0,t)),e.jspreadsheet.current.selectedHeader=null,e.jspreadsheet.current.selectedRow=null}}}else e.jspreadsheet.current.selectedRow=!1;t.target.classList.contains("jss_page")&&("<"==t.target.textContent?e.jspreadsheet.current.page(0):">"==t.target.textContent?e.jspreadsheet.current.page(t.target.getAttribute("title")-1):e.jspreadsheet.current.page(t.target.textContent-1))}e.jspreadsheet.current.edition?e.jspreadsheet.isMouseAction=!1:e.jspreadsheet.isMouseAction=!0}else e.jspreadsheet.isMouseAction=!1},H=function(t){let n;if(n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which,n||(e.jspreadsheet.isMouseAction=!1),e.jspreadsheet.current)if(1==e.jspreadsheet.isMouseAction){if(e.jspreadsheet.current.resizing)if(e.jspreadsheet.current.resizing.column){const n=t.pageX-e.jspreadsheet.current.resizing.mousePosition;if(e.jspreadsheet.current.resizing.width+n>0){const t=e.jspreadsheet.current.resizing.width+n;e.jspreadsheet.current.cols[e.jspreadsheet.current.resizing.column].colElement.setAttribute("width",t),A.x8.call(e.jspreadsheet.current)}}else{const n=t.pageY-e.jspreadsheet.current.resizing.mousePosition;if(e.jspreadsheet.current.resizing.height+n>0){const t=e.jspreadsheet.current.resizing.height+n;e.jspreadsheet.current.rows[e.jspreadsheet.current.resizing.row].element.setAttribute("height",t),A.x8.call(e.jspreadsheet.current)}}else if(e.jspreadsheet.current.dragging)if(e.jspreadsheet.current.dragging.column){const n=t.target.getAttribute("data-x");if(n)if(v.D0.call(e.jspreadsheet.current,n).length);else{for(let t=0;t<e.jspreadsheet.current.headers.length;t++)e.jspreadsheet.current.headers[t].classList.remove("dragging-left"),e.jspreadsheet.current.headers[t].classList.remove("dragging-right");e.jspreadsheet.current.dragging.column==n?e.jspreadsheet.current.dragging.destination=parseInt(n):t.target.clientWidth/2>t.offsetX?(e.jspreadsheet.current.dragging.column<n?e.jspreadsheet.current.dragging.destination=parseInt(n)-1:e.jspreadsheet.current.dragging.destination=parseInt(n),e.jspreadsheet.current.headers[n].classList.add("dragging-left")):(e.jspreadsheet.current.dragging.column<n?e.jspreadsheet.current.dragging.destination=parseInt(n):e.jspreadsheet.current.dragging.destination=parseInt(n)+1,e.jspreadsheet.current.headers[n].classList.add("dragging-right"))}}else{const n=t.target.getAttribute("data-y");if(n)if(v.q4.call(e.jspreadsheet.current,n).length);else{const n=t.target.clientHeight/2>t.offsetY?t.target.parentNode.nextSibling:t.target.parentNode;e.jspreadsheet.current.dragging.element!=n&&(t.target.parentNode.parentNode.insertBefore(e.jspreadsheet.current.dragging.element,n),e.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(e.jspreadsheet.current.dragging.element.parentNode.children,e.jspreadsheet.current.dragging.element))}}}else{const n=t.target.getAttribute("data-x"),r=t.target.getAttribute("data-y"),o=t.target.getBoundingClientRect();e.jspreadsheet.current.cursor&&(e.jspreadsheet.current.cursor.style.cursor="",e.jspreadsheet.current.cursor=null),t.target.parentNode.parentNode&&t.target.parentNode.parentNode.className&&(t.target.parentNode.parentNode.classList.contains("resizable")&&(t.target&&n&&!r&&o.width-(t.clientX-o.left)<6?(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="col-resize"):t.target&&!n&&r&&o.height-(t.clientY-o.top)<6&&(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="row-resize")),t.target.parentNode.parentNode.classList.contains("draggable")&&(t.target&&!n&&r&&o.width-(t.clientX-o.left)<6||t.target&&n&&!r&&o.height-(t.clientY-o.top)<6)&&(e.jspreadsheet.current.cursor=t.target,e.jspreadsheet.current.cursor.style.cursor="move"))}},q=function(e,t){const n=this;A.Mt.call(n);const r=n.selectedContainer[0],o=n.selectedContainer[1],s=n.selectedContainer[2],l=n.selectedContainer[3];if(null!=e&&null!=t){let i,a,c,u;e-s>0?(i=parseInt(s)+1,a=parseInt(e)):(i=parseInt(e),a=parseInt(r)-1),t-l>0?(c=parseInt(l)+1,u=parseInt(t)):(c=parseInt(t),u=parseInt(o)-1),a-i<=u-c?(i=parseInt(r),a=parseInt(s)):(c=parseInt(o),u=parseInt(l));for(let e=c;e<=u;e++)for(let t=i;t<=a;t++)n.records[e][t]&&"none"!=n.rows[e].element.style.display&&"none"!=n.records[e][t].element.style.display&&(n.records[e][t].element.classList.add("selection"),n.records[c][t].element.classList.add("selection-top"),n.records[u][t].element.classList.add("selection-bottom"),n.records[e][i].element.classList.add("selection-left"),n.records[e][a].element.classList.add("selection-right"),n.selection.push(n.records[e][t].element))}},V=function(t){let n;if(n=(t=t||window.event).buttons?t.buttons:t.button?t.button:t.which,n||(e.jspreadsheet.isMouseAction=!1),e.jspreadsheet.current&&1==e.jspreadsheet.isMouseAction){const n=k(t.target);if(n[0]){if(e.jspreadsheet.current!=n[0].jssWorksheet&&e.jspreadsheet.current)return!1;let r=t.target.getAttribute("data-x");const o=t.target.getAttribute("data-y");if(e.jspreadsheet.current.resizing||e.jspreadsheet.current.dragging);else{if(1==n[1]&&e.jspreadsheet.current.selectedHeader){r=t.target.getAttribute("data-x");const n=e.jspreadsheet.current.selectedHeader,o=r;A.Es.call(e.jspreadsheet.current,n,0,o,e.jspreadsheet.current.options.data.length-1,t)}if(2==n[1])if(t.target.classList.contains("jss_row")){if(e.jspreadsheet.current.selectedRow){const n=e.jspreadsheet.current.selectedRow,r=o;A.Es.call(e.jspreadsheet.current,0,n,e.jspreadsheet.current.options.data[0].length-1,r,t)}}else e.jspreadsheet.current.edition||r&&o&&(e.jspreadsheet.current.selectedCorner?q.call(e.jspreadsheet.current,r,o):e.jspreadsheet.current.selectedCell&&A.Es.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],r,o,t))}}}e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null)},U=function(t){if(e.jspreadsheet.current)if(t.target.classList.contains("jss_corner")){if(e.jspreadsheet.current.highlighted.length>0){const t=e.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),n=parseInt(e.jspreadsheet.current.highlighted[e.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,r=e.jspreadsheet.current.highlighted[e.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),o=e.jspreadsheet.current.records.length-1;A.F1.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][t].element,e.jspreadsheet.current.records[o][r].element)}}else if(t.target.classList.contains("jss_column_filter")){const n=t.target.getAttribute("data-x");x.B4.call(e.jspreadsheet.current,n)}else{const n=k(t.target);if(1==n[1]&&0!=e.jspreadsheet.current.options.columnSorting){const n=t.target.getAttribute("data-x");n&&e.jspreadsheet.current.orderBy(parseInt(n))}if(2==n[1]&&0!=e.jspreadsheet.current.options.editable&&!e.jspreadsheet.current.edition){const n=function(e){if(e.parentNode){const t=e.getAttribute("data-x"),r=e.getAttribute("data-y");return t&&r?e:n(e.parentNode)}},r=n(t.target);r&&r.classList.contains("highlight")&&o.call(e.jspreadsheet.current,r,void 0,t)}}},W=function(t){e.jspreadsheet.current&&e.jspreadsheet.current.selectedCell&&(e.jspreadsheet.current.edition||0!=e.jspreadsheet.current.options.editable&&(t&&t.clipboardData?(I.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],t.clipboardData.getData("text")),t.preventDefault()):window.clipboardData&&I.call(e.jspreadsheet.current,e.jspreadsheet.current.selectedCell[0],e.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},z=function(e){const t=e.parentElement.children;for(let n=0;n<t.length;n++)if(e===t[n])return n;return-1},Y=function(t){if("buttons"in(t=t||window.event)?t.buttons:t.which||t.button,e.jspreadsheet.current){const n=e.jspreadsheet.current.parent;if(e.jspreadsheet.current.edition)t.preventDefault();else if(n.contextMenu.contextmenu.close(),e.jspreadsheet.current){const r=function(e){if(e.classList.contains("jss_selectall"))return"select-all";if(e.classList.contains("jss_corner"))return"fill-handle";let t=e;for(;!t.classList.contains("jss_spreadsheet");){if(t.classList.contains("jss_row"))return"row";if(t.classList.contains("jss_nested"))return"nested";if(t.classList.contains("jtabs-headers"))return"tabs";if(t.classList.contains("jtoolbar"))return"toolbar";if(t.classList.contains("jss_pagination"))return"pagination";if("TBODY"===t.tagName)return"cell";if("TFOOT"===t.tagName)return 0===z(e)?"grid":"footer";if("THEAD"===t.tagName)return"header";t=t.parentElement}return"applications"}(t.target);let o=null,s=null;if("cell"===r||"row"===r||"header"===r)"cell"!==r&&"row"!==r||(s=t.target.getAttribute("data-y")),"cell"!==r&&"header"!==r||(o=t.target.getAttribute("data-x")),(!e.jspreadsheet.current.selectedCell||o<parseInt(e.jspreadsheet.current.selectedCell[0])||o>parseInt(e.jspreadsheet.current.selectedCell[2])||s<parseInt(e.jspreadsheet.current.selectedCell[1])||s>parseInt(e.jspreadsheet.current.selectedCell[3]))&&A.Es.call(e.jspreadsheet.current,o,s,o,s,t);else if("nested"===r){const n=t.target.getAttribute("data-column").split(",");o=z(t.target)-1,s=z(t.target.parentElement),e.jspreadsheet.current.selectedCell&&n[0]==parseInt(e.jspreadsheet.current.selectedCell[0])&&n[n.length-1]==parseInt(e.jspreadsheet.current.selectedCell[2])&&null==e.jspreadsheet.current.selectedCell[1]&&null==e.jspreadsheet.current.selectedCell[3]||A.Es.call(e.jspreadsheet.current,n[0],null,n[n.length-1],null,t)}else"select-all"===r?A.td.call(e.jspreadsheet.current):"tabs"===r?o=z(t.target):"footer"===r&&(o=z(t.target)-1,s=z(t.target.parentElement));let l=function(e,t,n,r){const o=[];if("header"===r&&(0!=e.options.allowInsertColumn&&o.push({title:jSuites.translate("Insert a new column before"),onclick:function(){e.insertColumn(1,parseInt(t),1)}}),0!=e.options.allowInsertColumn&&o.push({title:jSuites.translate("Insert a new column after"),onclick:function(){e.insertColumn(1,parseInt(t),0)}}),0!=e.options.allowDeleteColumn&&o.push({title:jSuites.translate("Delete selected columns"),onclick:function(){e.deleteColumn(e.getSelectedColumns().length?void 0:parseInt(t))}}),0!=e.options.allowRenameColumn&&o.push({title:jSuites.translate("Rename this column"),onclick:function(){const n=e.getHeader(t),r=prompt(jSuites.translate("Column name"),n);e.setHeader(t,r)}}),0!=e.options.columnSorting&&(o.push({type:"line"}),o.push({title:jSuites.translate("Order ascending"),onclick:function(){e.orderBy(t,0)}}),o.push({title:jSuites.translate("Order descending"),onclick:function(){e.orderBy(t,1)}}))),"row"!==r&&"cell"!==r||(0!=e.options.allowInsertRow&&(o.push({title:jSuites.translate("Insert a new row before"),onclick:function(){e.insertRow(1,parseInt(n),1)}}),o.push({title:jSuites.translate("Insert a new row after"),onclick:function(){e.insertRow(1,parseInt(n))}})),0!=e.options.allowDeleteRow&&o.push({title:jSuites.translate("Delete selected rows"),onclick:function(){e.deleteRow(e.getSelectedRows().length?void 0:parseInt(n))}})),"cell"===r&&0!=e.options.allowComments){o.push({type:"line"});const r=e.records[n][t].element.getAttribute("title")||"";o.push({title:jSuites.translate(r?"Edit comments":"Add comments"),onclick:function(){const o=prompt(jSuites.translate("Comments"),r);o&&e.setComments((0,j.getCellNameFromCoords)(t,n),o)}}),r&&o.push({title:jSuites.translate("Clear comments"),onclick:function(){e.setComments((0,j.getCellNameFromCoords)(t,n),"")}})}return 0!==o.length&&o.push({type:"line"}),"header"!==r&&"row"!==r&&"cell"!==r||(o.push({title:jSuites.translate("Copy..."),shortcut:"Ctrl + C",onclick:function(){_.call(e,!0)}}),navigator&&navigator.clipboard&&o.push({title:jSuites.translate("Paste..."),shortcut:"Ctrl + V",onclick:function(){e.selectedCell&&navigator.clipboard.readText().then((function(t){t&&I.call(e,e.selectedCell[0],e.selectedCell[1],t)}))}})),0!=e.parent.config.allowExport&&o.push({title:jSuites.translate("Save as..."),shortcut:"Ctrl + S",onclick:function(){e.download()}}),0!=e.parent.config.about&&o.push({title:jSuites.translate("About"),onclick:function(){void 0===e.parent.config.about||e.parent.config.about}}),o}(e.jspreadsheet.current,parseInt(o),parseInt(s),r);if("function"==typeof n.config.contextMenu){const i=n.config.contextMenu(e.jspreadsheet.current,o,s,t,l,r,o,s);if(i)l=i;else if(!1===i)return}"object"==typeof n.plugins&&Object.entries(n.plugins).forEach((function([,n]){if("function"==typeof n.contextMenu){const i=n.contextMenu(e.jspreadsheet.current,null!==o?parseInt(o):null,null!==s?parseInt(s):null,t,l,r,null!==o?parseInt(o):null,null!==s?parseInt(s):null);i&&(l=i)}})),n.contextMenu.contextmenu.open(t,l),t.preventDefault()}}},K=function(t){const n=k(t.target);if(n[0]?e.jspreadsheet.current!=n[0].jssWorksheet&&(e.jspreadsheet.current&&e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current=n[0].jssWorksheet):e.jspreadsheet.current&&(e.jspreadsheet.current.resetSelection(),e.jspreadsheet.current=null),e.jspreadsheet.current&&!e.jspreadsheet.current.edition){const n=t.target.getAttribute("data-x"),r=t.target.getAttribute("data-y");n&&r&&(A.Es.call(e.jspreadsheet.current,n,r,void 0,void 0,t),e.jspreadsheet.timeControl=setTimeout((function(){"color"==e.jspreadsheet.current.options.columns[n].type?e.jspreadsheet.tmpElement=null:e.jspreadsheet.tmpElement=t.target,o.call(e.jspreadsheet.current,t.target,!1,t)}),500))}},X=function(t){e.jspreadsheet.timeControl&&(clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=null,e.jspreadsheet.tmpElement&&"INPUT"==e.jspreadsheet.tmpElement.children[0].tagName&&e.jspreadsheet.tmpElement.children[0].focus(),e.jspreadsheet.tmpElement=null)},G=function(t){e.jspreadsheet.current&&(e.jspreadsheet.current.edition||(_.call(e.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),0!=e.jspreadsheet.current.options.editable&&e.jspreadsheet.current.setValue(e.jspreadsheet.current.highlighted.map((function(e){return e.element})),"")))},Z=function(t){e.jspreadsheet.current&&Z.enabled&&(e.jspreadsheet.current.edition||_.call(e.jspreadsheet.current,!0))},J=function(t){if(e.jspreadsheet.current){if(e.jspreadsheet.current.edition)if(27==t.which)e.jspreadsheet.current.edition&&s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!1),t.preventDefault();else if(13==t.which)if(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&"calendar"==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type)s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0);else if(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&"dropdown"==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type);else if((1==e.jspreadsheet.current.options.wordWrap||e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&1==e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].wordWrap||e.jspreadsheet.current.options.data[e.jspreadsheet.current.edition[3]][e.jspreadsheet.current.edition[2]]&&e.jspreadsheet.current.options.data[e.jspreadsheet.current.edition[3]][e.jspreadsheet.current.edition[2]].length>200)&&t.altKey){const t=e.jspreadsheet.current.edition[0].children[0];let n=e.jspreadsheet.current.edition[0].children[0].value;const r=t.selectionStart;n=n.slice(0,r)+"\n"+n.slice(r),t.value=n,t.focus(),t.selectionStart=r+1,t.selectionEnd=r+1}else e.jspreadsheet.current.edition[0].children[0].blur();else 9==t.which&&(e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(e.jspreadsheet.current.options.columns[e.jspreadsheet.current.edition[2]].type)?s.call(e.jspreadsheet.current,e.jspreadsheet.current.edition[0],!0):e.jspreadsheet.current.edition[0].children[0].blur());if(!e.jspreadsheet.current.edition&&e.jspreadsheet.current.selectedCell)if(37==t.which)b.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(39==t.which)p.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(38==t.which)u.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(40==t.which)m.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(36==t.which)w.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(35==t.which)E.call(e.jspreadsheet.current,t.shiftKey,t.ctrlKey),t.preventDefault();else if(46==t.which)0!=e.jspreadsheet.current.options.editable&&(e.jspreadsheet.current.selectedRow?0!=e.jspreadsheet.current.options.allowDeleteRow&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&e.jspreadsheet.current.deleteRow():e.jspreadsheet.current.selectedHeader?0!=e.jspreadsheet.current.options.allowDeleteColumn&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&e.jspreadsheet.current.deleteColumn():e.jspreadsheet.current.setValue(e.jspreadsheet.current.highlighted.map((function(e){return e.element})),""));else if(13==t.which)t.shiftKey?u.call(e.jspreadsheet.current):(0!=e.jspreadsheet.current.options.allowInsertRow&&0!=e.jspreadsheet.current.options.allowManualInsertRow&&e.jspreadsheet.current.selectedCell[1]==e.jspreadsheet.current.options.data.length-1&&e.jspreadsheet.current.insertRow(),m.call(e.jspreadsheet.current)),t.preventDefault();else if(9==t.which)t.shiftKey?b.call(e.jspreadsheet.current):(0!=e.jspreadsheet.current.options.allowInsertColumn&&0!=e.jspreadsheet.current.options.allowManualInsertColumn&&e.jspreadsheet.current.selectedCell[0]==e.jspreadsheet.current.options.data[0].length-1&&e.jspreadsheet.current.insertColumn(),p.call(e.jspreadsheet.current)),t.preventDefault();else if(!t.ctrlKey&&!t.metaKey||t.shiftKey){if(e.jspreadsheet.current.selectedCell&&0!=e.jspreadsheet.current.options.editable){const n=e.jspreadsheet.current.selectedCell[1],r=e.jspreadsheet.current.selectedCell[0];32==t.keyCode?(t.preventDefault(),"checkbox"==e.jspreadsheet.current.options.columns[r].type||"radio"==e.jspreadsheet.current.options.columns[r].type?l.call(e.jspreadsheet.current):o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][r].element,!0,t)):113==t.keyCode?o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][r].element,!1,t):(8==t.keyCode||t.keyCode>=48&&t.keyCode<=57||t.keyCode>=96&&t.keyCode<=111||t.keyCode>=187&&t.keyCode<=190||(String.fromCharCode(t.keyCode)==t.key||String.fromCharCode(t.keyCode).toLowerCase()==t.key.toLowerCase())&&String.fromCharCode(t.keyCode).match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g))&&(o.call(e.jspreadsheet.current,e.jspreadsheet.current.records[n][r].element,!0,t),e.jspreadsheet.current.options.columns&&e.jspreadsheet.current.options.columns[r]&&"calendar"==e.jspreadsheet.current.options.columns[r].type&&t.preventDefault())}}else 65==t.which?(A.td.call(e.jspreadsheet.current),t.preventDefault()):83==t.which?(e.jspreadsheet.current.download(),t.preventDefault()):89==t.which?(e.jspreadsheet.current.redo(),t.preventDefault()):90==t.which?(e.jspreadsheet.current.undo(),t.preventDefault()):67==t.which?(_.call(e.jspreadsheet.current,!0),t.preventDefault()):88==t.which?(0!=e.jspreadsheet.current.options.editable?G():Z(),t.preventDefault()):86==t.which&&W();else t.target.classList.contains("jss_search")&&(e.jspreadsheet.timeControl&&clearTimeout(e.jspreadsheet.timeControl),e.jspreadsheet.timeControl=setTimeout((function(){e.jspreadsheet.current.search(t.target.value)}),200))}},Q=function(t){const n=this;1==n.options.lazyLoading&&null==e.jspreadsheet.timeControlLoading&&(e.jspreadsheet.timeControlLoading=setTimeout((function(){n.content.scrollTop+n.content.clientHeight>=n.content.scrollHeight-10?i.VG.call(n)&&(n.content.scrollTop+n.content.clientHeight>n.content.scrollHeight-10&&(n.content.scrollTop=n.content.scrollTop-n.content.clientHeight),A.x8.call(n)):n.content.scrollTop<=n.content.clientHeight&&i.Kw.call(n)&&(n.content.scrollTop<10&&(n.content.scrollTop=n.content.scrollTop+n.content.clientHeight),A.x8.call(n)),e.jspreadsheet.timeControlLoading=null}),100))};let ee=0;const te=function(){const e=this;ee=e.content.scrollLeft;let t=0;if(ee>50)for(let n=0;n<e.options.freezeColumns;n++){if(n>0&&(!e.options.columns||!e.options.columns[n-1]||"hidden"!==e.options.columns[n-1].type)){let r;r=e.options.columns&&e.options.columns[n-1]&&void 0!==e.options.columns[n-1].width?parseInt(e.options.columns[n-1].width):void 0!==e.options.defaultColWidth?parseInt(e.options.defaultColWidth):100,t+=parseInt(r)}e.headers[n].classList.add("jss_freezed"),e.headers[n].style.left=t+"px";for(let t=0;t<e.rows.length;t++)if(e.rows[t]&&e.records[t][n]){const r=ee+(n>0?e.records[t][n-1].element.style.width:0)-51+"px";e.records[t][n].element.classList.add("jss_freezed"),e.records[t][n].element.style.left=r}}else for(let t=0;t<e.options.freezeColumns;t++){e.headers[t].classList.remove("jss_freezed"),e.headers[t].style.left="";for(let n=0;n<e.rows.length;n++)e.records[n][t]&&(e.records[n][t].element.classList.remove("jss_freezed"),e.records[n][t].element.style.left="")}A.x8.call(e)},ne=function(e){const t=this;Q.call(t),t.options.freezeColumns>0&&t.content.scrollLeft!=ee&&te.call(t),1!=t.options.lazyLoading&&1!=t.options.tableOverflow||t.edition&&"jdropdown"!=e.target.className.substr(0,9)&&s.call(t,t.edition[0],!0)},re=function(e){oe(e),e.addEventListener("mouseup",B),e.addEventListener("mousedown",P),e.addEventListener("mousemove",H),e.addEventListener("mouseover",V),e.addEventListener("dblclick",U),e.addEventListener("paste",W),e.addEventListener("contextmenu",Y),e.addEventListener("touchstart",K),e.addEventListener("touchend",X),e.addEventListener("touchcancel",X),e.addEventListener("touchmove",X),document.addEventListener("keydown",J)},oe=function(e){e.removeEventListener("mouseup",B),e.removeEventListener("mousedown",P),e.removeEventListener("mousemove",H),e.removeEventListener("mouseover",V),e.removeEventListener("dblclick",U),e.removeEventListener("paste",W),e.removeEventListener("contextmenu",Y),e.removeEventListener("touchstart",K),e.removeEventListener("touchend",X),e.removeEventListener("touchcancel",X),document.removeEventListener("keydown",J)};var se=__webpack_require__(898),le=__webpack_require__(673);const ie=function(e,n,o,s,l){const i=this,a={},c={},u=function(e,t,n){const r=(0,M.qP)(e,!0);if(i.records[r[1]]&&i.records[r[1]][r[0]]&&(0==i.records[r[1]][r[0]].element.classList.contains("readonly")||s)){const o=i.records[r[1]][r[0]].element.style[t];o!=n||s?i.records[r[1]][r[0]].element.style[t]=n:(n="",i.records[r[1]][r[0]].element.style[t]=""),c[e]||(c[e]=[]),a[e]||(a[e]=[]),c[e].push([t+":"+o]),a[e].push([t+":"+n])}};if(n&&o)"string"==typeof e&&u(e,n,o);else{const t=Object.keys(e);for(let n=0;n<t.length;n++){let r=e[t[n]];"string"==typeof r&&(r=r.split(";"));for(let e=0;e<r.length;e++)"string"==typeof r[e]&&(r[e]=r[e].split(":")),r[e][0].trim()&&u(t[n],r[e][0].trim(),r[e][1])}}let f=Object.keys(c);for(let e=0;e<f.length;e++)c[f[e]]=c[f[e]].join(";");f=Object.keys(a);for(let e=0;e<f.length;e++)a[f[e]]=a[f[e]].join(";");l||r.JB.call(i,{action:"setStyle",oldValue:c,newValue:a}),t.Z.call(i,"onchangestyle",i,a)},ae=function(e){const t=this;if(e)return"string"!=typeof e?ae.call(t):(e=(0,M.qP)(e,!0),t.records[e[1]][e[0]].element.getAttribute("title")||"");{const e={};for(let n=0;n<t.options.data.length;n++)for(let r=0;r<t.options.columns.length;r++){const o=t.records[n][r].element.getAttribute("title");o&&(e[(0,M.Ar)([r,n])]=o)}return e}};var ce=__webpack_require__(54);const ue=function(){return this.config},fe=function(e,t){const n=this,r=Object.keys(e);let o;n.parent?o=n.parent:(t=!0,o=n),r.forEach((function(r){t?(o.config[r]=e[r],"toolbar"===r&&(!0===e[r]?o.showToolbar():!1===e[r]&&o.hideToolbar())):n.options[r]=e[r]}))};var de=__webpack_require__(272);const pe=function(){let e=this;!function(e){for(let t=0;t<be;t++){const[n,r]=Ce[t];e[n]=r.bind(e)}}(e),e.table=document.createElement("table"),e.thead=document.createElement("thead"),e.tbody=document.createElement("tbody"),e.headers=[],e.cols=[],e.content=document.createElement("div"),e.content.classList.add("jss_content"),e.content.onscroll=function(t){ne.call(e,t)},e.content.onwheel=function(t){Q.call(e,t)};const t=document.createElement("div"),r=document.createTextNode(jSuites.translate("Search")+": ");e.searchInput=document.createElement("input"),e.searchInput.classList.add("jss_search"),t.appendChild(r),t.appendChild(e.searchInput),e.searchInput.onfocus=function(){e.resetSelection()};const o=document.createElement("div");if(e.options.pagination>0&&e.options.paginationOptions&&e.options.paginationOptions.length>0){e.paginationDropdown=document.createElement("select"),e.paginationDropdown.classList.add("jss_pagination_dropdown"),e.paginationDropdown.onchange=function(){e.options.pagination=parseInt(this.value),e.page(0)};for(let t=0;t<e.options.paginationOptions.length;t++){const n=document.createElement("option");n.value=e.options.paginationOptions[t],n.innerHTML=e.options.paginationOptions[t],e.paginationDropdown.appendChild(n)}e.paginationDropdown.value=e.options.pagination,o.appendChild(document.createTextNode(jSuites.translate("Show "))),o.appendChild(e.paginationDropdown),o.appendChild(document.createTextNode(jSuites.translate("entries")))}const s=document.createElement("div");s.classList.add("jss_filter"),s.appendChild(o),s.appendChild(t),e.colgroupContainer=document.createElement("colgroup");let l=document.createElement("col");if(l.setAttribute("width","50"),e.colgroupContainer.appendChild(l),e.options.nestedHeaders&&e.options.nestedHeaders.length>0&&e.options.nestedHeaders[0]&&e.options.nestedHeaders[0][0])for(let t=0;t<e.options.nestedHeaders.length;t++)e.thead.appendChild(n.UQ.call(e,e.options.nestedHeaders[t]));e.headerContainer=document.createElement("tr"),l=document.createElement("td"),l.classList.add("jss_selectall"),e.headerContainer.appendChild(l);const i=N.call(e);for(let t=0;t<i;t++)S.call(e,t),e.headerContainer.appendChild(e.headers[t]),e.colgroupContainer.appendChild(e.cols[t].colElement);if(e.thead.appendChild(e.headerContainer),1==e.options.filters){e.filter=document.createElement("tr");const t=document.createElement("td");e.filter.appendChild(t);for(let t=0;t<e.options.columns.length;t++){const n=document.createElement("td");n.innerHTML="&nbsp;",n.setAttribute("data-x",t),n.className="jss_column_filter","hidden"==e.options.columns[t].type&&(n.style.display="none"),e.filter.appendChild(n)}e.thead.appendChild(e.filter)}e.table=document.createElement("table"),e.table.classList.add("jss_worksheet"),e.table.setAttribute("cellpadding","0"),e.table.setAttribute("cellspacing","0"),e.table.setAttribute("unselectable","yes"),e.table.appendChild(e.colgroupContainer),e.table.appendChild(e.thead),e.table.appendChild(e.tbody),e.options.textOverflow||e.table.classList.add("jss_overflow"),e.corner=document.createElement("div"),e.corner.className="jss_corner",e.corner.setAttribute("unselectable","on"),e.corner.setAttribute("onselectstart","return false"),0==e.options.selectionCopy&&(e.corner.style.display="none"),e.textarea=document.createElement("textarea"),e.textarea.className="jss_textarea",e.textarea.id="jss_textarea",e.textarea.tabIndex="-1";const a=document.createElement("a");a.setAttribute("href","https://bossanova.uk/jspreadsheet/"),e.ads=document.createElement("div"),e.ads.className="jss_about";const c=document.createElement("span");c.innerHTML="Jspreadsheet CE",a.appendChild(c),e.ads.appendChild(a),document.createElement("div").classList.add("jss_table"),e.pagination=document.createElement("div"),e.pagination.classList.add("jss_pagination");const u=document.createElement("div"),f=document.createElement("div");if(e.pagination.appendChild(u),e.pagination.appendChild(f),e.options.pagination||(e.pagination.style.display="none"),1==e.options.search&&e.element.appendChild(s),e.content.appendChild(e.table),e.content.appendChild(e.corner),e.content.appendChild(e.textarea),e.element.appendChild(e.content),e.element.appendChild(e.pagination),e.element.appendChild(e.ads),e.element.classList.add("jss_container"),e.element.jssWorksheet=e,e.element.jspreadsheet=e,1==e.options.tableOverflow&&(e.options.tableHeight&&(e.content.style["overflow-y"]="auto",e.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",e.content.style.maxHeight="string"==typeof e.options.tableHeight?e.options.tableHeight:e.options.tableHeight+"px"),e.options.tableWidth&&(e.content.style["overflow-x"]="auto",e.content.style.width="string"==typeof e.options.tableWidth?e.options.tableWidth:e.options.tableWidth+"px")),1!=e.options.tableOverflow&&e.parent.config.toolbar&&e.element.classList.add("with-toolbar"),0!=e.options.columnDrag&&e.thead.classList.add("draggable"),0!=e.options.columnResize&&e.thead.classList.add("resizable"),0!=e.options.rowDrag&&e.tbody.classList.add("draggable"),0!=e.options.rowResize&&e.tbody.classList.add("resizable"),e.setData.call(e),e.options.style&&(e.setStyle(e.options.style,null,null,1,1),delete e.options.style),Object.defineProperty(e.options,"style",{enumerable:!0,configurable:!0,get:()=>e.getStyle()}),e.options.comments&&e.setComments(e.options.comments),e.options.classes){const t=Object.keys(e.options.classes);for(let n=0;n<t.length;n++){const r=(0,M.qP)(t[n],!0);e.records[r[1]][r[0]].element.classList.add(e.options.classes[t[n]])}}},he=function(){const e=this;1==e.options.lazyLoading&&1!=e.options.tableOverflow&&1!=e.parent.config.fullscreen&&(e.options.lazyLoading=!1),e.options.columns||(e.options.columns=[]);let t,n=e.options.columns.length;if(e.options.data&&void 0!==e.options.data[0])if(Array.isArray(e.options.data[0])){const t=e.options.data[0].length;t>n&&(n=t)}else t=Object.keys(e.options.data[0]),t.length>n&&(n=t.length);e.options.minDimensions||(e.options.minDimensions=[0,0]),e.options.minDimensions[0]>n&&(n=e.options.minDimensions[0]);const r=[];for(let o=0;o<n;o++)e.options.columns[o]||(e.options.columns[o]={}),!e.options.columns[o].name&&t&&t[o]&&(e.options.columns[o].name=t[o]),"dropdown"==e.options.columns[o].type&&e.options.columns[o].url&&r.push({url:e.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(t){e.options.columns[this.index].source||(e.options.columns[this.index].source=[]);for(let n=0;n<t.length;n++)e.options.columns[this.index].source.push(t[n])}});r.length?jSuites.ajax(r,(function(){pe.call(e)})):pe.call(e)},ge=function(e){const t=/^Sheet(\d+)$/;let n=0;return e.worksheets.forEach((function(e){const r=t.exec(e.options.worksheetName);r&&(n=Math.max(n,parseInt(r[1])))})),"Sheet"+(n+1)},me=async function(){const t=this,n=t.element,r=t.parent;"object"==typeof r.plugins&&Object.entries(r.plugins).forEach((function([,e]){"function"==typeof e.beforeinit&&e.beforeinit(t)})),e.jspreadsheet.current=t,n.setAttribute("tabindex",1),n.addEventListener("focus",(function(n){e.jspreadsheet.current&&!t.selectedCell&&t.updateSelectionFromCoords(0,0,0,0)}));const o=[];if(t.options.csv){const e=new Promise((e=>{jSuites.ajax({url:t.options.csv,method:"GET",dataType:"text",success:function(n){const r=(0,j.parseCSV)(n,t.options.csvDelimiter);if(1==t.options.csvHeaders&&r.length>0){const e=r.shift();if(e.length>0){t.options.columns||(t.options.columns=[]);for(let n=0;n<e.length;n++)t.options.columns[n]||(t.options.columns[n]={}),void 0===t.options.columns[n].title&&(t.options.columns[n].title=e[n])}}t.options.data=r,he.call(t),e()}})}));o.push(e)}else if(t.options.url){const e=new Promise((e=>{jSuites.ajax({url:t.options.url,method:"GET",dataType:"json",success:function(n){t.options.data=n.data?n.data:n,he.call(t),e()}})}));o.push(e)}else he.call(t);await Promise.all(o),"object"==typeof r.plugins&&Object.entries(r.plugins).forEach((function([,e]){"function"==typeof e.init&&e.init(t)}))},ye=function(e){const t=this.parent;e.worksheetName||(e.worksheetName=ge(this.parent));const n={parent:t,options:e,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return t.config.worksheets.push(n.options),t.worksheets.push(n),n},Ce=[["selectAll",A.td],["updateSelectionFromCoords",function(e,t,n,r){return A.Es.call(this,e,t,n,r)}],["resetSelection",function(){return A.yE.call(this)}],["getSelection",A.Mf],["getSelected",A.ey],["getSelectedColumns",A.H7],["getSelectedRows",A.Ym],["getData",function(e,t,n,r){const o=this,s=[];let l=0,i=0;const a=Math.max(...o.options.data.map((function(e){return e.length}))),c=o.options.data.length;for(let n=0;n<c;n++){l=0;for(let r=0;r<a;r++)e&&!o.records[n][r].element.classList.contains("highlight")||(s[i]||(s[i]=[]),s[i][l]=t?o.records[n][r].element.innerHTML:o.options.data[n][r],l++);l>0&&i++}return n?s.map((function(e){return e.join(n)})).join("\r\n")+"\r\n":r?s.map((function(e){const t={};return e.forEach((function(e,n){t[n]=e})),t})):s}],["setData",function(e){const t=this;if(e&&(t.options.data=e),t.options.data||(t.options.data=[]),t.options.data&&t.options.data[0]&&!Array.isArray(t.options.data[0])){e=[];for(let n=0;n<t.options.data.length;n++){const r=[];for(let e=0;e<t.options.columns.length;e++)r[e]=t.options.data[n][t.options.columns[e].name];e.push(r)}t.options.data=e}let r=0,o=0;const s=t.options.columns&&t.options.columns.length||0,l=t.options.data.length,i=t.options.minDimensions[0],a=t.options.minDimensions[1],c=i>s?i:s,u=a>l?a:l;for(r=0;r<u;r++)for(o=0;o<c;o++)null==t.options.data[r]&&(t.options.data[r]=[]),null==t.options.data[r][o]&&(t.options.data[r][o]="");let f,d;for(t.rows=[],t.results=null,t.records=[],t.history=[],t.historyIndex=-1,t.tbody.innerHTML="",1==t.options.lazyLoading?(f=0,d=t.options.data.length<100?t.options.data.length:100,t.options.pagination&&(t.options.pagination=!1)):t.options.pagination?(t.pageNumber||(t.pageNumber=0),t.options.pagination,f=t.options.pagination*t.pageNumber,d=t.options.pagination*t.pageNumber+t.options.pagination,t.options.data.length<d&&(d=t.options.data.length)):(f=0,d=t.options.data.length),r=0;r<t.options.data.length;r++){const e=L.call(t,r,t.options.data[r]);r>=f&&r<d&&t.tbody.appendChild(e.element)}if(1==t.options.lazyLoading||t.options.pagination&&le.Ik.call(t),t.options.mergeCells){const e=Object.keys(t.options.mergeCells);for(let n=0;n<e.length;n++){const r=t.options.mergeCells[e[n]];v.mt.call(t,e[n],r[0],r[1],1)}}n.T0.call(t)}],["getValue",function(e,t){const n=this;let r,o;if("string"!=typeof e)return null;r=(e=(0,M.qP)(e,!0))[0],o=e[1];let s=null;return null!=r&&null!=o&&(n.records[o]&&n.records[o][r]&&t?s=n.records[o][r].element.innerHTML:n.options.data[o]&&"undefined"!=n.options.data[o][r]&&(s=n.options.data[o][r])),s}],["getValueFromCoords",function(e,t,n){const r=this;let o=null;return null!=e&&null!=t&&(r.records[t]&&r.records[t][e]&&n?o=r.records[t][e].element.innerHTML:r.options.data[t]&&"undefined"!=r.options.data[t][e]&&(o=r.options.data[t][e])),o}],["setValue",function(e,o,s){const l=this,i=[];if("string"==typeof e){const t=(0,M.qP)(e,!0),r=t[0],a=t[1];i.push(n.wW.call(l,r,a,o,s)),n.Zz.call(l,r,a,i)}else{let t=null,r=null;if(e&&e.getAttribute&&(t=e.getAttribute("data-x"),r=e.getAttribute("data-y")),null!=t&&null!=r)i.push(n.wW.call(l,t,r,o,s)),n.Zz.call(l,t,r,i);else{const t=Object.keys(e);if(t.length>0)for(let r=0;r<t.length;r++){let t,a;if("string"==typeof e[r]){const n=(0,M.qP)(e[r],!0);t=n[0],a=n[1]}else null!=e[r].x&&null!=e[r].y?(t=e[r].x,a=e[r].y,null!=e[r].value&&(o=e[r].value)):(t=e[r].getAttribute("data-x"),a=e[r].getAttribute("data-y"));null!=t&&null!=a&&(i.push(n.wW.call(l,t,a,o,s)),n.Zz.call(l,t,a,i))}}}r.JB.call(l,{action:"setValue",records:i,selection:l.selectedCell}),n.T0.call(l);const a=i.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(l,"onafterchanges",l,a)}],["setValueFromCoords",function(e,o,s,l){const i=this,a=[];a.push(n.wW.call(i,e,o,s,l)),n.Zz.call(i,e,o,a),r.JB.call(i,{action:"setValue",records:a,selection:i.selectedCell}),n.T0.call(i);const c=a.map((function(e){return{x:e.x,y:e.y,value:e.newValue,oldValue:e.oldValue}}));t.Z.call(i,"onafterchanges",i,c)}],["getWidth",function(e){const t=this;let n;if(void 0===e){n=[];for(let e=0;e<t.headers.length;e++)n.push(t.options.columns&&t.options.columns[e]&&t.options.columns[e].width||t.options.defaultColWidth||100)}else n=parseInt(t.cols[e].colElement.getAttribute("width"));return n}],["setWidth",function(e,t){return T.call(this,e,t)}],["insertRow",function(e,o,s){const l=this;if(0!=l.options.allowInsertRow){let i,a=[];Array.isArray(e)?(i=1,e&&(a=e)):i=void 0!==e?e:1,s=!!s;const c=l.options.data.length-1;(null==o||o>=parseInt(c)||o<0)&&(o=c);const u=[];for(let e=0;e<i;e++){const t=[];for(let e=0;e<l.options.columns.length;e++)t[e]=a[e]?a[e]:"";u.push({row:e+o+(s?0:1),data:t})}if(!1===t.Z.call(l,"onbeforeinsertrow",l,u))return!1;if(l.options.mergeCells&&Object.keys(l.options.mergeCells).length>0&&v.q4.call(l,o,s).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;l.destroyMerge()}if(1==l.options.search){if(l.results&&l.results.length!=l.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;l.resetSearch()}l.results=null}const f=s?o:o+1,d=l.records.splice(f),p=l.options.data.splice(f),h=l.rows.splice(f),g=[],m=[],y=[];for(let e=f;e<i+f;e++){l.options.data[e]=[];for(let t=0;t<l.options.columns.length;t++)l.options.data[e][t]=a[t]?a[t]:"";const t=L.call(l,e,l.options.data[e]);h[0]?Array.prototype.indexOf.call(l.tbody.children,h[0].element)>=0&&l.tbody.insertBefore(t.element,h[0].element):Array.prototype.indexOf.call(l.tbody.children,l.rows[o].element)>=0&&l.tbody.appendChild(t.element),g.push(l.records[e]),m.push(l.options.data[e]),y.push(t)}Array.prototype.push.apply(l.records,d),Array.prototype.push.apply(l.options.data,p),Array.prototype.push.apply(l.rows,h);for(let e=f;e<l.rows.length;e++)l.rows[e].y=e;for(let e=f;e<l.records.length;e++)for(let t=0;t<l.records[e].length;t++)l.records[e][t].y=e;l.options.pagination>0&&l.page(l.pageNumber),r.JB.call(l,{action:"insertRow",rowNumber:o,numOfRows:i,insertBefore:s,rowRecords:g,rowData:m,rowNode:y}),n.ec.call(l),t.Z.call(l,"oninsertrow",l,u)}}],["moveRow",function(e,t){return O.call(this,e,t)}],["deleteRow",function(e,o){const s=this;if(0!=s.options.allowDeleteRow&&(1==s.options.allowDeletingAllRows||s.options.data.length>1)){if(null==e){const t=A.Ym.call(s);0===t.length?(e=s.options.data.length-1,o=1):(e=t[0],o=t.length)}let l=s.options.data.length-1;(null==e||e>l||e<0)&&(e=l),o||(o=1),e+o>=s.options.data.length&&(o=s.options.data.length-e);const i=[];for(let t=0;t<o;t++)i.push(t+e);if(!1===t.Z.call(s,"onbeforedeleterow",s,i))return!1;if(parseInt(e)>-1){let a=!1;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0)for(let t=e;t<e+o;t++)v.q4.call(s,t,!1).length&&(a=!0);if(a){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}if(1==s.options.search){if(s.results&&s.results.length!=s.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;s.resetSearch()}s.results=null}1!=s.options.allowDeletingAllRows&&l+1===o&&o--;for(let t=e;t<e+o;t++)Array.prototype.indexOf.call(s.tbody.children,s.rows[t].element)>=0&&(s.rows[t].element.className="",s.rows[t].element.parentNode.removeChild(s.rows[t].element));const c=s.records.splice(e,o),u=s.options.data.splice(e,o),f=s.rows.splice(e,o);for(let t=e;t<s.rows.length;t++)s.rows[t].y=t;for(let t=e;t<s.records.length;t++)for(let e=0;e<s.records[t].length;e++)s.records[t][e].y=t;s.options.pagination>0&&s.tbody.children.length!=s.options.pagination&&s.page(s.pageNumber),A.Uv.call(s,1,e,e+o-1),r.JB.call(s,{action:"deleteRow",rowNumber:e,numOfRows:o,insertBefore:1,rowRecords:c,rowData:u,rowNode:f}),n.ec.call(s),t.Z.call(s,"ondeleterow",s,i)}}}],["hideRow",function(e){const t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){t.rows[e].element.style.display="none"}))}],["showRow",function(e){const t=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){t.rows[e].element.style.display=""}))}],["getRowData",function(e,t){return t?this.records[e].map((function(e){return e.element.innerHTML})):this.options.data[e]}],["setRowData",function(e,t,n){const r=this;for(let o=0;o<r.headers.length;o++){const s=(0,M.Ar)([o,e]);null!=t[o]&&r.setValue(s,t[o],n)}}],["getHeight",function(e){const t=this;let n;if(void 0===e){n=[];for(let e=0;e<t.rows.length;e++){const r=t.rows[e].element.style.height;r&&(n[e]=r)}}else"object"==typeof e&&(e=$(e).getAttribute("data-y")),n=t.rows[e].element.style.height;return n}],["setHeight",function(e,t){return R.call(this,e,t)}],["getMerge",v.D8],["setMerge",function(e,t,n){return v.mt.call(this,e,t,n)}],["destroyMerge",function(){return v.tW.call(this)}],["removeMerge",function(e,t){return v.Vg.call(this,e,t)}],["search",function(e){const t=this;if(t.options.filters&&x.aw.call(t),t.resetSelection(),t.pageNumber=0,t.results=[],e){t.searchInput.value!==e&&(t.searchInput.value=e);const n=function(e,n,r){for(let o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(n)>=0||(""+t.records[r][o].element.innerHTML).toLowerCase().search(n)>=0)return!0;return!1},r=function(e){-1==t.results.indexOf(e)&&t.results.push(e)};let o=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=new RegExp(o,"i"),t.options.data.forEach((function(e,s){if(n(e,o,s)){const e=v.q4.call(t,s);if(e.length)for(let n=0;n<e.length;n++){const o=(0,M.qP)(e[n],!0);for(let s=0;s<t.options.mergeCells[e[n]][1];s++)r(o[1]+s)}else r(s)}}))}else t.results=null;n.cW.call(t)}],["resetSearch",function(){const e=this;e.searchInput.value="",e.search(""),e.results=null}],["getHeader",function(e){return this.headers[e].textContent}],["getHeaders",function(e){const t=this,n=[];for(let e=0;e<t.headers.length;e++)n.push(t.getHeader(e));return e?n:n.join(t.options.csvDelimiter)}],["setHeader",function(e,n){const o=this;if(o.headers[e]){const s=o.headers[e].textContent,l=o.options.columns&&o.options.columns[e]&&o.options.columns[e].title||"";n||(n=(0,j.getColumnName)(e)),o.headers[e].textContent=n,o.headers[e].setAttribute("title",n),o.options.columns||(o.options.columns=[]),o.options.columns[e]||(o.options.columns[e]={}),o.options.columns[e].title=n,r.JB.call(o,{action:"setHeader",column:e,oldValue:s,newValue:n}),t.Z.call(o,"onchangeheader",o,parseInt(e),n,l)}}],["getStyle",function(e,t){const n=this;if(e)return e=(0,M.qP)(e,!0),t?n.records[e[1]][e[0]].element.style[t]:n.records[e[1]][e[0]].element.getAttribute("style");{const e={},r=n.options.data[0].length,o=n.options.data.length;for(let s=0;s<o;s++)for(let o=0;o<r;o++){const r=t?n.records[s][o].element.style[t]:n.records[s][o].element.getAttribute("style");r&&(e[(0,M.Ar)([o,s])]=r)}return e}}],["setStyle",function(e,t,n,r){return ie.call(this,e,t,n,r)}],["resetStyle",function(e,t){const n=this,r=Object.keys(e);for(let e=0;e<r.length;e++){const t=(0,M.qP)(r[e],!0);n.records[t[1]]&&n.records[t[1]][t[0]]&&n.records[t[1]][t[0]].element.setAttribute("style","")}n.setStyle(e,null,null,null,t)}],["insertColumn",function(e,o,s,l){const i=this;if(0!=i.options.allowInsertColumn){let a,c=[];Array.isArray(e)?(a=1,e&&(c=e)):a="number"==typeof e?e:1,s=!!s;const u=Math.max(i.options.columns.length,...i.options.data.map((function(e){return e.length})))-1;(null==o||o>=parseInt(u)||o<0)&&(o=u),l||(l=[]);for(let e=0;e<a;e++)l[e]||(l[e]={});const f=[];if(Array.isArray(e)){const t=[];for(let n=0;n<i.options.data.length;n++)t.push(n<e.length?e[n]:"");const n={column:o+(s?0:1),options:Object.assign({},l[0]),data:t};f.push(n)}else for(let t=0;t<e;t++){const e={column:o+t+(s?0:1),options:Object.assign({},l[t])};f.push(e)}if(!1===t.Z.call(i,"onbeforeinsertcolumn",i,f))return!1;if(i.options.mergeCells&&Object.keys(i.options.mergeCells).length>0&&v.D0.call(i,o,s).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;i.destroyMerge()}const d=s?o:o+1;i.options.columns=(0,M.Wc)(i.options.columns,d,l);const p=i.headers.splice(d),h=i.cols.splice(d),g=[],m=[],y=[],C=[],b=[];for(let e=d;e<a+d;e++)S.call(i,e),i.headerContainer.insertBefore(i.headers[e],i.headerContainer.children[e+1]),i.colgroupContainer.insertBefore(i.cols[e].colElement,i.colgroupContainer.children[e+1]),g.push(i.headers[e]),m.push(i.cols[e]);if(i.options.footers)for(let e=0;e<i.options.footers.length;e++){b[e]=[];for(let t=0;t<a;t++)b[e].push("");i.options.footers[e].splice(d,0,b[e])}for(let e=0;e<i.options.data.length;e++){const t=i.options.data[e].splice(d),r=i.records[e].splice(d);C[e]=[],y[e]=[];for(let t=d;t<a+d;t++){const r=c[e]?c[e]:"";i.options.data[e][t]=r;const o=n.kE.call(i,t,e,i.options.data[e][t]);i.records[e][t]={element:o,y:e},i.rows[e]&&i.rows[e].element.insertBefore(o,i.rows[e].element.children[t+1]),i.options.columns&&i.options.columns[t]&&"function"==typeof i.options.columns[t].render&&i.options.columns[t].render(o,r,parseInt(t),parseInt(e),i,i.options.columns[t]),C[e].push(r),y[e].push({element:o,x:t,y:e})}Array.prototype.push.apply(i.options.data[e],t),Array.prototype.push.apply(i.records[e],r)}Array.prototype.push.apply(i.headers,p),Array.prototype.push.apply(i.cols,h);for(let e=d;e<i.cols.length;e++)i.cols[e].x=e;for(let e=0;e<i.records.length;e++)for(let t=0;t<i.records[e].length;t++)i.records[e][t].x=t;if(i.options.nestedHeaders&&i.options.nestedHeaders.length>0&&i.options.nestedHeaders[0]&&i.options.nestedHeaders[0][0])for(let e=0;e<i.options.nestedHeaders.length;e++){const t=parseInt(i.options.nestedHeaders[e][i.options.nestedHeaders[e].length-1].colspan)+a;i.options.nestedHeaders[e][i.options.nestedHeaders[e].length-1].colspan=t,i.thead.children[e].children[i.thead.children[e].children.length-1].setAttribute("colspan",t);let n=i.thead.children[e].children[i.thead.children[e].children.length-1].getAttribute("data-column");n=n.split(",");for(let e=d;e<a+d;e++)n.push(e);i.thead.children[e].children[i.thead.children[e].children.length-1].setAttribute("data-column",n)}r.JB.call(i,{action:"insertColumn",columnNumber:o,numOfColumns:a,insertBefore:s,columns:l,headers:g,cols:m,records:y,footers:b,data:C}),n.ec.call(i),t.Z.call(i,"oninsertcolumn",i,f)}}],["moveColumn",function(e,o){const s=this;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0){let t;if(t=e>o?1:0,v.D0.call(s,e).length||v.D0.call(s,o,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}}if((e=parseInt(e))>(o=parseInt(o))){s.headerContainer.insertBefore(s.headers[e],s.headers[o]),s.colgroupContainer.insertBefore(s.cols[e].colElement,s.cols[o].colElement);for(let t=0;t<s.rows.length;t++)s.rows[t].element.insertBefore(s.records[t][e].element,s.records[t][o].element)}else{s.headerContainer.insertBefore(s.headers[e],s.headers[o].nextSibling),s.colgroupContainer.insertBefore(s.cols[e].colElement,s.cols[o].colElement.nextSibling);for(let t=0;t<s.rows.length;t++)s.rows[t].element.insertBefore(s.records[t][e].element,s.records[t][o].element.nextSibling)}s.options.columns.splice(o,0,s.options.columns.splice(e,1)[0]),s.headers.splice(o,0,s.headers.splice(e,1)[0]),s.cols.splice(o,0,s.cols.splice(e,1)[0]);const l=Math.min(e,o),i=Math.max(e,o);for(let t=0;t<s.rows.length;t++)s.options.data[t].splice(o,0,s.options.data[t].splice(e,1)[0]),s.records[t].splice(o,0,s.records[t].splice(e,1)[0]);for(let e=l;e<=i;e++)s.cols[e].x=e;for(let e=0;e<s.records.length;e++)for(let t=l;t<=i;t++)s.records[e][t].x=t;if(s.options.footers)for(let t=0;t<s.options.footers.length;t++)s.options.footers[t].splice(o,0,s.options.footers[t].splice(e,1)[0]);r.JB.call(s,{action:"moveColumn",oldValue:e,newValue:o}),n.ec.call(s),t.Z.call(s,"onmovecolumn",s,e,o,1)}],["deleteColumn",function(e,o){const s=this;if(0!=s.options.allowDeleteColumn&&s.headers.length>1){if(null==e){const t=s.getSelectedColumns(!0);t.length?(e=parseInt(t[0]),o=parseInt(t.length)):(e=s.headers.length-1,o=1)}const l=s.options.data[0].length-1;(null==e||e>l||e<0)&&(e=l),o||(o=1),o>s.options.data[0].length-e&&(o=s.options.data[0].length-e);const i=[];for(let t=0;t<o;t++)i.push(t+e);if(!1===t.Z.call(s,"onbeforedeletecolumn",s,i))return!1;if(parseInt(e)>-1){let l=!1;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0)for(let t=e;t<e+o;t++)v.D0.call(s,t,!1).length&&(l=!0);if(l){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}const a=s.options.columns?s.options.columns.splice(e,o):void 0;for(let t=e;t<e+o;t++)s.cols[t].colElement.className="",s.headers[t].className="",s.cols[t].colElement.parentNode.removeChild(s.cols[t].colElement),s.headers[t].parentNode.removeChild(s.headers[t]);const c=s.headers.splice(e,o),u=s.cols.splice(e,o),f=[],d=[],p=[];for(let t=0;t<s.options.data.length;t++)for(let n=e;n<e+o;n++)s.records[t][n].element.className="",s.records[t][n].element.parentNode.removeChild(s.records[t][n].element);for(let t=0;t<s.options.data.length;t++)d[t]=s.options.data[t].splice(e,o),f[t]=s.records[t].splice(e,o);for(let t=e;t<s.cols.length;t++)s.cols[t].x=t;for(let t=0;t<s.records.length;t++)for(let n=e;n<s.records[t].length;n++)s.records[t][n].x=n;if(s.options.footers)for(let t=0;t<s.options.footers.length;t++)p[t]=s.options.footers[t].splice(e,o);if(A.Uv.call(s,0,e,e+o-1),s.options.nestedHeaders&&s.options.nestedHeaders.length>0&&s.options.nestedHeaders[0]&&s.options.nestedHeaders[0][0])for(let e=0;e<s.options.nestedHeaders.length;e++){const t=parseInt(s.options.nestedHeaders[e][s.options.nestedHeaders[e].length-1].colspan)-o;s.options.nestedHeaders[e][s.options.nestedHeaders[e].length-1].colspan=t,s.thead.children[e].children[s.thead.children[e].children.length-1].setAttribute("colspan",t)}r.JB.call(s,{action:"deleteColumn",columnNumber:e,numOfColumns:o,insertBefore:1,columns:a,headers:c,cols:u,records:f,footers:p,data:d}),n.ec.call(s),t.Z.call(s,"ondeletecolumn",s,i)}}}],["getColumnData",function(e,t){const n=this,r=[];for(let o=0;o<n.options.data.length;o++)t?r.push(n.records[o][e].element.innerHTML):r.push(n.options.data[o][e]);return r}],["setColumnData",function(e,t,n){const r=this;for(let o=0;o<r.rows.length;o++){const s=(0,M.Ar)([e,o]);null!=t[o]&&r.setValue(s,t[o],n)}}],["whichPage",le.an],["page",le.Md],["download",function(e,t){const n=this;if(0==n.parent.config.allowExport);else{let r="";r+=_.call(n,!1,n.options.csvDelimiter,!0,e,!0,void 0,t);const o=new Blob(["\ufeff"+r],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,(n.options.csvFileName||n.options.worksheetName)+".csv");else{const e=document.createElement("a"),t=URL.createObjectURL(o);e.href=t,e.setAttribute("download",(n.options.csvFileName||n.options.worksheetName)+".csv"),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}}}],["getComments",ae],["setComments",function(e,n){const o=this;let s;s="string"==typeof e?{[e]:n}:e;const l={};Object.entries(s).forEach((function([e,t]){const n=(0,j.getCoordsFromCellName)(e);l[e]=o.records[n[1]][n[0]].element.getAttribute("title"),o.records[n[1]][n[0]].element.setAttribute("title",t||""),t?(o.records[n[1]][n[0]].element.classList.add("jss_comments"),o.options.comments||(o.options.comments={}),o.options.comments[e]=t):(o.records[n[1]][n[0]].element.classList.remove("jss_comments"),o.options.comments&&o.options.comments[e]&&delete o.options.comments[e])})),r.JB.call(o,{action:"setComments",newValue:s,oldValue:l}),t.Z.call(o,"oncomments",o,s,l)}],["orderBy",ce.Xo],["undo",r.Yw],["redo",r.KX],["getCell",n.$S],["getCellFromCoords",n.Sl],["getLabel",n.id],["getConfig",function(){return this.options}],["setConfig",fe],["getMeta",function(e){return de.xZ.call(this,e)}],["setMeta",de.US],["showColumn",function(e){const t=this;Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++){const r=e[n];t.headers[r].style.display="",t.cols[r].colElement.style.display="",t.filter&&t.filter.children.length>r+1&&(t.filter.children[r+1].style.display="");for(let e=0;e<t.options.data.length;e++)t.records[e][r].element.style.display=""}t.options.footers&&D.i.call(t),t.resetSelection()}],["hideColumn",function(e){const t=this;Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++){const r=e[n];t.headers[r].style.display="none",t.cols[r].colElement.style.display="none",t.filter&&t.filter.children.length>r+1&&(t.filter.children[r+1].style.display="none");for(let e=0;e<t.options.data.length;e++)t.records[e][r].element.style.display="none"}t.options.footers&&D.i.call(t),t.resetSelection()}],["showIndex",n.UI],["hideIndex",n.TO],["getWorksheetActive",n.X0],["openEditor",o],["closeEditor",s],["createWorksheet",function(e){const t=this.parent;t.creationThroughJss=!0,ye.call(this,e),t.element.tabs.create(e.worksheetName)}],["openWorksheet",function(e){this.parent.element.tabs.open(e)}],["deleteWorksheet",function(e){const n=this;n.parent.element.tabs.remove(e);const r=n.parent.worksheets.splice(e,1)[0];t.Z.call(n.parent,"ondeleteworksheet",r,e)}],["copy",function(e){e?G():_.call(this,!0)}],["paste",I],["executeFormula",n.pX],["getDataFromRange",function(e,t){const n=this,r=(0,j.getCoordsFromRange)(e),o=[];for(let e=r[1];e<=r[3];e++){o.push([]);for(let s=r[0];s<=r[2];s++)t?o[o.length-1].push(n.records[e][s].element.innerHTML):o[o.length-1].push(n.options.data[e][s])}return o}],["quantiyOfPages",le.ur],["getRange",A.rx],["isSelected",A.VL],["setReadOnly",function(e,t){const n=this;let r;if("string"==typeof e){const t=(0,j.getCoordsFromCellName)(e);r=n.records[t[1]][t[0]]}else{const t=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));r=n.records[o][t]}t?r.element.classList.add("readonly"):r.element.classList.remove("readonly")}],["isReadOnly",function(e,t){if("string"==typeof e&&void 0===t){const n=(0,j.getCoordsFromCellName)(e);[e,t]=n}return this.records[t][e].element.classList.contains("readonly")}],["getHighlighted",A.VD],["dispatch",t.Z],["down",m],["first",w],["last",E],["left",b],["right",p],["up",u],["openFilter",x.B4],["resetFilters",x.aw]],be=Ce.length,we=function(){};we.spreadsheet=async function(r,o,s){if("TABLE"==r.tagName){o||(o={}),o.worksheets||(o.worksheets=[]);const e=(0,j.createFromTable)(r,o.worksheets[0]);o.worksheets[0]=e;const t=document.createElement("div");r.parentNode.insertBefore(t,r),r.remove(),r=t}let l={worksheets:s,config:o,element:r,el:r};return l.contextMenu=document.createElement("div"),l.contextMenu.className="jss_contextmenu",l.getWorksheetActive=n.X0.bind(l),l.fullscreen=n.Gr.bind(l),l.showToolbar=se.bv.bind(l),l.hideToolbar=se.iu.bind(l),l.getConfig=ue.bind(l),l.setConfig=fe.bind(l),l.setPlugins=function(t){l.plugins||(l.plugins={}),"object"==typeof t&&Object.entries(t).forEach((function([t,n]){l.plugins[t]=n.call(e.jspreadsheet,l,{},l.config)}))},l.setPlugins(o.plugins),await async function(e,n,r){let o=n.worksheets;if(!o)throw new Error("JSS: worksheets are not defined");{let l={animation:!0,onbeforecreate:function(t,n){return n||ge(e)},oncreate:function(r,o){if(e.creationThroughJss)e.creationThroughJss=!1;else{const t=r.tabs.headers.children[r.tabs.headers.children.length-2].innerHTML;ye.call(e.worksheets[0],{minDimensions:[10,15],worksheetName:t})}const s=e.worksheets[e.worksheets.length-1];s.element=o,me.call(s).then((function(){(0,se.yf)(s),t.Z.call(s,"oncreateworksheet",s,n,e.worksheets.length-1)}))},onchange:function(t,n,r){0!=e.worksheets.length&&e.worksheets[r]&&(0,se.yf)(e.worksheets[r])}};if(1==n.tabs?l.allowCreate=!0:l.hideHeaders=l.hideHeaders,l.data=[],"object"==typeof n.tabs)for(var s in n.tabs)l[s]=n.tabs[s];let i=1;for(let e=0;e<o.length;e++)o[e].worksheetName||(o[e].worksheetName="Sheet"+i++),l.data.push({title:o[e].worksheetName,content:""});r.classList.add("jss_spreadsheet");const a=jSuites.tabs(r,l);for(let t=0;t<o.length;t++)e.worksheets.push({parent:e,element:a.content.children[t],options:o[t],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await me.call(e.worksheets[t])}}(l,o,r),l.element.appendChild(l.contextMenu),jSuites.contextmenu(l.contextMenu,{onclick:function(){l.contextMenu.contextmenu.close(!1)}}),1==l.config.fullscreen&&l.element.classList.add("fullscreen"),se.bv.call(l),o.root?re(o.root):re(document),r.spreadsheet=l,l},we.worksheet=function(e,t,n){let r={parent:e,options:{}};return void 0===n?e.worksheets.push(r):e.worksheets.splice(n,0,r),Object.assign(r.options,t),r};var Ee=we;e.jspreadsheet=function(n,r){try{let o=[];return Ee.spreadsheet(n,r,o).then((n=>{e.jspreadsheet.spreadsheet.push(n),t.Z.call(n,"onload",n)})),o}catch(e){}},e.jspreadsheet.getWorksheetInstanceByName=function(t,n){const r=e.jspreadsheet.spreadsheet.find((e=>e.config.namespace===n));if(r)return{};if(null==t){const e=r.worksheets.map((e=>[e.options.worksheetName,e]));return Object.fromEntries(e)}return r.worksheets.find((e=>e.options.worksheetName===t))},e.jspreadsheet.setDictionary=function(e){jSuites.setDictionary(e)},e.jspreadsheet.destroy=function(t,n){if(t.spreadsheet){const r=e.jspreadsheet.spreadsheet.indexOf(t.spreadsheet);e.jspreadsheet.spreadsheet.splice(r,1);const o=t.spreadsheet.config.root||document;t.spreadsheet=null,t.innerHTML="",n&&oe(o)}},e.jspreadsheet.destroyAll=function(){for(let t=0;t<e.jspreadsheet.spreadsheet.length;t++){const n=e.jspreadsheet.spreadsheet[t];e.jspreadsheet.destroy(n.element)}},e.jspreadsheet.current=null,e.jspreadsheet.spreadsheet=[],e.jspreadsheet.helpers={},e.jspreadsheet.version=function(){return F},Object.entries(j).forEach((([t,n])=>{e.jspreadsheet.helpers[t]=n}));var ve=e.jspreadsheet}(),jspreadsheet=__webpack_exports__.default}(),jspreadsheet}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jSuites=t()}(this,(function(){var e;return function(){var t={195:function(e){e.exports=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,i,o,a,s,r,l,d,c,u,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64),m=8;function v(e){return unescape(encodeURIComponent(e))}function g(e){for(var t=[],n=(1<<m)-1,i=e.length*m,o=0;o<i;o+=m)t[o>>5]|=(e.charCodeAt(o/m)&n)<<32-m-o%32;return t}function y(e){for(var t,n="0123456789abcdef",i="",o=4*e.length,a=0;a<o;a+=1)t=e[a>>2]>>8*(3-a%4),i+=n.charAt(t>>4&15)+n.charAt(15&t);return i}function b(e,n){var i,o,a;return i=(65535&e.lowOrder)+(65535&n.lowOrder),a=(65535&(o=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(o>>>16),new t((65535&(o=(e.highOrder>>>16)+(n.highOrder>>>16)+(i>>>16)))<<16|65535&i,a)}function x(e,n,i,o){var a,s,r;return a=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder)+(65535&o.lowOrder),r=(65535&(s=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(o.lowOrder>>>16)+(a>>>16)))<<16|65535&a,a=(65535&e.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(65535&o.highOrder)+(s>>>16),new t((65535&(s=(e.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(o.highOrder>>>16)+(a>>>16)))<<16|65535&a,r)}function w(e,n,i,o,a){var s,r,l;return s=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder)+(65535&o.lowOrder)+(65535&a.lowOrder),l=(65535&(r=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(o.lowOrder>>>16)+(a.lowOrder>>>16)+(s>>>16)))<<16|65535&s,s=(65535&e.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(65535&o.highOrder)+(65535&a.highOrder)+(r>>>16),new t((65535&(r=(e.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(o.highOrder>>>16)+(a.highOrder>>>16)+(s>>>16)))<<16|65535&s,l)}function L(e,n,i){return new t(e.highOrder&n.highOrder^e.highOrder&i.highOrder^n.highOrder&i.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&i.lowOrder^n.lowOrder&i.lowOrder)}function j(e,n,i){return new t(e.highOrder&n.highOrder^~e.highOrder&i.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&i.lowOrder)}function E(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function C(e){var n=E(e,28),i=E(e,34),o=E(e,39);return new t(n.highOrder^i.highOrder^o.highOrder,n.lowOrder^i.lowOrder^o.lowOrder)}function T(e){var n=E(e,14),i=E(e,18),o=E(e,41);return new t(n.highOrder^i.highOrder^o.highOrder,n.lowOrder^i.lowOrder^o.lowOrder)}function k(e){var n=E(e,1),i=E(e,8),o=M(e,7);return new t(n.highOrder^i.highOrder^o.highOrder,n.lowOrder^i.lowOrder^o.lowOrder)}function A(e){var n=E(e,19),i=E(e,61),o=M(e,6);return new t(n.highOrder^i.highOrder^o.highOrder,n.lowOrder^i.lowOrder^o.lowOrder)}function M(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var N=(e=v(e)).length*m;(e=g(e))[N>>5]|=128<<24-N%32,e[31+(N+128>>10<<5)]=N;for(var D=0;D<e.length;D+=32){n=p[0],i=p[1],o=p[2],a=p[3],s=p[4],r=p[5],l=p[6],d=p[7];for(var O=0;O<80;O++)h[O]=O<16?new t(e[2*O+D],e[2*O+D+1]):x(A(h[O-2]),h[O-7],k(h[O-15]),h[O-16]),c=w(d,T(s),j(s,r,l),f[O],h[O]),u=b(C(n),L(n,i,o)),d=l,l=r,r=s,s=b(a,c),a=o,o=i,i=n,n=b(c,u);p[0]=b(n,p[0]),p[1]=b(i,p[1]),p[2]=b(o,p[2]),p[3]=b(a,p[3]),p[4]=b(s,p[4]),p[5]=b(r,p[5]),p[6]=b(l,p[6]),p[7]=b(d,p[7])}var I=[];for(D=0;D<p.length;D++)I.push(p[D].highOrder),I.push(p[D].lowOrder);return y(I)}}},n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};!function(){"use strict";i.d(o,{default:function(){return Y}});var t={setDictionary:function(e){document.dictionary||(document.dictionary={});var t=null,n=Object.keys(e);for(t=0;t<n.length;t++)document.dictionary[n[t]]=e[n[t]]},translate:function(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}};var n=function(e,t){if(!0===t)window.jSuitesStateControl=window.jSuitesStateControl.filter((function(e){return null!==e})),setTimeout((function(){window.jSuitesStateControl.push(e)}),0);else{var n=window.jSuitesStateControl.indexOf(e);n>=0&&window.jSuitesStateControl.splice(n,1)}},a={two:function(e){return 1==(e=""+e).length&&(e="0"+e),e},focus:function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),i=e.childNodes[e.childNodes.length-1];t.setStart(i,i.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,n,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(i=(i<<5)-i+n,i|=0);return i},randomColor:function(e){var t=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var n,i,o=[];for(i=0;i<3;i++)n=parseInt(t.substr(2*i,2),16),n=Math.round(Math.min(Math.max(0,n+-.25*n),255)).toString(16),o.push(("00"+n).substr(n.length));return 1==e?"#"+a.two(o[0].toString(16))+a.two(o[1].toString(16))+a.two(o[2].toString(16)):o},getWindowWidth:function(){var e=window,t=document,n=t.documentElement,i=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||i.clientWidth},getWindowHeight:function(){var e=window,t=document,n=t.documentElement,i=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||i.clientHeight},getPosition:function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},click:function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},findElement:function(e,t){var n=!1;return function e(i){i&&!n&&("function"==typeof t?n=t(i):"string"==typeof t&&i.classList&&i.classList.contains(t)&&(n=i)),i.parentNode&&!n&&e(i.parentNode)}(e),n}},s=a;function r(e,t,n){if((e=e.split(".")).length){let i=this,o=null;for(;e.length>1;)if(o=e.shift(),i.hasOwnProperty(o))i=i[o];else{if(void 0===t)return;i[o]={},i=i[o]}if(o=e.shift(),void 0!==t)return!0===n?delete i[o]:i[o]=t,!0;if(i)return i[o]}return!1}function l(e,t){var n={options:{}},i={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},o=null;for(var a in i)t&&t.hasOwnProperty(a)?n.options[a]=t[a]:n.options[a]=i[a];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){let i=t.target;if(3===i.nodeType){if("true"!==i.parentNode.getAttribute("draggable"))return t.preventDefault(),void t.stopPropagation();i=i.parentNode}if("true"===i.getAttribute("draggable")){let a=Array.prototype.indexOf.call(i.parentNode.children,i);o={element:i,o:a,d:a},i.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,i,t),t.dataTransfer.setDragImage(i,0,0)}})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),o&&s(e.target)&&"true"==e.target.getAttribute("draggable")&&o.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(o.element,e.target):e.target.parentNode.insertBefore(o.element,e.target.nextSibling),o.d=Array.prototype.indexOf.call(e.target.parentNode.children,o.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),o&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,o.element,t),o.o<o.d?t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o]):t.target.parentNode.insertBefore(o.element,t.target.parentNode.children[o.o].nextSibling),o.element.style.opacity="",o=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),o&&(o.o!==o.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,o.o,o.d,o.element,t.target,t),o.element.style.opacity="",o=null)}));for(var s=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},r=0;r<e.children.length;r++)e.children[r].hasAttribute("draggable")||e.children[r].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],i=0;i<e.children.length;i++)(t=e.children[i].getAttribute("data-id"))&&n.push(t);return n},e}function d(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,i=function(i){if(null==n){var o=!1,a=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(a==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),o=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(a==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),o=!0),n=setTimeout((function(){n=null}),t.timer),o&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){i()},e.onwheel=function(e){i()},{}}var c,u=((c=function(e,t){if(Array.isArray(e)){var n={instance:[],complete:t};if(e.length>0)for(var i=0;i<e.length;i++)e[i].multiple=n,n.instance.push(c(e[i]));return n}if(e.data||(e.data={}),e.type&&(e.method=e.type),e.method||(e.method="GET"),e.dataType||(e.dataType="json"),e.data){var o=function(e,t){var n=[];if(e){var i=Object.keys(e);if(i.length)for(var a=0;a<i.length;a++){if(t)var s=t+"["+i[a]+"]";else s=i[a];if(e[s]instanceof FileList)n[s]=e[i[a]];else if(null===e[i[a]]||void 0===e[i[a]])n[s]="";else if("object"==typeof e[i[a]])for(var r=o(e[i[a]],s),l=Object.keys(r),d=0;d<l.length;d++)n[l[d]]=r[l[d]];else n[s]=e[i[a]]}}return n},a=o(e.data),s=Object.keys(a);if("GET"==e.method){if(s.length){var r=[];for(i=0;i<s.length;i++)r.push(s[i]+"="+encodeURIComponent(a[s[i]]));e.url.indexOf("?")<0&&(e.url+="?"),e.url+=r.join("&")}}else for(r=new FormData,i=0;i<s.length;i++)if(a[s[i]]instanceof FileList){if(a[s[i]].length)for(var l=0;l<a[s[i]].length;l++)r.append(s[i],a[s[i]][l],a[s[i]][l].name)}else r.append(s[i],a[s[i]])}var d=new XMLHttpRequest;return d.open(e.method,e.url,!0),e.requestedWith?d.setRequestHeader("X-Requested-With",e.requestedWith):!1!==e.requestedWith&&d.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.contentType&&d.setRequestHeader("Content-Type",e.contentType),"POST"===e.method?d.setRequestHeader("Accept","application/json"):"blob"===e.dataType?d.responseType="blob":e.contentType||("json"===e.dataType?d.setRequestHeader("Content-Type","text/json"):"html"===e.dataType&&d.setRequestHeader("Content-Type","text/html")),!0!==e.cache&&(d.setRequestHeader("pragma","no-cache"),d.setRequestHeader("cache-control","no-cache")),!0===e.withCredentials&&(d.withCredentials=!0),"function"==typeof e.beforeSend&&e.beforeSend(d),"function"==typeof c.beforeSend&&c.beforeSend(d),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(d),d.onerror=function(){e.error&&"function"==typeof e.error&&e.error({message:"Network error: Unable to reach the server.",status:0})},d.ontimeout=function(){e.error&&"function"==typeof e.error&&e.error({message:"Request timed out after "+d.timeout+"ms.",status:0})},d.onload=function(){if(d.status>=200&&d.status<300)if("json"===e.dataType)try{var t=JSON.parse(d.responseText);e.success&&"function"==typeof e.success&&e.success(t)}catch(n){e.error&&"function"==typeof e.error&&e.error(n,t)}else t="blob"===e.dataType?d.response:d.responseText,e.success&&"function"==typeof e.success&&e.success(t);else e.error&&"function"==typeof e.error&&e.error(d.responseText,d.status);if(c.queue&&c.queue.length>0&&c.send(c.queue.shift()),c.requests&&c.requests.length){var n=c.requests.indexOf(d);c.requests.splice(n,1),c.requests.length||e.complete&&"function"==typeof e.complete&&e.complete(t),e.group&&c.oncomplete&&"function"==typeof c.oncomplete[e.group]&&(c.pending(e.group)||(c.oncomplete[e.group](),c.oncomplete[e.group]=null)),e.multiple&&e.multiple.instance&&(n=e.multiple.instance.indexOf(d),e.multiple.instance.splice(n,1),e.multiple.instance.length||e.multiple.complete&&"function"==typeof e.multiple.complete&&e.multiple.complete(t))}},d.options=e,d.data=r,!0===e.queue&&c.requests.length>0?c.queue.push(d):c.send(d),d}).send=function(e){e.data?Array.isArray(e.data)?e.send(e.data.join("&")):e.send(e.data):e.send(),c.requests.push(e)},c.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},c.pending=function(e){var t=0,n=c.requests;if(n&&n.length)for(var i=0;i<n.length;i++)e&&e!=n[i].options.group||t++;return t},c.oncomplete={},c.requests=[],c.queue=[],c);var p=function(){const e={loading:{}};return e.loading.show=function(t){e.loading.element||(e.loading.element=document.createElement("div"),e.loading.element.className="jloading"),document.body.appendChild(e.loading.element),t>0&&setTimeout((function(){e.loading.hide()}),1e3*t)},e.loading.hide=function(){e.loading.element&&e.loading.element.parentNode&&document.body.removeChild(e.loading.element)},e.slideLeft=function(e,t,n){1==t?(e.classList.add("jslide-left-in"),setTimeout((function(){e.classList.remove("jslide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-left-out"),setTimeout((function(){e.classList.remove("jslide-left-out"),"function"==typeof n&&n()}),400))},e.slideRight=function(e,t,n){!0===t?(e.classList.add("jslide-right-in"),setTimeout((function(){e.classList.remove("jslide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-right-out"),setTimeout((function(){e.classList.remove("jslide-right-out"),"function"==typeof n&&n()}),400))},e.slideTop=function(e,t,n){!0===t?(e.classList.add("jslide-top-in"),setTimeout((function(){e.classList.remove("jslide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-top-out"),setTimeout((function(){e.classList.remove("jslide-top-out"),"function"==typeof n&&n()}),400))},e.slideBottom=function(e,t,n){!0===t?(e.classList.add("jslide-bottom-in"),setTimeout((function(){e.classList.remove("jslide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-bottom-out"),setTimeout((function(){e.classList.remove("jslide-bottom-out"),"function"==typeof n&&n()}),100))},e.fadeIn=function(e,t){e.style.display="",e.classList.add("jfade-in"),setTimeout((function(){e.classList.remove("jfade-in"),"function"==typeof t&&t()}),2e3)},e.fadeOut=function(e,t){e.classList.add("jfade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("jfade-out"),"function"==typeof t&&t()}),1e3)},e}();var f=function(){var e={now:function(e,t){var n=null,i=null,o=null,a=null,r=null,l=null;return Array.isArray(e)?(n=e[0],i=e[1],o=e[2],a=e[3],r=e[4],l=e[5]):(e||(e=new Date),n=e.getFullYear(),i=e.getMonth()+1,o=e.getDate(),a=e.getHours(),r=e.getMinutes(),l=e.getSeconds()),1==t?s.two(n)+"-"+s.two(i)+"-"+s.two(o):s.two(n)+"-"+s.two(i)+"-"+s.two(o)+" "+s.two(a)+":"+s.two(r)+":"+s.two(l)},toArray:function(e){var t=(n=e.split(-1!==e.indexOf("T")?"T":" "))[1],n=n[0].split("-"),i=parseInt(n[0]),o=parseInt(n[1]),a=parseInt(n[2]),s=0,r=0;return t&&(t=t.split(":"),s=parseInt(t[0]),r=parseInt(t[1])),[i,o,a,s,r,0]}},n=Date.UTC(1900,0,0),i=Date.UTC(1900,1,29),o=864e5;e.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=i&&(t+=o),(t-=n)/o},e.numToDate=function(t){var a=n+t*o;a>=i&&(a-=o);const s=new Date(a);var r=[s.getUTCFullYear(),s.getUTCMonth()+1,s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds()];return e.now(r)};let a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(e,"weekdays",{get:function(){return a.map((function(e){return t.translate(e)}))}}),Object.defineProperty(e,"weekdaysShort",{get:function(){return a.map((function(e){return t.translate(e).substring(0,3)}))}}),Object.defineProperty(e,"months",{get:function(){return r.map((function(e){return t.translate(e)}))}}),Object.defineProperty(e,"monthsShort",{get:function(){return r.map((function(e){return t.translate(e).substring(0,3)}))}}),e}();var h=function(){var t={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var e=0;this.date[4]&&(e=parseFloat(this.date[4]/60));var t=parseInt(this.date[3])+e;t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=s.two(this.date[0])+"-"+s.two(this.date[1])+"-"+s.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]))):t=s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]);return t},i=function(){var e="";if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var t=f.now(this.date);e=f.dateToNum(t),this.date[4]&&(e+=parseFloat(this.date[4]/60))}}else{if(-1!==this.mask.toLowerCase().indexOf("[h]"))e=parseInt(this.date[3]);else{let t=parseInt(this.date[3]);e=t<13&&-1!==this.values.indexOf("PM")?(t+12)%24:t%24}this.date[4]&&(e+=parseFloat(this.date[4]/60)),this.date[5]&&(e+=parseFloat(this.date[5]/3600)),e/=24}return isNaN(e)&&(e=""),e},o=function(e){return null===e||""===e||void 0===e},a=function(e){return"currency"===e||"percentage"===e||"scientific"===e||"numeric"===e},r=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}return e||(e=this.mask),(t=new RegExp("0{1}(.{1})0+","ig").exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=new RegExp("#{1}(.{1})#+","ig").exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},l=function(e,t){if(""==e)return"";t||(t=r.call(this));var n=(e=(""+e).split(t))[0].match(/[-]+/g);return n=!(!n||!n.length),e[0]=e[0].match(/[0-9]+/g),e[0]?(n&&e[0].unshift("-"),e[0]=e[0].join("")):n&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},d=function(e,t){if(""===e)return"";var n=r.call(this),i=this.options;if(""===(e=l.call(this,e)))return"";var o=null;if(e[0]&&(o="percent"===i.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),("-"===e[0]||"-00"===e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var a=new Intl.NumberFormat(this.locale,i).format(o);if(a=a.split(n),"percent"===i.style&&-1!==a[0].indexOf("%")&&(a[0]=a[0].replace("%",""),a[2]="%"),void 0!==a[1]){var s=a[1].replace(/[0-9]*/g,"");s&&(a[2]=s)}return void 0!==e[1]?a[1]=n+e[1]:a[1]="",a.join("")},c=function(e,t){var n=h.call(e);if(n){var i=d.call(this,n,t),o=i.length-n.length,a=p.call(e)+o;h.call(e,i,a,!0)}},u=function(e){var t=l.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},p=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0;if(s=window.getSelection())if(0!==s.rangeCount)(o=(r=s.getRangeAt(0)).cloneRange()).selectNodeContents(this),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length;return n}return this.selectionStart}var i=h.call(this);if(t){for(var o=null,a=0;a<i.length;a++)(i[a].match(/[\-0-9]/g)||"."===i[a]||","===i[a])&&(o=a);null===o&&(o=i.indexOf(" ")),e>=o&&(e=o+1)}if(e>i.length&&(e=i.length),e)if("DIV"==this.tagName){var s=window.getSelection(),r=document.createRange();this.childNodes[0]&&(r.setStart(this.childNodes[0],e),s.removeAllRanges(),s.addRange(r))}else this.selectionStart=e,this.selectionEnd=e},h=function(e,t,n){if("DIV"==this.tagName){if(void 0===e){e=this.innerText;return this.value&&this.value.length>e.length&&(e=this.value),e}this.innerText!==e&&(this.innerText=e,t&&p.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&p.call(this,t,n))}},m=f.weekdays,v=f.weekdaysShort,g=f.months,y=f.monthsShort,b={YEAR:function(e,t){var n=""+(new Date).getFullYear();if(void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t){if(2==t)n=n.substr(0,2)+this.values[this.index];else if(3==t)n=n.substr(0,1)+this.values[this.index];else if(4==t)n=this.values[this.index];this.date[0]=n,this.index++}},YYYY:function(e){b.YEAR.call(this,e,4)},YYY:function(e){b.YEAR.call(this,e,3)},YY:function(e){b.YEAR.call(this,e,2)},FIND:function(e,t){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1)this.values[this.index]+=e;else{for(var n=0,i=0,a=(this.values[this.index]+e).toLowerCase(),s=0;s<t.length;s++)0==t[s].toLowerCase().indexOf(a)&&(n=s,i++);if(i>1)this.values[this.index]+=e;else if(1==i){var r=t[n].length-this.values[this.index].length-1;return this.position+=r,this.values[this.index]=t[n],this.index++,n}}},MMM:function(e){var t=b.FIND.call(this,e,y);void 0!==t&&(this.date[1]=t+1)},MON:function(e){b.MMM.call(this,e)},MMMM:function(e){var t=b.FIND.call(this,e,g);void 0!==t&&(this.date[1]=t+1)},MONTH:function(e){b.MMMM.call(this,e)},MMMMM:function(e){o(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<g.length;n++)if(0==g[n][0].toLowerCase().indexOf(t)){this.values[this.index]=g[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10)if(o(this.values[this.index]))this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++);else if(1==this.values[this.index]&&parseInt(e)<3)this.date[1]=this.values[this.index]+=e,this.index++;else if(0==this.values[this.index]&&parseInt(e)>0)this.date[1]=this.values[this.index]+=e,this.index++;else t=!0;else t=!0;if(1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10)if(o(this.values[this.index]))this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++);else if(3==this.values[this.index]&&parseInt(e)<2)this.date[2]=this.values[this.index]+=e,this.index++;else if(1==this.values[this.index]||2==this.values[this.index])this.date[2]=this.values[this.index]+=e,this.index++;else if(0==this.values[this.index]&&parseInt(e)>0)this.date[2]=this.values[this.index]+=e,this.index++;else t=!0;else t=!0;if(1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){o(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){b.FIND.call(this,e,v)},DY:function(e){b.DDD.call(this,e)},DDDD:function(e){b.FIND.call(this,e,m)},DAY:function(e){b.DDDD.call(this,e)},HH12:function(e,t){o(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){b.HH24.call(this,e,1)},H:function(e){b.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){b.N60.call(this,e,4)},SS:function(e){b.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=r.call(this),n=!1;o(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var i=l.call(this,this.values[this.index],t);i&&(this.values[this.index]=i.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(e){b["0{1}(.{1}0+)?"].call(this,e)},"0{1}(.{1}0+)?%":function(e){b["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){b["0{1}(.{1}0+)?"].call(this,e);var t=r.call(this),n=this.tokens[this.index].substr(1,1),i="-"===this.values[this.index][0],o=l.call(this,this.values[this.index],t);if(""!==o){var a=o[0].match(/[0-9]/g);if(a){for(var s=[],d=0,c=(a=a.join("")).length-1;c>=0;c--)s.push(a[c]),++d%3||s.push(n);s=s.reverse(),o[0]=s.join(""),o[0].substr(0,1)==n&&(o[0]=o[0].substr(1))}else o[0]="";this.values[this.index]=o.join(t),i&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){o(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){b["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},x=function(e){if("general"==this.type)var n=[].concat(t.general);else n=[].concat(t.currency,t.datetime,t.percentage,t.scientific,t.numeric,t.text,t.general);var i=new RegExp(n.join("|"),"gi");return e.match(i)},w=function(e){if(this.type)if("text"==this.type)n=["text"];else if("general"==this.type)n=["general"];else if("datetime"==this.type)n=["numeric","datetime","general"];else n=["currency","percentage","scientific","numeric","general"];else var n=Object.keys(t);for(var i=0;i<n.length;i++)for(var o=n[i],a=0;a<t[o].length;a++){var s=new RegExp(t[o][a],"gi");if(e.match(s))return{type:o,method:t[o][a]}}},L=function(e){for(var t=[],n=0;n<e.length;n++){var i=w.call(this,e[n]);i?t.push(i.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},j=function(e){var t=w.call(this,e);if(t)var n=t.type;if(n){for(var i=0,o=x.call(this,e),s=0;s<o.length;s++)(t=w.call(this,o[s]))&&a(t.type)&&i++;i>1&&(n="general")}return n},E=function(){"function"==typeof b[this.methods[this.index]]?(b[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},C=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,i,o){return o<0?t+"0."+Array(1-o-n.length).join(0)+n+i:t+n+i+Array(o-i.length+1).join(0)}))},T=function(e,t,i){var o=null,l={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(l.input=e.target,l.value=h.call(e.target),l.caret=p.call(e.target),(o=e.target.getAttribute("data-mask"))&&(l.mask=o),(o=e.target.getAttribute("data-type"))&&(l.type=o),e.target.mask?(e.target.mask.options&&(l.options=e.target.mask.options),e.target.mask.locale&&(l.locale=e.target.mask.locale)):(o=e.target.getAttribute("data-locale"))&&(l.locale=o,l.mask&&(l.options.style=l.mask)),e.target.attributes&&e.target.attributes.length)for(var f=0;f<e.target.attributes.length;f++){var m=e.target.attributes[f].name,v=e.target.attributes[f].value;"data"==m.substr(0,4)&&(l.options[m.substr(5)]=v)}}else{if("string"==typeof t)l.mask=t;else for(m=Object.keys(t),f=0;f<m.length;f++)l[m[f]]=t[m[f]];"number"==typeof e&&(r.call(l,l.mask),e=(""+e).replace(".",l.options.decimal)),l.value=e,l.input&&(h.call(l.input,e),s.focus(l.input),l.caret=p.call(l.input))}if("="!=(""+l.value)[0]&&(l.mask||l.locale)){if(l.mask){if(l.mask=l.mask.replace(new RegExp(/\[h]/),"|h|"),l.mask=l.mask.replace(new RegExp(/\[.*?\]/),""),l.mask=l.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==l.mask.indexOf(";")){o=l.mask.split(";");l.mask=o[0]}var g;if(-1!==l.mask.indexOf("##"))(g=l.mask.split(";"))[0]&&("object"==typeof e&&(g[0]=g[0].replace(new RegExp(/_\)/g),""),g[0]=g[0].replace(new RegExp(/_\(/g),"")),g[0]=g[0].replace("*","\t"),g[0]=g[0].replace(new RegExp(/_-/g),""),g[0]=g[0].replace(new RegExp(/_/g),""),g[0]=g[0].replace(new RegExp(/"/g),""),g[0]=g[0].replace("##0.###","##0.000"),g[0]=g[0].replace("##0.##","##0.00"),g[0]=g[0].replace("##0.#","##0.0"),g[0]=g[0].replace("##0,###","##0,000"),g[0]=g[0].replace("##0,##","##0,00"),g[0]=g[0].replace("##0,#","##0,0")),l.mask=g[0];if(-1!==l.mask.indexOf("\\"))(g=l.mask.split(";"))[0]=g[0].replace(new RegExp(/\\/g),""),l.mask=g[0];l.type||(l.type=j.call(l,l.mask)),l.tokens=x.call(l,l.mask)}if("object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(l.locale)if(l.input)c.call(l,l.input,e);else var y=d.call(l,l.value);else{for(l.methods=L.call(l,l.tokens),l.event=e;l.position<l.value.length&&void 0!==l.tokens[l.index];)E.call(l);y=l.values.join("");if(a(l.type)&&""!==y){for(;void 0!==l.tokens[l.index];){(o=w.call(l,l.tokens[l.index]))&&"general"==o.type&&(l.values[l.index]=l.tokens[l.index]),l.index++}var b=!0}else b=!1;if(y=l.values.join(""),l.input){if((o=y.length-l.value.length)>0)var C=l.caret+o;else C=l.caret;h.call(l.input,y,C,b)}}if(l.input){var k=null;if(a(l.type)){let e=h.call(l.input);l.number=u.call(l,e),k="percentage"==l.type&&-1!==(""+e).indexOf("%")?T.adjustPrecision(l.number/100):l.number}else"datetime"==l.type&&(k=n.call(l),l.date[0]&&l.date[1]&&l.date[2]&&l.input.setAttribute("data-completed",!0));k&&l.input.setAttribute("data-value",k)}if(void 0!==y)return i?l:y}};return T.adjustPrecision=function(e){if("number"==typeof e&&!Number.isInteger(e)){const t=e.toString().split(".");if(t[1]&&t[1].length>10){let n=0;const i=t[1][t[1].length-2];if(0==i||9==i){for(let e=t[1].length-2;e>0;e--){if(!(n>=0&&t[1][e]==i)){n=0;break}if(n++,n>6)break}if(n)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e},T.getType=j,T.prepare=function(e,t){return t||(t={}),x.call(t,e)},T.apply=function(e){var t=h.call(e.target);1==e.key.length&&(t+=e.key),h.call(e.target,T(t,e.target.getAttribute("data-mask")))},T.run=function(e,t,n){return T(e,{mask:t,decimal:n})},T.extract=function(e,t,n){if(o(e))return e;if("object"!=typeof t)return e;if((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask){if(-1!==t.mask.indexOf(";")){var a=t.mask.split(";");t.mask=a[0]}t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")}r.call(t,t.mask);var l=null,d=null;if("percent"==t.type||"percent"==t.options.style?l="percentage":t.mask&&(l=j.call(t,t.mask)),"text"===l){var c={};d=e}else if("general"===l){c=T(e,t,!0);d=e}else if("datetime"===l){e instanceof Date&&(e=T.getDateString(e,t.mask));c=T(e,t,!0);d=s.isNumeric(e)?e:i.call(c)}else if("scientific"===l){d=e,"string"==typeof e&&(d=Number(d));c=t}else{d=u.call(t,e),"percentage"===l&&-1!==(""+e).indexOf("%")&&(d/=100);c=t}return c.value=d,!c.type&&l&&(c.type=l),n?c:d},T.render=function(t,n,i,a){if(o(t))return t;if("object"!=typeof n)return t;if((n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),n.mask){if(-1!==n.mask.indexOf(";")){var s=n.mask.split(";");i||(s[0]=s[0].replace(new RegExp(/_\)/g),""),s[0]=s[0].replace(new RegExp(/_\(/g),"")),n.mask=s[0]}n.mask=n.mask.replace(new RegExp(/\[h]/),"|h|"),n.mask=n.mask.replace(new RegExp(/\[.*?\]/),""),n.mask=n.mask.replace(new RegExp(/\|h\|/),"[h]")}var l=null;"percent"==n.type||"percent"==n.options.style?l="percentage":n.mask?l=j.call(n,n.mask):t instanceof Date&&(l="datetime");var d=!1;if("datetime"==l||"calendar"==n.type)(s=T.getDateString(t,n.mask))&&(t=s),n.mask&&i&&(d=!0);else if("text"===l);else if("string"==typeof t&&e.isNumeric(t)&&(t=Number(t)),"percentage"===l&&(t=T.adjustPrecision(100*t)),"number"==typeof t){s=null;if(n.mask&&i){var c=r.call(n,n.mask);if("scientific"===l)if(-1!==n.mask.indexOf(c)){let e=n.mask.split("E");e=e[0].split(c),e=""+e[1].match(/[0-9]+/g),e=e.length,s=t.toExponential(e)}else s=t.toExponential(0);else{if(-1!==n.mask.indexOf(c)){c=(c=""+(c=n.mask.split(c))[1].match(/[0-9]+/g)).length,s=t.toFixed(c);let e=t.toString().split("."),i=e[1];i&&i.length>c&&"5"===i[i.length-1]&&(s=parseFloat(e[0]+"."+i+"1").toFixed(c))}else-1!==t.toString().indexOf(c)&&(s=t.toFixed(0));-1!==(""+s).indexOf("e")&&(s=C(s))}}else if(n.locale&&i){c=(""+t).split(".");if(n.options){void 0===c[1]&&(c[1]="");var u=c[1].length;if(n.options.minimumFractionDigits>u)for(var p=0;p<n.options.minimumFractionDigits-u;p++)c[1]+="0"}s=c[1].length?c.join("."):c[0];u=c[1].length;n.options&&n.options.maximumFractionDigits<u&&(s=parseFloat(s).toFixed(n.options.maximumFractionDigits))}else s=C(t);null!==s&&(t=s,r.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))}else n.mask&&i&&(d=!0);if(d){var f=n.mask.length-t.length;if(f>0)for(p=0;p<f;p++)t+=" "}if("scientific"===l){if(i)return t;t=C(t)}if("numeric"===l&&!1===a&&"string"==typeof t)return t;if(t=T(t,n),i&&"numeric"===l){var h=n.mask.match(new RegExp(/^[0]+$/gm));if(h&&1===h.length){var m=h[0].length;if(m>3)for(t=""+t;t.length<m;)t="0"+t}}return t},T.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},T.extractDateFromString=function(e,t){var n=T(e,{mask:t},!0);if(e>0&&Number(e)==e&&(n.values.join("")!==n.value||"numeric"==n.type)){var i=new Date(Math.round(86400*(e-25569)*1e3));return i.getFullYear()+"-"+s.two(i.getMonth())+"-"+s.two(i.getDate())+" 00:00:00"}var o=!1;return n.values&&n.values.length===n.tokens.length&&n.values[n.values.length-1].length>=n.tokens[n.tokens.length-1].length&&(o=!0),n.date[0]&&n.date[1]&&(n.date[2]||o)?(n.date[2]||(n.date[2]=1),n.date[0]+"-"+s.two(n.date[1])+"-"+s.two(n.date[2])+" "+s.two(n.date[3])+":"+s.two(n.date[4])+":"+s.two(n.date[5])):""},T.getDateString=function(e,t){if(!t)t={};if(t&&"object"==typeof t){if(t.format)var n=t.format;else if(t.mask)n=t.mask}else n=t;if(n||(n="YYYY-MM-DD"),n.indexOf("[h]")>=0){var i=0;if(e&&s.isNumeric(e)&&(i=parseFloat(24*Number(e)),n.indexOf("mm")>=0)){if((u=(""+i).split("."))[1]){var o=60*parseFloat("0."+u[1]);o=parseFloat(o.toFixed(2))}else o=0;i=parseInt(u[0])+":"+s.two(o)}return i}e instanceof Date?e=f.now(e):e&&s.isNumeric(e)&&(e=f.numToDate(e));for(var a=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),r=n.match(a),l=0;l<r.length;l++)"MM"==r[l].toUpperCase()&&(r[l-1]&&r[l-1].toUpperCase().indexOf("H")>=0||r[l-2]&&r[l-2].toUpperCase().indexOf("H")>=0||r[l+1]&&r[l+1].toUpperCase().indexOf("S")>=0||r[l+2]&&r[l+2].toUpperCase().indexOf("S")>=0)&&(r[l]="mi");var d={tokens:r};if(e){var c=-1!==(o=""+e).indexOf("T")?"T":" ",u=0,p=0,h=0;(o=o.split(c))[1]&&(p=(u=o[1].split(":"))[1]?u[1]:0,h=u[2]?u[2]:0,u=u[0]?u[0]:0),o=o[0].split("-");let t=new Date(o[0],o[1],0).getDate();if(o[0]&&o[1]&&o[2]&&o[0]>0&&o[1]>0&&o[1]<13&&o[2]>0&&o[2]<=t){d.data=[o[0],o[1],o[2],u,p,h],d.value=[];var m=new Date(d.data[0],d.data[1]-1,d.data[2],d.data[3],d.data[4],d.data[5]),v=function(e){var t=this.tokens[e],n=t.toUpperCase(),i=null;"YYYY"===n?i=this.data[0]:"YYY"===n?i=this.data[0].substring(1,4):"YY"===n?i=this.data[0].substring(2,4):"Y"===n?i=this.data[0].substring(3,4):"MON"===t?i=f.months[m.getMonth()].substr(0,3).toUpperCase():"mon"===t?i=f.months[m.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?i=f.months[m.getMonth()].toUpperCase():"month"===t?i=f.months[m.getMonth()].toLowerCase():"MMMMM"===n?i=f.months[m.getMonth()].substr(0,1):"MMMM"===n||"Month"===t?i=f.months[m.getMonth()]:"MMM"===n||"Mon"==t?i=f.months[m.getMonth()].substr(0,3):"MM"===n?i=s.two(this.data[1]):"M"===n?i=m.getMonth()+1:"DAY"===t?i=f.weekdays[m.getDay()].toUpperCase():"day"===t?i=f.weekdays[m.getDay()].toLowerCase():"DDDD"===n||"Day"==t?i=f.weekdays[m.getDay()]:"DDD"===n?i=f.weekdays[m.getDay()].substr(0,3):"DD"===n?i=s.two(this.data[2]):"D"===n?i=parseInt(this.data[2]):"Q"===n?i=Math.floor((m.getMonth()+3)/3):"HH24"===n||"HH"===n?((i=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(i-=12),i=s.two(i)):"HH12"===n?i=this.data[3]>12?s.two(this.data[3]-12):s.two(this.data[3]):"H"===n?(i=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(i-=12,i=s.two(i)):"MI"===n?i=s.two(this.data[4]):"SS"===n?i=s.two(this.data[5]):"MS"===n?i=m.getMilliseconds():"AM/PM"===n?i=this.data[3]>=12?"PM":"AM":"WD"===n&&(i=f.weekdays[m.getDay()]),this.value[e]=null===i?this.tokens[e]:i};for(l=0;l<d.tokens.length;l++)v.call(d,l);e=d.value.join("")}else e=""}return e},T}();var m=function(){var e=function(i,o){if(i.calendar)return i.calendar.setOptions(o,!0);var a={type:"calendar",options:{},date:null,setOptions:function(n,o){var r={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:f.monthsShort,monthsFull:f.months,weekdays:f.weekdays,textDone:t.translate("Done"),textReset:t.translate("Reset"),textUpdate:t.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var l in r)n&&n.hasOwnProperty(l)?a.options[l]=n[l]:void 0!==a.options[l]&&!0!==o||(a.options[l]=r[l]);if(0==a.options.resetButton?u.style.display="none":u.style.display="",a.options.readonly?i.setAttribute("readonly","readonly"):i.removeAttribute("readonly"),a.options.placeholder?i.setAttribute("placeholder",a.options.placeholder):i.removeAttribute("placeholder"),s.isNumeric(a.options.value)&&a.options.value>0&&(a.options.value=e.numToDate(a.options.value),a.options.dataType="numeric"),u.innerHTML=a.options.textReset,h.innerHTML=a.options.textDone,E.innerHTML=a.options.textUpdate,a.options.format&&i.setAttribute("data-mask",a.options.format.toLowerCase()),!a.options.value&&a.options.today)var d=e.now();else d=a.options.value;return d&&(a.options.value=null,a.setValue(d)),a},open:function(t){if(!c.classList.contains("jcalendar-focus")&&!c.classList.contains("jcalendar-inline")){if(e.current=a,n(a,!0),a.getDays(),"year-month-picker"==a.options.type&&a.getMonths(),a.options.time&&(C.value=a.date[3],T.value=a.date[4]),c.classList.add("jcalendar-focus"),s.getWindowWidth()<800||a.options.fullscreen)c.classList.add("jcalendar-fullsize"),p.slideBottom(v,1);else{c.classList.remove("jcalendar-fullsize");var o=i.getBoundingClientRect(),r=v.getBoundingClientRect();if(a.options.position)m.style.position="fixed",window.innerHeight<o.bottom+r.height?m.style.top=o.top-(r.height+2)+"px":m.style.top=o.top+o.height+2+"px",m.style.left=o.left+"px";else{if(window.innerHeight<o.bottom+r.height)(l=-1*(o.height+r.height+2))+o.top<0&&(l=-1*(o.top+o.height)),m.style.top=l+"px";else m.style.top="2px";if(window.innerWidth<o.left+r.width){var l=window.innerWidth-(o.left+r.width+20);m.style.left=l+"px"}else m.style.left="0px"}}"function"==typeof a.options.onopen&&a.options.onopen(i)}},close:function(t,o){if(!0!==a.options.autoSelect&&void 0===o&&(o=!1),c.classList.contains("jcalendar-focus")){if(!1!==o){var s=c.querySelector(".jcalendar-selected");if("string"==typeof o)var r=o;else if(!s||s.classList.contains("jcalendar-disabled"))r=a.options.value;else r=a.getValue();a.setValue(r)}else{let e=a.options.value||"";a.options.value=null,a.setValue(e)}t||"function"!=typeof a.options.onclose||a.options.onclose(i),c.classList.remove("jcalendar-focus"),n(a,!1),e.current=null}return a.options.value},prev:function(){"years"==a.options.mode?(a.date[0]=a.date[0]-12,a.getYears()):"months"==a.options.mode?(a.date[0]=parseInt(a.date[0])-1,a.getMonths()):(a.date[1]<2?(a.date[0]=a.date[0]-1,a.date[1]=12):a.date[1]=a.date[1]-1,a.getDays())},next:function(){"years"==a.options.mode?(a.date[0]=parseInt(a.date[0])+12,a.getYears()):"months"==a.options.mode?(a.date[0]=parseInt(a.date[0])+1,a.getMonths()):(a.date[1]>11?(a.date[0]=parseInt(a.date[0])+1,a.date[1]=1):a.date[1]=parseInt(a.date[1])+1,a.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return a.setValue(e),e},setValue:function(n){n||(n=""+n);var o=n,s=a.options.value;if(s!=o){if(o){a.setLabel(o,a.options);(l=o.split(" "))[1]||(l[1]="00:00:00");var r=l[1].split(":"),l=l[0].split("-"),d=parseInt(l[0]),c=parseInt(l[1]),u=parseInt(l[2]),p=parseInt(r[0]),f=parseInt(r[1]);a.date=[d,c,u,p,f,0];n=a.setLabel(o,a.options);var h=e.now(new Date(d,c-1,u),!0);if(a.options.validRange){if(!a.options.validRange[0]||h>=a.options.validRange[0])var m=!0;else m=!1;if(!a.options.validRange[1]||h<=a.options.validRange[1])var v=!0;else v=!1;m&&v?(i.classList.remove("jcalendar_warning"),i.title=""):(i.classList.add("jcalendar_warning"),i.title=t.translate("Date outside the valid range"))}else i.classList.remove("jcalendar_warning"),i.title=""}else{a.date=null;var n="";i.classList.remove("jcalendar_warning"),i.title=""}a.options.value=o,"function"==typeof a.options.onchange&&a.options.onchange(i,o,s),i.value!=n&&(i.value=n,"function"==typeof i.oninput&&i.oninput({type:"input",target:i,value:i.value}))}a.date&&(a.getDays(),"year-month-picker"==a.options.type&&a.getMonths())},getValue:function(){return a.date?a.options.time?s.two(a.date[0])+"-"+s.two(a.date[1])+"-"+s.two(a.date[2])+" "+s.two(a.date[3])+":"+s.two(a.date[4])+":"+s.two(0):s.two(a.date[0])+"-"+s.two(a.date[1])+"-"+s.two(a.date[2])+" "+s.two(0)+":"+s.two(0)+":"+s.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=c.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(a.date[1]=t,a.date[2]=1):a.date[2]=e.innerText,a.options.time?(a.date[3]=C.value,a.date[4]=T.value):a.close(null,!0)}d()},reset:function(){a.setValue(""),a.date=null,a.close(!1,!1)},getDays:function(){a.options.mode="days";var t=new Date,n=a.date&&s.isNumeric(a.date[0])?a.date[0]:parseInt(t.getFullYear()),i=a.date&&s.isNumeric(a.date[1])?a.date[1]:parseInt(t.getMonth())+1,o=a.date&&s.isNumeric(a.date[2])?a.date[2]:parseInt(t.getDate()),r=a.date&&s.isNumeric(a.date[3])?a.date[3]:parseInt(t.getHours()),l=a.date&&s.isNumeric(a.date[4])?a.date[4]:parseInt(t.getMinutes());a.date=[n,i,o,r,l,0],g.innerHTML=n,y.innerHTML=a.options.months[i-1];var c=t.getMonth()==i-1&&t.getFullYear()==n,u=t.getDate(),p=(t=new Date(n,i,0,0,0)).getDate(),f=(t=new Date(n,i-1,0,0,0)).getDay()+1;f-=m=a.options.startingDay||0,x.innerHTML="",(w=document.createElement("tr")).setAttribute("align","center"),x.appendChild(w);for(var h=0;h<7;h++){(j=document.createElement("td")).classList.add("jcalendar-weekday"),j.innerHTML=a.options.weekdays[m].substr(0,1),w.appendChild(j),++m>6&&(m=0)}for(var m=0,v=0,b=0;b<6;b++){var w;(w=document.createElement("tr")).setAttribute("align","center"),w.style.height="34px";for(h=0;h<7;h++){var j;if((j=document.createElement("td")).classList.add("jcalendar-set-day"),m>=f&&m<f+p){v++,j.innerHTML=v,v==o&&j.classList.add("jcalendar-selected"),c&&u==v&&(j.style.fontWeight="bold");var E=e.now(new Date(n,i-1,v),!0);if(a.options.validRange){if(!a.options.validRange[0]||E>=a.options.validRange[0])var C=!0;else C=!1;if(!a.options.validRange[1]||E<=a.options.validRange[1])var T=!0;else T=!1;C&&T||j.classList.add("jcalendar-disabled")}}w.appendChild(j),m++}x.appendChild(w)}a.options.time?L.style.display="":L.style.display="none",d()},getMonths:function(){a.options.mode="months";var e=a.options.months,t=(a.options.value,new Date),n=parseInt(t.getFullYear()),i=parseInt(t.getMonth())+1,o=a.date&&s.isNumeric(a.date[0])?a.date[0]:n,r=a.date&&s.isNumeric(a.date[1])?a.date[1]:i;g.innerHTML=a.date[0],y.innerHTML=e[r-1];var l=document.createElement("table");l.setAttribute("width","100%");for(var c=null,u=0;u<12;u++){if(!(u%4))(c=document.createElement("tr")).setAttribute("align","center"),l.appendChild(c);var p=document.createElement("td");if(p.classList.add("jcalendar-set-month"),p.setAttribute("data-value",u+1),p.innerText=e[u],a.options.validRange){var f=o+"-"+s.two(u+1);if(!a.options.validRange[0]||f>=a.options.validRange[0].substr(0,7))var h=!0;else h=!1;if(!a.options.validRange[1]||f<=a.options.validRange[1].substr(0,7))var m=!0;else m=!1;h&&m||p.classList.add("jcalendar-disabled")}u+1==r&&p.classList.add("jcalendar-selected"),n==o&&u+1==i&&(p.style.fontWeight="bold"),c.appendChild(p)}x.innerHTML='<tr><td colspan="7"></td></tr>',x.children[0].children[0].appendChild(l),d()},getYears:function(){a.options.mode="years";for(var e=new Date,t=e.getFullYear(),n=a.date&&s.isNumeric(a.date[0])?a.date[0]:parseInt(e.getFullYear()),i=[],o=0;o<25;o++)i[o]=parseInt(a.date[0])+(o-12);var r=document.createElement("table");r.setAttribute("width","100%");for(o=0;o<25;o++){if(!(o%5)){var l=document.createElement("tr");l.setAttribute("align","center"),r.appendChild(l)}var c=document.createElement("td");c.classList.add("jcalendar-set-year"),c.innerText=i[o],n==i[o]&&c.classList.add("jcalendar-selected"),t==i[o]&&(c.style.fontWeight="bold"),l.appendChild(c)}x.innerHTML='<tr><td colspan="7"></td></tr>',x.firstChild.firstChild.appendChild(r),d()},setLabel:function(t,n){return e.getDateString(t,n)},fromFormatted:function(t,n){return e.extractDateFromString(t,n)}},r=function(e){if(s.findElement(e.target,"jcalendar-container")){var t=e.target.className;if("jcalendar-prev"==t)a.prev();else if("jcalendar-next"==t)a.next();else if("jcalendar-month"==t)a.getMonths();else if("jcalendar-year"==t)a.getYears();else if("jcalendar-set-year"==t)a.date[0]=e.target.innerText,"year-month-picker"==a.options.type?a.getMonths():a.getDays();else if(e.target.classList.contains("jcalendar-set-month")){var n=parseInt(e.target.getAttribute("data-value"));"year-month-picker"==a.options.type?a.update(e.target,n):(a.date[1]=n,a.getDays())}else"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?a.close(null,!0):"jcalendar-backdrop"==t?a.close(!1,!1):"jcalendar-reset"==t?a.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&a.update(e.target)}else a.close(!1,!1)},l=function(t){if(t.target.value&&t.target.value.length>3){var n=e.extractDateFromString(t.target.value,a.options.format);n&&a.setValue(n)}},d=function(){var e=c.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(E.setAttribute("disabled","disabled"),C.setAttribute("disabled","disabled"),T.setAttribute("disabled","disabled")):(E.removeAttribute("disabled"),C.removeAttribute("disabled"),T.removeAttribute("disabled")),"function"==typeof a.options.onupdate&&a.options.onupdate(i,a.getValue())},c=null,u=null,h=null,m=null,v=null,g=null,y=null,b=null,x=null,w=null,L=null,j=null,E=null,C=null,T=null;return function(){"INPUT"==i.tagName&&i.value&&(o.value=i.value),(u=document.createElement("div")).className="jcalendar-reset",(h=document.createElement("div")).className="jcalendar-confirm",(w=document.createElement("div")).className="jcalendar-controls",w.style.borderBottom="1px solid #ddd",w.appendChild(u),w.appendChild(h),(m=document.createElement("div")).className="jcalendar-container",(v=document.createElement("div")).className="jcalendar-content",m.appendChild(v),"DIV"==i.tagName?(c=i).classList.add("jcalendar-inline"):(v.appendChild(w),(c=document.createElement("div")).className="jcalendar"),c.classList.add("jcalendar-container"),c.appendChild(m);var t=document.createElement("div");t.className="jcalendar-table",v.appendChild(t);var n=document.createElement("td");n.setAttribute("colspan","2"),n.className="jcalendar-prev",(g=document.createElement("span")).className="jcalendar-year",(y=document.createElement("span")).className="jcalendar-month";var d=document.createElement("td");d.className="jcalendar-header",d.setAttribute("colspan","3"),d.appendChild(y),d.appendChild(g);var f=document.createElement("td");f.setAttribute("colspan","2"),f.className="jcalendar-next";var k=document.createElement("thead"),A=document.createElement("tr");A.appendChild(n),A.appendChild(d),A.appendChild(f),k.appendChild(A),b=document.createElement("table"),x=document.createElement("tbody"),b.setAttribute("cellpadding","0"),b.setAttribute("cellspacing","0"),b.appendChild(k),b.appendChild(x),t.appendChild(b),(C=document.createElement("select")).className="jcalendar-select",C.onchange=function(){a.date[3]=this.value,"function"==typeof a.options.onupdate&&a.options.onupdate(i,a.getValue())};for(var M=0;M<24;M++){(N=document.createElement("option")).value=M,N.innerHTML=s.two(M),C.appendChild(N)}(T=document.createElement("select")).className="jcalendar-select",T.onchange=function(){a.date[4]=this.value,"function"==typeof a.options.onupdate&&a.options.onupdate(i,a.getValue())};for(M=0;M<60;M++){var N;(N=document.createElement("option")).value=M,N.innerHTML=s.two(M),T.appendChild(N)}var D=document.createElement("div");D.className="jcalendar-controls",(L=document.createElement("div")).className="jcalendar-time",L.style.maxWidth="140px",L.appendChild(C),L.appendChild(T),(E=document.createElement("button")).setAttribute("type","button"),E.className="jcalendar-update",(j=document.createElement("div")).style.flexGrow="10",j.appendChild(E),D.appendChild(L),"INPUT"==i.tagName&&D.appendChild(j),v.appendChild(D);var O=document.createElement("div");O.className="jcalendar-backdrop",c.appendChild(O),i.addEventListener("keyup",l),c.addEventListener("swipeleft",(function(e){p.slideLeft(b,0,(function(){a.next(),p.slideRight(b,1)})),e.preventDefault(),e.stopPropagation()})),c.addEventListener("swiperight",(function(e){p.slideRight(b,0,(function(){a.prev(),p.slideLeft(b,1)})),e.preventDefault(),e.stopPropagation()})),"ontouchend"in document.documentElement==!0?(c.addEventListener("touchend",r),i.addEventListener("touchend",a.open)):(c.addEventListener("mouseup",r),i.addEventListener("mouseup",a.open)),e.hasEvents||(e.hasEvents=!0,document.addEventListener("keydown",e.keydown)),a.setOptions(o),"INPUT"==i.tagName?(i.parentNode.insertBefore(c,i.nextSibling),i.setAttribute("autocomplete","off"),i.classList.add("jcalendar-input"),i.value=a.setLabel(a.getValue(),a.options)):(a.getDays(),a.options.time&&(C.value=a.date[3],T.value=a.date[4])),1==a.options.opened&&a.open(),0==a.options.controls&&m.classList.add("jcalendar-hide-controls"),i.change=a.setValue,i.val=function(e){if(void 0===e)return a.getValue();a.setValue(e)},i.calendar=c.calendar=a}(),a};return e.keydown=function(t){var n=null;(n=e.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.prettify=function(e,t){if(!t)t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};-1===e.indexOf("GMT")&&-1===e.indexOf("Z")&&(e+=" GMT");var n=new Date,i=new Date(e),o=parseInt((n-i)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==o)var a=t.justNow;else if(o<90)a=t.xMinutesAgo.format(o);else if(o<1440)a=t.xHoursAgo.format(Math.round(o/60));else if(o<20160)a=t.xDaysAgo.format(Math.round(o/1440));else if(o<43200)a=t.xWeeksAgo.format(Math.round(o/10080));else if(o<1036800)a=t.xMonthsAgo.format(Math.round(o/43200));else a=t.xYearsAgo.format(Math.round(o/525600));return a},e.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.prettify(t[n].getAttribute("data-date")):t[n].innerHTML&&(t[n].setAttribute("title",t[n].innerHTML),t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.prettify(t[n].innerHTML))},e.now=f.now,e.toArray=f.toArray,e.dateToNum=f.dateToNum,e.numToDate=f.numToDate,e.weekdays=f.weekdays,e.months=f.months,e.weekdaysShort=f.weekdaysShort,e.monthsShort=f.monthsShort,e.extractDateFromString=h.extractDateFromString,e.getDateString=h.getDateString,e}();var v=function(){var e={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},t=function(t){return e[t]?e[t]:e.material};return t.get=function(t){return e[t]?e[t]:e},t.set=function(t,n){e[t]=n},t}();function g(e,t){var n={options:{}},i={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var o in i)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=i[o];e.classList.add("jtabs");var a=null,s=null,r=null;const d=function(e){n.options.animation&&setTimeout((function(){let t=n.headers.children[e].getBoundingClientRect();"modern"===n.options.palette?(r.style.width=t.width-4+"px",r.style.left=n.headers.children[e].offsetLeft+2+"px"):(r.style.width=t.width+"px",r.style.left=n.headers.children[e].offsetLeft+"px"),"bottom"===n.options.position?r.style.top="0px":r.style.bottom="0px"}),50)};var c=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?a.classList.add("disabled"):a.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?s.classList.add("disabled"):s.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(a.style.display="none",s.style.display="none"):(a.style.display="",s.style.display="")};if(n.setBorder=d,n.open=function(t){Array.from(n.content.children);if(n.content.children[t]){for(var i=null,o=0;o<n.headers.children.length;o++)n.headers.children[o].classList.contains("jtabs-selected")&&(i=o),n.headers.children[o].classList.remove("jtabs-selected"),n.content.children[o]&&n.content.children[o].classList.remove("jtabs-selected");if(n.headers.children[t].classList.add("jtabs-selected"),n.content.children[t]&&n.content.children[t].classList.add("jtabs-selected"),i!=t&&"function"==typeof n.options.onchange&&n.content.children[t]&&n.options.onchange(e,n,t,n.headers.children[t],n.content.children[t]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{n.headers.parentNode.style.display="";var a=n.headers.children[t].offsetLeft,s=a+n.headers.children[t].offsetWidth,r=n.headers.scrollLeft,l=r+n.headers.offsetWidth;r<=a&&l>=s||c(a-1),d(t)}}},n.selectIndex=function(e){var t=Array.prototype.indexOf.call(n.headers.children,e);return t>=0&&n.open(t),t},n.rename=function(e,t){t||(t=prompt("New title",n.headers.children[e].innerText)),n.headers.children[e].innerText=t,d(n.getActive())},n.create=function(t,i){if("function"==typeof n.options.onbeforecreate){var o=n.options.onbeforecreate(e,t);if(!1===o)return!1;t=o}var a=n.appendElement(t);return"function"==typeof n.options.oncreate&&n.options.oncreate(e,a),d(n.getActive()),a},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,t=0;t<n.headers.children.length;t++){var i=n.headers.children[t].innerText.match(/[0-9].*/);i>e&&(e=parseInt(i))}return e?e++:e=1,e},n.deleteElement=function(t){let i=n.getActive();if(!n.headers.children[t])return!1;if(n.headers.removeChild(n.headers.children[t]),n.content.removeChild(n.content.children[t]),i===t)n.open(0);else{let e=n.getActive()||0;d(e)}"function"==typeof n.options.ondelete&&n.options.ondelete(e,t)},n.appendElement=function(e,t,i,o){if(!e)e=prompt("Title?","");if(e){var a=document.createElement("div"),s=document.createElement("div");if(s.innerHTML=e,s.content=a,void 0===o)n.content.appendChild(a),n.headers.insertBefore(s,n.headers.lastChild);else{let e=n.content.children[o];e?n.content.insertBefore(a,e):n.content.appendChild(a),e=n.headers.children[o]||n.headers.lastChild,n.headers.insertBefore(s,e)}return n.options.allowChangePosition&&s.setAttribute("draggable","true"),!1!==i&&n.selectIndex(s),"function"==typeof t&&t(a,s),a}},n.getActive=function(){for(var e=0;e<n.headers.children.length;e++)if(n.headers.children[e].classList.contains("jtabs-selected"))return e;return!1},n.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t);n.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),n.content.replaceChild(t,n.content.children[e]),d()},n.updatePosition=function(e,t,i,o){if(e>t?n.content.insertBefore(n.content.children[e],n.content.children[t]):n.content.insertBefore(n.content.children[e],n.content.children[t].nextSibling),!1!==o)n.open(t);else{const e=n.getActive();t<e&&n.setBorder(e)}i||"function"!=typeof n.options.onchangeposition||n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t,i,o){e>t?n.headers.insertBefore(n.headers.children[e],n.headers.children[t]):n.headers.insertBefore(n.headers.children[e],n.headers.children[t].nextSibling),n.updatePosition(e,t,i,o)},n.setBorder=d,n.init=function(){e.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.content.classList.add("jtabs-content"),n.options.palette?e.classList.add("jtabs-modern"):e.classList.remove("jtabs-modern"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var t=document.createElement("div");t.className="jtabs-headers-container",t.appendChild(n.headers),n.options.maxWidth&&(t.style.maxWidth=parseInt(n.options.maxWidth)+"px");var i=document.createElement("div");if(i.className="jtabs-controls",i.setAttribute("draggable","false"),t.appendChild(i),"bottom"==n.options.position?(e.appendChild(n.content),e.appendChild(t)):(e.appendChild(t),e.appendChild(n.content)),1==n.options.allowCreate){var o=document.createElement("div");o.className="jtabs-add",o.onclick=function(){n.create()},i.appendChild(o)}(a=document.createElement("div")).className="jtabs-prev",a.onclick=function(){c(n.headers.scrollLeft-n.headers.offsetWidth)},i.appendChild(a),(s=document.createElement("div")).className="jtabs-next",s.onclick=function(){c(n.headers.scrollLeft+n.headers.offsetWidth)},i.appendChild(s);for(var d=0;d<n.options.data.length;d++){if(n.options.data[d].titleElement)var u=n.options.data[d].titleElement;else u=document.createElement("div");if(n.options.data[d].icon){var p=document.createElement("div"),f=document.createElement("i");f.classList.add("material-icons"),f.innerHTML=n.options.data[d].icon,p.appendChild(f),u.appendChild(p)}if(n.options.data[d].title){var h=document.createTextNode(n.options.data[d].title);u.appendChild(h)}if(n.options.data[d].width&&(u.style.width=n.options.data[d].width),n.options.data[d].contentElement)var m=n.options.data[d].contentElement;else(m=document.createElement("div")).innerHTML=n.options.data[d].content;n.headers.appendChild(u),n.content.appendChild(m)}(r=document.createElement("div")).className="jtabs-border",n.headers.appendChild(r),n.options.animation&&e.classList.add("jtabs-animation"),n.headers.addEventListener("click",(function(t){if(t.target.parentNode.classList.contains("jtabs-headers"))var i=t.target;else if("I"==t.target.tagName)i=t.target.parentNode.parentNode;else i=t.target.parentNode;var o=n.selectIndex(i);"function"==typeof n.options.onclick&&n.options.onclick(e,n,o,n.headers.children[o],n.content.children[o])})),n.headers.addEventListener("contextmenu",(function(e){n.selectIndex(e.target)})),n.headers.children.length&&n.open(0),c(0),1==n.options.allowChangePosition&&l(n.headers,{direction:1,ondrop:function(e,t,i){n.updatePosition(t,i)}}),"function"==typeof n.options.onload&&n.options.onload(e,n)},e.children[0]&&e.children[0].children.length)for(var p=0;p<e.children[0].children.length;p++){var f=n.options.data&&n.options.data[p]?n.options.data[p]:{};e.children[1]&&e.children[1].children[p]?(f.titleElement=e.children[0].children[p],f.contentElement=e.children[1].children[p]):f.contentElement=e.children[0].children[p],n.options.data[p]=f}var h=!1;if(n.options.data)for(p=0;p<n.options.data.length;p++)n.options.data[p].url&&(u({url:n.options.data[p].url,type:"GET",dataType:"text/html",index:p,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),h=!0);return h||n.init(),e.tabs=n,n}function b(e,t){if(e.color)return e.color.setOptions(t,!0);var i={type:"color",options:{}},o=null,a=null,r=null,l=null,d=null,c=null,u=null;i.setOptions=function(t,n){var o={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var a in t||(t={}),t&&!t.palette&&(t.palette=v()),o)t&&t.hasOwnProperty(a)?i.options[a]=t[a]:void 0!==i.options[a]&&!0!==n||(i.options[a]=o[a]);return l&&(l.innerHTML=i.options.resetLabel),d&&(d.innerHTML=i.options.doneLabel),i.options.palette&&u&&u.updateContent(0,b()),"string"==typeof i.options.value&&(e.value=i.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value)),i.options.placeholder?e.setAttribute("placeholder",i.options.placeholder):e.getAttribute("placeholder")&&e.removeAttribute("placeholder"),i},i.select=function(e){var t=o.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),i.values[e]&&i.values[e].classList.add("jcolor-selected"),i.options.value=e},i.open=function(){if(!o.classList.contains("jcolor-focus")){n(i,!0),o.classList.add("jcolor-focus"),i.options.value&&i.select(i.options.value),r.style.marginTop="",r.style.marginLeft="";var t=r.getBoundingClientRect(),l=s.getWindowWidth(),d=s.getWindowHeight();if(l<800||1==i.options.fullscreen?(r.classList.add("jcolor-fullscreen"),p.slideBottom(r,1),a.style.display="block"):(r.classList.contains("jcolor-fullscreen")&&(r.classList.remove("jcolor-fullscreen"),a.style.display=""),i.options.position?r.style.position="fixed":r.style.position="",t.left+t.width>l&&(r.style.marginLeft=-1*(t.left+t.width-(l-20))+"px"),t.top+t.height>d&&(r.style.marginTop=-1*(t.top+t.height-(d-20))+"px")),"function"==typeof i.options.onopen&&i.options.onopen(e,i),u.setBorder(u.getActive()),i.options.value){var c=y(i.options.value);T.forEach((function(e,t){e.value=c[t],e.dispatchEvent(new Event("input"))}))}}},i.close=function(t){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),a.style.display="",t||"function"!=typeof i.options.onclose||i.options.onclose(e,i),n(i,!1)),i.options.value},i.setValue=function(t){t||(t=""),t!=i.options.value&&(i.options.value=t,C=t,i.select(t),"function"==typeof i.options.onchange&&i.options.onchange(e,t,i),e.value!=i.options.value&&(e.value=i.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value),"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),1==i.options.closeOnChange&&i.close())},i.getValue=function(){return i.options.value};var f=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},h=function(e,t,n){return"#"+f(e)+f(t)+f(n)},m=function(e){return parseInt("0x"+e)},y=function(e){return[m(e.substr(1,2)),m(e.substr(3,2)),m(e.substr(5,2))]},b=function(){var e=document.createElement("div");e.className="jcolor-grid",i.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<i.options.palette.length;n++){for(var o=document.createElement("tr"),a=0;a<i.options.palette[n].length;a++){var s=document.createElement("td"),r=i.options.palette[n][a];r.length<7&&"#"!==r.substr(0,1)&&(r="#"+r),s.style.backgroundColor=r,s.setAttribute("data-value",r),s.innerHTML="",o.appendChild(s),i.options.value==r&&s.classList.add("jcolor-selected"),i.values[r]=s}t.appendChild(o)}return e.appendChild(t),e},x=document.createElement("canvas");x.width=200,x.height=160;var w=x.getContext("2d"),L=function(){var e=c.firstChild.getBoundingClientRect();x.width=e.width-14,j()},j=function(){var e=w.createLinearGradient(0,0,x.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),w.fillStyle=e,w.fillRect(0,0,x.width,x.height),(e=w.createLinearGradient(0,0,0,x.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),w.fillStyle=e,w.fillRect(0,0,x.width,x.height)},E=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(x),n.appendChild(t),e.appendChild(n);var i=function(n,i,o){if(1===n){var a=e.getBoundingClientRect(),s=i-a.left,r=o-a.top;s<0&&(s=0),r<0&&(r=0),s>a.width&&(s=a.width),r>a.height&&(r=a.height),t.style.left=s+"px",t.style.top=r+"px";var l=w.getImageData(s,r,1,1).data;C=h(l[0],l[1],l[2])}};return e.addEventListener("mousedown",(function(e){i(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){i(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){i(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},C="",T=[],k=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var i=document.createElement("label");i.innerText=e;var o=document.createElement("div");o.className="jcolor-sliders-input-subcontainer";var a=document.createElement("input");a.type="range",a.min=0,a.max=255,a.value=0,n.appendChild(i),o.appendChild(a);var s=document.createElement("div");return s.innerText=a.value,a.addEventListener("input",(function(){s.innerText=a.value})),o.appendChild(s),n.appendChild(o),t.appendChild(n),a};T=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var i=document.createElement("div");i.className="jcolor-sliders-final-color";var o=document.createElement("div");o.style.visibility="hidden",o.innerText="a",i.appendChild(o);return T.forEach((function(e){e.addEventListener("input",(function(){var e;e=h(parseInt(T[0].value),parseInt(T[1].value),parseInt(T[2].value)),o.innerText=e,o.style.color=e,o.style.removeProperty("visibility"),C=e,function(){if(""!==C)for(var e=0;e<T.length;e++){var t=y(C);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",T[e].style.backgroundImage=n}}()}))})),e.appendChild(i),e};return i.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},function(){i.setOptions(t),"INPUT"==e.tagName&&(e.classList.add("jcolor-input"),e.readOnly=!0),(o=document.createElement("div")).className="jcolor",(a=document.createElement("div")).className="jcolor-backdrop",o.appendChild(a),(r=document.createElement("div")).className="jcolor-content";var n=document.createElement("div");n.className="jcolor-controls",r.appendChild(n),(l=document.createElement("div")).className="jcolor-reset",l.innerHTML=i.options.resetLabel,n.appendChild(l),(d=document.createElement("div")).className="jcolor-close",d.innerHTML=i.options.doneLabel,n.appendChild(d),c=document.createElement("div"),r.appendChild(c),u=g(c,{animation:!0,data:[{title:"Grid",contentElement:b()},{title:"Spectrum",contentElement:E()},{title:"Sliders",contentElement:k()}],onchange:function(e,t,n){if(1===n)L();else{var o=""!==C?C:i.getValue();if(2===n&&o){var a=y(o);T.forEach((function(e,t){e.value=a[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),o.appendChild(r),"INPUT"==e.tagName?e.parentNode.insertBefore(o,e.nextSibling):e.appendChild(o),o.addEventListener("click",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&i.setValue(t)}else e.target.classList.contains("jcolor-reset")?(i.setValue(""),i.close()):e.target.classList.contains("jcolor-close")?(u.getActive()>0&&i.setValue(C),i.close()):e.target.classList.contains("jcolor-backdrop")?i.close():i.open()})),e.addEventListener("mouseup",(function(e){i.open()})),window.addEventListener("resize",(function(){o.classList.contains("jcolor-focus")&&1==u.getActive()&&L()})),1==i.options.opened&&i.open(),e.change=i.setValue,e.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},e.color=i,o.color=i}(),i}var w=function(){var e=function(i,o){var a={type:"contextmenu",options:{}},s={items:null,onclick:null};for(var r in s)o&&o.hasOwnProperty(r)?a.options[r]=o[r]:a.options[r]=s[r];function l(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){d=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&d.setAttribute("title",e.tooltip),e.icon&&d.setAttribute("data-icon",e.icon),e.id&&(d.id=e.id),e.disabled?d.className="jcontextmenu-disabled":e.onclick&&(d.method=e.onclick,d.addEventListener("mousedown",(function(e){e.preventDefault()})),d.addEventListener("mouseup",(function(e){this.method(this,e)}))),d.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",d.appendChild(n),d.classList.add("jcontexthassubmenu");var i=document.createElement("div");i.classList.add("jcontextmenu"),i.setAttribute("tabindex","900");for(var o=e.submenu,a=0;a<o.length;a++){var s=l(o[a]);i.appendChild(s)}d.appendChild(i)}else if(e.shortcut){var r=document.createElement("span");r.innerHTML=e.shortcut,d.appendChild(r)}}else var d=document.createElement("hr");return d}return i.classList.add("jcontextmenu"),a.open=function(t,o){if(o&&(a.options.items=o,a.create(o)),e.current&&e.current.close(),n(a,!0),i.classList.add("jcontextmenu-focus"),e.current=a,a.options.items&&a.options.items.length>0||i.children.length){if(t.target)if(t.changedTouches&&t.changedTouches[0])s=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY;else var s=t.clientX,r=t.clientY;else s=t.x,r=t.y;var l=i.getBoundingClientRect();if(window.innerHeight<r+l.height){var d=r-l.height;d<0&&(d=0),i.style.top=d+"px"}else i.style.top=r+"px";window.innerWidth<s+l.width?s-l.width>0?i.style.left=s-l.width+"px":i.style.left="10px":i.style.left=s+"px"}},a.isOpened=function(){return!!i.classList.contains("jcontextmenu-focus")},a.close=function(){i.classList.contains("jcontextmenu-focus")&&i.classList.remove("jcontextmenu-focus"),n(a,!1)},a.create=function(e){i.innerHTML="";var n=function(){var e=document.createElement("div");e.classList.add("header"),e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var n=document.createElement("a");n.classList.add("title"),n.innerHTML=t.translate("Menu"),e.appendChild(n);var i=document.createElement("a");return i.classList.add("close"),i.innerHTML=t.translate("close"),i.addEventListener("click",(function(e){a.close()})),e.appendChild(i),e}();i.appendChild(n);for(var o=0;o<e.length;o++){var s=l(e[o]);i.appendChild(s)}},"function"==typeof a.options.onclick&&i.addEventListener("click",(function(e){a.options.onclick(a,e)})),a.options.items&&a.create(a.options.items),window.addEventListener("mousewheel",(function(){a.close()})),i.contextmenu=a,a};return e}();var L=function(){var e=function(i,o){if(i.dropdown)return i.dropdown.setOptions(o,!0);var a={type:"dropdown",options:{}},r=function(e,t){e&&e.length&&(!1!==a.options.sortResults&&("function"==typeof a.options.sortResults?e.sort(a.options.sortResults):e.sort(l)),a.setData(e)),"function"==typeof a.options.onload&&a.options.onload(i,a,e,t),t&&f(t),null==t&&(a.options.value=""),i.value=a.options.value,1==a.options.opened&&a.open()},l=function(e,t){var n,i;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?i=t:t.text?i=t.text:t.name&&(i=t.name),"string"==typeof n||"string"==typeof i?("string"!=typeof n&&(n=""+n),"string"!=typeof i&&(i=""+i),n.localeCompare(i)):n-i},c=function(){a.value={};for(var e=0;e<a.items.length;e++)1==a.items[e].selected&&(a.items[e].element&&a.items[e].element.classList.remove("jdropdown-selected"),a.items[e].selected=null);a.options.value="",i.value=""},f=function(e){if(c(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)a.value[e[t]]=""}else void 0!==a.value[""]&&(a.value[""]="");for(t=0;t<a.items.length;t++)void 0!==a.value[h(t)]&&(a.items[t].element&&a.items[t].element.classList.add("jdropdown-selected"),a.items[t].selected=!0,a.value[h(t)]=m(t));a.options.value=Object.keys(a.value).join(";"),a.header.value=a.getText()},h=function(e,t){if(a.options.format)n="id";else var n="value";return a.items[e]?void 0!==t?a.items[e].data[n]=t:a.items[e].data[n]:""},m=function(e,t){if(a.options.format)n="name";else var n="text";return a.items[e]?void 0!==t?a.items[e].data[n]=t:a.items[e].data[n]:""},v=function(){return Object.keys(a.value)},g=function(){for(var e=[],t=Object.keys(a.value),n=0;n<t.length;n++)e.push(a.value[t[n]]);return e};a.setOptions=function(e,t){e||(e={});var n={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var o in n)e&&e.hasOwnProperty(o)?a.options[o]=e[o]:void 0!==a.options[o]&&!0!==t||(a.options[o]=n[o]);return 1!=a.options.remoteSearch&&"searchbar"!==a.options.type||(a.options.autocomplete=!0),1==a.options.newOptions?a.header.classList.add("jdropdown-add"):a.header.classList.remove("jdropdown-add"),1==a.options.autocomplete?a.header.removeAttribute("readonly"):a.header.setAttribute("readonly","readonly"),a.options.placeholder?a.header.setAttribute("placeholder",a.options.placeholder):a.header.removeAttribute("placeholder"),i.classList.remove("jdropdown-searchbar"),i.classList.remove("jdropdown-picker"),i.classList.remove("jdropdown-list"),"searchbar"==a.options.type?i.classList.add("jdropdown-searchbar"):"list"==a.options.type?i.classList.add("jdropdown-list"):"picker"==a.options.type?i.classList.add("jdropdown-picker"):s.getWindowWidth()<800?a.options.autocomplete?(i.classList.add("jdropdown-searchbar"),a.options.type="searchbar"):(i.classList.add("jdropdown-picker"),a.options.type="picker"):(a.options.width?(i.style.width=a.options.width,i.style.minWidth=a.options.width):(i.style.removeProperty("width"),i.style.removeProperty("min-width")),i.classList.add("jdropdown-default"),a.options.type="default"),"searchbar"==a.options.type?y.appendChild(w):b.insertBefore(w,b.firstChild),a.options.url&&!e.data?u({url:a.options.url,method:"GET",dataType:"json",success:function(e){e&&r(e,a.options.value)}}):r(a.options.data,a.options.value),a};var y=null,b=null,x=null,w=null,L=null,j=null,E=null;a.getUrl=function(){return a.options.url},a.setUrl=function(e,t){a.options.url=e,u({url:a.options.url,method:"GET",dataType:"json",success:function(e){a.setData(e),"function"==typeof t&&t(a)}})},a.setId=function(e,t){if(a.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:a.items[e].data[n]=t};const C=function(e,n){if(!e){let n=1==a.options.autocomplete?a.header.value:"";if(!(e=prompt(t.translate("Add A New Option"),n)))return!1}if(n||(n=s.guid()),a.options.format)i={id:n,name:e};else var i={value:n,text:e};if("function"==typeof a.options.onbeforeinsert){let e=a.options.onbeforeinsert(a,i);if(!1===e)return!1;e&&(i=e)}a.options.data.push(i);var o=a.createItem(i);return x.appendChild(o.element),"function"==typeof a.options.oninsert&&a.options.oninsert(a,i,o),"none"==x.style.display&&(x.style.display=""),a.results&&a.results.push(o),i};a.add=function(e,t){return"function"==typeof a.options.prompt?a.options.prompt.call(a,C):C(e,t)},a.createItem=function(e,t,n){a.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var i={};if(i.element=document.createElement("div"),i.element.className="jdropdown-item",i.element.indexValue=a.items.length,i.data=e,t&&(i.group=t),e.id&&i.element.setAttribute("id",e.id),1==e.disabled&&i.element.setAttribute("data-disabled",!0),e.tooltip&&i.element.setAttribute("title",e.tooltip),e.image){var o=document.createElement("img");o.className="jdropdown-image",o.src=e.image,e.title||o.classList.add("jdropdown-image-small"),i.element.appendChild(o)}else if(e.icon){var s=document.createElement("span");s.className="jdropdown-icon material-icons",s.innerText=e.icon,e.title||s.classList.add("jdropdown-icon-small"),e.color&&(s.style.color=e.color),i.element.appendChild(s)}else if(e.color){var r=document.createElement("div");r.className="jdropdown-color",r.style.backgroundColor=e.color,i.element.appendChild(r)}if(a.options.format)l=e.name;else var l=e.text;var d=document.createElement("div");if(d.className="jdropdown-description",d.textContent=l||"&nbsp;",e.title){var c=document.createElement("div");c.className="jdropdown-title",c.innerText=e.title,d.appendChild(c)}if(a.options.format)u=e.id;else var u=e.value;return a.value[u]&&(i.element.classList.add("jdropdown-selected"),i.selected=!0),a.items.push(i),i.element.appendChild(d),i},a.appendData=function(e){if(e.length){for(var t=[],n=[],i=0;i<e.length;i++)e[i].group?(n[e[i].group]||(n[e[i].group]=[]),n[e[i].group].push(i)):t.push(i);var o=0,s=Object.keys(n);if(s.length>0)for(i=0;i<s.length;i++){var r=document.createElement("div");r.className="jdropdown-group";var l=document.createElement("div");l.className="jdropdown-group-name",l.textContent=s[i];var d=document.createElement("i");d.className="jdropdown-group-arrow jdropdown-group-arrow-down",l.appendChild(d);var c=document.createElement("div");c.className="jdropdown-group-items";for(var u=0;u<n[s[i]].length;u++){var p=a.createItem(e[n[s[i]][u]],r,s[i]);(0==a.options.lazyLoading||o<200)&&(c.appendChild(p.element),o++)}r.appendChild(l),r.appendChild(c),a.groups.push(r),c.children.length>0&&x.appendChild(r)}if(t.length)for(i=0;i<t.length;i++){p=a.createItem(e[t[i]]);(0==a.options.lazyLoading||o<200)&&(x.appendChild(p.element),o++)}}},a.setData=function(e){if(c(),x.textContent="",a.header.value="",a.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(a.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});a.appendData(e),a.options.data=e}else a.options.data=[];a.close()},a.getData=function(){return a.options.data},a.getPosition=function(e){for(var t=0;t<a.items.length;t++)if(h(t)==e)return t;return!1},a.getText=function(e){var t=g();return e?t:t.join("; ")},a.getValue=function(e){var t=v();return e?t:t.join(";")};var T=function(e){i.value!=a.options.value&&(i.value=a.options.value,"function"==typeof i.oninput&&i.oninput({type:"input",target:i,value:i.value})),"function"==typeof a.options.onchange&&a.options.onchange(i,a,e,a.options.value)};a.setValue=function(e){var t=a.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(f(e),T(t))},a.resetSelected=function(){a.setValue(null)},a.selectIndex=function(e,t){e=parseInt(e);if(a.items&&a.items[e]&&(!0===t||!0!==a.items[e].data.disabled))if(a.setCursor(e,!1),a.options.multiple){var n=a.options.value;a.items[e].selected?(a.items[e].element.classList.remove("jdropdown-selected"),a.items[e].selected=!1,delete a.value[h(e)]):(a.items[e].element.classList.add("jdropdown-selected"),a.items[e].selected=!0,a.value[h(e)]=m(e)),a.options.value=Object.keys(a.value).join(";"),0==a.options.autocomplete&&(a.header.value=g().join("; ")),T(n)}else a.items[e].selected?!1!==a.options.allowEmpty&&a.setValue(null):a.setValue(h(e)),a.close()},a.selectItem=function(e){a.selectIndex(e.indexValue)};var k=function(e,t){for(var n=0;n<t.length;n++)if(a.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return a.find=function(e){if(a.search==e.trim())return!1;if(a.search=e,a.setCursor(),a.groups.length)for(var t=0;t<a.groups.length;t++)a.groups[t].lastChild.textContent="";if(x.textContent="",1==a.options.remoteSearch){a.results=null;let t={url:a.options.url,method:"GET",data:{q:e},dataType:"json",success:function(e){a.items=[];var t=Object.keys(a.value);if(t.length)for(var n=0;n<t.length;n++)k(t[n],e)||(a.options.format?e.unshift({id:t[n],name:a.value[t[n]]}):e.unshift({value:t[n],text:a.value[t[n]]}));a.appendData(e),e.length?x.style.display="":x.style.display="none","function"==typeof a.options.onsearch&&a.options.onsearch(a,e)}};if("function"==typeof a.options.onbeforesearch){let e=a.options.onbeforesearch(a,t);if(!1===e)return;"object"==typeof e&&(t=e)}u(t)}else{e=new RegExp(e,"gi");var n=[];for(t=0;t<a.items.length;t++){var i=m(t),o=a.items[t].data.title||"",s=a.items[t].data.group||"",r=a.items[t].data.synonym||"";r&&(r=r.join(" ")),(null==e||1==a.items[t].selected||i.toString().match(e)||o.match(e)||s.match(e)||r.match(e))&&n.push(a.items[t])}if(n.length){x.style.display="",a.results=n;var l=n.length||0;1==a.options.lazyLoading&&l>200&&(l=200);for(t=0;t<l;t++)a.results[t].group?(a.results[t].group.parentNode||x.appendChild(a.results[t].group),a.results[t].group.lastChild.appendChild(a.results[t].element)):x.appendChild(a.results[t].element)}else x.style.display="none",a.results=null}1==a.options.autofocus&&a.first()},a.open=function(){if(!i.classList.contains("jdropdown-focus")){e.current=a,n(a,!0),i.classList.add("jdropdown-focus"),s.getWindowWidth()<800&&(null!=a.options.type&&"picker"!=a.options.type||p.slideBottom(b,1)),1==a.options.autocomplete&&(a.header.value=a.search,a.header.focus());var t=v();if(t[0]){var o=a.getPosition(t[0]);!1!==o&&a.setCursor(o)}if(!a.options.type||"default"==a.options.type){var r=i.getBoundingClientRect(),l=b.getBoundingClientRect();a.options.position?(b.style.position="fixed",window.innerHeight<r.bottom+l.height?(b.style.top="",b.style.bottom=window.innerHeight-r.top+1+"px"):(b.style.top=r.bottom+"px",b.style.bottom=""),b.style.left=r.left+"px"):window.innerHeight<r.bottom+l.height?(b.style.top="",b.style.bottom=r.height+1+"px"):(b.style.top="",b.style.bottom=""),b.style.minWidth=r.width+"px",a.options.maxWidth&&(b.style.maxWidth=a.options.maxWidth),a.items.length||1!=a.options.autocomplete?x.style.display="":x.style.display="none"}}"function"==typeof a.options.onopen&&a.options.onopen(i)},a.close=function(t){return i.classList.contains("jdropdown-focus")&&(a.header.value=a.getText(),a.setCursor(),t||"function"!=typeof a.options.onclose||a.options.onclose(i),a.header.blur&&a.header.blur(),i.classList.remove("jdropdown-focus"),n(a,!1),e.current=null),a.getValue()},a.setCursor=function(e,t){if(null!=a.currentIndex&&a.items&&a.items[a.currentIndex]&&a.items[a.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)a.currentIndex=null;else if(e=parseInt(e),a.items[e].element.parentNode&&(a.items[e].element.classList.add("jdropdown-cursor"),a.currentIndex=e,!1!==t&&a.items[a.currentIndex].element)){x.scrollTop;var n=a.items[a.currentIndex].element;x.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},a.resetCursor=a.setCursor,a.updateCursor=a.setCursor,a.reset=function(){a.setCursor(),a.setValue(null)},a.first=function(){!0===a.options.lazyLoading&&a.loadFirst();var e=x.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;a.setCursor(t)}},a.last=function(){!0===a.options.lazyLoading&&a.loadLast();var e=x.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;a.setCursor(t)}},a.next=function(e){var t=null;if(e){if(1==e.length){var n=a.currentIndex||-1;e=e.toLowerCase();var i=null,o=null,s=x.querySelectorAll(".jdropdown-item");if(s.length){for(var r=0;r<s.length;r++)if(s[r].indexValue>n&&(i=a.items[s[r].indexValue])&&(o=i.element.innerText[0])&&e==(o=o.toLowerCase())){t=s[r].indexValue;break}a.setCursor(t)}}}else if(null==a.currentIndex||null==a.currentIndex)a.first();else{var l=a.items[a.currentIndex].element,d=l.nextElementSibling;d?(d.classList.contains("jdropdown-group")&&(d=d.lastChild.firstChild),t=d.indexValue):l.parentNode.classList.contains("jdropdown-group-items")&&((d=l.parentNode.parentNode.nextElementSibling)&&(d.classList.contains("jdropdown-group")?d=d.lastChild.firstChild:d.classList.contains("jdropdown-item")?t=d.indexValue:d=null),d&&(t=d.indexValue)),null!==t&&a.setCursor(t)}},a.prev=function(){var e=null;if(null===a.currentIndex)a.first();else{var t=a.items[a.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&a.setCursor(e)},a.loadFirst=function(){if(a.results)var e=a.results;else e=a.items;var t=e.length||0;1==a.options.lazyLoading&&t>200&&(t=200),x.textContent="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||x.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):x.appendChild(e[n].element);x.scrollTop=0},a.loadLast=function(){if(a.results)var e=a.results;else e=a.items;var t=e.length;if(t>200){t-=200,x.textContent="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||x.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):x.appendChild(e[n].element);x.scrollTop=x.scrollHeight}},a.loadUp=function(){var e=!1;if(a.results)var t=a.results;else t=a.items;var n=x.querySelectorAll(".jdropdown-item")[0].indexValue;n=a.items[n];var i=t.indexOf(n)-1;if(i>0){for(var o=0;i>0&&t[i]&&o<200;)t[i].group?(t[i].group.parentNode||x.insertBefore(t[i].group,x.firstChild),t[i].group.lastChild.insertBefore(t[i].element,t[i].group.lastChild.firstChild)):x.insertBefore(t[i].element,x.firstChild),i--,o++;e=!0}return e},a.loadDown=function(){var e=!1;if(a.results)var t=a.results;else t=a.items;var n=x.querySelectorAll(".jdropdown-item"),i=n[n.length-1].indexValue;i=a.items[i];var o=t.indexOf(i)+1;if(o<t.length){for(var s=0;o<t.length&&t[o]&&s<200;)t[o].group?(t[o].group.parentNode||x.appendChild(t[o].group),t[o].group.lastChild.appendChild(t[o].element)):x.appendChild(t[o].element),o++,s++;e=!0}return e},function(){if(o||(o={}),"SELECT"==i.tagName){var t=e.extractFromDom(i,o);i=t.el,o=t.options}!o.placeholder&&i.getAttribute("placeholder")&&(o.placeholder=i.getAttribute("placeholder")),a.value={},a.items=[],a.groups=[],a.search="",a.results=null,i.classList.add("jdropdown"),(y=document.createElement("div")).className="jdropdown-container-header",a.header=document.createElement("input"),a.header.className="jdropdown-header jss_object",a.header.type="text",a.header.setAttribute("autocomplete","off"),a.header.onfocus=function(){"function"==typeof a.options.onfocus&&a.options.onfocus(i)},a.header.onblur=function(){"function"==typeof a.options.onblur&&a.options.onblur(i)},a.header.onkeyup=function(e){1!=a.options.autocomplete||E?a.options.autocomplete||a.next(e.key):(a.search!=a.header.value.trim()&&(E=setTimeout((function(){a.find(a.header.value.trim()),E=null}),400)),i.classList.contains("jdropdown-focus")||a.open())},e.hasEvents||(e.hasEvents=!0,document.addEventListener("keydown",e.keydown)),(b=document.createElement("div")).className="jdropdown-container",(x=document.createElement("div")).className="jdropdown-content",(w=document.createElement("div")).className="jdropdown-close",w.textContent="Done",(L=document.createElement("div")).className="jdropdown-reset",L.textContent="x",L.onclick=function(){a.reset(),a.close()},(j=document.createElement("div")).className="jdropdown-backdrop",y.appendChild(a.header),b.appendChild(x),i.appendChild(y),i.appendChild(b),i.appendChild(j),a.setOptions(o),"ontouchsend"in document.documentElement==!0?i.addEventListener("touchsend",e.mouseup):i.addEventListener("mouseup",e.mouseup),1==a.options.lazyLoading&&d(x,{loadUp:a.loadUp,loadDown:a.loadDown}),x.onwheel=function(e){e.stopPropagation()},i.change=a.setValue,i.val=function(e){if(void 0===e)return a.getValue(!!a.options.multiple);a.setValue(e)},i.dropdown=a}(),a};return e.keydown=function(t){var n=null;if(n=e.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var i=0;i<7;i++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(i=0;i<7;i++)n.next();t.preventDefault()}},e.mouseup=function(e){var t=s.findElement(e.target,"jdropdown");if(t){var n=t.dropdown;if(e.target.classList.contains("jdropdown-header"))if(t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")){var i=t.getBoundingClientRect();if(e.changedTouches&&e.changedTouches[0]){var o=e.changedTouches[0].clientX;e.changedTouches[0].clientY}else o=e.clientX,e.clientY;i.width-(o-i.left)<30?e.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()}else n.open();else if(e.target.classList.contains("jdropdown-group-name")){var a=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var r=0;r<a.length;r++)"none"!=a[r].style.display&&n.selectItem(a[r])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?n.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?n.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?n.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&n.close()}},e.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var i=0;i<e.children.length;i++)if("OPTGROUP"==e.children[i].tagName)for(var o=0;o<e.children[i].children.length;o++)t.data.push({value:e.children[i].children[o].value,text:e.children[i].children[o].textContent,group:e.children[i].getAttribute("label")});else t.data.push({value:e.children[i].value,text:e.children[i].textContent})}t&&null!=t.onchange||(t.onchange=function(e,i,o,a){1==t.multiple?obj.items[i].classList.contains("jdropdown-selected")?n.options[i].setAttribute("selected","selected"):n.options[i].removeAttribute("selected"):n.value=a});var a=document.createElement("div");return e.parentNode.insertBefore(a,e),e.style.display="none",{el:e=a,options:t}},e}();function j(e,t){if(e.picker)return e.picker.setOptions(t,!0);var i={type:"picker",options:{}},o=null,a=null,r=function(e){return e instanceof Element||e instanceof HTMLDocument};i.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(var s in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(s)?i.options[s]=e[s]:void 0!==i.options[s]&&!0!==t||(i.options[s]=n[s]);return!1===i.options.header?o.style.display="none":o.style.display="",i.options.width?o.style.width=parseInt(i.options.width)+"px":o.style.width="",i.options.height?(a.style.maxHeight=i.options.height+"px",a.style.overflow="scroll"):a.style.overflow="",i.options.columns>0&&(i.options.grid?(a.classList.add("jpicker-grid"),a.style.gridTemplateColumns="repeat("+i.options.grid+", 1fr)"):(a.classList.add("jpicker-columns"),a.style.width=i.options.width?i.options.width:36*i.options.columns+"px")),isNaN(parseInt(i.options.value))&&(i.options.value=0),function(){a.innerHTML="";for(var e=Object.keys(i.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.k=e[t],n.v=i.options.data[e[t]];var o=i.getLabel(e[t],n);r(o)?n.appendChild(o):n.innerHTML=o,a.appendChild(n)}}(),i.setValue(i.options.value),i},i.getValue=function(){return i.options.value},i.setValue=function(t,n){if(i.setLabel(t),i.options.value=String(t),e.value!=i.options.value&&(e.value=i.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),a.children[t]&&"generic"!==a.children[t].getAttribute("type")&&i.close(),n&&"function"==typeof i.options.onchange){var o=i.options.data[t];i.options.onchange(e,i,o,o,t,n)}},i.getLabel=function(e,t){var n=i.options.data[e]||null;return"function"==typeof i.options.render&&(n=i.options.render(n,t)),n},i.setLabel=function(e){var t;t=i.options.content?'<i class="material-icons">'+i.options.content+"</i>":i.getLabel(e,null),r(t)?(o.innerHTML="",o.appendChild(t)):o.innerHTML=t},i.open=function(){if(!e.classList.contains("jpicker-focus")){n(i,!0),e.classList.add("jpicker-focus"),e.focus();var t=0,s=0;a.style.marginLeft="";var r=o.getBoundingClientRect(),l=a.getBoundingClientRect();t=window.innerHeight<r.bottom+l.height||i.options.bottom?-1*(l.height+4):r.height+4,!0===i.options.right&&(s=-1*l.width+r.width),l.left+s<0&&(s=s+l.left+10),l.left+l.width>window.innerWidth&&(s=-1*(10+l.left+l.width-window.innerWidth)),a.style.marginTop=parseInt(t)+"px",a.style.marginLeft=parseInt(s)+"px","function"==typeof i.options.onopen&&i.options.onopen(e,i)}},i.close=function(){e.classList.contains("jpicker-focus")&&(e.classList.remove("jpicker-focus"),n(i,!1),"function"==typeof i.options.onclose&&i.options.onclose(e,i))};return e.classList.add("jpicker"),e.setAttribute("tabindex","900"),e.onmousedown=function(t){e.classList.contains("jpicker-focus")||i.open()},(o=document.createElement("div")).classList.add("jpicker-header"),(a=document.createElement("div")).classList.add("jpicker-content"),a.onclick=function(e){var t=s.findElement(e.target,"jpicker-item");t&&t.parentNode===a&&i.setValue(t.k,e)},e.appendChild(o),e.appendChild(a),e.value=t.value||0,i.setOptions(t),"function"==typeof i.options.onload&&i.options.onload(e,i),e.change=i.setValue,e.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},e.picker=i,i}function E(e,t){var i={type:"toolbar",options:{}},o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var a in o)t&&t.hasOwnProperty(a)?i.options[a]=t[a]:i.options[a]=o[a];!e&&t.app&&t.app.el&&(e=document.createElement("div"),t.app.el.appendChild(e));var r=document.createElement("div");r.classList.add("jtoolbar-item"),r.classList.add("jtoolbar-arrow");var l=document.createElement("div");l.classList.add("jtoolbar-floating"),r.appendChild(l),i.selectItem=function(e){for(var t=d.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},i.hide=function(){p.slideBottom(e,0,(function(){e.style.display="none"}))},i.show=function(){e.style.display="",p.slideBottom(e,1)},i.get=function(){return e},i.setBadge=function(e,t){d.children[e].children[1].firstChild.innerHTML=t},i.destroy=function(){toolbar.remove(),e.innerHTML=""},i.update=function(t,n){for(var o=0;o<d.children.length;o++){"function"==typeof(a=d.children[o]).updateState&&a.updateState(e,i,a,t,n)}for(o=0;o<l.children.length;o++){var a;"function"==typeof(a=l.children[o]).updateState&&a.updateState(e,i,a,t,n)}},i.create=function(t){d.innerHTML="";for(var n=0;n<t.length;n++){var o=document.createElement("div");if(o.classList.add("jtoolbar-item"),t[n].width&&(o.style.width=parseInt(t[n].width)+"px"),t[n].k&&(o.k=t[n].k),t[n].tooltip&&o.setAttribute("title",t[n].tooltip),t[n].id&&o.setAttribute("id",t[n].id),t[n].updateState&&(o.updateState=t[n].updateState),t[n].active&&o.classList.add("jtoolbar-active"),t[n].disabled&&o.classList.add("jtoolbar-disabled"),"select"==t[n].type||"dropdown"==t[n].type)j(o,t[n]);else if("divisor"==t[n].type)o.classList.add("jtoolbar-divisor");else if("label"==t[n].type)o.classList.add("jtoolbar-label"),o.innerHTML=t[n].content;else{var a=document.createElement("i");if(void 0===t[n].class)a.classList.add("material-icons");else for(var s=t[n].class.split(" "),r=0;r<s.length;r++)a.classList.add(s[r]);if(a.innerHTML=t[n].content?t[n].content:"",o.appendChild(a),1==i.options.badge){var l=document.createElement("div");l.classList.add("jbadge");var c=document.createElement("div");c.innerHTML=t[n].badge?t[n].badge:"",l.appendChild(c),o.appendChild(l)}if(t[n].title)if(1==i.options.title){var u=document.createElement("span");u.innerHTML=t[n].title,o.appendChild(u)}else o.setAttribute("title",t[n].title);i.options.app&&t[n].route&&(o.route=t[n].route,o.onclick=function(){i.options.app.pages(this.route)},i.options.app.pages(t[n].route,{toolbarItem:o,closed:!0})),"function"==typeof t[n].render&&t[n].render(o,t[n])}t[n].onclick&&(o.onclick=t[n].onclick.bind(t[n],e,i,o)),d.appendChild(o)}setTimeout((function(){i.refresh()}),0)},i.open=function(){r.classList.add("jtoolbar-arrow-selected");e.getBoundingClientRect();l.getBoundingClientRect().bottom>window.innerHeight||i.options.bottom?l.style.bottom="0":l.style.removeProperty("bottom"),l.style.right="0",r.children[0].focus(),n(i,!0)},i.close=function(){r.classList.remove("jtoolbar-arrow-selected"),n(i,!1)},i.refresh=function(){if(1==i.options.responsive){var t=e.parentNode.getBoundingClientRect();i.options.maxWidth||(i.options.maxWidth=t.width);var n=parseInt(i.options.maxWidth);for(r.parentNode&&r.parentNode.removeChild(r);l.firstChild;)d.appendChild(l.firstChild);if(n<d.offsetWidth)for(n-=50;d.lastChild&&n<d.offsetWidth;)l.insertBefore(d.lastChild,l.firstChild);l.children.length>0&&d.appendChild(r)}},i.setReadonly=function(t){t=t?"add":"remove",e.classList[t]("jtoolbar-disabled")},e.onclick=function(e){var t=s.findElement(e.target,"jtoolbar-item");t&&i.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&i.open()},window.addEventListener("resize",(function(){i.refresh()})),e.classList.add("jtoolbar"),e.innerHTML="",1==i.options.container&&e.classList.add("jtoolbar-container");var d=document.createElement("div");return e.appendChild(d),i.options.app&&e.classList.add("jtoolbar-mobile"),i.create(i.options.items),e.toolbar=i,i}var C=function(){var e=function(t,n){var i={type:"editor",options:{}},o={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var a in o)n&&n.hasOwnProperty(a)?i.options[a]=n[a]:i.options[a]=o[a];var r=null,l=null,d=[];i.el=t,"function"==typeof i.options.onclick&&(t.onclick=function(e){i.options.onclick(t,i,e)}),t.classList.add("jeditor-container");var c=document.createElement("div");c.className="jsnippet",c.setAttribute("contenteditable",!1);var p=document.createElement("div");if(p.className="jeditor-toolbar",i.editor=document.createElement("div"),i.editor.setAttribute("contenteditable",!0),i.editor.setAttribute("spellcheck",!1),i.editor.classList.add("jeditor"),i.options.placeholder&&i.editor.setAttribute("data-placeholder",i.options.placeholder),(i.options.maxHeight||i.options.height)&&(i.editor.style.overflowY="auto",i.options.maxHeight&&(i.editor.style.maxHeight=i.options.maxHeight),i.options.height&&(i.editor.style.height=i.options.height)),i.options.url)u({url:i.options.url,dataType:"html",success:function(t){i.editor.innerHTML=t,e.setCursor(i.editor,"initial"==i.options.focus)}});else if(i.options.value)i.editor.innerHTML=i.options.value;else for(var f=0;f<t.children.length;f++)i.editor.appendChild(t.children[f]);t.innerHTML="";var h=function(e){"function"==typeof i.options.onchange&&i.options.onchange(t,i,e),i.options.value=i.getData(),t.value!=i.options.value&&(t.value=i.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},m=function(){var e=null;if(e=c.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}};i.appendSnippet=function(e){c.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var o=document.createElement("div");if(o.className="jsnippet-"+t[n],o.setAttribute("data-k",t[n]),c.appendChild(o),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var a=0;a<e.image.length;a++){var s=document.createElement("img");s.src=e.image[a],o.appendChild(s)}}else o.innerHTML=e[t[n]]}i.editor.appendChild(document.createElement("br")),i.editor.appendChild(c)},i.setData=function(t){i.editor.innerHTML="object"==typeof t?t.content:t,i.options.focus&&e.setCursor(i.editor,!0),d=[]},i.getFiles=function(){for(var e=i.editor.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)d[e[n].src]&&t.push(d[e[n].src]);return t},i.getText=function(){return i.editor.innerText},i.getData=function(e){if(e){u={content:""};if(c.innerHTML){u.snippet={};for(var t=0;t<c.children.length;t++){var n=c.children[t].getAttribute("data-k");if(n)if("image"==n){u.snippet.image||(u.snippet.image=[]);for(var o=0;o<c.children[t].children.length;o++)u.snippet.image.push(c.children[t].children[o].getAttribute("src"))}else u.snippet[n]=c.children[t].innerHTML}}var a=Object.keys(d);if(a.length){u.files=[];for(t=0;t<a.length;t++)u.files.push(d[a[t]])}var s=document.createElement("div");s.innerHTML=i.editor.innerHTML;var r=s.querySelector(".jsnippet");r&&r.remove();var l=s.innerHTML;l=(l=(l=l.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),u.content=l.trim(),S("getData",u)}else var u=i.editor.innerHTML;return u},i.reset=function(){i.editor.innerHTML="",c.innerHTML="",d=[]},i.addPdf=function(e){if("data"!=e.result.substr(0,4));else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",d[n.src]={file:n.src,extension:"pdf",content:e.result},document.execCommand("insertHtml",!1,n.outerHTML)}))}},i.addImage=function(e,t){if(i.options.acceptImages)if(e||(e=""),"data"==e.substr(0,4)||i.options.remoteParser){if("data"==e.substr(0,4)){n=(n=(n=e.split(";"))[0].split("/"))[1]}else{var n=e.substr(e.lastIndexOf(".")+1);e=i.options.remoteParser+e}var o=new Image;o.onload=function(){var e=document.createElement("canvas");e.width=o.width,e.height=o.height,e.getContext("2d").drawImage(o,0,0,e.width,e.height),e.toBlob((function(a){var s,r=document.createElement("img");r.src=window.URL.createObjectURL(a),r.classList.add("jfile"),r.setAttribute("tabindex","900"),r.setAttribute("width",o.width),r.setAttribute("height",o.height),d[r.src]={file:r.src,extension:n,content:e.toDataURL()},i.options.dropAsSnippet||t?(s=r,c.innerHTML||i.appendSnippet({}),c.children[0].appendChild(s),m(),d[r.src].snippet=!0):document.execCommand("insertHtml",!1,r.outerHTML),h()}))},o.src=e}else;},i.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>i.options.maxFileSize);else{var o=e[n].type.split("/");(o="image"==o[0]?1:"pdf"==o[1]?2:0)&&(t[n]=new FileReader,t[n].index=n,t[n].type=o,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==i.options.acceptFiles&&i.addPdf(e.target):i.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n]))}},i.destroy=function(){i.editor.removeEventListener("mouseup",D),i.editor.removeEventListener("mousedown",O),i.editor.removeEventListener("mousemove",I),i.editor.removeEventListener("keyup",M),i.editor.removeEventListener("keydown",N),i.editor.removeEventListener("dragstart",L),i.editor.removeEventListener("dragenter",j),i.editor.removeEventListener("dragover",C),i.editor.removeEventListener("drop",T),i.editor.removeEventListener("paste",w),i.editor.removeEventListener("blur",k),i.editor.removeEventListener("focus",A),t.editor=null,t.classList.remove("jeditor-container"),p.remove(),c.remove(),i.editor.remove()},i.upload=function(){s.click(i.file)};const v=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],g=["width","height","align","border","src","tabindex"],y=["color","font-weight","font-size","background","background-color","margin"],b=function(e){if(e.tagName&&-1===v.indexOf(e.tagName.toLowerCase())&&e.innerText&&(e.innerHTML=e.innerText),e.attributes&&e.attributes.length){let t=null,n=e.getAttribute("style");if(n){t=[];let e=n.split(";");for(let n=0;n<e.length;n++){let i=e[n].trim().split(":");if(y.indexOf(i[0].trim())>=0){let e=i.shift();i=i.join(":"),t.push(e+":"+i)}}}"IMG"===e.tagName.toUpperCase()&&(i.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),i.addImage(e.src)):e.parentNode.removeChild(e));let o=[];for(let t=0;t<e.attributes.length;t++)o.push(e.attributes[t].name);o.length&&o.forEach((function(t){-1===g.indexOf(t)?e.removeAttribute(t):e.attributes&&e.attributes[f]&&-1!==e.attributes[f].value.indexOf("<")&&e.attributes[f].value.replace("<","&#60;")})),e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(let t=e.children.length;t>0;t--)b(e.children[t-1])};var x=function(e){var t=window.getSelection(),n=document.createRange();n.selectNode(e),t.addRange(n)},w=function(e){if(1==i.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),o=(e.originalEvent||e).clipboardData.files;else if(window.clipboardData)t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),o=window.clipboardData.files;if(o.length)i.addFile(o);else if(t){var a=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");b(t);var n=document.createElement("div");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,a.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertText",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,i.editor.appendChild(t)}));e.preventDefault()}},L=function(e){l&&l.e&&e.preventDefault()},j=function(e){l||0==i.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},C=function(e){l||0==i.options.dropZone||(r&&clearTimeout(r),r=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},T=function(e){if(l||0==i.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var o=window.getSelection();o.removeAllRanges(),o.addRange(n),o.anchorNode.parentNode.focus();var a=(e.originalEvent||e).dataTransfer.getData("text/html"),s=(e.originalEvent||e).dataTransfer.getData("text/plain"),r=(e.originalEvent||e).dataTransfer.files;r.length?i.addFile(r):s&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var o=0;o<n.length;o++)i.addImage(n[o].src)}(a),t.classList.remove("jeditor-dragging"),e.preventDefault()}},k=function(e){S("onevent",e),h(e),"function"==typeof i.options.onblur&&i.options.onblur(t,i,e)},A=function(e){"function"==typeof i.options.onfocus&&i.options.onfocus(t,i,e)},M=function(e){i.editor.innerHTML||(i.editor.innerHTML="<div><br></div>"),"function"==typeof i.options.onkeyup&&i.options.onkeyup(t,i,e)},N=function(e){if(S("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName){var n=e.target.parentNode;x(e.target),n.classList.contains("jsnippet-image")&&m()}"function"==typeof i.options.onkeydown&&i.options.onkeydown(t,i,e)},D=function(e){if(l&&l.e&&(l.e.classList.remove("resizing"),1==l.e.changed)){var t=l.e.cloneNode();t.width=parseInt(l.e.style.width)||l.e.getAttribute("width"),t.height=parseInt(l.e.style.height)||l.e.getAttribute("height"),l.e.style.width="",l.e.style.height="",x(l.e),document.execCommand("insertHtml",!1,t.outerHTML)}l=!1},O=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();l={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.getAttribute("width")||e.target.setAttribute("width",n.width),e.target.getAttribute("height")||e.target.setAttribute("height",n.height);var i=window.getSelection();if(i.rangeCount)for(var o=0;o<i.rangeCount;o++)i.removeRange(i.getRangeAt(o));e.target.classList.add("resizing")}else l=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),l=!0},I=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==i.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&l&&l.d){if("e-resize"==l.d||"ne-resize"==l.d||"se-resize"==l.d)if(l.e.style.width=l.w+(e.clientX-l.x),e.shiftKey){var n=(e.clientX-l.x)*(l.h/l.w);l.e.style.height=l.h+n}else n=null;n||"s-resize"!=l.d&&"se-resize"!=l.d&&"sw-resize"!=l.d||e.shiftKey||(l.e.style.height=l.h+(e.clientY-l.y)),l.e.changed=!0}},S=function(e,t){if(i.options.extensions){var n=Object.keys(i.options.extensions);if(n.length)for(var o=0;o<n.length;o++)i.options.extensions[n[o]]&&"function"==typeof i.options.extensions[n[o]][e]&&i.options.extensions[n[o]][e].call(i,t)}};if(document.addEventListener("mouseup",D),document.addEventListener("mousemove",I),i.editor.addEventListener("mousedown",O),i.editor.addEventListener("keyup",M),i.editor.addEventListener("keydown",N),i.editor.addEventListener("dragstart",L),i.editor.addEventListener("dragenter",j),i.editor.addEventListener("dragover",C),i.editor.addEventListener("drop",T),i.editor.addEventListener("paste",w),i.editor.addEventListener("focus",A),i.editor.addEventListener("blur",k),t.appendChild(i.editor),i.options.snippet&&i.appendSnippet(i.options.snippet),i.options.toolbar){if(Array.isArray(i.options.toolbar))var H={container:!0,responsive:!0,items:i.options.toolbar};else if(!0===i.options.toolbar)H={container:!0,responsive:!0,items:[]};else H=i.options.toolbar;H.items&&H.items.length||(H.items=e.getDefaultToolbar(i)),i.options.toolbarOnTop?(t.classList.add("toolbar-on-top"),t.insertBefore(p,t.firstChild)):(i.editor.style.padding="15px",t.appendChild(p)),E(p,H),p.addEventListener("click",(function(){i.editor.focus()}))}return i.file=document.createElement("input"),i.file.style.display="none",i.file.type="file",i.file.setAttribute("accept","image/*"),i.file.onchange=function(){i.addFile(this.files)},t.appendChild(i.file),i.options.focus&&e.setCursor(i.editor,"initial"==i.options.focus),t.change=i.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return i.getData(n)}i.setData(e)},function(){if(i.options.extensions){var e=Object.keys(i.options.extensions);if(e.length)for(var n=0;n<e.length;n++)i.options.extensions[e[n]]&&"function"==typeof i.options.extensions[e[n]]&&(i.options.extensions[e[n]]=i.options.extensions[e[n]](t,i))}}(),t.editor=i,"function"==typeof i.options.onload&&i.options.onload(t,i,i.editor),i};return e.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),i=n.getRangeAt(0);if(1==t)var o=i.startContainer,a=0;else a=(o=i.endContainer).length;i.setStart(o,a),i.setEnd(o,a),n.removeAllRanges(),n.addRange(i)},e.getDefaultToolbar=function(e){var t=function(e,t,n){if(!n.color){b(n,{onchange:function(e,t){"color"===n.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}});n.color.open()}},n=[];return n.push({content:"undo",onclick:function(){document.execCommand("undo")}}),n.push({content:"redo",onclick:function(){document.execCommand("redo")}}),n.push({type:"divisor"}),e.options.toolbarOnTop&&(n.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,n,i,o){document.execCommand("fontName",!1,i)}}),n.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,n,i,o){document.execCommand("fontSize",!1,parseInt(o)+1)}}),n.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,n,i,o){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][o])}}),n.push({type:"divisor"}),n.push({content:"format_color_text",k:"color",onclick:t}),n.push({content:"format_color_fill",k:"background-color",onclick:t})),n.push({content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({type:"divisor"}),n.push({content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(n.push({type:"divisor"}),n.push({content:"photo",onclick:function(){e.upload()}}),n.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));var n=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",n},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),n=parseInt(e.target.getAttribute("data-y")),i=0;i<e.target.parentNode.children.length;i++){var o=e.target.parentNode.children[i],a=parseInt(o.getAttribute("data-x")),s=parseInt(o.getAttribute("data-y"));a<=t&&s<=n?(o.style.backgroundColor="#cae1fc",o.style.borderColor="#2977ff"):(o.style.backgroundColor="",o.style.borderColor="#ddd")}},onchange:function(e,t,n){n=n.split("x");for(var i=document.createElement("table"),o=document.createElement("tbody"),a=0;a<=n[1];a++){for(var s=document.createElement("tr"),r=0;r<=n[0];r++){var l=document.createElement("td");l.innerHTML="",s.appendChild(l)}o.appendChild(s)}i.appendChild(o),i.setAttribute("width","100%"),i.setAttribute("cellpadding","6"),i.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,i.outerHTML)}})),n},e}();var T=function(){var e=function(t,n){var i={options:{}},o={type:"big",title:"Untitled",width:510,height:472};for(var a in o)n&&n.hasOwnProperty(a)?i.options[a]=n[a]:i.options[a]=o[a];return i.state={isMinized:!1},i.setState=function(){i.state.isMinized?i.container.classList.remove("jfloating-minimized"):i.container.classList.add("jfloating-minimized"),i.state.isMinized=!i.state.isMinized},i.close=function(){Components.elements.splice(e.elements.indexOf(i.container),1),i.updatePosition(),t.remove()},i.updatePosition=function(){for(var t=0;t<e.elements.length;t++){var n=e.elements[t],i=e.elements[t-1];n.style.right=t*(i?i.offsetWidth:n.offsetWidth)*1.01+"px"}},i.init=function(){!function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(i.content=document.createElement("div"),i.content.className="jfloating_content",i.content.innerHTML=t.innerHTML;e.children[0];)i.content.appendChild(e.children[0]);i.container=document.createElement("div"),i.container.className="jfloating",i.container.appendChild(i.content),i.options.title?i.container.setAttribute("title",i.options.title):i.container.classList.add("no-title"),i.options.width&&(i.container.style.width=parseInt(i.options.width)+"px"),i.options.height&&(i.container.style.height=parseInt(i.options.height)+"px"),t.innerHTML="",t.appendChild(i.container)}(),i.container&&i.container.addEventListener("click",(function(e){var t=e.target.getBoundingClientRect();if(e.target.classList.contains("jfloating")){if(e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else n=e.clientX,o=e.clientY;t.width-(n-t.left)<50&&o-t.top<50?setTimeout((function(){i.close()}),100):i.setState()}})),i.container.classList.add("jfloating-"+i.options.type),e.elements.push(i.container),i.updatePosition(),t.floating=i},i.init(),i};return e.elements=[],e}();var k=function(){const e=function(e){return!isNaN(e)&&null!==e&&("string"!=typeof e||""!==e.trim())},t={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},n={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},i={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},o=function(e,t){return"function"==typeof o[t.type]?!(!t.allowBlank||void 0!==e&&""!==e&&null!==e)||o[t.type].call(this,e,t):null};o.url=function(e){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)},o.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},o.required=function(e){return!(!e||!e.trim())},o.empty=function(e){return null==e||"string"==typeof e&&!e.toString().trim()},o["not exist"]=o.empty,o.notEmpty=function(e){return!o.empty(e)},o.exist=o.notEmpty,o.number=function(n,i){if(!e(n))return!1;if(!i||!i.criteria)return!0;if(!t[i.criteria])return!1;let o=i.value.map((function(e){return parseFloat(e)}));return t[i.criteria](n,o)},o.login=function(e){let t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},o.list=function(e,t){let n,i=typeof e;if("string"!==i&&"number"!==i)return!1;if(n="string"==typeof t.value[0]?t.source?t.source:t.value[0].split(","):t.value[0],Array.isArray(n)){return n.findIndex((function(t){return t==e}))>-1}return!1};const a=function(){let e=new Date;return e.setHours(0,0,0,0),e},s={"one year ago":function(){let e=a();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){let e=a();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){let e=a();return e.setDate(e.getDate()-7),e},yesterday:function(){let e=a();return e.setDate(e.getDate()-1),e},today:a,tomorrow:function(){let e=a();return e.setDate(e.getDate()+1),e}};return o.date=function(t,i){if(e(t)&&t>0&&t<1e6&&(t=f.numToDate(t)),"Invalid Date"==new Date(t))return!1;if(!i||!i.criteria)return!0;if(!n[i.criteria])return!1;let o=i.value.map((function(e){return"string"==typeof e&&s[e]?s[e]().getTime():new Date(e).getTime()}));return n[i.criteria](new Date(t).getTime(),o)},o.text=function(e,t){if(null==e)e="";else if("string"!=typeof e)return!1;return!t||!t.criteria||!!i[t.criteria]&&i[t.criteria](e,t.value)},o.textLength=function(e,t){return e=e.toString(),o.number(e.length,t)},o}();var A=function(){var e=function(t,n){var i={options:{}},o={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){}};for(var a in o)n&&n.hasOwnProperty(a)?i.options[a]=n[a]:i.options[a]=o[a];i.options.validations||(i.options.validations={}),i.options.submitButton||(i.options.submitButton=t.querySelector("input[type=submit]")),i.options.submitButton&&i.options.url&&(i.options.submitButton.onclick=function(){i.save()}),i.options.validations.email||(i.options.validations.email=k.email),i.options.validations.length||(i.options.validations.length=k.length),i.options.validations.required||(i.options.validations.required=k.required),i.setUrl=function(e){i.options.url=e},i.load=function(){u({url:i.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof i.options.onbeforeload){var o=i.options.onbeforeload(t,n);o&&(n=o)}e.setElements(t,n),"function"==typeof i.options.onload&&i.options.onload(t,n)}})},i.save=function(){var n=i.validate();if(n)i.options.onerror(t,n);else{var o=e.getElements(t,!0);if("function"==typeof i.options.onbeforesave)if(!1===(o=i.options.onbeforesave(t,o)))return;u({url:i.options.url,method:"POST",dataType:"json",data:o,success:function(e){"function"==typeof i.options.onsave&&i.options.onsave(t,o,e)}})}},i.remove=function(){if("function"==typeof i.options.onbeforeremove&&!1===i.options.onbeforeremove(t,i))return!1;u({url:i.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof i.options.onremove&&i.options.onremove(t,i,e),i.reset()}})};return i.validateElement=function(n){var o=!1,a=e.getValue(n),s=n.getAttribute("data-validation");return"function"!=typeof i.options.validations[s]||i.options.validations[s](a,n)?n.classList.contains("error")&&function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var o=t.querySelectorAll("input, select, textarea, div[name]"),a=0;a<o.length;a++)o[a].getAttribute("data-validation")&&o[a].classList.contains("error")&&(n=!0);i.options.submitButton&&(n?i.options.submitButton.setAttribute("disabled",!0):i.options.submitButton.removeAttribute("disabled"))}(n):o=function(e){e.classList.add("error"),i.options.submitButton&&i.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(n),o},i.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},i.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),o=0;o<n.length;o++)if(n[o].getAttribute("data-validation")){var a=i.validateElement(n[o]);a&&e.push(a)}return e.length>0&&e.join("<br>")},i.getError=function(){return!!i.validation()},i.setHash=function(){return i.getHash(e.getElements(t))},i.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},i.isChanged=function(){var e=i.setHash();return i.options.currentHash!=e},i.resetTracker=function(){i.options.currentHash=i.setHash(),i.options.ignore=!1},i.setIgnore=function(e){i.options.ignore=!!e},setTimeout((function(){i.options.currentHash=i.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&i.validateElement(e.target)})),e.hasEvents||(window.addEventListener("beforeunload",(function(e){if(i.isChanged()&&0==i.options.ignore){var t=i.options.message?i.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.hasEvents=!0),t.form=i,i};return e.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),i=0;i<n.length;i++)t.push(n[i].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.getElements=function(t,n){for(var i={},o=null,a=t.querySelectorAll("input, select, textarea, div[name]"),s=0;s<a.length;s++)(o=a[s].getAttribute("name"))&&(i[o]=e.getValue(a[s])||"");return 1==n?i:JSON.stringify(i)},e.setElements=function(e,t){for(var n=null,i=null,o=e.querySelectorAll("input, select, textarea, div[name]"),a=0;a<o.length;a++){var s=o[a].getAttribute("type");if(n=o[a].getAttribute("name")){if(i=null,(n=n.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var l=r.call(t,n)||"";void 0!==l&&(i=l)}else void 0!==t[n]&&(i=t[n]);null!==i&&("checkbox"==s||"radio"==s?o[a].checked=!!i:"file"==s||("function"==typeof o[a].val?o[a].val(i):o[a].value=i))}}},e}();var M=function(){var e=function(){var e=null;document.addEventListener("keydown",(function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()})),document.addEventListener("mouseup",(function(t){let n=t.composedPath();var i=s.findElement(n[0],"jmodal");if(i){var o=i.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var a=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY;else a=t.clientX,r=t.clientY;o.width-(a-o.left)<50&&r-o.top<50&&i.parentNode.modal.close()}e&&(e.element.style.cursor="auto",e=null)})),document.addEventListener("mousedown",(function(t){let n=t.composedPath();var i=s.findElement(n[0],"jmodal");if(i){var o=i.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var a=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY;else a=t.clientX,r=t.clientY;o.width-(a-o.left)<50&&r-o.top<50||r-o.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e={left:o.left,top:o.top,x:t.clientX,y:t.clientY,width:o.width,height:o.height,element:i})}})),document.addEventListener("mousemove",(function(t){if(e){if((t=t||window.event).buttons)var n=t.buttons;else if(t.button)n=t.button;else n=t.which;n?(e.element.style.top=e.top+(t.clientY-e.y)+e.height/2+"px",e.element.style.left=e.left+(t.clientX-e.x)+e.width/2+"px",e.element.style.cursor="move"):e.element.style.cursor="auto"}}))};return function(t,n){var i={options:{}},o={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var a in o)n&&n.hasOwnProperty(a)?i.options[a]=n[a]:i.options[a]=o[a];!i.options.title&&t.getAttribute("title")&&(i.options.title=t.getAttribute("title"));for(var r=document.createElement("div");t.children[0];)r.appendChild(t.children[0]);for(i.title=document.createElement("div"),i.title.className="jmodal_title",i.options.icon&&i.title.setAttribute("data-icon",i.options.icon),i.content=document.createElement("div"),i.content.className="jmodal_content",i.content.innerHTML=t.innerHTML;r.children[0];)i.content.appendChild(r.children[0]);if(i.container=document.createElement("div"),i.container.className="jmodal",i.container.appendChild(i.title),i.container.appendChild(i.content),i.options.padding&&(i.content.style.padding=i.options.padding),i.options.width&&(i.container.style.width=i.options.width),i.options.height&&(i.container.style.height=i.options.height),i.options.title){var l=document.createElement("h4");l.innerText=i.options.title,i.title.appendChild(l)}if(t.innerHTML="",t.style.display="none",t.appendChild(i.container),i.options.backdrop){var d=document.createElement("div");d.className="jmodal_backdrop",d.onclick=function(){i.close()},t.appendChild(d)}return i.open=function(){t.style.display="block";var e=i.container.getBoundingClientRect();s.getWindowWidth()<e.width?(i.container.style.top="",i.container.style.left="",i.container.classList.add("jmodal_fullscreen"),p.slideBottom(i.container,1)):i.options.backdrop&&(d.style.display="block"),"function"==typeof i.options.onopen&&i.options.onopen(t,i)},i.resetPosition=function(){i.container.style.top="",i.container.style.left=""},i.isOpen=function(){return"none"!=t.style.display},i.close=function(){i.isOpen()&&(t.style.display="none",i.options.backdrop&&(d.style.display=""),i.container.classList.remove("jmodal_fullscreen"),"function"==typeof i.options.onclose&&i.options.onclose(t,i))},i.options.url?u({url:i.options.url,method:"GET",dataType:"text/html",success:function(e){i.content.innerHTML=e,i.options.closed||i.open(),"function"==typeof i.options.onload&&i.options.onload(i)}}):(i.options.closed||i.open(),"function"==typeof i.options.onload&&i.options.onload(i)),t.modal=i,e(),e=function(){},i}}();var N=function(){var e=function(e){var t={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var i in n)e&&e.hasOwnProperty(i)?t.options[i]=e[i]:t.options[i]=n[i];var o=document.createElement("div");o.className="jnotification",t.options.error&&o.classList.add("jnotification-error");var a=document.createElement("div");a.className="jnotification-container",o.appendChild(a);var r=document.createElement("div");r.className="jnotification-header",a.appendChild(r);var l=document.createElement("div");if(l.className="jnotification-image",r.appendChild(l),t.options.icon){var d=document.createElement("img");d.src=t.options.icon,l.appendChild(d)}var c=document.createElement("div");if(c.className="jnotification-name",c.innerHTML=t.options.name,r.appendChild(c),1==t.options.closeable){var u=document.createElement("div");u.className="jnotification-close",u.onclick=function(){t.hide()},r.appendChild(u)}var f=document.createElement("div");f.className="jnotification-date",r.appendChild(f);var h=document.createElement("div");if(h.className="jnotification-content",a.appendChild(h),t.options.title){var m=document.createElement("div");m.className="jnotification-title",m.innerHTML=t.options.title,h.appendChild(m)}var v=document.createElement("div");if(v.className="jnotification-message",v.innerHTML=t.options.message,h.appendChild(v),t.show=function(){document.body.appendChild(o),s.getWindowWidth()>800?p.fadeIn(o):p.slideTop(o,1)},t.hide=function(){s.getWindowWidth()>800?p.fadeOut(o,(function(){o.parentNode&&(o.parentNode.removeChild(o),g&&clearTimeout(g))})):p.slideTop(o,0,(function(){o.parentNode&&(o.parentNode.removeChild(o),g&&clearTimeout(g))}))},t.show(),1==t.options.autoHide)var g=setTimeout((function(){t.hide()}),t.options.timeout);return s.getWindowWidth()<800&&o.addEventListener("swipeup",(function(e){t.hide(),e.preventDefault(),e.stopPropagation()})),t};return e.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e}();function D(e,t){if(e.search)return e.search;var n=null,i=function(t){if("function"==typeof r.options.onsearch){var n=r.options.onsearch(r,t);n&&(t=n)}if(l.innerHTML="",t.length){e.style.display="block";for(var i=t.length<11?t.length:10,o=0;o<i;o++){if("string"==typeof t[o])var a=t[o],s=t[o];else!(a=t[o].text)&&t[o].name&&(a=t[o].name),!(s=t[o].value)&&t[o].id&&(s=t[o].id);var d=document.createElement("div");d.setAttribute("data-value",s),d.setAttribute("data-text",a),d.className="jsearch_item",t[o].id&&d.setAttribute("id",t[o].id),r.options.forceSelect&&0==o&&d.classList.add("selected");var c=document.createElement("img");t[o].image?c.src=t[o].image:c.style.display="none",d.appendChild(c);var u=document.createElement("div");u.innerHTML=a,d.appendChild(u),l.appendChild(d)}}else e.style.display=""},o=function(e){if(e!=r.terms)if(r.terms=e,n=r.options.forceSelect?0:null,Array.isArray(r.options.data)){var t=r.options.data.filter((function(t){return function(t){if("string"==typeof t){if((""+t).toLowerCase().search(e.toLowerCase())>=0)return!0}else for(var n in t)if((""+t[n]).toLowerCase().search(e.toLowerCase())>=0)return!0;return!1}(t)}));i(t)}else u({url:r.options.data+e,method:"GET",dataType:"json",success:function(e){i(e)}})},a=null,r=function(e){a&&clearTimeout(a),a=setTimeout((function(){o(e)}),500)};null===t.forceSelect&&(t.forceSelect=!0),r.options={data:t.data||null,input:t.input||null,searchByNode:t.searchByNode||null,onselect:t.onselect||null,forceSelect:t.forceSelect,onsearch:t.onsearch||null,onbeforesearch:t.onbeforesearch||null},r.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),i=e.getAttribute("data-value"),o=e.children[0].src||"";"function"==typeof r.options.onselect&&r.options.onselect(r,n,i,t,o),r.close()},r.open=function(){e.style.display="block"},r.close=function(){a&&clearTimeout(a),r.terms="",l.innerHTML="",e.style.display=""},r.isOpened=function(){return!!e.style.display},r.keydown=function(e){r.isOpened()&&("Enter"==e.key?null!==n&&l.children[n]?(r.selectIndex(l.children[n]),e.preventDefault()):r.close():"ArrowUp"===e.key?(null!==n&&l.children[0]&&(l.children[n].classList.remove("selected"),r.options.forceSelect||0!==n?(n=Math.max(0,n-1),l.children[n].classList.add("selected")):n=null),e.preventDefault()):"ArrowDown"===e.key&&(null==n?n=-1:l.children[n].classList.remove("selected"),n<9&&l.children[n+1]&&n++,l.children[n].classList.add("selected"),e.preventDefault()))},r.keyup=function(e){if(!r.options.searchByNode&&r.options.input)if("DIV"===r.options.input.tagName)var t=r.options.input.innerText;else t=r.options.input.value;else{var n=s.getNode();if(n)t=n.innerText}if("function"==typeof r.options.onbeforesearch){var i=r.options.onbeforesearch(r,t);if(i)t=i;else if(!1===i)return}r(t)},r.blur=function(e){r.close()},r.options.input&&(r.options.input.addEventListener("keyup",r.keyup),r.options.input.addEventListener("keydown",r.keydown),r.options.input.addEventListener("blur",r.blur));var l=document.createElement("div");return l.classList.add("jsearch_container"),l.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;r.selectIndex(t),e.preventDefault()},e.appendChild(l),e.classList.add("jsearch"),e.search=r,r}function O(e,t){var n={options:{}},i={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var o in i)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=i[o];1==n.options.multiple&&e.setAttribute("data-multiple",!0),e.content=[],e.classList.add("jupload"),1==n.options.input&&e.classList.add("input"),n.add=function(t){if(0==n.options.multiple&&(e.content=[],e.innerText=""),"image"==n.options.type){var i=document.createElement("img");i.setAttribute("src",t.file),i.setAttribute("tabindex",-1),e.getAttribute("name")||(i.className="jfile",i.content=t),e.appendChild(i)}else{if(t.name)var o=t.name;else o=t.file;var a=document.createElement("div");a.innerText=o||n.options.type,a.classList.add("jupload-item"),a.setAttribute("tabindex",-1),e.appendChild(a)}t.content&&(t.file=s.guid()),e.content.push(t),"function"==typeof n.options.onchange&&n.options.onchange(e,t)},n.addFromFile=function(e){if(e.type.split("/")[0]==n.options.type){var t=new FileReader;t.addEventListener("load",(function(t){var i={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result};n.add(i)})),t.readAsDataURL(e)}},n.addFromUrl=function(e){if("data"==e.substr(0,4)||n.options.remoteParser)if("data"==e.substr(0,4)){if((i=(i=e.split(";"))[0].split("/"))[0].replace("data:","")==n.options.type){var t={file:e,name:"",extension:i[1],content:e};n.add(t)}}else{var i=e.substr(e.lastIndexOf(".")+1);e=n.options.remoteParser+e,u({url:e,type:"GET",dataType:"blob",success:function(e){}})}else;};var a=n.options.type+"/"+n.options.extension,r=document.createElement("input");r.type="file",r.setAttribute("accept",a),r.onchange=function(){for(var e=0;e<this.files.length;e++)n.addFromFile(this.files[e])},1==n.options.multiple&&r.setAttribute("multiple",!0);var l=null;return e.addEventListener("click",(function(t){l=null,e.children.length&&t.target!==e?t.target.parentNode==e&&(l=t.target):s.click(r)})),e.addEventListener("dblclick",(function(e){s.click(r)})),e.addEventListener("dragenter",(function(t){e.style.border="1px dashed #000"})),e.addEventListener("dragleave",(function(t){e.style.border="1px solid #eee"})),e.addEventListener("dragstop",(function(t){e.style.border="1px solid #eee"})),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("keydown",(function(t){if(l&&46==t.which){var n=Array.prototype.indexOf.call(e.children,l);n>=0&&(e.content.splice(n,1),l.remove(),l=null)}})),e.addEventListener("drop",(function(t){t.preventDefault(),t.stopPropagation();var i=(t.originalEvent||t).dataTransfer.getData("text/html");if((t.originalEvent||t).dataTransfer.files.length)for(var o=0;o<t.dataTransfer.files.length;o++)n.addFromFile(t.dataTransfer.files[o]);else if(i){0==n.options.multiple&&(e.innerText="");var a=document.createElement("div");a.innerHTML=i;var s=a.querySelectorAll("img");if(s.length)for(o=0;o<s.length;o++)n.addFromUrl(s[o].src)}return e.style.border="1px solid #eee",!1})),e.val=function(t){if(void 0===t)return e.content&&e.content.length?e.content:null;if(e.innerText="",e.content=[],t)if(Array.isArray(t))for(var i=0;i<t.length;i++)"string"==typeof t[i]?n.add({file:t[i]}):n.add(t[i]);else"string"==typeof t&&n.add({file:t})},e.upload=e.image=n,n}var I=i(195),S=i.n(I),H={...t,...s,version:"5.8.3",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),n=0;n<t.length;n++)H[t[n]]=e[t[n]]},tracking:n,path:r,sorting:l,lazyLoading:d,ajax:u,animation:p,calendar:m,color:b,contextmenu:w,dropdown:L,editor:C,floating:T,form:A,mask:h,modal:M,notification:N,palette:v,picker:j,progressbar:function(e,t){var n={options:{}},i={value:0,onchange:null,width:null};for(var o in i)t&&t.hasOwnProperty(o)?n.options[o]=t[o]:n.options[o]=i[o];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var a=document.createElement("div");a.style.width=n.options.value+"%",a.style.color="#fff",e.appendChild(a),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,a.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var s=function(t){if(t.which){var i=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var o=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else o=t.clientX,t.clientY;n.setValue(Math.round((o-i.left)/i.width*100))}};return"touchstart"in document.documentElement==!0?(e.addEventListener("touchstart",s),e.addEventListener("touchend",s)):(e.addEventListener("mousedown",s),e.addEventListener("mousemove",s)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},rating:function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,i){var o={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var a in o)t&&t.hasOwnProperty(a)?n.options[a]=t[a]:void 0!==n.options[a]&&!0!==i||(n.options[a]=o[a]);e.innerHTML="";for(var s=0;s<n.options.number;s++){var r=document.createElement("div");r.setAttribute("data-index",s+1),r.setAttribute("title",n.options.tooltip[s]),e.appendChild(r)}if(n.options.value)for(s=0;s<n.options.number;s++)s<n.options.value&&e.children[s].classList.add("jrating-selected");return n},setValue:function(t){for(var i=0;i<n.options.number;i++)i<t?e.children[i].classList.add("jrating-selected"):(e.children[i].classList.remove("jrating-over"),e.children[i].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var i=t.target.getAttribute("data-index"),o=0;o<n.options.number;o++)o<i?e.children[o].classList.add("jrating-over"):e.children[o].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var i=0;i<n.options.number;i++)e.children[i].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},search:D,slider:function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=parseInt(n.options.height)+"px"),n.options.width&&(e.style.width=parseInt(n.options.width)+"px"),n.options.grid){e.classList.add("jslider-grid");var i=e.children.length;i>4&&e.setAttribute("data-total",i-4),e.setAttribute("data-number",i>4?4:i)}var o=document.createElement("div");if(o.classList.add("jslider-counter"),e.children.length>0)for(var a=0;a<e.children.length;a++){n.options.items.push(e.children[a]);var s=document.createElement("div");s.onclick=function(){var e=Array.prototype.slice.call(o.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},o.appendChild(s)}var r=document.createElement("div");r.className="jslider-caption";var l=document.createElement("div"),d=document.createElement("div");d.className="jslider-close",d.innerHTML="",d.onclick=function(){n.close()},l.appendChild(r),l.appendChild(d)}n.updateCounter=function(e){for(var t=0;t<o.children.length;t++)if(o.children[t].classList.contains("jslider-counter-focus")){o.children[t].classList.remove("jslider-counter-focus");break}o.children[e].classList.add("jslider-counter-focus")},n.show=function(t){if(!t)t=e.children[0];e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(l),e.appendChild(o);var i=n.options.items.indexOf(t);n.updateCounter(i);for(var a=0;a<e.children.length;a++)e.children[a].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),l.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";o.remove(),l.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var c=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==!0?e.addEventListener("touchend",c):e.addEventListener("mouseup",c),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n,n},tabs:g,tags:function(e,t){if(e.tags)return e.tags.setOptions(t,!0);var n={type:"tags",options:{}},i=function(){return!!(n.options.limit&&e.children.length>=n.options.limit)},o=null,a=null;n.setOptions=function(t,i){var s={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var r in s)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:void 0!==n.options[r]&&!0!==i||(n.options[r]=s[r]);return n.options.placeholder?e.setAttribute("data-placeholder",n.options.placeholder):e.removeAttribute("data-placeholder"),e.placeholder=n.options.placeholder,n.setValue(n.options.value),c(),n.options.search?a||(a=document.createElement("div"),e.parentNode.insertBefore(a,e.nextSibling),o=D(a,{data:n.options.search,onselect:function(e,t,i){n.selectIndex(t,i)}})):a&&(o=null,a.remove(),a=null),n},n.add=function(t,a){if("function"==typeof n.options.onbeforechange){var c=n.options.onbeforechange(e,n,n.options.value,t);if(!1===c)return!1;null!=c&&(t=c)}if(o&&o.close(),i())"function"==typeof n.options.onlimit&&n.options.onlimit(n,n.options.limit);else{var u=s.getNode();if(!(u&&u.parentNode&&u.parentNode.classList.contains("jtags")&&u.nextSibling)||u.nextSibling.innerText&&u.nextSibling.innerText.trim()){if(e.lastChild&&(e.lastChild.innerText.trim()||e.removeChild(e.lastChild)),t&&"string"!=typeof t){for(var p=0;p<=t.length;p++)if(!i()){if(t[p]&&"string"!=typeof t[p])f=t[p].text,h=t[p].value;else var f=t[p]||"",h=null;m=l(f,h)}}else var m=l(t,t,u);d()}else m=u.nextSibling;a&&r(m)}},n.setLimit=function(t){n.options.limit=t;for(e.children.length;e.children.length>t;)e.removeChild(e.lastChild)},n.remove=function(t){t.parentNode.removeChild(t),e.children.length?d():n.add("",!0),"function"==typeof n.options.onremoveitem&&n.options.onremoveitem(e,n,t)},n.getData=function(){for(var t=[],n=0;n<e.children.length;n++){var i=e.children[n].innerText.replace("\n",""),o=e.children[n].getAttribute("data-value");o||(o=i),(i||o)&&t.push({text:i,value:o})}return t},n.getValue=function(t){var i=null;if(null!=t)(i=e.children[t].getAttribute("data-value"))||(i=e.children[t].innerText.replace("\n",""));else{for(var o=[],a=0;a<e.children.length;a++)(i=e.children[a].innerText.replace("\n",""))&&o.push(n.getValue(a));i=o.join(",")}return i},n.setValue=function(t){if(t){if(e.value!=t)if(Array.isArray(t))n.add(t);else{var i=(""+t).trim(),o=p(i);e.innerHTML="",n.add(o)}}else n.reset()},n.reset=function(){e.classList.add("jtags-empty"),e.innerHTML="<div></div>",d()},n.isValid=function(){for(var t=0,n=0;n<e.children.length;n++)e.children[n].classList.contains("jtags_error")&&t++;return 0==t},n.selectIndex=function(e,t){var o=s.getNode();o&&(o.innerText=e,t&&o.setAttribute("data-value",t),o.classList.remove("jtags_error"),i()||n.add("",!0))},n.search=function(e){e.innerText},n.destroy=function(){e.removeEventListener("mouseup",g),e.removeEventListener("keydown",h),e.removeEventListener("keyup",m),e.removeEventListener("paste",v),e.removeEventListener("focus",y),e.removeEventListener("blur",b),e.parentNode.removeChild(e)};var r=function(t){if(e.children.length){var n=document.createRange(),i=window.getSelection();if(!t)t=e.childNodes[e.childNodes.length-1];n.setStart(t,t.length),n.collapse(!0),i.removeAllRanges(),i.addRange(n),e.scrollLeft=e.scrollWidth}},l=function(t,n,i){var o=document.createElement("div");return o.textContent=t||"",n&&o.setAttribute("data-value",n),i&&i.parentNode.classList.contains("jtags")?e.insertBefore(o,i.nextSibling):e.appendChild(o),o},d=function(){var t=n.getValue();t!=n.options.value&&(n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,n,n.options.value),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))),c()},c=function(){for(var t=0;t<e.children.length;t++)"DIV"===e.children[t].tagName&&(n.getValue(t)?(e.children[t].classList.add("jtags_label"),"function"==typeof n.options.validation&&n.getValue(t)?n.options.validation(e.children[t],e.children[t].innerText,e.children[t].getAttribute("data-value"))?e.children[t].classList.remove("jtags_error"):e.children[t].classList.add("jtags_error"):e.children[t].classList.remove("jtags_error")):e.children[t].classList.remove("jtags_label"));u()},u=function(){e.innerText.trim()?e.classList.remove("jtags-empty"):e.children.length&&"BR"!==e.children[0].tagName||(e.innerHTML="",r(l()))},p=function(e){var t=[],n="";if(e=e.trim()){for(var i=0;i<e.length;i++)","==e[i]||";"==e[i]||"\n"==e[i]?n&&(t.push(n.trim()),n=""):n+=e[i];n&&t.push(n)}return t},f=0,h=function(t){if(f=window.getSelection().anchorOffset,u(),"Tab"===t.key||";"===t.key||","===t.key)window.getSelection().anchorOffset>1&&(i()?"function"==typeof n.options.onlimit&&n.options.onlimit(n,n.options.limit):n.add("",!0)),t.preventDefault();else if("Enter"==t.key){if(!o||!o.isOpened())window.getSelection().anchorOffset>1&&(i()||n.add("",!0)),t.preventDefault()}else"Backspace"==t.key&&1==e.children.length&&window.getSelection().anchorOffset<1&&t.preventDefault();o&&o.keydown(t),u()},m=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==f&&n.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():o&&o.keyup(e);c()},v=function(t){if(t.clipboardData||t.originalEvent.clipboardData)var i=(t.originalEvent||t).clipboardData.getData("text/plain");else if(window.clipboardData)i=window.clipboardData.getData("Text");var o=p(i);if("function"==typeof n.options.onbeforepaste){var a=n.options.onbeforepaste(e,n,o);if(!1===a)return t.preventDefault(),!1;a&&(o=a)}o.length>1?(n.add(o,!0),t.preventDefault()):o[0]&&(document.execCommand("insertText",!1,o[0]),t.preventDefault())},g=function(t){if(t.target.parentNode&&t.target.parentNode.classList.contains("jtags")&&(t.target.classList.contains("jtags_label")||t.target.classList.contains("jtags_error"))){var i=t.target.getBoundingClientRect();i.width-(t.clientX-i.left)<16&&n.remove(t.target)}t.target==e&&r()},y=function(){e.classList.contains("jtags-focus")||(e.children.length&&!n.getValue(e.children.length-1)||i()||l(""),"function"==typeof n.options.onfocus&&n.options.onfocus(e,n,n.getValue()),e.classList.add("jtags-focus"))},b=function(){if(e.classList.contains("jtags-focus")){o&&o.close();for(var t=0;t<e.children.length-1;t++)n.getValue(t)||e.removeChild(e.children[t]);d(),e.classList.remove("jtags-focus"),"function"==typeof n.options.onblur&&n.options.onblur(e,n,n.getValue())}};return"touchend"in document.documentElement==1?e.addEventListener("touchend",g):e.addEventListener("mouseup",g),e.addEventListener("keydown",h),e.addEventListener("keyup",m),e.addEventListener("paste",v),e.addEventListener("focus",y),e.addEventListener("blur",b),e.setAttribute("contenteditable",!0),e.classList.add("jtags"),n.setOptions(t),"function"==typeof n.options.onload&&n.options.onload(e,n),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.tags=n,n},toolbar:E,upload:O,validations:k};H.image=O,H.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},H.tracker=A,H.loading=p.loading,H.sha512=S();const R=function(){if(void 0!==window.jSuitesStateControl)return;window.jSuitesStateControl=[];const e=function(t,n){return!(!t[n.type]||t[n.type]!=n)||(!(!t.component||t.component!=n)||!!t.parentNode&&e(t.parentNode,n))};let t=15,n=!1,i={x:null,y:null},o=document.createElement("div");o.classList.add("jtooltip");const a=function(e){return e&&(e.shadowRoot||e.tagName&&e.tagName.includes("-"))},s=function(e){let t,n,i=e.path||e.composedPath&&e.composedPath();return i?(n=i[0],n&&a(n)&&!n.shadowRoot&&e.toElement&&(n=e.toElement)):(t=e.target&&a(e.target)?e.target.shadowRoot:document,n=t.elementFromPoint(x,y)),n};let r,l=["n","ne","e","se","s","sw","w","nw","rotate"];l.forEach((function(e,t){l[t]=document.createElement("div"),l[t].classList.add("jpanel-action"),"rotate"===e?l[t].setAttribute("data-action","rotate"):(l[t].setAttribute("data-action","resize"),l[t].setAttribute("data-position",e+"-resize"))}));const d=function(e){let t=s(e),n=H.findElement(t,"jpanel");n&&!n.classList.contains("readonly")&&n.classList.contains("jpanel-controls")?(n.append(...l),n.classList.contains("jpanel-rotate")||l[l.length-1].remove(),r=n):c(e)},c=function(e){r&&(l.forEach((function(e){e.remove()})),r=null)};document.addEventListener("focusin",d),document.addEventListener("mouseup",(function(e){n&&n.e&&("function"==typeof n.e.refresh&&i.actioned&&n.e.refresh(),n.e.style.cursor=""),i={x:null,y:null},n=!1})),document.addEventListener("mousedown",(function(t){if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY;else i=t.clientX,o=t.clientY;let a=s(t),r=a&&"DIV"===a.tagName&&a.getAttribute("contentEditable"),l=H.findElement(a,"jpanel");if(!l||l.classList.contains("readonly")||r)n=!1;else{let e=l.getBoundingClientRect(),t=0;l.style.rotate&&(t=parseFloat(l.style.rotate));let s="move";a.getAttribute("data-action")?s=a.getAttribute("data-action"):l.style.cursor?s="resize":l.style.cursor="move",n={action:s,a:t,e:l,x:i,y:o,l:e.left,t:e.top,b:e.bottom,r:e.right,w:e.width,h:e.height,d:l.style.cursor,actioned:!1},l.style.width||(l.style.width=e.width+"px"),l.style.height||(l.style.height=e.height+"px")}!function(t){let n=window.jSuitesStateControl;if(n&&n.length>0)for(let i=0;i<n.length;i++)n[i]&&!e(t,n[i])&&n[i].close()}(a),d(t)})),document.addEventListener("mousemove",(function(e){if(n){let t=e.clientX||e.pageX,s=e.clientY||e.pageY;if(null==i.x&&null==i.y&&(i.x=t,i.y=s),"move"===n.action){var o=t-i.x,a=s-i.y,r=n.e.offsetTop+a,l=n.e.offsetLeft+o;n.e.style.top=r+"px",n.e.style.left=l+"px","function"==typeof n.e.refresh&&(i.actioned=!0,n.e.refresh("position",r,l))}else if("rotate"===n.action){let e=function(e,t,n,i,o,a){const s=n-e,r=i-t,l=o-e,d=a-t;let c=Math.atan2(r,s),u=Math.atan2(d,l)-c;return u*=180/Math.PI,u<0&&(u+=360),u}(n.l+n.w/2,n.t+n.h/2,n.x,n.y,t,s);e+=n.a%360,e=2*Math.round(e/2),n.e.style.rotate=`${e}deg`,"function"==typeof n.e.refresh&&(i.actioned=!0,n.e.refresh("rotate",e))}else if("resize"===n.action){let o=null,a=null,r=null,l=null;"e-resize"==n.d||"ne-resize"==n.d||"se-resize"==n.d?(r=n.e.offsetWidth+(t-i.x),e.shiftKey&&(l=n.e.offsetHeight+(t-i.x)*(n.e.offsetHeight/n.e.offsetWidth))):"w-resize"!==n.d&&"nw-resize"!=n.d&&"sw-resize"!=n.d||(a=n.e.offsetLeft+(t-i.x),r=n.e.offsetLeft+n.e.offsetWidth-a,e.shiftKey&&(l=n.e.offsetHeight-(t-i.x)*(n.e.offsetHeight/n.e.offsetWidth))),"s-resize"==n.d||"se-resize"==n.d||"sw-resize"==n.d?l||(l=n.e.offsetHeight+(s-i.y)):"n-resize"!==n.d&&"ne-resize"!=n.d&&"nw-resize"!=n.d||(o=n.e.offsetTop+(s-i.y),l=n.e.offsetTop+n.e.offsetHeight-o),o&&(n.e.style.top=o+"px"),a&&(n.e.style.left=a+"px"),r&&(n.e.style.width=r+"px"),l&&(n.e.style.height=l+"px"),"function"==typeof n.e.refresh&&(i.actioned=!0,n.e.refresh("dimensions",r,l))}i.x=t,i.y=s}else{let n=s(e),i=H.findElement(n,"jpanel");if(i){if(i.classList.contains("jpanel-controls")){let e=n.getAttribute("data-position");i.style.cursor=e||""}else if(i.getAttribute("tabindex")){let n=i.getBoundingClientRect();e.clientY-n.top<t?n.width-(e.clientX-n.left)<t?i.style.cursor="ne-resize":e.clientX-n.left<t?i.style.cursor="nw-resize":i.style.cursor="n-resize":n.height-(e.clientY-n.top)<t?n.width-(e.clientX-n.left)<t?i.style.cursor="se-resize":e.clientX-n.left<t?i.style.cursor="sw-resize":i.style.cursor="s-resize":n.width-(e.clientX-n.left)<t?i.style.cursor="e-resize":e.clientX-n.left<t?i.style.cursor="w-resize":i.style.cursor=""}}}})),document.addEventListener("mouseover",(function(e){var t=s(e).getAttribute("data-tooltip");if(t){if(o.innerText=t,e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY;else n=e.clientX,i=e.clientY;o.style.top=i+"px",o.style.left=n+"px",document.body.appendChild(o)}else o.innerText&&(o.innerText="",document.body.removeChild(o))})),document.addEventListener("keydown",(function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation());let n=window.jSuitesStateControl;n&&n.length>0&&(t=n[n.length-1],t&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation()))})),document.addEventListener("contextmenu",(function(e){var t=document.activeElement;if(t&&"function"==typeof t.contextmenu)t.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation();else if(t=H.findElement(e.target,(function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")})),t){var n=document.querySelector("#"+t);n&&(n.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation())}})),document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&H.mask(e)}))};"undefined"!=typeof document&&R();var Y=H}(),e=o.default}(),e}));