function fallback(){var e=document.createElement("script");e.src="../node_modules/sortablejs/Sortable.min.js",document.body.appendChild(e)}window.Sortable||fallback();
/*! Sortable 1.15.6 - MIT | git://github.com/SortableJS/Sortable.git */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Sortable=e()}(this,(function(){"use strict";function t(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function e(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){var n,i;n=e,t=o[i=t],i in n?Object.defineProperty(n,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function i(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function a(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var l=a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),s=a(/Edge/i),c=a(/firefox/i),u=a(/safari/i)&&!a(/chrome/i)&&!a(/android/i),d=a(/iP(ad|od|hone)/i),h=a(/chrome/i)&&a(/android/i),p={capture:!1,passive:!1};function f(t,e,n){t.addEventListener(e,n,!l&&p)}function g(t,e,n){t.removeEventListener(e,n,!l&&p)}function m(t,e){if(e&&(">"===e[0]&&(e=e.substring(1)),t))try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return}}function v(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function b(t,e,n,o){if(t){n=n||document;do{if(null!=e&&(">"!==e[0]||t.parentNode===n)&&m(t,e)||o&&t===n)return t}while(t!==n&&(t=v(t)))}return null}var y,w=/\s+/g;function D(t,e,n){var o;t&&e&&(t.classList?t.classList[n?"add":"remove"](e):(o=(" "+t.className+" ").replace(w," ").replace(" "+e+" "," "),t.className=(o+(n?" "+e:"")).replace(w," ")))}function E(t,e,n){var o=t&&t.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];o[e=e in o||-1!==e.indexOf("webkit")?e:"-webkit-"+e]=n+("string"==typeof n?"":"px")}}function S(t,e){var n="";if("string"==typeof t)n=t;else do{var o=E(t,"transform")}while(o&&"none"!==o&&(n=o+" "+n),!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function _(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function C(){return document.scrollingElement||document.documentElement}function T(t,e,n,o,i){if(t.getBoundingClientRect||t===window){var r,a,s,c,u,d,h=t!==window&&t.parentNode&&t!==C()?(a=(r=t.getBoundingClientRect()).top,s=r.left,c=r.bottom,u=r.right,d=r.height,r.width):(s=a=0,c=window.innerHeight,u=window.innerWidth,d=window.innerHeight,window.innerWidth);if((e||n)&&t!==window&&(i=i||t.parentNode,!l))do{if(i&&i.getBoundingClientRect&&("none"!==E(i,"transform")||n&&"static"!==E(i,"position"))){var p=i.getBoundingClientRect();a-=p.top+parseInt(E(i,"border-top-width")),s-=p.left+parseInt(E(i,"border-left-width")),c=a+r.height,u=s+r.width;break}}while(i=i.parentNode);return o&&t!==window&&(o=(e=S(i||t))&&e.a,t=e&&e.d,e&&(c=(a/=t)+(d/=t),u=(s/=o)+(h/=o))),{top:a,left:s,bottom:c,right:u,width:h,height:d}}}function x(t,e,n){for(var o=I(t,!0),i=T(t)[e];o;){var r=T(o)[n];if(!("top"===n||"left"===n?r<=i:i<=r))return o;if(o===C())break;o=I(o,!1)}return!1}function O(t,e,n,o){for(var i=0,r=0,a=t.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==Bt.ghost&&(o||a[r]!==Bt.dragged)&&b(a[r],n.draggable,t,!1)){if(i===e)return a[r];i++}r++}return null}function M(t,e){for(var n=t.lastElementChild;n&&(n===Bt.ghost||"none"===E(n,"display")||e&&!m(n,e));)n=n.previousElementSibling;return n||null}function A(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Bt.clone||e&&!m(t,e)||n++;return n}function N(t){var e=0,n=0,o=C();if(t)do{var i=(r=S(t)).a,r=r.d}while(e+=t.scrollLeft*i,n+=t.scrollTop*r,t!==o&&(t=t.parentNode));return[e,n]}function I(t,e){if(!t||!t.getBoundingClientRect)return C();var n=t,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=E(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return C();if(o||e)return n;o=!0}}}while(n=n.parentNode);return C()}function P(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function k(t,e){return function(){var n;y||(1===(n=arguments).length?t.call(this,n[0]):t.apply(this,n),y=setTimeout((function(){y=void 0}),e))}}function R(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function X(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Y(t,e){E(t,"position","absolute"),E(t,"top",e.top),E(t,"left",e.left),E(t,"width",e.width),E(t,"height",e.height)}function B(t){E(t,"position",""),E(t,"top",""),E(t,"left",""),E(t,"width",""),E(t,"height","")}function F(t,e,n){var o={};return Array.from(t.children).forEach((function(i){var r;b(i,e.draggable,t,!1)&&!i.animated&&i!==n&&(r=T(i),o.left=Math.min(null!==(i=o.left)&&void 0!==i?i:1/0,r.left),o.top=Math.min(null!==(i=o.top)&&void 0!==i?i:1/0,r.top),o.right=Math.max(null!==(i=o.right)&&void 0!==i?i:-1/0,r.right),o.bottom=Math.max(null!==(i=o.bottom)&&void 0!==i?i:-1/0,r.bottom))})),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var j="Sortable"+(new Date).getTime();var H=[],L={initializeByDefault:!0},K={mount:function(t){for(var e in L)!L.hasOwnProperty(e)||e in t||(t[e]=L[e]);H.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),H.push(t)},pluginEvent:function(t,n,o){var i=this;this.eventCanceled=!1,o.cancel=function(){i.eventCanceled=!0};var r=t+"Global";H.forEach((function(i){n[i.pluginName]&&(n[i.pluginName][r]&&n[i.pluginName][r](e({sortable:n},o)),n.options[i.pluginName]&&n[i.pluginName][t]&&n[i.pluginName][t](e({sortable:n},o)))}))},initializePlugins:function(t,e,n,i){for(var r in H.forEach((function(i){var r=i.pluginName;(t.options[r]||i.initializeByDefault)&&((i=new i(t,e,t.options)).sortable=t,i.options=t.options,t[r]=i,o(n,i.defaults))})),t.options){var a;t.options.hasOwnProperty(r)&&void 0!==(a=this.modifyOption(t,r,t.options[r]))&&(t.options[r]=a)}},getEventProperties:function(t,e){var n={};return H.forEach((function(i){"function"==typeof i.eventProperties&&o(n,i.eventProperties.call(e[i.pluginName],t))})),n},modifyOption:function(t,e,n){var o;return H.forEach((function(i){t[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[e]&&(o=i.optionListeners[e].call(t[i.pluginName],n))})),o}};function W(t){var n=t.sortable,o=t.rootEl,i=t.name,r=t.targetEl,a=t.cloneEl,c=t.toEl,u=t.fromEl,d=t.oldIndex,h=t.newIndex,p=t.oldDraggableIndex,f=t.newDraggableIndex,g=t.originalEvent,m=t.putSortable,v=t.extraEventProperties;if(n=n||o&&o[j]){var b,y=n.options;t="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||l||s?(b=document.createEvent("Event")).initEvent(i,!0,!0):b=new CustomEvent(i,{bubbles:!0,cancelable:!0}),b.to=c||o,b.from=u||o,b.item=r||o,b.clone=a,b.oldIndex=d,b.newIndex=h,b.oldDraggableIndex=p,b.newDraggableIndex=f,b.originalEvent=g,b.pullMode=m?m.lastPutMode:void 0;var w,D=e(e({},v),K.getEventProperties(i,n));for(w in D)b[w]=D[w];o&&o.dispatchEvent(b),y[t]&&y[t].call(n,b)}}function z(t,n){var o=(i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).evt,i=function(t,e){if(null==t)return{};var n,o=function(t,e){if(null==t)return{};for(var n,o={},i=Object.keys(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n]);return o}(i,G);K.pluginEvent.bind(Bt)(t,n,e({dragEl:q,parentEl:V,ghostEl:Z,rootEl:$,nextEl:Q,lastDownEl:J,cloneEl:tt,cloneHidden:et,dragStarted:ft,putSortable:lt,activeSortable:Bt.active,originalEvent:o,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt,hideGhostForTarget:kt,unhideGhostForTarget:Rt,cloneNowHidden:function(){et=!0},cloneNowShown:function(){et=!1},dispatchSortableEvent:function(t){U({sortable:n,name:t,originalEvent:o})}},i))}var G=["evt"];function U(t){W(e({putSortable:lt,cloneEl:tt,targetEl:q,rootEl:$,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt},t))}var q,V,Z,$,Q,J,tt,et,nt,ot,it,rt,at,lt,st,ct,ut,dt,ht,pt,ft,gt,mt,vt,bt,yt=!1,wt=!1,Dt=[],Et=!1,St=!1,_t=[],Ct=!1,Tt=[],xt="undefined"!=typeof document,Ot=d,Mt=s||l?"cssFloat":"float",At=xt&&!h&&!d&&"draggable"in document.createElement("div"),Nt=function(){if(xt){if(l)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),It=function(t,e){var n=E(t),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=O(t,0,e),r=O(t,1,e),a=i&&E(i),l=r&&E(r),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+T(i).width;t=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+T(r).width;return"flex"===n.display?"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal":"grid"===n.display?n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":i&&a.float&&"none"!==a.float?(e="left"===a.float?"left":"right",!r||"both"!==l.clear&&l.clear!==e?"horizontal":"vertical"):i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||o<=s&&"none"===n[Mt]||r&&"none"===n[Mt]&&o<s+t)?"vertical":"horizontal"},Pt=function(t){function e(t,n){return function(o,i,r,a){var l=o.options.group.name&&i.options.group.name&&o.options.group.name===i.options.group.name;return!(null!=t||!n&&!l)||null!=t&&!1!==t&&(n&&"clone"===t?t:"function"==typeof t?e(t(o,i,r,a),n)(o,i,r,a):(i=(n?o:i).options.group.name,!0===t||"string"==typeof t&&t===i||t.join&&-1<t.indexOf(i)))}}var o={},i=t.group;i&&"object"==n(i)||(i={name:i}),o.name=i.name,o.checkPull=e(i.pull,!0),o.checkPut=e(i.put),o.revertClone=i.revertClone,t.group=o},kt=function(){!Nt&&Z&&E(Z,"display","none")},Rt=function(){!Nt&&Z&&E(Z,"display","")};function Xt(t){if(q){t=t.touches?t.touches[0]:t;var e=(i=t.clientX,r=t.clientY,Dt.some((function(t){if((o=t[j].options.emptyInsertThreshold)&&!M(t)){var e=T(t),n=i>=e.left-o&&i<=e.right+o,o=r>=e.top-o&&r<=e.bottom+o;return n&&o?a=t:void 0}})),a);if(e){var n,o={};for(n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[j]._onDragOver(o)}}var i,r,a}function Yt(t){q&&q.parentNode[j]._isOutsideThisEl(t.target)}function Bt(t,n){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=n=o({},n),t[j]=this;var i,r,a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return It(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Bt.supportPointer&&"PointerEvent"in window&&(!u||d),emptyInsertThreshold:5};for(i in K.initializePlugins(this,t,a),a)i in n||(n[i]=a[i]);for(r in Pt(n),this)"_"===r.charAt(0)&&"function"==typeof this[r]&&(this[r]=this[r].bind(this));this.nativeDraggable=!n.forceFallback&&At,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?f(t,"pointerdown",this._onTapStart):(f(t,"mousedown",this._onTapStart),f(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(f(t,"dragover",this),f(t,"dragenter",this)),Dt.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),o(this,function(){var t,n=[];return{captureAnimationState:function(){n=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(t){var o,i;"none"!==E(t,"display")&&t!==Bt.ghost&&(n.push({target:t,rect:T(t)}),o=e({},n[n.length-1].rect),!t.thisAnimationDuration||(i=S(t,!0))&&(o.top-=i.f,o.left-=i.e),t.fromRect=o)}))},addAnimationState:function(t){n.push(t)},removeAnimationState:function(t){n.splice(function(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n);return-1}(n,{target:t}),1)},animateAll:function(e){var o=this;if(!this.options.animation)return clearTimeout(t),void("function"==typeof e&&e());var i=!1,r=0;n.forEach((function(t){var e=0,n=t.target,a=n.fromRect,l=T(n),s=n.prevFromRect,c=n.prevToRect,u=t.rect,d=S(n,!0);d&&(l.top-=d.f,l.left-=d.e),n.toRect=l,n.thisAnimationDuration&&P(s,l)&&!P(a,l)&&(u.top-l.top)/(u.left-l.left)==(a.top-l.top)/(a.left-l.left)&&(t=u,d=s,s=c,c=o.options,e=Math.sqrt(Math.pow(d.top-t.top,2)+Math.pow(d.left-t.left,2))/Math.sqrt(Math.pow(d.top-s.top,2)+Math.pow(d.left-s.left,2))*c.animation),P(l,a)||(n.prevFromRect=a,n.prevToRect=l,e=e||o.options.animation,o.animate(n,u,l,e)),e&&(i=!0,r=Math.max(r,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),i?t=setTimeout((function(){"function"==typeof e&&e()}),r):"function"==typeof e&&e(),n=[]},animate:function(t,e,n,o){var i,r;o&&(E(t,"transition",""),E(t,"transform",""),i=(r=S(this.el))&&r.a,r=r&&r.d,i=(e.left-n.left)/(i||1),r=(e.top-n.top)/(r||1),t.animatingX=!!i,t.animatingY=!!r,E(t,"transform","translate3d("+i+"px,"+r+"px,0)"),this.forRepaintDummy=t.offsetWidth,E(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),E(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){E(t,"transition",""),E(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),o))}}}())}function Ft(t,e,n,o,i,r,a,c){var u,d,h=t[j],p=h.options.onMove;return!window.CustomEvent||l||s?(u=document.createEvent("Event")).initEvent("move",!0,!0):u=new CustomEvent("move",{bubbles:!0,cancelable:!0}),u.to=e,u.from=t,u.dragged=n,u.draggedRect=o,u.related=i||e,u.relatedRect=r||T(e),u.willInsertAfter=c,u.originalEvent=a,t.dispatchEvent(u),p?p.call(h,u,a):d}function jt(t){t.draggable=!1}function Ht(){Ct=!1}function Lt(t){return setTimeout(t,0)}function Kt(t){return clearTimeout(t)}xt&&!h&&document.addEventListener("click",(function(t){if(wt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),wt=!1}),!0),Bt.prototype={constructor:Bt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(gt=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,q):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,o=this.options,i=o.preventOnFilter,r=t.type,a=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,l=(a||t).target,s=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,c=o.filter;if(function(t){Tt.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&Tt.push(o)}}(n),!q&&!(/mousedown|pointerdown/.test(r)&&0!==t.button||o.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!u||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=b(l,o.draggable,n,!1))&&l.animated||J===l)){if(nt=A(l),it=A(l,o.draggable),"function"==typeof c){if(c.call(this,t,l,this))return U({sortable:e,rootEl:s,name:"filter",targetEl:l,toEl:n,fromEl:n}),z("filter",e,{evt:t}),void(i&&t.preventDefault())}else if(c=c&&c.split(",").some((function(o){if(o=b(s,o.trim(),n,!1))return U({sortable:e,rootEl:o,name:"filter",targetEl:l,fromEl:n,toEl:n}),z("filter",e,{evt:t}),!0})))return void(i&&t.preventDefault());o.handle&&!b(s,o.handle,n,!1)||this._prepareDragStart(t,a,l)}}},_prepareDragStart:function(t,e,n){var o,i=this,r=i.el,a=i.options,u=r.ownerDocument;n&&!q&&n.parentNode===r&&(o=T(n),$=r,V=(q=n).parentNode,Q=q.nextSibling,J=n,at=a.group,st={target:Bt.dragged=q,clientX:(e||t).clientX,clientY:(e||t).clientY},ht=st.clientX-o.left,pt=st.clientY-o.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,q.style["will-change"]="all",o=function(){z("delayEnded",i,{evt:t}),Bt.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!c&&i.nativeDraggable&&(q.draggable=!0),i._triggerDragStart(t,e),U({sortable:i,name:"choose",originalEvent:t}),D(q,a.chosenClass,!0))},a.ignore.split(",").forEach((function(t){_(q,t.trim(),jt)})),f(u,"dragover",Xt),f(u,"mousemove",Xt),f(u,"touchmove",Xt),a.supportPointer?(f(u,"pointerup",i._onDrop),this.nativeDraggable||f(u,"pointercancel",i._onDrop)):(f(u,"mouseup",i._onDrop),f(u,"touchend",i._onDrop),f(u,"touchcancel",i._onDrop)),c&&this.nativeDraggable&&(this.options.touchStartThreshold=4,q.draggable=!0),z("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(s||l)?o():Bt.eventCanceled?this._onDrop():(a.supportPointer?(f(u,"pointerup",i._disableDelayedDrag),f(u,"pointercancel",i._disableDelayedDrag)):(f(u,"mouseup",i._disableDelayedDrag),f(u,"touchend",i._disableDelayedDrag),f(u,"touchcancel",i._disableDelayedDrag)),f(u,"mousemove",i._delayedDragTouchMoveHandler),f(u,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&f(u,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,a.delay)))},_delayedDragTouchMoveHandler:function(t){t=t.touches?t.touches[0]:t,Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){q&&jt(q),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;g(t,"mouseup",this._disableDelayedDrag),g(t,"touchend",this._disableDelayedDrag),g(t,"touchcancel",this._disableDelayedDrag),g(t,"pointerup",this._disableDelayedDrag),g(t,"pointercancel",this._disableDelayedDrag),g(t,"mousemove",this._delayedDragTouchMoveHandler),g(t,"touchmove",this._delayedDragTouchMoveHandler),g(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?f(document,"pointermove",this._onTouchMove):f(document,e?"touchmove":"mousemove",this._onTouchMove):(f(q,"dragend",this),f($,"dragstart",this._onDragStart));try{document.selection?Lt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){var n;yt=!1,$&&q?(z("dragStarted",this,{evt:e}),this.nativeDraggable&&f(document,"dragover",Yt),n=this.options,t||D(q,n.dragClass,!1),D(q,n.ghostClass,!0),Bt.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:e})):this._nulling()},_emulateDragOver:function(){if(ct){this._lastX=ct.clientX,this._lastY=ct.clientY,kt();for(var t=document.elementFromPoint(ct.clientX,ct.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ct.clientX,ct.clientY))!==e;)e=t;if(q.parentNode[j]._isOutsideThisEl(t),e)do{if(e[j]&&e[j]._onDragOver({clientX:ct.clientX,clientY:ct.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}while(e=v(t=e));Rt()}},_onTouchMove:function(t){if(st){var e=(l=this.options).fallbackTolerance,n=l.fallbackOffset,o=t.touches?t.touches[0]:t,i=Z&&S(Z,!0),r=Z&&i&&i.a,a=Z&&i&&i.d,l=Ot&&bt&&N(bt);r=(o.clientX-st.clientX+n.x)/(r||1)+(l?l[0]-_t[0]:0)/(r||1),a=(o.clientY-st.clientY+n.y)/(a||1)+(l?l[1]-_t[1]:0)/(a||1);if(!Bt.active&&!yt){if(e&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<e)return;this._onDragStart(t,!0)}Z&&(i?(i.e+=r-(ut||0),i.f+=a-(dt||0)):i={a:1,b:0,c:0,d:1,e:r,f:a},i="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")"),E(Z,"webkitTransform",i),E(Z,"mozTransform",i),E(Z,"msTransform",i),E(Z,"transform",i),ut=r,dt=a,ct=o),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Z){var t=this.options.fallbackOnBody?document.body:$,e=T(q,!0,Ot,!0,t),n=this.options;if(Ot){for(bt=t;"static"===E(bt,"position")&&"none"===E(bt,"transform")&&bt!==document;)bt=bt.parentNode;bt!==document.body&&bt!==document.documentElement?(bt===document&&(bt=C()),e.top+=bt.scrollTop,e.left+=bt.scrollLeft):bt=C(),_t=N(bt)}D(Z=q.cloneNode(!0),n.ghostClass,!1),D(Z,n.fallbackClass,!0),D(Z,n.dragClass,!0),E(Z,"transition",""),E(Z,"transform",""),E(Z,"box-sizing","border-box"),E(Z,"margin",0),E(Z,"top",e.top),E(Z,"left",e.left),E(Z,"width",e.width),E(Z,"height",e.height),E(Z,"opacity","0.8"),E(Z,"position",Ot?"absolute":"fixed"),E(Z,"zIndex","100000"),E(Z,"pointerEvents","none"),Bt.ghost=Z,t.appendChild(Z),E(Z,"transform-origin",ht/parseInt(Z.style.width)*100+"% "+pt/parseInt(Z.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,o=t.dataTransfer,i=n.options;z("dragStart",this,{evt:t}),Bt.eventCanceled?this._onDrop():(z("setupClone",this),Bt.eventCanceled||((tt=X(q)).removeAttribute("id"),tt.draggable=!1,tt.style["will-change"]="",this._hideClone(),D(tt,this.options.chosenClass,!1),Bt.clone=tt),n.cloneId=Lt((function(){z("clone",n),Bt.eventCanceled||(n.options.removeCloneOnHide||$.insertBefore(tt,q),n._hideClone(),U({sortable:n,name:"clone"}))})),e||D(q,i.dragClass,!0),e?(wt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(g(document,"mouseup",n._onDrop),g(document,"touchend",n._onDrop),g(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,q)),f(document,"drop",n),E(q,"transform","translateZ(0)")),yt=!0,n._dragStartId=Lt(n._dragStarted.bind(n,e,t)),f(document,"selectstart",n),ft=!0,window.getSelection().removeAllRanges(),u&&E(document.body,"user-select","none"))},_onDragOver:function(t){var n,o,i,r,a,l=this.el,s=t.target,c=this.options,u=c.group,d=Bt.active,h=at===u,p=c.sort,f=lt||d,g=this,m=!1;if(!Ct){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),s=b(s,c.draggable,l,!0),B("dragOver"),Bt.eventCanceled)return m;if(q.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||g._ignoreWhileAnimating===s)return L(!1);if(wt=!1,d&&!c.disabled&&(h?p||(o=V!==$):lt===this||(this.lastPutMode=at.checkPull(this,d,q,t))&&u.checkPut(this,d,q,t))){if(i="vertical"===this._getDirection(t,s),n=T(q),B("dragOverValid"),Bt.eventCanceled)return m;if(o)return V=$,H(),this._hideClone(),B("revert"),Bt.eventCanceled||(Q?$.insertBefore(q,Q):$.appendChild(q)),L(!0);var v=M(l,c.draggable);if(v&&(N=t,u=i,Y=T(M((C=this).el,C.options.draggable)),C=F(C.el,C.options,Z),!(u?N.clientX>C.right+10||N.clientY>Y.bottom&&N.clientX>Y.left:N.clientY>C.bottom+10||N.clientX>Y.right&&N.clientY>Y.top)||v.animated)){if(v&&(r=t,a=i,P=T(O((I=this).el,0,I.options,!0)),I=F(I.el,I.options,Z),a?r.clientX<I.left-10||r.clientY<P.top&&r.clientX<P.right:r.clientY<I.top-10||r.clientY<P.bottom&&r.clientX<P.left)){if((k=O(l,0,c,!0))===q)return L(!1);if(_=T(s=k),!1!==Ft($,l,q,n,s,_,t,!1))return H(),l.insertBefore(q,k),V=l,K(),L(!0)}else if(s.parentNode===l){var y,w,S,_=T(s),C=q.parentNode!==l,N=(N=q.animated&&q.toRect||n,Y=s.animated&&s.toRect||_,I=(a=i)?N.left:N.top,r=a?N.right:N.bottom,P=a?N.width:N.height,k=a?Y.left:Y.top,N=a?Y.right:Y.bottom,Y=a?Y.width:Y.height,!(I===k||r===N||I+P/2===k+Y/2)),I=i?"top":"left",P=x(s,"top","top")||x(q,"top","top"),k=P?P.scrollTop:void 0;if(gt!==s&&(w=_[I],Et=!1,St=!N&&c.invertSwap||C),0!==(y=function(t,e,n,o,i,r,a,l){var s=o?t.clientY:t.clientX,c=o?n.height:n.width;t=o?n.top:n.left,o=o?n.bottom:n.right,n=!1;if(!a)if(l&&vt<c*i){if(Et=!Et&&(1===mt?t+c*r/2<s:s<o-c*r/2)||Et)n=!0;else if(1===mt?s<t+vt:o-vt<s)return-mt}else if(t+c*(1-i)/2<s&&s<o-c*(1-i)/2)return function(t){return A(q)<A(t)?1:-1}(e);return(n=n||a)&&(s<t+c*r/2||o-c*r/2<s)?t+c/2<s?1:-1:0}(t,s,_,i,N?1:c.swapThreshold,null==c.invertedSwapThreshold?c.swapThreshold:c.invertedSwapThreshold,St,gt===s)))for(var X=A(q);(S=V.children[X-=y])&&("none"===E(S,"display")||S===Z););if(0===y||S===s)return L(!1);mt=y;var Y=(gt=s).nextElementSibling;C=!1;if(!1!==(N=Ft($,l,q,n,s,_,t,C=1===y)))return 1!==N&&-1!==N||(C=1===N),Ct=!0,setTimeout(Ht,30),H(),C&&!Y?l.appendChild(q):s.parentNode.insertBefore(q,C?Y:s),P&&R(P,0,k-P.scrollTop),V=q.parentNode,void 0===w||St||(vt=Math.abs(w-T(s)[I])),K(),L(!0)}}else{if(v===q)return L(!1);if((s=v&&l===t.target?v:s)&&(_=T(s)),!1!==Ft($,l,q,n,s,_,t,!!s))return H(),v&&v.nextSibling?l.insertBefore(q,v.nextSibling):l.appendChild(q),V=l,K(),L(!0)}if(l.contains(q))return L(!1)}return!1}function B(r,a){z(r,g,e({evt:t,isOwner:h,axis:i?"vertical":"horizontal",revert:o,dragRect:n,targetRect:_,canSort:p,fromSortable:f,target:s,completed:L,onMove:function(e,o){return Ft($,l,q,n,e,T(e),t,o)},changed:K},a))}function H(){B("dragOverAnimationCapture"),g.captureAnimationState(),g!==f&&f.captureAnimationState()}function L(e){return B("dragOverCompleted",{insertion:e}),e&&(h?d._hideClone():d._showClone(g),g!==f&&(D(q,(lt||d).options.ghostClass,!1),D(q,c.ghostClass,!0)),lt!==g&&g!==Bt.active?lt=g:g===Bt.active&&lt&&(lt=null),f===g&&(g._ignoreWhileAnimating=s),g.animateAll((function(){B("dragOverAnimationComplete"),g._ignoreWhileAnimating=null})),g!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(s===q&&!q.animated||s===l&&!s.animated)&&(gt=null),c.dragoverBubble||t.rootEl||s===document||(q.parentNode[j]._isOutsideThisEl(t.target),e||Xt(t)),!c.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function K(){ot=A(q),rt=A(q,c.draggable),U({sortable:g,name:"change",toEl:l,newIndex:ot,newDraggableIndex:rt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",Xt),g(document,"mousemove",Xt),g(document,"touchmove",Xt)},_offUpEvents:function(){var t=this.el.ownerDocument;g(t,"mouseup",this._onDrop),g(t,"touchend",this._onDrop),g(t,"pointerup",this._onDrop),g(t,"pointercancel",this._onDrop),g(t,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;ot=A(q),rt=A(q,n.draggable),z("drop",this,{evt:t}),V=q&&q.parentNode,ot=A(q),rt=A(q,n.draggable),Bt.eventCanceled||(Et=St=yt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Kt(this.cloneId),Kt(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),u&&E(document.body,"user-select",""),E(q,"transform",""),t&&(ft&&(t.cancelable&&t.preventDefault(),n.dropBubble||t.stopPropagation()),Z&&Z.parentNode&&Z.parentNode.removeChild(Z),($===V||lt&&"clone"!==lt.lastPutMode)&&tt&&tt.parentNode&&tt.parentNode.removeChild(tt),q&&(this.nativeDraggable&&g(q,"dragend",this),jt(q),q.style["will-change"]="",ft&&!yt&&D(q,(lt||this).options.ghostClass,!1),D(q,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:V,newIndex:null,newDraggableIndex:null,originalEvent:t}),$!==V?(0<=ot&&(U({rootEl:V,name:"add",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"remove",toEl:V,originalEvent:t}),U({rootEl:V,name:"sort",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),lt&&lt.save()):ot!==nt&&0<=ot&&(U({sortable:this,name:"update",toEl:V,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),Bt.active&&(null!=ot&&-1!==ot||(ot=nt,rt=it),U({sortable:this,name:"end",toEl:V,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){z("nulling",this),$=q=V=Z=Q=tt=J=et=st=ct=ft=ot=rt=nt=it=gt=mt=lt=at=Bt.dragged=Bt.ghost=Bt.clone=Bt.active=null,Tt.forEach((function(t){t.checked=!0})),Tt.length=ut=dt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":q&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)b(t=n[o],r.draggable,this.el,!1)&&e.push(t.getAttribute(r.dataIdAttr)||function(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}(t));return e},sort:function(t,e){var n={},o=this.el;this.toArray().forEach((function(t,e){b(e=o.children[e],this.options.draggable,o,!1)&&(n[t]=e)}),this),e&&this.captureAnimationState(),t.forEach((function(t){n[t]&&(o.removeChild(n[t]),o.appendChild(n[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return b(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var o=K.modifyOption(this,t,e);n[t]=void 0!==o?o:e,"group"===t&&Pt(n)},destroy:function(){z("destroy",this);var t=this.el;t[j]=null,g(t,"mousedown",this._onTapStart),g(t,"touchstart",this._onTapStart),g(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(t,"dragover",this),g(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Dt.splice(Dt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){et||(z("hideClone",this),Bt.eventCanceled||(E(tt,"display","none"),this.options.removeCloneOnHide&&tt.parentNode&&tt.parentNode.removeChild(tt),et=!0))},_showClone:function(t){"clone"===t.lastPutMode?et&&(z("showClone",this),Bt.eventCanceled||(q.parentNode!=$||this.options.group.revertClone?Q?$.insertBefore(tt,Q):$.appendChild(tt):$.insertBefore(tt,q),this.options.group.revertClone&&this.animate(q,tt),E(tt,"display",""),et=!1)):this._hideClone()}},xt&&f(document,"touchmove",(function(t){(Bt.active||yt)&&t.cancelable&&t.preventDefault()})),Bt.utils={on:f,off:g,css:E,find:_,is:function(t,e){return!!b(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},throttle:k,closest:b,toggleClass:D,clone:X,index:A,nextTick:Lt,cancelNextTick:Kt,detectDirection:It,getChild:O,expando:j},Bt.get=function(t){return t[j]},Bt.mount=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(n=n[0].constructor===Array?n[0]:n).forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Bt.utils=e(e({},Bt.utils),t.utils)),K.mount(t)}))},Bt.create=function(t,e){return new Bt(t,e)};var Wt,zt,Gt,Ut,qt,Vt,Zt=[],$t=!(Bt.version="1.15.6");function Qt(){Zt.forEach((function(t){clearInterval(t.pid)})),Zt=[]}function Jt(){clearInterval(Vt)}var te,ee=k((function(t,e,n,o){if(e.scroll){var i,r=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,l=e.scrollSensitivity,s=e.scrollSpeed,c=C(),u=!1;zt!==n&&(zt=n,Qt(),Wt=e.scroll,i=e.scrollFn,!0===Wt&&(Wt=I(n,!0)));var d=0,h=Wt;do{var p=h,f=(O=T(p)).top,g=O.bottom,m=O.left,v=O.right,b=O.width,y=O.height,w=void 0,D=p.scrollWidth,S=p.scrollHeight,_=E(p),x=p.scrollLeft,O=p.scrollTop,M=p===c?(w=b<D&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),y<S&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(w=b<D&&("auto"===_.overflowX||"scroll"===_.overflowX),y<S&&("auto"===_.overflowY||"scroll"===_.overflowY));x=w&&(Math.abs(v-r)<=l&&x+b<D)-(Math.abs(m-r)<=l&&!!x),O=M&&(Math.abs(g-a)<=l&&O+y<S)-(Math.abs(f-a)<=l&&!!O);if(!Zt[d])for(var A=0;A<=d;A++)Zt[A]||(Zt[A]={});Zt[d].vx==x&&Zt[d].vy==O&&Zt[d].el===p||(Zt[d].el=p,Zt[d].vx=x,Zt[d].vy=O,clearInterval(Zt[d].pid),0==x&&0==O||(u=!0,Zt[d].pid=setInterval(function(){o&&0===this.layer&&Bt.active._onTouchMove(qt);var e=Zt[this.layer].vy?Zt[this.layer].vy*s:0,n=Zt[this.layer].vx?Zt[this.layer].vx*s:0;"function"==typeof i&&"continue"!==i.call(Bt.dragged.parentNode[j],n,e,t,qt,Zt[this.layer].el)||R(Zt[this.layer].el,n,e)}.bind({layer:d}),24))),d++}while(e.bubbleScroll&&h!==c&&(h=I(h,!1)));$t=u}}),30);h=function(t){var e=t.originalEvent,n=t.putSortable,o=t.dragEl,i=t.activeSortable,r=t.dispatchSortableEvent,a=t.hideGhostForTarget;t=t.unhideGhostForTarget;e&&(i=n||i,a(),e=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,e=document.elementFromPoint(e.clientX,e.clientY),t(),i&&!i.el.contains(e)&&(r("spill"),this.onSpill({dragEl:o,putSortable:n})))};function ne(){}function oe(){}ne.prototype={startIndex:null,dragStart:function(t){t=t.oldDraggableIndex,this.startIndex=t},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState(),(t=O(this.sortable.el,this.startIndex,this.options))?this.sortable.el.insertBefore(e,t):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:h},o(ne,{pluginName:"revertOnSpill"}),oe.prototype={onSpill:function(t){var e=t.dragEl;(t=t.putSortable||this.sortable).captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),t.animateAll()},drop:h},o(oe,{pluginName:"removeOnSpill"});var ie,re,ae,le,se,ce=[],ue=[],de=!1,he=!1,pe=!1;function fe(t,e){ue.forEach((function(n,o){(o=e.children[n.sortableIndex+(t?Number(o):0)])?e.insertBefore(n,o):e.appendChild(n)}))}function ge(){ce.forEach((function(t){t!==ae&&t.parentNode&&t.parentNode.removeChild(t)}))}return Bt.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){t=t.originalEvent,this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):this.options.supportPointer?f(document,"pointermove",this._handleFallbackAutoScroll):t.touches?f(document,"touchmove",this._handleFallbackAutoScroll):f(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){t=t.originalEvent,this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),Jt(),Qt(),clearTimeout(y),y=void 0},nulling:function(){qt=zt=Wt=$t=Vt=Gt=Ut=null,Zt.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n,o=this,i=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,a=document.elementFromPoint(i,r);qt=t,e||this.options.forceAutoScrollFallback||s||l||u?(ee(t,this.options,a,e),n=I(a,!0),!$t||Vt&&i===Gt&&r===Ut||(Vt&&Jt(),Vt=setInterval((function(){var a=I(document.elementFromPoint(i,r),!0);a!==n&&(n=a,Qt()),ee(t,o.options,a,e)}),10),Gt=i,Ut=r)):this.options.bubbleScroll&&I(a,!0)!==C()?ee(t,this.options,I(a,!1),!1):Qt()}},o(t,{pluginName:"scroll",initializeByDefault:!0})}),Bt.mount(oe,ne),Bt.mount(new function(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){t=t.dragEl,te=t},dragOverValid:function(t){var e=t.completed,n=t.target,o=t.onMove,i=t.activeSortable,r=t.changed,a=t.cancel;i.options.swap&&(t=this.sortable.el,i=this.options,n&&n!==t&&(t=te,te=!1!==o(n)?(D(n,i.swapClass,!0),n):null,t&&t!==te&&D(t,i.swapClass,!1)),r(),e(!0),a())},drop:function(t){var e,n,o=t.activeSortable,i=t.putSortable,r=t.dragEl,a=i||this.sortable,l=this.options;te&&D(te,l.swapClass,!1),te&&(l.swap||i&&i.options.swap)&&r!==te&&(a.captureAnimationState(),a!==o&&o.captureAnimationState(),n=te,t=(e=r).parentNode,l=n.parentNode,t&&l&&!t.isEqualNode(n)&&!l.isEqualNode(e)&&(i=A(e),r=A(n),t.isEqualNode(l)&&i<r&&r++,t.insertBefore(n,t.children[i]),l.insertBefore(e,l.children[r])),a.animateAll(),a!==o&&o.animateAll())},nulling:function(){te=null}},o(t,{pluginName:"swap",eventProperties:function(){return{swapItem:te}}})}),Bt.mount(new function(){function t(t){for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));t.options.avoidImplicitDeselect||(t.options.supportPointer?f(document,"pointerup",this._deselectMultiDrag):(f(document,"mouseup",this._deselectMultiDrag),f(document,"touchend",this._deselectMultiDrag))),f(document,"keydown",this._checkKeyDown),f(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(e,n){var o="";ce.length&&re===t?ce.forEach((function(t,e){o+=(e?", ":"")+t.textContent})):o=n.textContent,e.setData("Text",o)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){t=t.dragEl,ae=t},delayEnded:function(){this.isMultiDrag=~ce.indexOf(ae)},setupClone:function(t){var e=t.sortable;t=t.cancel;if(this.isMultiDrag){for(var n=0;n<ce.length;n++)ue.push(X(ce[n])),ue[n].sortableIndex=ce[n].sortableIndex,ue[n].draggable=!1,ue[n].style["will-change"]="",D(ue[n],this.options.selectedClass,!1),ce[n]===ae&&D(ue[n],this.options.chosenClass,!1);e._hideClone(),t()}},clone:function(t){var e=t.sortable,n=t.rootEl,o=t.dispatchSortableEvent;t=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ce.length&&re===e&&(fe(!0,n),o("clone"),t()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl;t=t.cancel;this.isMultiDrag&&(fe(!1,n),ue.forEach((function(t){E(t,"display","")})),e(),se=!1,t())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden);t=t.cancel;this.isMultiDrag&&(ue.forEach((function(t){E(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)})),n(),se=!0,t())},dragStartGlobal:function(t){t.sortable,!this.isMultiDrag&&re&&re.multiDrag._deselectMultiDrag(),ce.forEach((function(t){t.sortableIndex=A(t)})),ce=ce.sort((function(t,e){return t.sortableIndex-e.sortableIndex})),pe=!0},dragStarted:function(t){var e,n=this;t=t.sortable;this.isMultiDrag&&(this.options.sort&&(t.captureAnimationState(),this.options.animation&&(ce.forEach((function(t){t!==ae&&E(t,"position","absolute")})),e=T(ae,!1,!0,!0),ce.forEach((function(t){t!==ae&&Y(t,e)})),de=he=!0)),t.animateAll((function(){de=he=!1,n.options.animation&&ce.forEach((function(t){B(t)})),n.options.sort&&ge()})))},dragOver:function(t){var e=t.target,n=t.completed;t=t.cancel;he&&~ce.indexOf(e)&&(n(!1),t())},revert:function(t){var e,n,o=t.fromSortable,i=t.rootEl,r=t.sortable,a=t.dragRect;1<ce.length&&(ce.forEach((function(t){r.addAnimationState({target:t,rect:he?T(t):a}),B(t),t.fromRect=a,o.removeAnimationState(t)})),he=!1,e=!this.options.removeCloneOnHide,n=i,ce.forEach((function(t,o){(o=n.children[t.sortableIndex+(e?Number(o):0)])?n.insertBefore(t,o):n.appendChild(t)})))},dragOverCompleted:function(t){var e,n=t.sortable,o=t.isOwner,i=t.insertion,r=t.activeSortable,a=t.parentEl,l=t.putSortable;t=this.options;i&&(o&&r._hideClone(),de=!1,t.animation&&1<ce.length&&(he||!o&&!r.options.sort&&!l)&&(e=T(ae,!1,!0,!0),ce.forEach((function(t){t!==ae&&(Y(t,e),a.appendChild(t))})),he=!0),o||(he||ge(),1<ce.length?(o=se,r._showClone(n),r.options.animation&&!se&&o&&ue.forEach((function(t){r.addAnimationState({target:t,rect:le}),t.fromRect=le,t.thisAnimationDuration=null}))):r._showClone(n)))},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner;t=t.activeSortable;ce.forEach((function(t){t.thisAnimationDuration=null})),t.options.animation&&!n&&t.multiDrag.isMultiDrag&&(le=o({},e),e=S(ae,!0),le.top-=e.f,le.left-=e.e)},dragOverAnimationComplete:function(){he&&(he=!1,ge())},drop:function(t){var e,n,o,i,r,a,l,s=t.originalEvent,c=t.rootEl,u=t.parentEl,d=t.sortable,h=t.dispatchSortableEvent,p=t.oldIndex,f=(t=t.putSortable)||this.sortable;s&&(e=this.options,n=u.children,pe||(e.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),D(ae,e.selectedClass,!~ce.indexOf(ae)),~ce.indexOf(ae)?(ce.splice(ce.indexOf(ae),1),ie=null,W({sortable:d,rootEl:c,name:"deselect",targetEl:ae,originalEvent:s})):(ce.push(ae),W({sortable:d,rootEl:c,name:"select",targetEl:ae,originalEvent:s}),s.shiftKey&&ie&&d.el.contains(ie)?(o=A(ie),i=A(ae),~o&&~i&&o!==i&&function(){for(var t,r=o<i?(t=o,i):(t=i,o+1),a=e.filter;t<r;t++)~ce.indexOf(n[t])||b(n[t],e.draggable,u,!1)&&(a&&("function"==typeof a?a.call(d,s,n[t],d):a.split(",").some((function(e){return b(n[t],e.trim(),u,!1)})))||(D(n[t],e.selectedClass,!0),ce.push(n[t]),W({sortable:d,rootEl:c,name:"select",targetEl:n[t],originalEvent:s})))}()):ie=ae,re=f)),pe&&this.isMultiDrag&&(he=!1,(u[j].options.sort||u!==c)&&1<ce.length&&(r=T(ae),a=A(ae,":not(."+this.options.selectedClass+")"),!de&&e.animation&&(ae.thisAnimationDuration=null),f.captureAnimationState(),de||(e.animation&&(ae.fromRect=r,ce.forEach((function(t){var e;t.thisAnimationDuration=null,t!==ae&&(e=he?T(t):r,t.fromRect=e,f.addAnimationState({target:t,rect:e}))}))),ge(),ce.forEach((function(t){n[a]?u.insertBefore(t,n[a]):u.appendChild(t),a++})),p===A(ae)&&(l=!1,ce.forEach((function(t){t.sortableIndex!==A(t)&&(l=!0)})),l&&(h("update"),h("sort")))),ce.forEach((function(t){B(t)})),f.animateAll()),re=f),(c===u||t&&"clone"!==t.lastPutMode)&&ue.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)})))},nullingGlobal:function(){this.isMultiDrag=pe=!1,ue.length=0},destroyGlobal:function(){this._deselectMultiDrag(),g(document,"pointerup",this._deselectMultiDrag),g(document,"mouseup",this._deselectMultiDrag),g(document,"touchend",this._deselectMultiDrag),g(document,"keydown",this._checkKeyDown),g(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(void 0!==pe&&pe||re!==this.sortable||t&&b(t.target,this.options.draggable,this.sortable.el,!1)||t&&0!==t.button))for(;ce.length;){var e=ce[0];D(e,this.options.selectedClass,!1),ce.shift(),W({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvent:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},o(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[j];e&&e.options.multiDrag&&!~ce.indexOf(t)&&(re&&re!==e&&(re.multiDrag._deselectMultiDrag(),re=e),D(t,e.options.selectedClass,!0),ce.push(t))},deselect:function(t){var e=t.parentNode[j],n=ce.indexOf(t);e&&e.options.multiDrag&&~n&&(D(t,e.options.selectedClass,!1),ce.splice(n,1))}},eventProperties:function(){var t=this,e=[],n=[];return ce.forEach((function(o){var i;e.push({multiDragElement:o,index:o.sortableIndex}),i=he&&o!==ae?-1:he?A(o,":not(."+t.options.selectedClass+")"):A(o),n.push({multiDragElement:o,index:i})})),{items:i(ce),clones:[].concat(ue),oldIndicies:e,newIndicies:n}},optionListeners:{multiDragKey:function(t){return"ctrl"===(t=t.toLowerCase())?t="Control":1<t.length&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}),Bt}));
"use strict";var Slick=(()=>{var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,r=(e,i,n)=>((e,i,n)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n)(e,"symbol"!=typeof i?i+"":i,n),s={};((e,i)=>{for(var n in i)t(e,n,{get:i[n],enumerable:!0})})(s,{BindingEventService:()=>f,ColAutosizeMode:()=>T,EditorLock:()=>S,Event:()=>y,EventData:()=>C,EventHandler:()=>w,GlobalEditorLock:()=>A,GridAutosizeColsMode:()=>D,Group:()=>_,GroupTotals:()=>P,NonDataRow:()=>O,Range:()=>k,RegexSanitizer:()=>R,RowSelectionMode:()=>M,SlickEditorLock:()=>p,SlickEvent:()=>l,SlickEventData:()=>o,SlickEventHandler:()=>a,SlickGlobalEditorLock:()=>E,SlickGroup:()=>d,SlickGroupTotals:()=>h,SlickNonDataItem:()=>c,SlickRange:()=>u,Utils:()=>m,ValueFilterMode:()=>j,WidthEvalMode:()=>F,keyCode:()=>N,preClickClassName:()=>L});var o=class{constructor(t,e){this.event=t,this.args=e,r(this,"_isPropagationStopped",!1),r(this,"_isImmediatePropagationStopped",!1),r(this,"_isDefaultPrevented",!1),r(this,"returnValues",[]),r(this,"returnValue"),r(this,"_eventTarget"),r(this,"nativeEvent"),r(this,"arguments_"),r(this,"altKey"),r(this,"ctrlKey"),r(this,"metaKey"),r(this,"shiftKey"),r(this,"key"),r(this,"keyCode"),r(this,"clientX"),r(this,"clientY"),r(this,"offsetX"),r(this,"offsetY"),r(this,"pageX"),r(this,"pageY"),r(this,"bubbles"),r(this,"target"),r(this,"type"),r(this,"which"),r(this,"x"),r(this,"y"),this.nativeEvent=t,this.arguments_=e,t&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach((e=>this[e]=t[e])),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}get defaultPrevented(){return this._isDefaultPrevented}stopPropagation(){var t;this._isPropagationStopped=!0,null==(t=this.nativeEvent)||t.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(t){this.returnValues.push(t),void 0===this.returnValue&&void 0!==t&&(this.returnValue=t)}getReturnValue(){return this.returnValue}getArguments(){return this.arguments_}},l=class{constructor(t,e){this.eventName=t,this.pubSub=e,r(this,"_handlers",[]),r(this,"_pubSubService"),this._pubSubService=e}get subscriberCount(){return this._handlers.length}subscribe(t){this._handlers.push(t)}unsubscribe(t){for(let e=this._handlers.length-1;e>=0;e--)this._handlers[e]===t&&this._handlers.splice(e,1)}notify(t,e,i){var n;let r=e instanceof o?e:new o(e,t);i=i||this;for(let e=0;e<this._handlers.length&&!r.isPropagationStopped()&&!r.isImmediatePropagationStopped();e++){let n=this._handlers[e].call(i,r,t);r.addReturnValue(n)}if("function"==typeof(null==(n=this._pubSubService)?void 0:n.publish)&&this.eventName){let e=this._pubSubService.publish(this.eventName,{args:t,eventData:r});r.addReturnValue(e)}return r}setPubSubService(t){this._pubSubService=t}},a=class{constructor(){r(this,"handlers",[])}subscribe(t,e){return this.handlers.push({event:t,handler:e}),t.subscribe(e),this}unsubscribe(t,e){let i=this.handlers.length;for(;i--;)if(this.handlers[i].event===t&&this.handlers[i].handler===e)return this.handlers.splice(i,1),void t.unsubscribe(e);return this}unsubscribeAll(){let t=this.handlers.length;for(;t--;)this.handlers[t].event.unsubscribe(this.handlers[t].handler);return this.handlers=[],this}},u=class{constructor(t,e,i,n){r(this,"fromRow"),r(this,"fromCell"),r(this,"toCell"),r(this,"toRow"),void 0===i&&void 0===n&&(i=t,n=e),this.fromRow=Math.min(t,i),this.fromCell=Math.min(e,n),this.toCell=Math.max(e,n),this.toRow=Math.max(t,i)}isSingleRow(){return this.fromRow===this.toRow}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}contains(t,e){return t>=this.fromRow&&t<=this.toRow&&e>=this.fromCell&&e<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}},c=class{constructor(){r(this,"__nonDataRow",!0)}},d=class extends c{constructor(){super(),r(this,"__group",!0),r(this,"level",0),r(this,"count",0),r(this,"value",null),r(this,"title",null),r(this,"collapsed",!1),r(this,"selectChecked",!1),r(this,"totals",null),r(this,"rows",[]),r(this,"groups",null),r(this,"groupingKey",null)}equals(t){return this.value===t.value&&this.count===t.count&&this.collapsed===t.collapsed&&this.title===t.title}},h=class extends c{constructor(){super(),r(this,"__groupTotals",!0),r(this,"group",null),r(this,"initialized",!1)}},p=class{constructor(){r(this,"activeEditController",null)}isActive(t){return t?this.activeEditController===t:null!==this.activeEditController}activate(t){if(t!==this.activeEditController){if(null!==this.activeEditController)throw new Error("Slick.EditorLock.activate: an editController is still active, can't activate another editController");if(!t.commitCurrentEdit)throw new Error("Slick.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!t.cancelCurrentEdit)throw new Error("Slick.EditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=t}}deactivate(t){if(this.activeEditController){if(this.activeEditController!==t)throw new Error("Slick.EditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return!this.activeEditController||this.activeEditController.commitCurrentEdit()}cancelCurrentEdit(){return!this.activeEditController||this.activeEditController.cancelCurrentEdit()}};var f=class{constructor(){r(this,"_boundedEvents",[])}getBoundedEvents(){return this._boundedEvents}destroy(){this.unbindAll()}bind(t,e,i,n,r=""){t&&(t.addEventListener(e,i,n),this._boundedEvents.push({element:t,eventName:e,listener:i,groupName:r}))}unbind(t,e,i){null!=t&&t.removeEventListener&&t.removeEventListener(e,i)}unbindByEventName(t,e){let i=this._boundedEvents.find((i=>i.element===t&&i.eventName===e));i&&this.unbind(i.element,i.eventName,i.listener)}unbindAll(t){if(t){let e=Array.isArray(t)?t:[t];for(let t=this._boundedEvents.length-1;t>=0;--t){let i=this._boundedEvents[t];if(e.some((t=>t===i.groupName))){let{element:e,eventName:n,listener:r}=i;this.unbind(e,n,r),this._boundedEvents.splice(t,1)}}}else for(;this._boundedEvents.length>0;){let t=this._boundedEvents.pop(),{element:e,eventName:i,listener:n}=t;this.unbind(e,i,n)}}},g=class t{static isFunction(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item}static isPlainObject(e){if(!e||"[object Object]"!==t.toString.call(e))return!1;let i=t.getProto(e);if(!i)return!0;let n=t.hasOwn.call(i,"constructor")&&i.constructor;return"function"==typeof n&&t.fnToString.call(n)===t.ObjectFunctionString}static calculateAvailableSpace(e){let i=0,n=0,r=0,s=0,o=window.innerHeight||0,l=window.innerWidth||0,a=t.windowScrollPosition(),u=a.top,c=a.left,d=t.offset(e);if(d){let t=d.top||0,e=d.left||0;n=t-u,i=o-(t-u),r=e-c,s=l-(e-c)}return{top:n,bottom:i,left:r,right:s}}static extend(...e){let i,n,r,s,o,l,a=e[0],u=1,c=!1,d=e.length;for("boolean"==typeof a?(c=a,a=e[u]||{},u++):a=a||{},"object"!=typeof a&&!t.isFunction(a)&&(a={}),u===d&&(a=this,u--);u<d;u++)if(t.isDefined(i=e[u]))for(n in i)s=i[n],"__proto__"!==n&&a!==s&&(c&&s&&(t.isPlainObject(s)||(o=Array.isArray(s)))?(r=a[n],l=o&&!Array.isArray(r)?[]:o||t.isPlainObject(r)?r:{},o=!1,a[n]=t.extend(c,l,s)):void 0!==s&&(a[n]=s));return a}static createDomElement(t,e,i){let n=document.createElement(t);return e&&Object.keys(e).forEach((t=>{let i=e[t];"object"==typeof i?Object.assign(n[t],i):n[t]=e[t]})),null!=i&&i.appendChild&&i.appendChild(n),n}static getHtmlStringOutput(t,e="innerHTML"){return t instanceof DocumentFragment?[].map.call(t.childNodes,(t=>t[e])).join("")||t.textContent||"":t instanceof HTMLElement?t[e]:String(t)}static emptyElement(t){for(;null!=t&&t.firstChild;)t.removeChild(t.firstChild);return t}static classNameToList(t=""){return t.split(" ").filter((t=>t))}static innerSize(e,i){let n=0;if(e){let r="height"===i?["top","bottom"]:["left","right"];n=e["height"===i?"clientHeight":"clientWidth"];for(let i of r){n-=parseFloat(t.getElementProp(e,`padding-${i}`)||"")||0}}return n}static isDefined(t){return null!=t&&""!==t}static getElementProp(t,e){return null!=t&&t.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue(e):null}static getFunctionDetails(t,e=!0){let i=!1;return{params:(t=>{var e;let i=t.toString().replace(/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/gm,"");return null!=(e=i.slice(i.indexOf("(")+1,i.indexOf(")")).match(/([^\s,]+)/g))?e:[]})(t),body:(t=>{let n=t.toString();if(i=n.includes("async "),n.replaceAll(" ","").includes("=>({")){let t=n.match(/(({.*}))/g)||[];return t.length>=1?`return ${t[0].trimStart()}`:n}let r=!n.includes("{")&&n.includes("=>"),s=n.substring(n.indexOf("{")+1||n.indexOf("=>")+2,n.includes("}")?n.lastIndexOf("}"):n.length);return e&&r&&!s.startsWith("return")?"return "+s.trimStart():s})(t),isAsync:i}}static insertAfterElement(t,e){var i;null==(i=t.parentNode)||i.insertBefore(e,t.nextSibling)}static isEmptyObject(t){return null==t||0===Object.entries(t).length}static noop(){}static offset(t){if(!t||!t.getBoundingClientRect)return;let e=t.getBoundingClientRect(),i=document.documentElement;return{top:e.top+window.pageYOffset-i.clientTop,left:e.left+window.pageXOffset-i.clientLeft}}static windowScrollPosition(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}static width(e,i){if(e&&e.getBoundingClientRect){if(void 0===i)return e.getBoundingClientRect().width;t.setStyleSize(e,"width",i)}}static height(e,i){if(e){if(void 0===i)return e.getBoundingClientRect().height;t.setStyleSize(e,"height",i)}}static setStyleSize(t,e,i){"function"==typeof i?i=i():t.style[e]="string"==typeof i?i:i+"px"}static contains(e,i){return!(!e||!i)&&!t.parents(i).every((t=>e!==t))}static isHidden(t){return 0===t.offsetWidth&&0===t.offsetHeight}static parents(e,i){let n=[],r=":visible"===i,s=":hidden"===i;for(;(e=e.parentNode)&&e!==document&&e&&e.parentNode;)s?t.isHidden(e)&&n.push(e):r?t.isHidden(e)||n.push(e):(!i||e.matches(i))&&n.push(e);return n}static toFloat(t){let e=parseFloat(t);return isNaN(e)?0:e}static show(t,e=""){Array.isArray(t)?t.forEach((t=>t.style.display=e)):t.style.display=e}static hide(t){Array.isArray(t)?t.forEach((t=>t.style.display="none")):t.style.display="none"}static slideUp(e,i){return t.slideAnimation(e,"slideUp",i)}static slideDown(e,i){return t.slideAnimation(e,"slideDown",i)}static slideAnimation(e,i,n){void 0===window.jQuery?("slideUp"===i?t.hide(e):t.show(e),n()):window.jQuery(e)[i]("fast",n)}static applyDefaults(t,e){"object"==typeof e&&Object.keys(e).forEach((i=>{e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i])}))}static addSlickEventPubSubWhenDefined(t,e){if(t)for(let i in e)e[i]instanceof l&&"function"==typeof e[i].setPubSubService&&e[i].setPubSubService(t)}};r(g,"getProto",Object.getPrototypeOf),r(g,"class2type",{}),r(g,"toString",g.class2type.toString),r(g,"hasOwn",g.class2type.hasOwnProperty),r(g,"fnToString",g.hasOwn.toString),r(g,"ObjectFunctionString",g.fnToString.call(Object)),r(g,"storage",{_storage:new WeakMap,put:function(t,e,i){this._storage.has(t)||this._storage.set(t,new Map),this._storage.get(t).set(e,i)},get:function(t,e){let i=this._storage.get(t);return i?i.get(e):null},remove:function(t,e){let i=this._storage.get(t).delete(e);return 0!==this._storage.get(t).size&&this._storage.delete(t),i}});var v,m=g,E=new p,b={Event:l,EventData:o,EventHandler:a,Range:u,NonDataRow:c,Group:d,GroupTotals:h,EditorLock:p,RegexSanitizer:function(t){return t.replace(/(\b)(on[a-z]+)(\s*)=|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;)(\/*)(script|script defer)(.*)(&gt;|&gt;">)/gi,"")},GlobalEditorLock:E,keyCode:{SPACE:8,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentExpandOnly:"CXO",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{Auto:"AUTO",TextOnly:"CANV",HTML:"HTML"}},{EditorLock:S,Event:y,EventData:C,EventHandler:w,Group:_,GroupTotals:P,NonDataRow:O,Range:k,RegexSanitizer:R,GlobalEditorLock:A,keyCode:N,preClickClassName:L,GridAutosizeColsMode:D,ColAutosizeMode:T,RowSelectionMode:M,ValueFilterMode:j,WidthEvalMode:F}=b;return"undefined"!=typeof global&&window.Slick&&(global.Slick=window.Slick),v=s,((r,s,o,l)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let a of i(s))!n.call(r,a)&&a!==o&&t(r,a,{get:()=>s[a],enumerable:!(l=e(s,a))||l.enumerable});return r})(t({},"__esModule",{value:!0}),v)})();
"use strict";(()=>{var e=Slick.Utils;window.Slick&&e.extend(Slick,{Draggable:function(t){let n,o,r,d,l,i,{containerElement:a}=t,{onDragInit:u,onDragStart:s,onDrag:c,onDragEnd:m,preventDragFromKeys:v}=t;a||(a=document.body);let h={dragSource:a,dragHandle:null};function E(e,t,n){if("function"==typeof e)return e(t,n)}function f(e){let t=!1;return v&&v.forEach((n=>{e[n]&&(t=!0)})),t}function b(i){var a,s;if(!f(i)){n=i.target;let c=null!=(s=null==(a=null==i?void 0:i.touches)?void 0:a[0])?s:i,{target:m}=c;if(!t.allowDragFrom||t.allowDragFrom&&n.matches(t.allowDragFrom)||t.allowDragFromClosest&&n.closest(t.allowDragFromClosest)){h.dragHandle=n;let t=e.windowScrollPosition();o=t.left+c.clientX,r=t.top+c.clientY,d=c.clientX-c.clientX,l=c.clientY-c.clientY,h=Object.assign(h,{deltaX:d,deltaY:l,startX:o,startY:r,target:m}),!1!==E(u,i,h)&&(document.body.addEventListener("mousemove",L),document.body.addEventListener("touchmove",L),document.body.addEventListener("mouseup",g),document.body.addEventListener("touchend",g),document.body.addEventListener("touchcancel",g))}}}function L(e){var t,n;if(!f(e)){let a=null!=(n=null==(t=null==e?void 0:e.touches)?void 0:t[0])?n:e;d=a.clientX-o,l=a.clientY-r;let{target:u}=a;i||(h=Object.assign(h,{deltaX:d,deltaY:l,startX:o,startY:r,target:u}),E(s,e,h),i=!0),h=Object.assign(h,{deltaX:d,deltaY:l,startX:o,startY:r,target:u}),E(c,e,h)}}function g(e){if(document.body.removeEventListener("mousemove",L),document.body.removeEventListener("touchmove",L),document.body.removeEventListener("mouseup",g),document.body.removeEventListener("touchend",g),document.body.removeEventListener("touchcancel",g),i){let{target:t}=e;h=Object.assign(h,{target:t}),E(m,e,h),i=!1}}return a&&(a.addEventListener("mousedown",b),a.addEventListener("touchstart",b)),{destroy:function(){a&&(a.removeEventListener("mousedown",b),a.removeEventListener("touchstart",b))}}},MouseWheel:function(e){let{element:t,onMouseWheel:n}=e;function o(e){let t=e||window.event,o=0,r=0,d=0;t.wheelDelta&&(o=t.wheelDelta/120),t.detail&&(o=-t.detail/3),d=o,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(d=0,r=-1*o),void 0!==t.wheelDeltaY&&(d=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(r=-1*t.wheelDeltaX/120),"function"==typeof n&&n(e,o,r,d)}return t.addEventListener("wheel",o),t.addEventListener("mousewheel",o),{destroy:function(){t.removeEventListener("wheel",o),t.removeEventListener("mousewheel",o)}}},Resizable:function(e){let{resizeableElement:t,resizeableHandleElement:n,onResizeStart:o,onResize:r,onResizeEnd:d}=e;if(!n||"function"!=typeof n.addEventListener)throw new Error("[Slick.Resizable] You did not provide a valid html element that will be used for the handle to resize.");function l(e,o){if("function"==typeof e)return e(o,{resizeableElement:t,resizeableHandleElement:n})}function i(e){e.preventDefault();let t=e.touches?e.changedTouches[0]:e;!1!==l(o,t)&&(document.body.addEventListener("mousemove",a),document.body.addEventListener("mouseup",u),document.body.addEventListener("touchmove",a),document.body.addEventListener("touchend",u))}function a(e){e.preventDefault&&"touchmove"!==e.type&&e.preventDefault();let o=e.touches?e.changedTouches[0]:e;"function"==typeof r&&r(o,{resizeableElement:t,resizeableHandleElement:n})}function u(e){let t=e.touches?e.changedTouches[0]:e;l(d,t),document.body.removeEventListener("mousemove",a),document.body.removeEventListener("mouseup",u),document.body.removeEventListener("touchmove",a),document.body.removeEventListener("touchend",u)}return n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),{destroy:function(){"function"==typeof(null==n?void 0:n.removeEventListener)&&(n.removeEventListener("mousedown",i),n.removeEventListener("touchstart",i))}}}})})();
"use strict";(()=>{var e=Object.defineProperty,t=(t,i,s)=>((t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s)(t,"symbol"!=typeof i?i+"":i,s),i=Slick.BindingEventService,s=Slick.ColAutosizeMode,o=Slick.Event,l=Slick.EventData,n=Slick.GlobalEditorLock,r=Slick.GridAutosizeColsMode,h=Slick.keyCode,a=Slick.preClickClassName,d=Slick.Range,c=Slick.RowSelectionMode,u=Slick.ValueFilterMode,p=Slick.Utils,m=Slick.WidthEvalMode,w=Slick.Draggable,g=Slick.MouseWheel,v=Slick.Resizable;window.Slick&&p.extend(Slick,{Grid:class{constructor(e,l,h,a,d){if(this.container=e,this.data=l,this.columns=h,this.externalPubSub=d,t(this,"slickGridVersion","5.15.3"),t(this,"cid",""),t(this,"onActiveCellChanged"),t(this,"onActiveCellPositionChanged"),t(this,"onAddNewRow"),t(this,"onAfterSetColumns"),t(this,"onAutosizeColumns"),t(this,"onBeforeAppendCell"),t(this,"onBeforeCellEditorDestroy"),t(this,"onBeforeColumnsResize"),t(this,"onBeforeDestroy"),t(this,"onBeforeEditCell"),t(this,"onBeforeFooterRowCellDestroy"),t(this,"onBeforeHeaderCellDestroy"),t(this,"onBeforeHeaderRowCellDestroy"),t(this,"onBeforeRemoveCachedRow"),t(this,"onBeforeSetColumns"),t(this,"onBeforeSort"),t(this,"onBeforeUpdateColumns"),t(this,"onCellChange"),t(this,"onCellCssStylesChanged"),t(this,"onClick"),t(this,"onColumnsReordered"),t(this,"onColumnsDrag"),t(this,"onColumnsResized"),t(this,"onColumnsResizeDblClick"),t(this,"onCompositeEditorChange"),t(this,"onContextMenu"),t(this,"onDrag"),t(this,"onDblClick"),t(this,"onDragInit"),t(this,"onDragStart"),t(this,"onDragEnd"),t(this,"onFooterClick"),t(this,"onFooterContextMenu"),t(this,"onFooterRowCellRendered"),t(this,"onHeaderCellRendered"),t(this,"onHeaderClick"),t(this,"onHeaderContextMenu"),t(this,"onHeaderMouseEnter"),t(this,"onHeaderMouseLeave"),t(this,"onHeaderRowCellRendered"),t(this,"onHeaderRowMouseEnter"),t(this,"onHeaderRowMouseLeave"),t(this,"onPreHeaderContextMenu"),t(this,"onPreHeaderClick"),t(this,"onKeyDown"),t(this,"onMouseEnter"),t(this,"onMouseLeave"),t(this,"onRendered"),t(this,"onScroll"),t(this,"onSelectedRowsChanged"),t(this,"onSetOptions"),t(this,"onActivateChangedOptions"),t(this,"onSort"),t(this,"onValidationError"),t(this,"onViewportChanged"),t(this,"scrollbarDimensions"),t(this,"maxSupportedCssHeight"),t(this,"canvas",null),t(this,"canvas_context",null),t(this,"_options"),t(this,"_defaults",{alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,auto:!1,nonce:"",editorLock:n,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableCellRowSpan:!1,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:r.LegacyOff,autosizeColPaddingPx:4,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,maxPartialRowSpanRemap:5e3,sanitizer:void 0,logSanitizedHtml:!1,mixinDefaults:!0,shadowRoot:void 0}),t(this,"_columnDefaults",{name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0}),t(this,"_columnAutosizeDefaults",{ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:s.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:c.FirstNRows,rowSelectionCount:100,valueFilterMode:u.None,widthEvalMode:m.Auto,sizeToRemaining:void 0,widthPx:void 0,contentSizePx:0,headerWidthPx:0,colDataTypeOf:void 0}),t(this,"_columnResizeTimer"),t(this,"_executionBlockTimer"),t(this,"_flashCellTimer"),t(this,"_highlightRowTimer"),t(this,"th"),t(this,"h"),t(this,"ph"),t(this,"n"),t(this,"cj"),t(this,"page",0),t(this,"offset",0),t(this,"vScrollDir",1),t(this,"_bindingEventService",new i),t(this,"initialized",!1),t(this,"_container"),t(this,"uid",`slickgrid_${Math.round(1e6*Math.random())}`),t(this,"_focusSink"),t(this,"_focusSink2"),t(this,"_groupHeaders",[]),t(this,"_headerScroller",[]),t(this,"_headers",[]),t(this,"_headerRows"),t(this,"_headerRowScroller"),t(this,"_headerRowSpacerL"),t(this,"_headerRowSpacerR"),t(this,"_footerRow"),t(this,"_footerRowScroller"),t(this,"_footerRowSpacerL"),t(this,"_footerRowSpacerR"),t(this,"_preHeaderPanel"),t(this,"_preHeaderPanelScroller"),t(this,"_preHeaderPanelSpacer"),t(this,"_preHeaderPanelR"),t(this,"_preHeaderPanelScrollerR"),t(this,"_preHeaderPanelSpacerR"),t(this,"_topHeaderPanel"),t(this,"_topHeaderPanelScroller"),t(this,"_topHeaderPanelSpacer"),t(this,"_topPanelScrollers"),t(this,"_topPanels"),t(this,"_viewport"),t(this,"_canvas"),t(this,"_style"),t(this,"_boundAncestors",[]),t(this,"stylesheet"),t(this,"columnCssRulesL"),t(this,"columnCssRulesR"),t(this,"viewportH",0),t(this,"viewportW",0),t(this,"canvasWidth",0),t(this,"canvasWidthL",0),t(this,"canvasWidthR",0),t(this,"headersWidth",0),t(this,"headersWidthL",0),t(this,"headersWidthR",0),t(this,"viewportHasHScroll",!1),t(this,"viewportHasVScroll",!1),t(this,"headerColumnWidthDiff",0),t(this,"headerColumnHeightDiff",0),t(this,"cellWidthDiff",0),t(this,"cellHeightDiff",0),t(this,"absoluteColumnMinWidth"),t(this,"hasFrozenRows",!1),t(this,"frozenRowsHeight",0),t(this,"actualFrozenRow",-1),t(this,"paneTopH",0),t(this,"paneBottomH",0),t(this,"viewportTopH",0),t(this,"viewportBottomH",0),t(this,"topPanelH",0),t(this,"headerRowH",0),t(this,"footerRowH",0),t(this,"tabbingDirection",1),t(this,"_activeCanvasNode"),t(this,"_activeViewportNode"),t(this,"activePosX"),t(this,"activePosY"),t(this,"activeRow"),t(this,"activeCell"),t(this,"activeCellNode",null),t(this,"currentEditor",null),t(this,"serializedEditorValue"),t(this,"editController"),t(this,"_prevDataLength",0),t(this,"_prevInvalidatedRowsCount",0),t(this,"_rowSpanIsCached",!1),t(this,"_colsWithRowSpanCache",{}),t(this,"rowsCache",{}),t(this,"renderedRows",0),t(this,"numVisibleRows",0),t(this,"prevScrollTop",0),t(this,"scrollHeight",0),t(this,"scrollTop",0),t(this,"lastRenderedScrollTop",0),t(this,"lastRenderedScrollLeft",0),t(this,"prevScrollLeft",0),t(this,"scrollLeft",0),t(this,"selectionModel"),t(this,"selectedRows",[]),t(this,"plugins",[]),t(this,"cellCssClasses",{}),t(this,"columnsById",{}),t(this,"sortColumns",[]),t(this,"columnPosLeft",[]),t(this,"columnPosRight",[]),t(this,"pagingActive",!1),t(this,"pagingIsLastPage",!1),t(this,"scrollThrottle"),t(this,"h_editorLoader"),t(this,"h_postrender"),t(this,"h_postrenderCleanup"),t(this,"postProcessedRows",{}),t(this,"postProcessToRow",null),t(this,"postProcessFromRow",null),t(this,"postProcessedCleanupQueue",[]),t(this,"postProcessgroupId",0),t(this,"counter_rows_rendered",0),t(this,"counter_rows_removed",0),t(this,"_paneHeaderL"),t(this,"_paneHeaderR"),t(this,"_paneTopL"),t(this,"_paneTopR"),t(this,"_paneBottomL"),t(this,"_paneBottomR"),t(this,"_headerScrollerL"),t(this,"_headerScrollerR"),t(this,"_headerL"),t(this,"_headerR"),t(this,"_groupHeadersL"),t(this,"_groupHeadersR"),t(this,"_headerRowScrollerL"),t(this,"_headerRowScrollerR"),t(this,"_footerRowScrollerL"),t(this,"_footerRowScrollerR"),t(this,"_headerRowL"),t(this,"_headerRowR"),t(this,"_footerRowL"),t(this,"_footerRowR"),t(this,"_topPanelScrollerL"),t(this,"_topPanelScrollerR"),t(this,"_topPanelL"),t(this,"_topPanelR"),t(this,"_viewportTopL"),t(this,"_viewportTopR"),t(this,"_viewportBottomL"),t(this,"_viewportBottomR"),t(this,"_canvasTopL"),t(this,"_canvasTopR"),t(this,"_canvasBottomL"),t(this,"_canvasBottomR"),t(this,"_viewportScrollContainerX"),t(this,"_viewportScrollContainerY"),t(this,"_headerScrollContainer"),t(this,"_headerRowScrollContainer"),t(this,"_footerRowScrollContainer"),t(this,"cssShow",{position:"absolute",visibility:"hidden",display:"block"}),t(this,"_hiddenParents",[]),t(this,"oldProps",[]),t(this,"enforceFrozenRowHeightRecalc",!1),t(this,"columnResizeDragging",!1),t(this,"slickDraggableInstance",null),t(this,"slickMouseWheelInstances",[]),t(this,"slickResizableInstances",[]),t(this,"sortableSideLeftInstance"),t(this,"sortableSideRightInstance"),t(this,"logMessageCount",0),t(this,"logMessageMaxCount",30),t(this,"_pubSubService"),this._container="string"==typeof this.container?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=d,this.onActiveCellChanged=new o("onActiveCellChanged",d),this.onActiveCellPositionChanged=new o("onActiveCellPositionChanged",d),this.onAddNewRow=new o("onAddNewRow",d),this.onAfterSetColumns=new o("onAfterSetColumns",d),this.onAutosizeColumns=new o("onAutosizeColumns",d),this.onBeforeAppendCell=new o("onBeforeAppendCell",d),this.onBeforeCellEditorDestroy=new o("onBeforeCellEditorDestroy",d),this.onBeforeColumnsResize=new o("onBeforeColumnsResize",d),this.onBeforeDestroy=new o("onBeforeDestroy",d),this.onBeforeEditCell=new o("onBeforeEditCell",d),this.onBeforeFooterRowCellDestroy=new o("onBeforeFooterRowCellDestroy",d),this.onBeforeHeaderCellDestroy=new o("onBeforeHeaderCellDestroy",d),this.onBeforeHeaderRowCellDestroy=new o("onBeforeHeaderRowCellDestroy",d),this.onBeforeRemoveCachedRow=new o("onRowRemovedFromCache",d),this.onBeforeSetColumns=new o("onBeforeSetColumns",d),this.onBeforeSort=new o("onBeforeSort",d),this.onBeforeUpdateColumns=new o("onBeforeUpdateColumns",d),this.onCellChange=new o("onCellChange",d),this.onCellCssStylesChanged=new o("onCellCssStylesChanged",d),this.onClick=new o("onClick",d),this.onColumnsReordered=new o("onColumnsReordered",d),this.onColumnsDrag=new o("onColumnsDrag",d),this.onColumnsResized=new o("onColumnsResized",d),this.onColumnsResizeDblClick=new o("onColumnsResizeDblClick",d),this.onCompositeEditorChange=new o("onCompositeEditorChange",d),this.onContextMenu=new o("onContextMenu",d),this.onDrag=new o("onDrag",d),this.onDblClick=new o("onDblClick",d),this.onDragInit=new o("onDragInit",d),this.onDragStart=new o("onDragStart",d),this.onDragEnd=new o("onDragEnd",d),this.onFooterClick=new o("onFooterClick",d),this.onFooterContextMenu=new o("onFooterContextMenu",d),this.onFooterRowCellRendered=new o("onFooterRowCellRendered",d),this.onHeaderCellRendered=new o("onHeaderCellRendered",d),this.onHeaderClick=new o("onHeaderClick",d),this.onHeaderContextMenu=new o("onHeaderContextMenu",d),this.onHeaderMouseEnter=new o("onHeaderMouseEnter",d),this.onHeaderMouseLeave=new o("onHeaderMouseLeave",d),this.onHeaderRowCellRendered=new o("onHeaderRowCellRendered",d),this.onHeaderRowMouseEnter=new o("onHeaderRowMouseEnter",d),this.onHeaderRowMouseLeave=new o("onHeaderRowMouseLeave",d),this.onPreHeaderClick=new o("onPreHeaderClick",d),this.onPreHeaderContextMenu=new o("onPreHeaderContextMenu",d),this.onKeyDown=new o("onKeyDown",d),this.onMouseEnter=new o("onMouseEnter",d),this.onMouseLeave=new o("onMouseLeave",d),this.onRendered=new o("onRendered",d),this.onScroll=new o("onScroll",d),this.onSelectedRowsChanged=new o("onSelectedRowsChanged",d),this.onSetOptions=new o("onSetOptions",d),this.onActivateChangedOptions=new o("onActivateChangedOptions",d),this.onSort=new o("onSort",d),this.onValidationError=new o("onValidationError",d),this.onViewportChanged=new o("onViewportChanged",d),this.initialize(a)}init(){this.finishInitialization()}initialize(e){if(null!=e&&e.mixinDefaults?(this._options||(this._options=e),p.applyDefaults(this._options,this._defaults)):this._options=p.extend(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!Sortable||!Sortable.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},p.emptyElement(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("ui-widget"),this._container.setAttribute("role","grid");let t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=p.createDomElement("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=p.createDomElement("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=p.createDomElement("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||p.hide(this._topHeaderPanelScroller)),this._paneHeaderL=p.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=p.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=p.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=p.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=p.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=p.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=p.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=p.createDomElement("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=p.createDomElement("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=p.createDomElement("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(p.hide(this._preHeaderPanelScroller),p.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=p.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=p.createDomElement("div",{className:"slick-header ui-state-default slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=p.createDomElement("div",{className:"slick-header-columns slick-header-columns-left",role:"row",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=p.createDomElement("div",{className:"slick-header-columns slick-header-columns-right",role:"row",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=p.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopL),this._headerRowScrollerR=p.createDomElement("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=p.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=p.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=p.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopL),this._topPanelScrollerR=p.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=p.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=p.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach((e=>{p.hide(e)})),this._options.showTopPanel||this._topPanelScrollers.forEach((e=>{p.hide(e)})),this._options.showHeaderRow||this._headerRowScroller.forEach((e=>{p.hide(e)})),this._viewportTopL=p.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=p.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=p.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=p.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach((e=>{e.classList.add(...p.classNameToList(this._options.viewportClass))})),this._activeViewportNode=this._viewportTopL,this._canvasTopL=p.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=p.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=p.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=p.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar();let i=this.getCanvasWidth()+this.scrollbarDimensions.width;this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&p.width(this._topHeaderPanelSpacer,i),this._preHeaderPanelSpacer&&p.width(this._preHeaderPanelSpacer,i),this._headers.forEach((e=>{p.width(e,this.getHeadersWidth())})),p.width(this._headerRowSpacerL,i),p.width(this._headerRowSpacerR,i),this._options.createFooterRow&&(this._footerRowScrollerR=p.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopR),this._footerRowScrollerL=p.createDomElement("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),p.width(this._footerRowSpacerL,i),this._footerRowSpacerR=p.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),p.width(this._footerRowSpacerR,i),this._footerRowL=p.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=p.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach((e=>{p.hide(e)}))),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach((e=>{this._bindingEventService.bind(e,"selectstart",(e=>{e.target instanceof HTMLInputElement||(e.target,HTMLTextAreaElement)}))})),this.setFrozenOptions(),this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))})),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(g({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))})),this._headerScroller.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))})),this._headerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))})),this._options.createFooterRow&&(this._footerRow.forEach((e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))})),this._footerRowScroller.forEach((e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))}))),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScroller,"click",this.handlePreHeaderClick.bind(this)),this._bindingEventService.bind(this._preHeaderPanelScrollerR,"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach((e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))})),w&&(this.slickDraggableInstance=w({containerElement:this._container,allowDragFrom:"div.slick-cell",allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=p.parents(this._container,":hidden"),this.oldProps=[],this._hiddenParents.forEach((e=>{let t={};Object.keys(this.cssShow).forEach((i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])})),this.oldProps.push(t)}))}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&(this._hiddenParents.forEach((t=>{let i=this.oldProps[e++];Object.keys(this.cssShow).forEach((e=>{this.cssShow&&(t.style[e]=i[e])}))})),this._hiddenParents=[])}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){var t;for(let i=this.plugins.length;i>=0;i--)if(this.plugins[i]===e){null==(t=this.plugins[i])||t.destroy(),this.plugins.splice(i,1);break}}destroy(e){var t,i,s,o;this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),null==(t=this.getEditorLock())||t.cancelCurrentEdit(),this.trigger(this.onBeforeDestroy,{});let l=this.plugins.length;for(;l--;)this.unregisterPlugin(this.plugins[l]);this._options.enableColumnReorder&&"function"==typeof(null==(i=this.sortableSideLeftInstance)?void 0:i.destroy)&&(null==(s=this.sortableSideLeftInstance)||s.destroy(),null==(o=this.sortableSideRightInstance)||o.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach((e=>{this._bindingEventService.unbindByEventName(e,"keydown"),this._bindingEventService.unbindByEventName(e,"click"),this._bindingEventService.unbindByEventName(e,"dblclick"),this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"mouseover"),this._bindingEventService.unbindByEventName(e,"mouseout")})),this._viewport.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._headerScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._headerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._footerRow&&this._footerRow.forEach((e=>{this._bindingEventService.unbindByEventName(e,"contextmenu"),this._bindingEventService.unbindByEventName(e,"click")})),this._footerRowScroller&&this._footerRowScroller.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");let n=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(n,(e=>{this._bindingEventService.unbindByEventName(e,"dblclick")}));let r=this._container.querySelectorAll(".slick-header-column");[].forEach.call(r,(e=>{this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave"),this._bindingEventService.unbindByEventName(e,"mouseenter"),this._bindingEventService.unbindByEventName(e,"mouseleave")})),p.emptyElement(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&this.destroyAllElements()}destroyAllInstances(e){if(e){let t,i=Array.isArray(e)?e:[e];for(;p.isDefined(t=i.pop());)t&&"function"==typeof t.destroy&&t.destroy()}return e=Array.isArray(e)?[]:null}destroyAllElements(){this._activeCanvasNode=null,this._activeViewportNode=null,this._boundAncestors=null,this._canvas=null,this._canvasTopL=null,this._canvasTopR=null,this._canvasBottomL=null,this._canvasBottomR=null,this._container=null,this._focusSink=null,this._focusSink2=null,this._groupHeaders=null,this._groupHeadersL=null,this._groupHeadersR=null,this._headerL=null,this._headerR=null,this._headers=null,this._headerRows=null,this._headerRowL=null,this._headerRowR=null,this._headerRowSpacerL=null,this._headerRowSpacerR=null,this._headerRowScrollContainer=null,this._headerRowScroller=null,this._headerRowScrollerL=null,this._headerRowScrollerR=null,this._headerScrollContainer=null,this._headerScroller=null,this._headerScrollerL=null,this._headerScrollerR=null,this._hiddenParents=null,this._footerRow=null,this._footerRowL=null,this._footerRowR=null,this._footerRowSpacerL=null,this._footerRowSpacerR=null,this._footerRowScroller=null,this._footerRowScrollerL=null,this._footerRowScrollerR=null,this._footerRowScrollContainer=null,this._preHeaderPanel=null,this._preHeaderPanelR=null,this._preHeaderPanelScroller=null,this._preHeaderPanelScrollerR=null,this._preHeaderPanelSpacer=null,this._preHeaderPanelSpacerR=null,this._topPanels=null,this._topPanelScrollers=null,this._style=null,this._topPanelScrollerL=null,this._topPanelScrollerR=null,this._topPanelL=null,this._topPanelR=null,this._paneHeaderL=null,this._paneHeaderR=null,this._paneTopL=null,this._paneTopR=null,this._paneBottomL=null,this._paneBottomR=null,this._viewport=null,this._viewportTopL=null,this._viewportTopR=null,this._viewportBottomL=null,this._viewportBottomR=null,this._viewportScrollContainerX=null,this._viewportScrollContainerY=null}getOptions(){return this._options}setOptions(e,t,i,s){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),void 0!==e.frozenColumn&&e.frozenColumn>=0&&(this.getViewports().forEach((e=>e.scrollLeft=0)),this.handleScroll());let o=p.extend(!0,{},this._options);this._options=p.extend(this._options,e),this.trigger(this.onSetOptions,{optionsBefore:o,optionsAfter:this._options}),this.internal_setOptions(t,i,s)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.trigger(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock().commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){void 0!==this._options.showColumnHeader&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),void 0!==this._options.frozenBottom&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach((e=>{e.style.overflowY=this._options.autoHeight?"hidden":"auto"})),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),!this._options.enableMouseWheelScrollHandler||!this._viewport||this.slickMouseWheelInstances&&0!==this.slickMouseWheelInstances.length?!1===this._options.enableMouseWheelScrollHandler&&this.destroyAllInstances(this.slickMouseWheelInstances):this._viewport.forEach((e=>{this.slickMouseWheelInstances.push(g({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}))}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1),this._options.forceFitColumns&&(this._options.autosizeColsMode=r.LegacyForceFit)}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}setPaneFrozenClasses(){let e=this.hasFrozenColumns()?"add":"remove";for(let t of[this._paneHeaderL,this._paneTopL,this._paneBottomL])t.classList[e]("frozen")}hasFrozenColumns(){return this._options.frozenColumn>-1}updateColumnHeader(e,t,i){if(this.initialized){let s=this.getColumnIndex(e);if(!p.isDefined(s))return;let o=this.columns[s],l=this.getColumnByIndex(s);l&&(void 0!==t&&(this.columns[s].name=t),void 0!==i&&(this.columns[s].toolTip=i),this.trigger(this.onBeforeHeaderCellDestroy,{node:l,column:o,grid:this}),l.setAttribute("title",i||""),void 0!==t&&this.applyHtmlCode(l.children[0],t),this.trigger(this.onHeaderCellRendered,{node:l,column:o,grid:this}))}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;let t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){let t="number"==typeof e?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[s]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow[0]}getHeaderRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._headerRowL:(t=this._headerRowR,i-=this._options.frozenColumn+1):t=this._headerRowL,t.children[i]}getFooterRowColumn(e){let t,i="number"==typeof e?e:this.getColumnIndex(e);return this.hasFrozenColumns()?i<=this._options.frozenColumn?t=this._footerRowL:(t=this._footerRowR,i-=this._options.frozenColumn+1):t=this._footerRowL,t.children[i]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach((e=>{e.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=p.storage.get(e,"column");this.trigger(this.onBeforeFooterRowCellDestroy,{node:e,column:t,grid:this})}))})),p.emptyElement(this._footerRowL),p.emptyElement(this._footerRowR);for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(!t||t.hidden)continue;let i=p.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),s=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;s&&i.classList.add(s),p.storage.put(i,"column",t),this.trigger(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}setupColumnSort(){this._headers.forEach((e=>{this._bindingEventService.bind(e,"click",(e=>{var t;if(this.columnResizeDragging||e.target.classList.contains("slick-resizable-handle"))return;let i=e.target.closest(".slick-header-column");if(!i)return;let s=p.storage.get(i,"column");if(s.sortable){if(null==(t=this.getEditorLock())||!t.commitCurrentEdit())return;let i=this.sortColumns.slice(),o=null,l=0;for(;l<this.sortColumns.length;l++)if(this.sortColumns[l].columnId===s.id){o=this.sortColumns[l],o.sortAsc=!o.sortAsc;break}let n,r=!!o;this._options.tristateMultiColumnSort?(o||(o={columnId:s.id,sortAsc:s.defaultSortAsc,sortCol:s}),r&&o.sortAsc&&(this.sortColumns.splice(l,1),o=null),this._options.multiColumnSort||(this.sortColumns=[]),o&&(!r||!this._options.multiColumnSort)&&this.sortColumns.push(o)):e.metaKey&&this._options.multiColumnSort?o&&this.sortColumns.splice(l,1):((!e.shiftKey&&!e.metaKey||!this._options.multiColumnSort)&&(this.sortColumns=[]),o?0===this.sortColumns.length&&this.sortColumns.push(o):(o={columnId:s.id,sortAsc:s.defaultSortAsc,sortCol:s},this.sortColumns.push(o))),n=this._options.multiColumnSort?{multiColumnSort:!0,previousSortColumns:i,sortCols:this.sortColumns.map((e=>{let t=this.columns[this.getColumnIndex(e.columnId)];return!t||t.hidden?null:{columnId:t.id,sortCol:t,sortAsc:e.sortAsc}})).filter((e=>e))}:{multiColumnSort:!1,previousSortColumns:i,columnId:this.sortColumns.length>0?s.id:null,sortCol:this.sortColumns.length>0?s:null,sortAsc:!(this.sortColumns.length>0)||this.sortColumns[0].sortAsc},!1!==this.trigger(this.onBeforeSort,n,e).getReturnValue()&&(this.setSortColumns(this.sortColumns),this.trigger(this.onSort,n,e))}}))}))}createColumnHeaders(){this._headers.forEach((e=>{e.querySelectorAll(".slick-header-column").forEach((e=>{let t=p.storage.get(e,"column");t&&this.trigger(this.onBeforeHeaderCellDestroy,{node:e,column:t,grid:this})}))})),p.emptyElement(this._headerL),p.emptyElement(this._headerR),this.getHeadersWidth(),p.width(this._headerL,this.headersWidthL),p.width(this._headerR,this.headersWidthR),this._headerRows.forEach((e=>{e.querySelectorAll(".slick-headerrow-column").forEach((e=>{let t=p.storage.get(e,"column");t&&this.trigger(this.onBeforeHeaderRowCellDestroy,{node:this,column:t,grid:this})}))})),p.emptyElement(this._headerRowL),p.emptyElement(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=p.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),p.emptyElement(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach((e=>{let t=p.storage.get(e,"column");t&&this.trigger(this.onBeforeFooterRowCellDestroy,{node:this,column:t,grid:this})})),p.emptyElement(this._footerRowR)));for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(t.hidden)continue;let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,s=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,o=p.createDomElement("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"ui-state-default slick-state-default slick-header-column"},i);t.toolTip&&(o.title=t.toolTip),t.reorderable||o.classList.add(this._options.unorderableColumnCssClass);let l=p.createDomElement("span",{className:"slick-column-name"},o);this.applyHtmlCode(l,t.name),p.width(o,t.width-this.headerColumnWidthDiff);let n=t.headerCssClass||null;if(n&&o.classList.add(...p.classNameToList(n)),n=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,n&&o.classList.add(n),this._bindingEventService.bind(o,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(o,"mouseleave",this.handleHeaderMouseLeave.bind(this)),p.storage.put(o,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(o,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(o,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach((e=>{t.headerCellAttrs.hasOwnProperty(e)&&o.setAttribute(e,t.headerCellAttrs[e])})),t.sortable&&(o.classList.add("slick-header-sortable"),p.createDomElement("div",{className:"slick-sort-indicator "+(this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")},o),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&p.createDomElement("div",{className:"slick-sort-indicator-numbered"},o)),this.trigger(this.onHeaderCellRendered,{node:o,column:t,grid:this}),this._options.showHeaderRow){let i=p.createDomElement("div",{className:`ui-state-default slick-state-default slick-headerrow-column l${e} r${e}`},s),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;o&&i.classList.add(o),this._bindingEventService.bind(i,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(i,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),p.storage.put(i,"column",t),this.trigger(this.onHeaderRowCellRendered,{node:i,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0],s=p.createDomElement("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},i);p.storage.put(s,"column",t),this.trigger(this.onFooterRowCellRendered,{node:s,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&("function"==typeof this._options.enableColumnReorder?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.trigger):this.setupColumnReorder())}setupColumnReorder(){var e,t;null==(e=this.sortableSideLeftInstance)||e.destroy(),null==(t=this.sortableSideRightInstance)||t.destroy();let i=null,s=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft+10,o=()=>this._viewportScrollContainerX.scrollLeft=this._viewportScrollContainerX.scrollLeft-10,l=!1,n={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:e=>!e.related.classList.contains(this._options.unorderableColumnCssClass),onStart:e=>{e.item.classList.add("slick-header-column-active"),l=!this.hasFrozenColumns()||p.offset(e.item).left>p.offset(this._viewportScrollContainerX).left,l&&e.originalEvent.pageX>this._container.clientWidth?i||(i=window.setInterval(s,100)):l&&e.originalEvent.pageX<p.offset(this._viewportScrollContainerX).left?i||(i=window.setInterval(o,100)):(window.clearInterval(i),i=null)},onEnd:e=>{var t,s,o,l,n;if(e.item.classList.remove("slick-header-column-active"),window.clearInterval(i),i=null,null==(t=this.getEditorLock())||!t.commitCurrentEdit())return;let r=null!=(o=null==(s=this.sortableSideLeftInstance)?void 0:s.toArray())?o:[];r=r.concat(null!=(n=null==(l=this.sortableSideRightInstance)?void 0:l.toArray())?n:[]);let h=[];for(let e=0;e<r.length;e++)h.push(this.columns[this.getColumnIndex(r[e])]);this.setColumns(h),this.trigger(this.onColumnsReordered,{impactedColumns:this.columns}),e.stopPropagation(),this.setupColumnResize(),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=Sortable.create(this._headerL,n),this.sortableSideRightInstance=Sortable.create(this._headerR,n)}getHeaderChildren(){let e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){let t=e.target.parentElement.id.replace(this.uid,"");this.trigger(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(void 0===v)throw new Error('Slick.Resizable is undefined, make sure to import "slick.interactions.js"');let e,t,i,s,o,l,n,r=-1,h=0,a=this.getHeaderChildren(),d=this.getVisibleColumns();for(let e=0;e<a.length;e++)a[e].querySelectorAll(".slick-resizable-handle").forEach((e=>e.remove())),!(e>=d.length)&&d[e]&&d[e].resizable&&(void 0===n&&(n=e),r=e);if(void 0!==n)for(let c=0;c<a.length;c++){let u=a[c];if(c>=d.length||!d[c]||c<n||this._options.forceFitColumns&&c>=r)continue;let m=p.createDomElement("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},u);this._bindingEventService.bind(m,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(v({resizeableElement:u,resizeableHandleElement:m,onResizeStart:(t,n)=>{var r;let u=t.touches?t.changedTouches[0]:t;if(null==(r=this.getEditorLock())||!r.commitCurrentEdit())return!1;s=u.pageX,h=0,n.resizeableElement.classList.add("slick-header-column-active");let p=null,m=null;for(let e=0;e<a.length;e++)e>=d.length||!d[e]||(d[e].previousWidth=a[e].offsetWidth);if(this._options.forceFitColumns)for(p=0,m=0,e=c+1;e<d.length;e++)i=d[e],null!=i&&i.resizable&&(null!==m&&(i.maxWidth?m+=i.maxWidth-(i.previousWidth||0):m=null),p+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let w=0,g=0;for(e=0;e<=c;e++)i=d[e],null!=i&&i.resizable&&(null!==g&&(i.maxWidth?g+=i.maxWidth-(i.previousWidth||0):g=null),w+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));null===p&&(p=1e5),null===w&&(w=1e5),null===m&&(m=1e5),null===g&&(g=1e5),l=s+Math.min(p,g),o=s-Math.min(w,m)},onResize:(n,r)=>{let a=n.touches?n.changedTouches[0]:n;this.columnResizeDragging=!0;let u,m,w=Math.min(l,Math.max(o,a.pageX))-s,g=0,v=0,C=this.getViewportInnerWidth();if(w<0){for(m=w,e=c;e>=0;e--)i=d[e],null!=i&&i.resizable&&!i.hidden&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),m&&(i.previousWidth||0)+m<u?(m+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+m,m=0));for(t=0;t<=c;t++)i=d[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(m=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m?(m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+m,m=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);else for(e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(m=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m?(m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+m,m=0))}else{for(m=w,g=0,v=0,e=c;e>=0;e--)if(i=d[e],i&&!i.hidden&&i.resizable)if(m&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<m)m-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{let t=(i.previousWidth||0)+m,s=this.canvasWidthL+m;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(t>h&&s<C-this._options.frozenRightViewportMinWidth&&(h=t),i.width=s+this._options.frozenRightViewportMinWidth>C?h:t):i.width=t,m=0}for(t=0;t<=c;t++)i=d[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);if(this._options.forceFitColumns)for(m=-w,e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&i.resizable&&(u=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),m&&(i.previousWidth||0)+m<u?(m+=(i.previousWidth||0)-u,i.width=u):(i.width=(i.previousWidth||0)+m,m=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0);else for(e=c+1;e<d.length;e++)i=d[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?v+=i.width||0:g+=i.width||0)}this.hasFrozenColumns()&&g!==this.canvasWidthL&&(p.width(this._headerL,g+1e3),p.setStyleSize(this._paneHeaderR,"left",g)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.trigger(this.onColumnsDrag,{triggeredByColumn:r.resizeableElement,resizeHandle:r.resizeableHandleElement})},onResizeEnd:(t,s)=>{s.resizeableElement.classList.remove("slick-header-column-active");let o,l=s.resizeableElement.id.replace(this.uid,"");for(!0===this.trigger(this.onBeforeColumnsResize,{triggeredByColumn:l}).getReturnValue()&&this.applyColumnHeaderWidths(),e=0;e<d.length;e++)i=d[e],i&&!i.hidden&&(o=a[e].offsetWidth,i.previousWidth!==o&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.trigger(this.onColumnsResized,{triggeredByColumn:l}),window.clearTimeout(this._columnResizeTimer),this._columnResizeTimer=window.setTimeout((()=>{this.columnResizeDragging=!1}),300)}}))}}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;let e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}autosizeColumn(e,t){let i=null,s=-1;if("number"==typeof e)i=this.columns[e],s=e;else if("string"==typeof e)for(let t=0;t<this.columns.length;t++)this.columns[t].id===e&&(i=this.columns[t],s=t);if(!i)return;let o=this.getCanvasNode(0,0);this.getColAutosizeWidth(i,s,o,t||!1,s)}treatAsLocked(e={}){var t;return!e.ignoreHeaderText&&!e.sizeToRemaining&&e.contentSizePx===e.headerWidthPx&&(null!=(t=e.widthPx)?t:0)<100}autosizeColumns(e,t){var i;let s=!(null!=(i=this._hiddenParents)&&i.length);s&&this.cacheCssForHiddenInit(),this.internalAutosizeColumns(e,t),s&&this.restoreCssFromHiddenInit()}internalAutosizeColumns(e,t){var i,o,l,n,h,a,d,c,u,m,w,g,v,C,f,_,R,S,b,y;if((e=e||this._options.autosizeColsMode)===r.LegacyForceFit||e===r.LegacyOff)return void this.legacyAutosizeColumns();if(e===r.None)return;this.canvas=document.createElement("canvas"),null!=(i=this.canvas)&&i.getContext&&(this.canvas_context=this.canvas.getContext("2d"));let H,P,L,E=this.getCanvasNode(0,0),z=this.getViewportInnerWidth(),x=!1,k=0,D=0,T=0,F=0,W=0;for(H=0;H<this.columns.length;H++)P=this.columns[H],this.getColAutosizeWidth(P,H,E,t||!1,H),W+=(null==(o=P.autoSize)?void 0:o.autosizeMode)===s.Locked?P.width||0:this.treatAsLocked(P.autoSize)&&(null==(l=P.autoSize)?void 0:l.widthPx)||0,F+=(null==(n=P.autoSize)?void 0:n.autosizeMode)===s.Locked?P.width||0:this.treatAsLocked(P.autoSize)?(null==(h=P.autoSize)?void 0:h.widthPx)||0:P.minWidth||0,k+=(null==(a=P.autoSize)?void 0:a.widthPx)||0,D+=null!=(d=P.autoSize)&&d.sizeToRemaining?0:(null==(c=P.autoSize)?void 0:c.widthPx)||0,T+=null!=(u=P.autoSize)&&u.sizeToRemaining&&P.minWidth||0;let A=k-D;if(e===r.FitViewportToCols){let t=k+(null!=(w=null==(m=this.scrollbarDimensions)?void 0:m.width)?w:0);e=r.IgnoreViewport,this._options.viewportMaxWidthPx&&t>this._options.viewportMaxWidthPx?(t=this._options.viewportMaxWidthPx,e=r.FitColsToViewport):this._options.viewportMinWidthPx&&t<this._options.viewportMinWidthPx&&(t=this._options.viewportMinWidthPx,e=r.FitColsToViewport),p.width(this._container,t)}if(e===r.FitColsToViewport)if(A>0&&D<z-T)for(H=0;H<this.columns.length;H++){if(P=this.columns[H],!P||P.hidden)continue;let e=z-D;L=null!=(g=P.autoSize)&&g.sizeToRemaining?e*((null==(v=P.autoSize)?void 0:v.widthPx)||0)/A:(null==(C=P.autoSize)?void 0:C.widthPx)||0,P.rerenderOnResize&&(P.width||0)!==L&&(x=!0),P.width=L}else if(this._options.viewportSwitchToScrollModeWidthPercent&&D+T>z*this._options.viewportSwitchToScrollModeWidthPercent/100||F>z)e=r.IgnoreViewport;else{let e=D-W,t=z-W-T;for(H=0;H<this.columns.length;H++)P=this.columns[H],P&&!P.hidden&&(L=P.width||0,(null==(f=P.autoSize)?void 0:f.autosizeMode)!==s.Locked&&!this.treatAsLocked(P.autoSize)&&(null!=(_=P.autoSize)&&_.sizeToRemaining?L=P.minWidth||0:(L=t/e*((null==(R=P.autoSize)?void 0:R.widthPx)||0)-1,L<(P.minWidth||0)&&(L=P.minWidth||0),e-=(null==(S=P.autoSize)?void 0:S.widthPx)||0,t-=L)),this.treatAsLocked(P.autoSize)&&(L=(null==(b=P.autoSize)?void 0:b.widthPx)||0,L<(P.minWidth||0)&&(L=P.minWidth||0)),P.rerenderOnResize&&P.width!==L&&(x=!0),P.width=L)}if(e===r.IgnoreViewport)for(H=0;H<this.columns.length;H++)!this.columns[H]||this.columns[H].hidden||(L=(null==(y=this.columns[H].autoSize)?void 0:y.widthPx)||0,this.columns[H].rerenderOnResize&&this.columns[H].width!==L&&(x=!0),this.columns[H].width=L);this.reRenderColumns(x)}getColAutosizeWidth(e,t,i,o,l){var n;let r=e.autoSize;if(r.widthPx=e.width,r.autosizeMode===s.Locked||r.autosizeMode===s.Guide)return;let h=this.getDataLength(),a=new RegExp(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/);if(r.autosizeMode===s.ContentIntelligent){let t,i=r.colDataTypeOf;if(h>0){let s=this.getDataItem(0);s&&(t=s[e.field],a.test(t)&&(t=Date.parse(t)),i=typeof t,"object"===i&&(t instanceof Date&&(i="date"),"undefined"!=typeof moment&&t instanceof moment&&(i="moment")))}"boolean"===i&&(r.colValueArray=[!0,!1]),"number"===i&&(r.valueFilterMode=u.GetGreatestAndSub,r.rowSelectionMode=c.AllRows),"string"===i&&(r.valueFilterMode=u.GetLongestText,r.rowSelectionMode=c.AllRows,r.allowAddlPercent=5),"date"===i&&(r.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===i&&"undefined"!=typeof moment&&(r.colValueArray=[moment([2009,8,30,12,20,20])])}let d=r.contentSizePx=this.getColContentSize(e,t,i,o,l);0===d&&(d=r.widthPx||0),d=d*(r.allowAddlPercent?1+r.allowAddlPercent/100:1)+(this._options.autosizeColPaddingPx||0),e.minWidth&&d<e.minWidth&&(d=e.minWidth),e.maxWidth&&d>e.maxWidth&&(d=e.maxWidth),(r.autosizeMode===s.ContentExpandOnly||null!=(n=null==e?void 0:e.editor)&&n.ControlFillsColumn)&&d<(e.width||0)&&(d=e.width||0),r.widthPx=d}getColContentSize(e,t,i,s,o){let l,n,r=e.autoSize,h=1,a=0,d=0;if(r.headerWidthPx=0,r.ignoreHeaderText||(r.headerWidthPx=this.getColHeaderWidth(e)),0===r.headerWidthPx&&(r.headerWidthPx=e.width?e.width:e.maxWidth?e.maxWidth:e.minWidth?e.minWidth:20),r.colValueArray)return d=this.getColWidth(e,i,r.colValueArray),Math.max(r.headerWidthPx,d);let p={};p.colIndex=t,p.rowCount=this.getDataLength(),p.startIndex=0,p.endIndex=p.rowCount-1,p.valueArr=null,p.getRowVal=t=>this.getDataItem(t)[e.field];let m=(s?r.rowSelectionModeOnInit:void 0)||r.rowSelectionMode;if(m===c.FirstRow&&(p.endIndex=0),m===c.LastRow&&(p.endIndex=p.startIndex=p.rowCount-1),m===c.FirstNRows&&(p.endIndex=Math.min(r.rowSelectionCount||0,p.rowCount)-1),r.valueFilterMode===u.DeDuplicate){let e={};for(l=p.startIndex;l<=p.endIndex;l++)e[p.getRowVal(l)]=!0;if(Object.keys)p.valueArr=Object.keys(e);else{p.valueArr=[];for(let t in e)e&&p.valueArr.push(t)}p.startIndex=0,p.endIndex=p.length-1}if(r.valueFilterMode===u.GetGreatestAndSub){let e,t=0;for(l=p.startIndex;l<=p.endIndex;l++)n=p.getRowVal(l),Math.abs(n)>t&&(e=n,t=Math.abs(n));e=""+e,e=Array(e.length+1).join("9"),e=+e,p.valueArr=[e],p.startIndex=p.endIndex=0}if(r.valueFilterMode===u.GetLongestTextAndSub){for(l=p.startIndex;l<=p.endIndex;l++)n=p.getRowVal(l),(n||"").length>a&&(a=n.length);n=Array(a+1).join("m"),h=this._options.autosizeTextAvgToMWidthRatio||0,p.maxLen=a,p.valueArr=[n],p.startIndex=p.endIndex=0}if(r.valueFilterMode===u.GetLongestText){a=0;let e=0;for(l=p.startIndex;l<=p.endIndex;l++)n=p.getRowVal(l),(n||"").length>a&&(a=n.length,e=l);n=p.getRowVal(e),p.maxLen=a,p.valueArr=[n],p.startIndex=p.endIndex=0}return p.maxLen&&p.maxLen>30&&o>1&&(r.sizeToRemaining=!0),d=this.getColWidth(e,i,p)*h,Math.max(r.headerWidthPx,d)}getColWidth(e,t,i){var s,o,l;let n=p.createDomElement("div",{className:"slick-row ui-widget-content"},t),r=p.createDomElement("div",{className:"slick-cell"},n);r.style.position="absolute",r.style.visibility="hidden",r.style.textOverflow="initial",r.style.whiteSpace="nowrap";let h,a,d,c,u=0,w="",g=e.autoSize.widthEvalMode===m.TextOnly;if((null==(s=e.autoSize)?void 0:s.widthEvalMode)===m.Auto){let t=!e.formatterOverride&&!e.formatter,i=(null==(o=null==e?void 0:e.formatterOverride)?void 0:o.ReturnsTextOnly)||!e.formatterOverride&&(null==(l=e.formatter)?void 0:l.ReturnsTextOnly);g=t||i}if(this.canvas_context&&g){let t=getComputedStyle(r);for(this.canvas_context.font=t.fontSize+" "+t.fontFamily,h=i.startIndex;h<=i.endIndex;h++)c=i.valueArr?i.valueArr[h]:i.getRowVal(h),d=e.formatterOverride?e.formatterOverride(h,i.colIndex,c,e,this.getDataItem(h),this):e.formatter?e.formatter(h,i.colIndex,c,e,this.getDataItem(h),this):""+c,a=d?this.canvas_context.measureText(d).width:0,a>u&&(u=a,w=d);return r.textContent=w,a=r.offsetWidth,n.remove(),a}for(h=i.startIndex;h<=i.endIndex;h++)c=i.valueArr?i.valueArr[h]:i.getRowVal(h),d=e.formatterOverride?e.formatterOverride(h,i.colIndex,c,e,this.getDataItem(h),this):e.formatter?e.formatter(h,i.colIndex,c,e,this.getDataItem(h),this):""+c,this.applyFormatResultToCellNode(d,r),a=r.offsetWidth,a>u&&(u=a);return n.remove(),u}getColHeaderWidth(e){let t=0,i=this.getUID()+e.id,s=document.getElementById(i),o=`${i}_`,l=s.cloneNode(!0);if(s)l.id=o,l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",s.parentNode.insertBefore(l,s),t=l.offsetWidth,l.parentNode.removeChild(l);else{let i=this.getHeader(e);s=p.createDomElement("div",{id:o,className:"ui-state-default slick-state-default slick-header-column"},i);let n=p.createDomElement("span",{className:"slick-column-name"},s);this.applyHtmlCode(n,e.name),l.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",e.headerCssClass&&s.classList.add(...p.classNameToList(e.headerCssClass)),t=s.offsetWidth,i.removeChild(s)}return t}legacyAutosizeColumns(){let e,t,i=0,s=0,o=0,l=[],n=this.getViewportInnerWidth();for(e=0;e<this.columns.length;e++)t=this.columns[e],t&&!t.hidden?(l.push(t.width||0),s+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))):l.push(0);for(o=s;s>n&&i;){let r=(s-n)/i;for(e=0;e<this.columns.length&&s>n;e++){if(t=this.columns[e],!t||t.hidden)continue;let o=l[e];if(!t.resizable||o<=t.minWidth||o<=this.absoluteColumnMinWidth)continue;let n=Math.max(t.minWidth,this.absoluteColumnMinWidth),h=Math.floor(r*(o-n))||1;h=Math.min(h,o-n),s-=h,i-=h,l[e]-=h}if(o<=s)break;o=s}for(o=s;s<n;){let i=n/s;for(e=0;e<this.columns.length&&s<n;e++){if(t=this.columns[e],!t||t.hidden)continue;let o,r=l[e];o=!t.resizable||t.maxWidth<=r?0:Math.min(Math.floor(i*r)-r,t.maxWidth-r||1e6)||1,s+=o,l[e]+=s<=n?o:0}if(o>=s)break;o=s}let r=!1;for(e=0;e<this.columns.length;e++)!t||t.hidden||(this.columns[e].rerenderOnResize&&this.columns[e].width!==l[e]&&(r=!0),this.columns[e].width=l[e]);this.reRenderColumns(r)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.trigger(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter((e=>!e.hidden))}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(!this.initialized)return;let e=0,t=this.getVisibleColumns();this._headers.forEach((i=>{for(let s=0;s<i.children.length;s++,e++){let o=i.children[s],l=((t[e]||{}).width||0)-this.headerColumnWidthDiff;p.width(o)!==l&&p.width(o,l)}})),this.updateColumnCaches()}applyColumnWidths(){var e;let t,i=0,s=0;for(let o=0;o<this.columns.length;o++)null!=(e=this.columns[o])&&e.hidden||(s=this.columns[o].width||0,t=this.getColumnCssRules(o),t.left.style.left=`${i}px`,t.right.style.right=(-1!==this._options.frozenColumn&&o>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-i-s+"px",this._options.frozenColumn!==o&&(i+=this.columns[o].width)),this._options.frozenColumn===o&&(i=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every((i=>{let s=i.children.length;return e<s?(t=i.children[e],!1):(e-=s,!0)})),t}setSortColumns(e){this.sortColumns=e;let t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach((e=>{let t=e.querySelectorAll(".slick-header-column-sorted");t.forEach((e=>{e.classList.remove("slick-header-column-sorted")})),t=e.querySelectorAll(".slick-sort-indicator"),t.forEach((e=>{e.classList.remove("slick-sort-indicator-asc"),e.classList.remove("slick-sort-indicator-desc")})),t=e.querySelectorAll(".slick-sort-indicator-numbered"),t.forEach((e=>{e.textContent=""}))}));let i=1;this.sortColumns.forEach((e=>{p.isDefined(e.sortAsc)||(e.sortAsc=!0);let s=this.getColumnIndex(e.columnId);if(p.isDefined(s)){let o=this.getColumnByIndex(s);if(o){o.classList.add("slick-header-column-sorted");let s=o.querySelector(".slick-sort-indicator");null==s||s.classList.add(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(s=o.querySelector(".slick-sort-indicator-numbered"),s&&(s.textContent=String(i)))}}i++}))}getColumns(){return this.columns}getSortColumns(){return this.sortColumns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)!this.columns[t]||this.columns[t].hidden||(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e];t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?(p.applyDefaults(t,this._columnDefaults),t.autoSize||(t.autoSize={}),p.applyDefaults(t.autoSize,this._columnAutosizeDefaults)):(t=this.columns[e]=p.extend({},this._columnDefaults,t),t.autoSize=p.extend({},this._columnAutosizeDefaults,t.autoSize)),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.trigger(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.trigger(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.trigger(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){var e;this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnHeaderWidths(),this.applyColumnWidths(),this.handleScroll(),null==(e=this.getSelectionModel())||e.refreshSelections())}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){var e,t;return this.data.getLength?this.data.getLength():null!=(t=null==(e=this.data)?void 0:e.length)?t:0}getDataLengthIncludingAddNew(){return this.getDataLength()+(!this._options.enableAddRow||this.pagingActive&&!this.pagingIsLastPage?0:1)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}hasDataView(){return!Array.isArray(this.data)}getItemMetadaWhenExists(e){return"getItemMetadata"in this.data?this.data.getItemMetadata(e):null}getFormatter(e,t){var i,s,o;let l=null==(s=null==(i=this.data)?void 0:i.getItemMetadata)?void 0:s.call(i,e),n=(null==l?void 0:l.columns)&&(l.columns[t.id]||l.columns[this.getColumnIndex(t.id)]);return(null==n?void 0:n.formatter)||(null==l?void 0:l.formatter)||t.formatter||(null==(o=this._options.formatterFactory)?void 0:o.getFormatter(t))||this._options.defaultFormatter}getEditor(e,t){var i,s,o,l;let n=this.columns[t],r=this.getItemMetadaWhenExists(e),h=null==r?void 0:r.columns;return void 0!==(null==(i=null==h?void 0:h[n.id])?void 0:i.editor)?h[n.id].editor:void 0!==(null==(s=null==h?void 0:h[t])?void 0:s.editor)?h[t].editor:n.editor||(null==(l=null==(o=this._options)?void 0:o.editorFactory)?void 0:l.getEditor(n))}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}resetActiveCell(){this.setActiveCellInternal(null,!1)}unsetActiveCell(){var e,t;p.isDefined(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),null==(t=null==(e=this.rowsCache[this.activeRow])?void 0:e.rowNode)||t.forEach((e=>e.classList.remove("active"))))}focus(){this.setFocus()}setFocus(){-1===this.tabbingDirection?this._focusSink.focus():this._focusSink2.focus()}setActiveCellInternal(e,t,i,s,o){var l,n;if(this.unsetActiveCell(),this.activeCellNode=e,p.isDefined(this.activeCellNode)){let e=p.offset(this.activeCellNode),s=Math.floor(p.offset(p.parents(this.activeCellNode,".grid-canvas")[0]).top),r=p.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&r&&(s-=this._options.frozenBottom?p.height(this._canvasTopL):this.frozenRowsHeight);let h=this.getCellFromPoint(e.left,Math.ceil(e.top)-s);this.activeRow=h.row,this.activePosY=h.row,this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!p.isDefined(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(document.querySelectorAll(".slick-cell.active").forEach((e=>e.classList.remove("active"))),this.activeCellNode.classList.add("active"),null==(n=null==(l=this.rowsCache[this.activeRow])?void 0:l.rowNode)||n.forEach((e=>e.classList.add("active")))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(window.clearTimeout(this.h_editorLoader),this.h_editorLoader=window.setTimeout((()=>{this.makeActiveCellEditable(void 0,i,o)}),this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,o))}else this.activeRow=this.activeCell=null;s||this.trigger(this.onActiveCellChanged,this.getActiveCell())}isCellPotentiallyEditable(e,t){let i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){var t;if(this.currentEditor){if(this.trigger(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){let t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),t){let e=this.columns[this.activeCell],i=this.getFormatter(this.activeRow,e)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,e),e,t,this);this.applyFormatResultToCellNode(i,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),null==(t=this.getEditorLock())||t.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){var s,o,l,n;if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when this._options.editable is false");if(window.clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;let r=this.columns[this.activeCell],h=this.getDataItem(this.activeRow);if(!1===this.trigger(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:h,column:r,target:"grid"}).getReturnValue())return void this.setFocus();null==(s=this.getEditorLock())||s.activate(this.editController),this.activeCellNode.classList.add("editable");let a=e||this.getEditor(this.activeRow,this.activeCell);if(!a||"function"!=typeof a)return;!e&&!a.suppressClearOnEdit&&p.emptyElement(this.activeCellNode);let d=this.getItemMetadaWhenExists(this.activeRow);d=null==d?void 0:d.columns;let c=d&&(d[r.id]||d[this.activeCell]),u={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:r,columnMetaData:c,item:h||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new a(u),h&&this.currentEditor&&(this.currentEditor.loadValue(h),t&&null!=(o=this.currentEditor)&&o.preClick&&this.currentEditor.preClick()),this.serializedEditorValue=null==(l=this.currentEditor)?void 0:l.serializeValue(),null!=(n=this.currentEditor)&&n.position&&this.handleActiveCellPositionChange()}commitEditAndSetFocus(){var e;null!=(e=this.getEditorLock())&&e.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&this.navigateDown())}cancelEditAndSetFocus(){var e;null!=(e=this.getEditorLock())&&e.cancelCurrentEdit()&&this.setFocus()}commitCurrentEdit(){var e;let t=this,i=t.getDataItem(t.activeRow),s=t.columns[t.activeCell];if(t.currentEditor){if(t.currentEditor.isValueChanged()){let o=t.currentEditor.validate();if(o.valid){let o=t.activeRow,l=t.activeCell,n=t.currentEditor,r=t.currentEditor.serializeValue(),h=t.serializedEditorValue;if(t.activeRow<t.getDataLength()){let e={row:o,cell:l,editor:n,serializedValue:r,prevSerializedValue:h,execute:()=>{n.applyValue(i,r),t.updateRow(o),t.trigger(t.onCellChange,{command:"execute",row:o,cell:l,item:i,column:s})},undo:()=>{n.applyValue(i,h),t.updateRow(o),t.trigger(t.onCellChange,{command:"undo",row:o,cell:l,item:i,column:s})}};t._options.editCommandHandler?(t.makeActiveCellNormal(!0),t._options.editCommandHandler(i,s,e)):(e.execute(),t.makeActiveCellNormal(!0))}else{let e={};t.currentEditor.applyValue(e,t.currentEditor.serializeValue()),t.makeActiveCellNormal(!0),t.trigger(t.onAddNewRow,{item:e,column:s})}return!(null!=(e=t.getEditorLock())&&e.isActive())}return t.activeCellNode&&(t.activeCellNode.classList.remove("invalid"),p.width(t.activeCellNode),t.activeCellNode.classList.add("invalid")),t.trigger(t.onValidationError,{editor:t.currentEditor,cellNode:t.activeCellNode,validationResults:o,row:t.activeRow,cell:t.activeCell,column:s}),t.currentEditor.focus(),!1}t.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){var i;if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");this&&this.getEditorLock&&(null==(i=this.getEditorLock())||!i.isActive())&&this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}trigger(e,t,i){let s=i||new l(i,t),o=t||{};return o.grid=this,e.notify(o,s,this)}handleCellMouseOut(e){this.trigger(this.onMouseLeave,{},e)}handleHeaderMouseHoverOn(e){null==e||e.target.classList.add("ui-state-hover","slick-state-hover")}handleHeaderMouseHoverOff(e){null==e||e.target.classList.remove("ui-state-hover","slick-state-hover")}handleSelectedRangesChanged(e,t){var i,s;let o=e.getNativeEvent(),l=this.selectedRows.slice(0);this.selectedRows=[];let n={};for(let e=0;e<t.length;e++)for(let i=t[e].fromRow;i<=t[e].toRow;i++){n[i]||(this.selectedRows.push(i),n[i]={});for(let s=t[e].fromCell;s<=t[e].toCell;s++)this.canCellBeSelected(i,s)&&(n[i][this.columns[s].id]=this._options.selectedCellCssClass)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",n),this.simpleArrayEquals(l,this.selectedRows)){let t=null!=(s=null==(i=null==o?void 0:o.detail)?void 0:i.caller)?s:"click",n=new Set(this.getSelectedRows()),r=new Set(l),h=Array.from(n).filter((e=>!r.has(e))),a=Array.from(r).filter((e=>!n.has(e)));this.trigger(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:l,caller:t,changedSelectedRows:h,changedUnselectedRows:a},e)}}handleMouseWheel(e,t,i,s){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,e.shiftKey||(this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-s*this._options.rowHeight)),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+10*i,this._handleScroll("mousewheel")&&e.preventDefault()}handleDragInit(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let s=this.trigger(this.onDragInit,t,e);return!!s.isImmediatePropagationStopped()&&s.getReturnValue()}handleDragStart(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let s=this.trigger(this.onDragStart,t,e);return!!s.isImmediatePropagationStopped()&&s.getReturnValue()}handleDrag(e,t){return this.trigger(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.trigger(this.onDragEnd,t,e)}handleKeyDown(e){var t,i,s,o;let l=this.trigger(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!l&&!e.shiftKey&&!e.altKey){if(this._options.editable&&null!=(t=this.currentEditor)&&t.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.ctrlKey&&"Home"===e.key?this.navigateTopStart():e.ctrlKey&&"End"===e.key?this.navigateBottomEnd():e.ctrlKey&&"ArrowUp"===e.key?this.navigateTop():e.ctrlKey&&"ArrowDown"===e.key?this.navigateBottom():e.ctrlKey&&"ArrowLeft"===e.key||!e.ctrlKey&&"Home"===e.key?this.navigateRowStart():(e.ctrlKey&&"ArrowRight"===e.key||!e.ctrlKey&&"End"===e.key)&&this.navigateRowEnd()}if(!l)if(e.shiftKey||e.altKey||e.ctrlKey)e.which===h.TAB&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(l=this.navigatePrev());else{if(this._options.editable&&null!=(i=this.currentEditor)&&i.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;if(e.which===h.ESCAPE){if(null==(s=this.getEditorLock())||!s.isActive())return;this.cancelEditAndSetFocus()}else e.which===h.PAGE_DOWN?(this.navigatePageDown(),l=!0):e.which===h.PAGE_UP?(this.navigatePageUp(),l=!0):e.which===h.LEFT?l=this.navigateLeft():e.which===h.RIGHT?l=this.navigateRight():e.which===h.UP?l=this.navigateUp():e.which===h.DOWN?l=this.navigateDown():e.which===h.TAB?l=this.navigateNext():e.which===h.ENTER&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():null!=(o=this.getEditorLock())&&o.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),l=!0)}if(l){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}handleClick(e){var t,i,s;let o=e instanceof l?e.getNativeEvent():e;if(!this.currentEditor&&(o.target!==document.activeElement||o.target.classList.contains("slick-cell"))){let e=this.getTextSelection();this.setFocus(),this.setTextSelection(e)}let n=this.getCellFromEvent(o);if(n&&(null===this.currentEditor||this.activeRow!==n.row||this.activeCell!==n.cell)&&(!(e=this.trigger(this.onClick,{row:n.row,cell:n.cell},e||o)).isImmediatePropagationStopped()&&this.canCellBeActive(n.row,n.cell)&&(null==(t=this.getEditorLock())||!t.isActive()||null!=(i=this.getEditorLock())&&i.commitCurrentEdit()))){this.scrollRowIntoView(n.row,!1);let e=(null==(s=o.target)?void 0:s.className)===a,t=this.columns[n.cell],i=!!(this._options.editable&&null!=t&&t.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(n.row,n.cell),null,e,i,o)}}handleContextMenu(e){let t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&null!==this.currentEditor||this.trigger(this.onContextMenu,{},e))}handleDblClick(e){let t=this.getCellFromEvent(e);!t||null!==this.currentEditor&&this.activeRow===t.row&&this.activeCell===t.cell||(this.trigger(this.onDblClick,{row:t.row,cell:t.cell},e),!e.defaultPrevented&&this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){let t=p.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseLeave(e){let t=p.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.trigger(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){let t=p.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){let t=p.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.trigger(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderContextMenu(e){let t=e.target.closest(".slick-header-column"),i=t&&p.storage.get(t,"column");this.trigger(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){let t=e.target.closest(".slick-header-column"),i=t&&p.storage.get(t,"column");i&&this.trigger(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.trigger(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.trigger(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&p.storage.get(t,"column");this.trigger(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&p.storage.get(t,"column");this.trigger(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.trigger(this.onMouseEnter,{},e)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.trigger(this.onActiveCellPositionChanged,{}),this.currentEditor)){let e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}actionThrottle(e,t){let i=!1,s=!1,o=()=>{s=!1},l=()=>{i=!0,window.clearTimeout(this._executionBlockTimer),this._executionBlockTimer=window.setTimeout(n,t),e.call(this)},n=()=>{s?(o(),l()):i=!1};return{enqueue:(()=>{i?s=!0:l()}).bind(this),dequeue:o.bind(this)}}getCellFromEvent(e){let t=e instanceof l?e.getNativeEvent():e,i=t.touches?t.touches[0]:t,s=t.target.closest(".slick-cell");if(!s)return null;let o=this.getRowFromNode(s.parentNode);if(this.hasFrozenRows){let e=0,t=p.offset(p.parents(s,".grid-canvas")[0]);p.parents(s,".grid-canvas-bottom").length&&(e=this._options.frozenBottom?p.height(this._canvasTopL):this.frozenRowsHeight),o=this.getCellFromPoint(i.clientX-t.left,i.clientY-t.top+e+document.documentElement.scrollTop).row}let n=this.getCellFromNode(s);return p.isDefined(o)&&p.isDefined(n)?{row:o,cell:n}:null}applyHtmlCode(e,t,i){if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)!1!==(null==i?void 0:i.emptyTarget)&&p.emptyElement(e),e.appendChild(t);else{if(!1!==(null==i?void 0:i.skipEmptyReassignment)&&!p.isDefined(t)&&!e.innerHTML)return;let s=t;"number"==typeof s||"boolean"==typeof s?e.textContent=s:(s=this.sanitizeHtmlString(t),this._options.enableHtmlRendering&&s?e.innerHTML=s:e.textContent=s)}}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return void 0===e||(e instanceof l&&(e=e.getNativeEvent()),this._activeCanvasNode=null==e?void 0:e.target.closest(".grid-canvas")),this._activeCanvasNode}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof l&&(e=e.getNativeEvent()),this._activeViewportNode=null==e?void 0:e.target.closest(".slick-viewport"),this._activeViewportNode}getHeadersWidth(){var e,t,i,s,o,l,n,r;this.headersWidth=this.headersWidthL=this.headersWidthR=0;let h=!this._options.autoHeight,a=0,d=this.columns.length;for(a=0;a<d;a++){if(!this.columns[a]||this.columns[a].hidden)continue;let e=this.columns[a].width;this._options.frozenColumn>-1&&a>this._options.frozenColumn?this.headersWidthR+=e||0:this.headersWidthL+=e||0}return h&&(this._options.frozenColumn>-1&&a>this._options.frozenColumn?this.headersWidthR+=null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.width)?t:0:this.headersWidthL+=null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.width)?s:0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=null!=(l=null==(o=this.scrollbarDimensions)?void 0:o.width)?l:0):(this.headersWidthL+=null!=(r=null==(n=this.scrollbarDimensions)?void 0:n.width)?r:0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){let e=this.getViewportInnerWidth(),t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)!this.columns[t]||this.columns[t].hidden||(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){let t=Math.max(i,e)-i;t>0&&(i+=t,this.hasFrozenColumns()?this.canvasWidthR+=t:this.canvasWidthL+=t)}return i}updateCanvasWidth(e){var t,i,s,o,l,n,r,h,a,d,c,u,m;let w=this.canvasWidth,g=this.canvasWidthL,v=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&p.width(this._topHeaderPanel,null!=(t=this._options.topHeaderPanelWidth)?t:this.canvasWidth);let C=this.canvasWidth!==w||this.canvasWidthL!==g||this.canvasWidthR!==v;if(C||this.hasFrozenColumns()||this.hasFrozenRows)if(p.width(this._canvasTopL,this.canvasWidthL-.1),this.getHeadersWidth(),p.width(this._headerL,this.headersWidthL),p.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()){let e=p.width(this._container)||0;if(e>0&&this.canvasWidthL>e&&this._options.throwWhenFrozenNotAllViewable)throw new Error("[SlickGrid] Frozen columns cannot be wider than the actual grid container width. Make sure to have less columns freezed or make your grid container wider");p.width(this._canvasTopR,this.canvasWidthR),p.width(this._paneHeaderL,this.canvasWidthL),p.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),p.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),p.width(this._paneTopL,this.canvasWidthL),p.setStyleSize(this._paneTopR,"left",this.canvasWidthL),p.width(this._paneTopR,this.viewportW-this.canvasWidthL),p.width(this._headerRowScrollerL,this.canvasWidthL),p.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),p.width(this._headerRowL,this.canvasWidthL),p.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(p.width(this._footerRowScrollerL,this.canvasWidthL),p.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),p.width(this._footerRowL,this.canvasWidthL),p.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&p.width(this._preHeaderPanel,null!=(i=this._options.preHeaderPanelWidth)?i:this.canvasWidth),p.width(this._viewportTopL,this.canvasWidthL),p.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(p.width(this._paneBottomL,this.canvasWidthL),p.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),p.width(this._viewportBottomL,this.canvasWidthL),p.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),p.width(this._canvasBottomL,this.canvasWidthL),p.width(this._canvasBottomR,this.canvasWidthR))}else p.width(this._paneHeaderL,"100%"),p.width(this._paneTopL,"100%"),p.width(this._headerRowScrollerL,"100%"),p.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(p.width(this._footerRowScrollerL,"100%"),p.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&p.width(this._preHeaderPanel,null!=(s=this._options.preHeaderPanelWidth)?s:this.canvasWidth),p.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(p.width(this._viewportBottomL,"100%"),p.width(this._canvasBottomL,this.canvasWidthL));this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(null!=(l=null==(o=this.scrollbarDimensions)?void 0:o.width)?l:0),p.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&null!=(r=null==(n=this.scrollbarDimensions)?void 0:n.width)?r:0)),p.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&null!=(a=null==(h=this.scrollbarDimensions)?void 0:h.width)?a:0)),this._options.createFooterRow&&(p.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&null!=(c=null==(d=this.scrollbarDimensions)?void 0:d.width)?c:0)),p.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&null!=(m=null==(u=this.scrollbarDimensions)?void 0:u.width)?m:0))),(C||e)&&this.applyColumnWidths()}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}setPaneVisibility(){this.hasFrozenColumns()?(p.show(this._paneHeaderR),p.show(this._paneTopR),this.hasFrozenRows?(p.show(this._paneBottomL),p.show(this._paneBottomR)):(p.hide(this._paneBottomR),p.hide(this._paneBottomL))):(p.hide(this._paneHeaderR),p.hide(this._paneTopR),p.hide(this._paneBottomR),this.hasFrozenRows?p.show(this._paneBottomL):(p.hide(this._paneBottomR),p.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows?"scroll":"auto"),this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":(this.hasFrozenColumns(),this.hasFrozenRows,"auto"),this._options.viewportClass){let e=p.classNameToList(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);let e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach((e=>{i.insertRule(e)}));for(let e=0;e<this.columns.length;e++)!this.columns[e]||this.columns[e].hidden||(i.insertRule(`.${this.uid} .l${e} { }`),i.insertRule(`.${this.uid} .r${e} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){let t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let t=0;t<this.columns.length;t++)!this.columns[t]||this.columns[t].hidden||(e.push(`.${this.uid} .l${t} { }`),e.push(`.${this.uid} .r${t} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){var t;let i;if(!this.stylesheet){let e=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&"number"==typeof(null==(t=this._options.devMode)?void 0:t.ownerNodeIndex)&&this._options.devMode.ownerNodeIndex>=0&&(e[this._options.devMode.ownerNodeIndex].ownerNode=this._style),i=0;i<e.length;i++)if((e[i].ownerNode||e[i].owningElement)===this._style){this.stylesheet=e[i];break}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];let s,o,l=this.stylesheet.cssRules||this.stylesheet.rules;for(i=0;i<l.length;i++){let e=l[i].selectorText;(s=/\.l\d+/.exec(e))?(o=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesL[o]=l[i]):(s=/\.r\d+/.exec(e))&&(o=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesR[o]=l[i])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){var e;null==(e=this._style)||e.remove(),this.stylesheet=null}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}togglePanelVisibility(e,t,i,s){let o=!1!==s;if(this._options[e]!==i)if(this._options[e]=i,i){if(o)return void p.slideDown(t,this.resizeCanvas.bind(this));p.show(t),this.resizeCanvas()}else{if(o)return void p.slideUp(t,this.resizeCanvas.bind(this));p.hide(t),this.resizeCanvas()}}setTopPanelVisibility(e,t){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e,t)}setHeaderRowVisibility(e,t){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e,t)}setColumnHeaderVisibility(e,t){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e,t)}setFooterRowVisibility(e,t){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e,t)}setPreHeaderPanelVisibility(e,t){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e,t)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getRowHeight(){return this._options.rowHeight}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowBottom(e){return this.getRowTop(e)+this._options.rowHeight}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}appendRowHtml(e,t,i,s,o){let l=this.getDataItem(i),n=i<o&&!l,r="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(n?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2==1?" odd":" even");l||(r+=` ${this._options.addNewRowCssClass}`);let h=this.getItemMetadaWhenExists(i);null!=h&&h.cssClasses&&(r+=` ${h.cssClasses}`);let a,d=p.createDomElement("div",{className:`ui-widget-content ${r}`,role:"row",dataset:{row:`${i}`}}),c=this.getFrozenRowOffset(i),u=this.getRowTop(i)-c;"transform"===this._options.rowTopOffsetRenderType?d.style.transform=`translateY(${u}px)`:d.style.top=`${u}px`,e.push(d),this.hasFrozenColumns()&&(a=d.cloneNode(!0),t.push(a));let m,w,g,v,C=!0;for(let e=0,t=this.columns.length;e<t;e++){if(C=!0,v=this.columns[e],!v||v.hidden)continue;w=1,g=1,m=null,null!=h&&h.columns&&(m=h.columns[v.id]||h.columns[e],w=(null==m?void 0:m.colspan)||1,g=(null==m?void 0:m.rowspan)||1,"*"===w&&(w=t-e),g>o-i&&(g=o-i)),this._options.enableCellRowSpan;let n=w;if(!this.getParentRowSpanByCell(i,e)){if(this.columnPosRight[Math.min(t-1,e+n-1)]>s.leftPx){if(!v.alwaysRenderColumn&&this.columnPosLeft[e]>s.rightPx&&(C=!1),C){let t=this.hasFrozenColumns()&&e>this._options.frozenColumn?a:d;this.appendCellHtml(t,i,e,n,g,m,l)}}else(v.alwaysRenderColumn||this.hasFrozenColumns()&&e<=this._options.frozenColumn)&&this.appendCellHtml(d,i,e,n,g,m,l);n>1&&(e+=n-1)}}}appendCellHtml(e,t,i,s,o,l,n){let r=this.columns[i],h=`slick-cell l${i} r${Math.min(this.columns.length-1,i+s-1)}`+(r.cssClass?` ${r.cssClass}`:"")+(o>1?" rowspan":"")+(null!=l&&l.cssClass?` ${l.cssClass}`:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(h+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(h+=" active"),Object.keys(this.cellCssClasses).forEach((e=>{var i;null!=(i=this.cellCssClasses[e][t])&&i[r.id]&&(h+=` ${this.cellCssClasses[e][t][r.id]}`)}));let a=null,d="";n&&(a=this.getDataItemValueForColumn(n,r),d=this.getFormatter(t,r)(t,i,a,r,n,this),null==d&&(d=""));let c=this.trigger(this.onBeforeAppendCell,{row:t,cell:i,value:a,dataContext:n}).getReturnValue(),u="string"==typeof c?c:"";null!=d&&d.addClasses&&(u+=p.classNameToList((u?" ":"")+d.addClasses).join(" "));let m=null!=d&&d.toolTip?`${d.toolTip}`:"",w=p.createDomElement("div",{className:p.classNameToList(`${h} ${u||""}`).join(" "),role:"gridcell",tabIndex:-1});w.setAttribute("aria-describedby",this.uid+r.id),m&&w.setAttribute("title",m);let g=this.getCellHeight(t,o);if(o>1&&g!==this._options.rowHeight-this.cellHeightDiff&&(w.style.height=`${g||0}px`),r.hasOwnProperty("cellAttrs")&&r.cellAttrs instanceof Object&&Object.keys(r.cellAttrs).forEach((e=>{r.cellAttrs.hasOwnProperty(e)&&w.setAttribute(e,r.cellAttrs[e])})),n){let e="[object Object]"!==Object.prototype.toString.call(d)?d:d.html||d.text;this.applyHtmlCode(w,e)}e.appendChild(w),d.insertElementAfterTarget&&p.insertAfterElement(w,d.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=s}cleanupRows(e){let t=new Set;if(this._options.enableCellRowSpan)for(let i=e.top,s=e.bottom;i<=s;i++){let e=this.getRowSpanIntersect(i);null!==e&&t.add(e)}Object.keys(this.rowsCache).forEach((i=>{if(this.rowsCache){let s=+i,o=!0;this.hasFrozenRows&&(this._options.frozenBottom&&s>=this.actualFrozenRow||!this._options.frozenBottom&&s<=this.actualFrozenRow)&&(o=!1),(s=parseInt(i,10))!==this.activeRow&&(s<e.top||s>e.bottom)&&o&&!t.has(s)&&this.removeRowFromCache(s)}})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{this.rowsCache&&this.removeRowFromCache(+e)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(!e||!e.length)return;let t;this.vScrollDir=0;let i=e.length,s=new Set,o=new Set,l=e.length>this._options.maxPartialRowSpanRemap||e.length===this.getDataLength()||this._prevInvalidatedRowsCount+e.length===this.getDataLength();for(let o=0;o<i;o++)if(t=e[o],this.currentEditor&&this.activeRow===t&&this.makeActiveCellNormal(),this.rowsCache[t]&&this.removeRowFromCache(t),this._options.enableCellRowSpan&&!l){s.add(t);let e=this.getRowSpanIntersect(t);null!==e&&s.add(e)}if(this._options.enableCellRowSpan&&!l){for(let e of Array.from(s)){let t=this.getRowSpanColumnIntersects(e);for(let i of t){let t=this.getParentRowSpanByCell(e,i);t&&this._colsWithRowSpanCache[i]&&(this._colsWithRowSpanCache[i].delete(t.range),o.add(t.range.split(":").map(Number)[0]))}}for(let e of Array.from(o))this.remapRowSpanMetadataByRow(e)}this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this._prevInvalidatedRowsCount=e.length}invalidateRow(e){if(e>=0){let t=[e];if(this._options.enableCellRowSpan){let i=this.getRowSpanIntersect(e);null!==i&&t.push(i)}this.invalidateRows(t)}}removeRowFromCache(e){var t;let i=this.rowsCache[e];null!=i&&i.rowNode&&(this.trigger(this.onBeforeRemoveCachedRow,{row:e}),this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(i,this.postProcessedRows[e],e):null==(t=i.rowNode)||t.forEach((e=>{var t;return null==(t=e.parentElement)?void 0:t.removeChild(e)})),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}updateCell(e,t){let i=this.getCellNode(e,t);if(!i)return;let s=this.columns[t],o=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(o);else{let l=o?this.getFormatter(e,s)(e,t,this.getDataItemValueForColumn(o,s),s,o,this):"";this.applyFormatResultToCellNode(l,i),this.invalidatePostProcessingResults(e)}}updateRow(e){let t=this.rowsCache[e];if(!t)return;this.ensureCellNodesInRowsCache(e);let i,s=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach((o=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(o))return;let l=+o,n=this.columns[l],r=t.cellNodesByColumnIdx[l];e===this.activeRow&&l===this.activeCell&&this.currentEditor?this.currentEditor.loadValue(s):s?(i=this.getFormatter(e,n)(e,l,this.getDataItemValueForColumn(s,n),n,s,this),this.applyFormatResultToCellNode(i,r)):p.emptyElement(r)})),this.invalidatePostProcessingResults(e)}getViewportRowCount(){var e,t;let i=this.getViewportHeight(),s=null!=(t=null==(e=this.getScrollbarDimensions())?void 0:e.height)?t:0;return Math.floor((i-s)/this._options.rowHeight)}getViewportHeight(){var e,t;if((!this._options.autoHeight||-1!==this._options.frozenColumn)&&(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let i=this._paneHeaderL.offsetHeight;i+=this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,i+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,i+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,i+=this.getCanvasWidth()>this.viewportW&&null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(-1===this._options.frozenColumn?i:0)}else{let e=getComputedStyle(this._container),t="content-box"!==e.boxSizing?this.getVBoxDelta(this._container):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,s=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,o=this._options.showColumnHeader?p.toFloat(p.height(this._headerScroller[0])):0;this.viewportH=p.toFloat(e.height)-p.toFloat(e.paddingTop)-p.toFloat(e.paddingBottom)-this.topPanelH-i-s-this.headerRowH-o-this.footerRowH-t}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportInnerWidth(){var e;return this.viewportHasVScroll?this.viewportW-((null==(e=this.scrollbarDimensions)?void 0:e.width)||0):this.viewportW}getViewportWidth(){return this.viewportW=parseFloat(p.innerSize(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){var e,t,i,s,o,l;if(!this.initialized)return;if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0),this.paneBottomH=this.frozenRowsHeight+(null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.height)?s:0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=null!=(l=null==(o=this.scrollbarDimensions)?void 0:o.height)?l:0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){let e=this.paneTopH+this._headerScrollerL.offsetHeight;e+=this.getVBoxDelta(this._container),this._options.showPreHeaderPanel&&(e+=this._options.preHeaderPanelHeight),p.height(this._container,e)}this._paneTopL.style.position="relative"}let n=p.height(this._paneHeaderL);n?n+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:n=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),p.setStyleSize(this._paneTopL,"top",n||n),p.height(this._paneTopL,this.paneTopH);let h=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||p.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let e=p.height(this._paneHeaderL);e&&(e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),p.setStyleSize(this._paneTopR,"top",e),p.height(this._paneTopR,this.paneTopH),p.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(p.setStyleSize(this._paneBottomL,"top",h),p.height(this._paneBottomL,this.paneBottomH),p.setStyleSize(this._paneBottomR,"top",h),p.height(this._paneBottomR,this.paneBottomH),p.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(p.width(this._paneBottomL,"100%"),p.height(this._paneBottomL,this.paneBottomH),p.setStyleSize(this._paneBottomL,"top",h));this.hasFrozenRows?(p.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(p.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&p.height(this._canvasBottomR,this.frozenRowsHeight)):(p.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&p.height(this._canvasTopR,this.frozenRowsHeight))):p.height(this._viewportTopR,this.viewportTopH),(!this.scrollbarDimensions||!this.scrollbarDimensions.width)&&(this.scrollbarDimensions=this.measureScrollbar()),this._options.autosizeColsMode===r.LegacyForceFit&&this.autosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}updateRowCount(){var e,t,i,s;if(!this.initialized)return;let o=this.getDataLength();o>0&&o!==this._prevDataLength&&(this._rowSpanIsCached=!1),this._options.enableCellRowSpan&&!this._rowSpanIsCached&&this.remapAllColumnsRowSpan(),this._prevDataLength=o;let l=this.getDataLengthIncludingAddNew(),n=0,h=this.hasFrozenRows&&!this._options.frozenBottom?p.height(this._canvasBottomL):p.height(this._canvasTopL);n=this.hasFrozenRows?this.getDataLength()-this._options.frozenRow:l+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);let a=p.height(this._viewportScrollContainerY),d=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&n*this._options.rowHeight>a,this.makeActiveCellNormal();let c=o-1;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((e=>{let t=+e;t>c&&this.removeRowFromCache(t)})),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>c&&this.resetActiveCell(),h=this.h,this._options.autoHeight?this.h=this._options.rowHeight*n:(this.th=Math.max(this._options.rowHeight*n,a-(null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.height)?t:0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==h||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(p.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&p.height(this._canvasBottomR,this.h)):(p.height(this._canvasTopL,this.h),p.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);let u=this.scrollTop+this.offset<=this.th-a;0===this.th||0===this.scrollTop?this.page=this.offset=0:u?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-a+(null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.height)?s:0)),this.h!==h&&this._options.autoHeight&&this.resizeCanvas(),this._options.autosizeColsMode===r.LegacyForceFit&&d!==this.viewportHasVScroll&&this.autosizeColumns(),this.updateCanvasWidth(!1)}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return null!=e||(e=this.scrollTop),null!=t||(t=this.scrollLeft),{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){let i=this.getVisibleRange(e,t),s=Math.round(this.viewportH/this._options.rowHeight),o=this._options.minRowBuffer;return-1===this.vScrollDir?(i.top-=s,i.bottom+=o):1===this.vScrollDir?(i.top-=o,i.bottom+=s):(i.top-=o,i.bottom+=o),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}getRowCache(){return this.rowsCache}ensureCellNodesInRowsCache(e){var t;let i=this.rowsCache[e];if(null!=i&&i.cellRenderQueue.length&&null!=(t=i.rowNode)&&t.length){let e=i.rowNode,t=Array.from(e[0].children);e.length>1&&(t=t.concat(Array.from(e[1].children)));let s=t.length-1;for(;i.cellRenderQueue.length;){let e=i.cellRenderQueue.pop();i.cellNodesByColumnIdx[e]=t[s--]}}}cleanUpCells(e,t){var i,s;if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;let o,l,n=this.rowsCache[t],r=[];for(Object.keys(n.cellNodesByColumnIdx).forEach((i=>{var s;if(!n.cellNodesByColumnIdx.hasOwnProperty(i))return;let o=+i;if(o<=this._options.frozenColumn||Array.isArray(this.columns)&&null!=(s=this.columns[o])&&s.alwaysRenderColumn)return;let l=n.cellColSpans[o];(this.columnPosLeft[o]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(o||0)+l-1)]<e.leftPx)&&(t===this.activeRow&&Number(o)===this.activeCell||r.push(o))}));p.isDefined(o=r.pop());)l=n.cellNodesByColumnIdx[o],this._options.enableAsyncPostRenderCleanup&&null!=(i=this.postProcessedRows[t])&&i[o]?this.queuePostProcessedCellForCleanup(l,o,t):null==(s=l.parentElement)||s.removeChild(l),delete n.cellColSpans[o],delete n.cellNodesByColumnIdx[o],this.postProcessedRows[t]&&delete this.postProcessedRows[t][o]}cleanUpAndRenderCells(e){var t;let i,s,o,l,n,r,h=document.createElement("div"),a=[],d=0,c=this.columns.length;for(let n=e.top,r=e.bottom;n<=r;n++){if(i=this.rowsCache[n],!i)continue;this.ensureCellNodesInRowsCache(n),(!this._options.enableCellRowSpan||null===this.getRowSpanIntersect(n))&&this.cleanUpCells(e,n),s=0;let r=this.getItemMetadaWhenExists(n);r=null==r?void 0:r.columns;let u=this.getDataItem(n);for(let a=0,d=c;a<d;a++){if(!this.columns[a]||this.columns[a].hidden)continue;if(this.columnPosLeft[a]>e.rightPx)break;if(p.isDefined(o=i.cellColSpans[a])){a+=o>1?o-1:0;continue}o=1,l=null,r&&(l=r[this.columns[a].id]||r[a],o=null!=(t=null==l?void 0:l.colspan)?t:1,"*"===o&&(o=d-a));let c=o;if(!this.getParentRowSpanByCell(n,a)){if(this.columnPosRight[Math.min(d-1,a+c-1)]>e.leftPx){let e=this.getRowspan(n,a);this.appendCellHtml(h,n,a,c,e,l,u),s++}a+=c>1?c-1:0}}s&&(d+=s,a.push(n))}if(h.children.length)for(;p.isDefined(n=a.pop());){let e;for(i=this.rowsCache[n];p.isDefined(e=i.cellRenderQueue.pop());)r=h.lastChild,r&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?i.rowNode[1].appendChild(r):i.rowNode[0].appendChild(r),i.cellNodesByColumnIdx[e]=r)}}renderRows(e){var t,i,s,o;let l=[],n=[],r=[],h=!1,a=this.getDataLength(),d=new Set,c=new Set;for(let t=e.top,i=e.bottom;t<=i;t++)if(!(this.rowsCache[t]||this.hasFrozenRows&&this._options.frozenBottom&&t===this.getDataLength())){if(this.renderedRows++,r.push(t),c.add(t),this.rowsCache[t]=this.createEmptyCachingRow(),this._options.enableCellRowSpan){let e=this.getRowSpanIntersect(t);null!==e&&c.add(e)}this.appendRowHtml(l,n,t,e,a),d.add(t),this.activeCellNode&&this.activeRow===t&&(h=!0),this.counter_rows_rendered++}let u=this.setDifference(c,d);if(u.size>0&&u.forEach((t=>{this.removeRowFromCache(t),r.push(t),this.rowsCache[t]=this.createEmptyCachingRow(),this.appendRowHtml(l,n,t,e,a)})),r.length){let e=document.createElement("div"),a=document.createElement("div");l.forEach((t=>e.appendChild(t))),n.forEach((e=>a.appendChild(e)));for(let l=0,n=r.length;l<n;l++)this.hasFrozenRows&&r[l]>=this.actualFrozenRow?this.hasFrozenColumns()?null!=(t=this.rowsCache)&&t.hasOwnProperty(r[l])&&e.firstChild&&a.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild,a.firstChild],this._canvasBottomL.appendChild(e.firstChild),this._canvasBottomR.appendChild(a.firstChild)):null!=(i=this.rowsCache)&&i.hasOwnProperty(r[l])&&e.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild],this._canvasBottomL.appendChild(e.firstChild)):this.hasFrozenColumns()?null!=(s=this.rowsCache)&&s.hasOwnProperty(r[l])&&e.firstChild&&a.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild,a.firstChild],this._canvasTopL.appendChild(e.firstChild),this._canvasTopR.appendChild(a.firstChild)):null!=(o=this.rowsCache)&&o.hasOwnProperty(r[l])&&e.firstChild&&(this.rowsCache[r[l]].rowNode=[e.firstChild],this._canvasTopL.appendChild(e.firstChild));h&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}}updateRowPositions(){for(let e in this.rowsCache)if(this.rowsCache){let t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];"transform"===this._options.rowTopOffsetRenderType?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`}}render(){if(!this.initialized)return;this.scrollThrottle.dequeue();let e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){let e=p.extend(!0,{},t);this._options.frozenBottom?(e.top=this.actualFrozenRow,e.bottom=this.getDataLength()):(e.top=0,e.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(e)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.trigger(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}getFrozenRowOffset(e){let t=0;return t=this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?this.actualFrozenRow*this._options.rowHeight:this.h:0:e>=this.actualFrozenRow?this.frozenRowsHeight:0:0,t}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)(e===this._viewportTopL||e.scrollWidth!==e.clientWidth||e.scrollHeight!==e.clientHeight)&&(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach((e=>{this._bindingEventService.unbindByEventName(e,"scroll")})),this._boundAncestors=[]}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}scrollTo(e){var t,i;e=Math.max(e,0),e=Math.min(e,(this.th||0)-p.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&null!=(i=null==(t=this.scrollbarDimensions)?void 0:t.height)?i:0));let s=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));let o=e-this.offset;if(this.offset!==s){let e=this.getVisibleRange(o);this.cleanupRows(e),this.updateRowPositions()}this.prevScrollTop!==o&&(this.vScrollDir=this.prevScrollTop+s<o+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=o,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=o),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=o),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=o),this.trigger(this.onViewportChanged,{}))}handleHeaderRowScroll(){let e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){let e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){let t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);let s=Math.abs(this.scrollTop-this.prevScrollTop),o=Math.abs(this.scrollLeft-this.prevScrollLeft);if(o&&(this.prevScrollLeft=this.scrollLeft,this._viewportScrollContainerX.scrollLeft=this.scrollLeft,this._headerScrollContainer.scrollLeft=this.scrollLeft,this._topPanelScrollers[0].scrollLeft=this.scrollLeft,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=this.scrollLeft),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=this.scrollLeft:this._preHeaderPanelScroller.scrollLeft=this.scrollLeft),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=this.scrollLeft),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=this.scrollLeft),this._headerRowScrollerR.scrollLeft=this.scrollLeft):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=this.scrollLeft),this._headerRowScrollerL.scrollLeft=this.scrollLeft)),s&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,"mousewheel"===e&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),s<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{let e=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),e!==this.offset&&this.invalidateAllRows()}if(o||s){let e=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),t=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(e>20||t>20)&&(this._options.forceSyncScrolling||t<this.viewportH&&e<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.trigger(this.onViewportChanged,{}))}return this.trigger(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!(!o&&!s)}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t<=this._options.frozenColumn)return;let s=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(s>1?s-1:0)])}internalScrollColumnIntoView(e,t){var i,s;let o=this.scrollLeft+p.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.width)?s:0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>o&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}updatePagingStatusFromView(e){this.pagingActive=0!==e.pageSize,this.pagingIsLastPage=e.pageNum===e.totalPages-1}getRowSpanColumnIntersects(e){return this.getRowSpanIntersection(e,"columns")}getRowSpanIntersect(e){return this.getRowSpanIntersection(e)}getRowSpanIntersection(e,t){let i=[],s=null;for(let o=0,l=this.columns.length;o<l;o++){let l=this._colsWithRowSpanCache[o];if(l)for(let n of Array.from(l)){let[l,r]=n.split(":").map(Number);if(e>=l&&e<=r){if("columns"!==t){s=l;break}i.push(o)}}}return"columns"===t?i:s}getParentRowSpanByCell(e,t,i=!0){let s=null,o=this._colsWithRowSpanCache[t]||new Set;for(let t of Array.from(o)){let[o,l]=t.split(":").map(Number);if((i?e>o:e>=o)&&e<=l){s={start:o,end:l,range:t};break}}return s}remapAllColumnsRowSpan(){let e=this.getDataLength();if(e>0){this._colsWithRowSpanCache={};for(let t=0;t<e;t++)this.remapRowSpanMetadataByRow(t);this._rowSpanIsCached=!0}}remapRowSpanMetadataByRow(e){let t=this.getItemMetadaWhenExists(e);null!=t&&t.columns&&Object.keys(t.columns).forEach((i=>{let s=+i,o=t.columns[s],l=+((null==o?void 0:o.colspan)||1),n=+((null==o?void 0:o.rowspan)||1);this.remapRowSpanMetadata(e,s,l,n)}))}remapRowSpanMetadata(e,t,i,s){var o,l,n;if(s>1){let r=`${e}:${e+s-1}`;if(null!=(o=this._colsWithRowSpanCache)[t]||(o[t]=new Set),this._colsWithRowSpanCache[t].add(r),i>1)for(let e=1;e<i;e++)null!=(l=this._colsWithRowSpanCache)[n=t+e]||(l[n]=new Set),this._colsWithRowSpanCache[t+e].add(r)}}createEmptyCachingRow(){return{rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]}}scrollRowIntoView(e,t){var i,s;if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){let o=p.height(this._viewportScrollContainerY),l=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,n=l*this._options.rowHeight,r=(l+1)*this._options.rowHeight-o+(this.viewportHasHScroll&&null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.height)?s:0);(l+1)*this._options.rowHeight>this.scrollTop+o+this.offset?(this.scrollTo(t?n:r),this.render()):l*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?r:n),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){let t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&p.isDefined(this.activeRow)){let i=this.activeRow+t,s=this.getDataLengthIncludingAddNew();i>=s&&(i=s-1),i<0&&(i=0);let o=1===e?this.gotoDown(i-1||0,this.activeCell,this.activePosY,this.activePosX):this.gotoUp(i+1,this.activeCell,this.activePosY,this.activePosX);this.navigateToPos(o)}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.unsetActiveCell(),this.navigateToRow(0)}navigateBottom(){var e,t;let i=this.getDataLength()-1,s=null!=(t=null==(e=this.getParentRowSpanByCell(i,this.activeCell))?void 0:e.start)?t:i;do{if(this._options.enableCellRowSpan&&this.setActiveRow(s),this.navigateToRow(s)&&this.activeCell===this.activePosX||!p.isDefined(this.activeCell))break}while(--s>0)}navigateToRow(e){let t=this.getDataLength();if(!t)return!1;e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0);let i=!p.isDefined(this.activeCell)||!p.isDefined(this.activeRow);if(this._options.enableCellNavigation&&p.isDefined(this.activeRow)){let t=0,s=null,o=this.activePosX;for(;t<=this.activePosX;)this.canCellBeActive(e,t)&&(s=t,(!p.isDefined(this.activeCell)||t===this.activeCell)&&(i=!0)),t+=this.getColspan(e,t);null!==s?(this.setActiveCellInternal(this.getCellNode(e,s)),this.activePosX=o):this.resetActiveCell()}return i}getColspan(e,t){let i=this.getItemMetadaWhenExists(e);if(!i||!i.columns)return 1;t>=this.columns.length&&(t=this.columns.length-1);let s=i.columns[this.columns[t].id]||i.columns[t],o=null==s?void 0:s.colspan;return o="*"===o?this.columns.length-t:o||1,o}queuePostProcessedRowForCleanup(e,t,i){var s;this.postProcessgroupId++,"object"==typeof t&&Object.keys(t).forEach((s=>{t.hasOwnProperty(s)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+s],columnIdx:+s,rowIdx:i})})),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),null==(s=e.rowNode)||s.forEach((e=>e.remove()))}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}applyFormatResultToCellNode(e,t,i){if(null==e&&(e=""),"[object Object]"!==Object.prototype.toString.call(e))return void this.applyHtmlCode(t,e);let s=e.html||e.text;this.applyHtmlCode(t,s),e.removeClasses&&!i&&t.classList.remove(...p.classNameToList(e.removeClasses)),e.addClasses&&t.classList.add(...p.classNameToList(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}startPostProcessing(){this._options.enableAsyncPostRender&&(window.clearTimeout(this.h_postrender),this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(window.clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){"object"==typeof this.postProcessedRows[e]&&Object.keys(this.postProcessedRows[e]).forEach((t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")})),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}asyncPostProcessRows(){let e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){let t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(i&&!(t>=e))return this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach((e=>{if(i.cellNodesByColumnIdx.hasOwnProperty(e)){let s=+e,o=this.columns[s],l=this.postProcessedRows[t][s];if(o.asyncPostRender&&"R"!==l){let e=i.cellNodesByColumnIdx[s];e&&o.asyncPostRender(e,t,this.getDataItem(t),o,"C"===l),this.postProcessedRows[t][s]="R"}}})),void(this.h_postrender=window.setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){let e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){let e=this.postProcessedCleanupQueue.shift();if("R"===(null==e?void 0:e.actionType)&&e.node.forEach((e=>{e.remove()})),"C"===(null==e?void 0:e.actionType)){let t=this.columns[e.columnIdx];t.asyncPostRenderCleanup&&e.node&&t.asyncPostRenderCleanup(e.node,e.rowIdx,t)}}this.h_postrenderCleanup=window.setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,s,o;"object"==typeof this.rowsCache&&Object.keys(this.rowsCache).forEach((l=>{this.rowsCache&&(o=null==t?void 0:t[l],s=null==e?void 0:e[l],o&&Object.keys(o).forEach((e=>{(!s||o[e]!==s[e])&&(i=this.getCellNode(+l,this.getColumnIndex(e)),i&&i.classList.remove(o[e]))})),s&&Object.keys(s).forEach((e=>{(!o||o[e]!==s[e])&&(i=this.getCellNode(+l,this.getColumnIndex(e)),i&&i.classList.add(s[e]))})))}))}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.trigger(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){let i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.trigger(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){let s=(e,t)=>{t<1||(window.clearTimeout(this._flashCellTimer),this._flashCellTimer=window.setTimeout((()=>{t%2==0?e.classList.add(this._options.cellFlashingCssClass||""):e.classList.remove(this._options.cellFlashingCssClass||""),s(e,t-1)}),i))};if(this.rowsCache[e]){let i=this.getCellNode(e,t);i&&s(i,5)}}highlightRow(e,t){let i=this.rowsCache[e];t||(t=this._options.rowHighlightDuration),Array.isArray(null==i?void 0:i.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach((e=>e.classList.add(...p.classNameToList(this._options.rowHighlightCssClass)))),window.clearTimeout(this._highlightRowTimer),this._highlightRowTimer=window.setTimeout((()=>{var e;null==(e=i.rowNode)||e.forEach((e=>e.classList.remove(...p.classNameToList(this._options.rowHighlightCssClass))))}),t))}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);let s="number"==typeof t?t:this.getColumnIndex(t);return e[(this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1)?2:0)+(this.hasFrozenColumns()&&s>this._options.frozenColumn?1:0)]}measureScrollbar(){let e="";this._viewport.forEach((t=>e+=t.className));let t=p.createDomElement("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=p.createDomElement("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),s={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),s}getMaxSupportedCssHeight(){let e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=p.createDomElement("div",{style:{display:"hidden"}},document.body);for(;;){let s=2*e;p.height(i,s);let o=p.height(i);if(s>t||o!==s)break;e=s}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){var e,t,i,s;return{width:this.viewportHasVScroll&&null!=(t=null==(e=this.scrollbarDimensions)?void 0:e.width)?t:0,height:this.viewportHasHScroll&&null!=(s=null==(i=this.scrollbarDimensions)?void 0:i.height)?s:0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}getVBoxDelta(e){let t=getComputedStyle(e),i=0;return["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].forEach((e=>i+=p.toFloat(t[e]))),i}measureCellPaddingAndBorder(){let e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let s=p.createDomElement("div",{className:"ui-state-default slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),o=getComputedStyle(s);"border-box"!==o.boxSizing&&(e.forEach((e=>this.headerColumnWidthDiff+=p.toFloat(o[e]))),t.forEach((e=>this.headerColumnHeightDiff+=p.toFloat(o[e])))),s.remove();let l=p.createDomElement("div",{className:"slick-row"},this._canvas[0]);s=p.createDomElement("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},l),o=getComputedStyle(s),"border-box"!==o.boxSizing&&(e.forEach((e=>this.cellWidthDiff+=p.toFloat(o[e]))),t.forEach((e=>this.cellHeightDiff+=p.toFloat(o[e])))),l.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}clearAllTimers(){window.clearTimeout(this._columnResizeTimer),window.clearTimeout(this._executionBlockTimer),window.clearTimeout(this._flashCellTimer),window.clearTimeout(this._highlightRowTimer),window.clearTimeout(this.h_editorLoader)}LogColWidths(){let e="Col Widths:";for(let t=0;t<this.columns.length;t++)e+=" "+(this.columns[t].hidden?"H":this.columns[t].width)}simpleArrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.sort().toString()!==e.sort().toString()}defaultFormatter(e,t,i){return p.isDefined(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromNode(e){let t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){var t;for(let i in this.rowsCache)if(this.rowsCache)for(let s in this.rowsCache[i].rowNode)if((null==(t=this.rowsCache[i].rowNode)?void 0:t[+s])===e)return i?parseInt(i,10):0;return null}clearTextSelection(){var e;if(null!=(e=document.selection)&&e.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){let e=window.getSelection();null!=e&&e.removeAllRanges&&e.removeAllRanges()}}disableSelection(e){e.forEach((e=>{e.setAttribute("unselectable","on"),e.style.mozUserSelect="none",this._bindingEventService.bind(e,"selectstart",(()=>!1))}))}getPubSubService(){return this._pubSubService}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),s=0,o=0;for(let t=0;t<this.columns.length&&o<=e;t++)this.columns[t]&&(o+=this.columns[t].width,s++);return s-=1,i<-1&&(i=-1),{row:i,cell:s}}getPluginByName(e){var t;for(let i=this.plugins.length-1;i>=0;i--)if((null==(t=this.plugins[i])?void 0:t.pluginName)===e)return this.plugins[i]}getContainerNode(){return this._container}getCellHeight(e,t){let i=this._options.rowHeight||0;if(t>1){let s=e+t-1;i=this.getRowBottom(s)-this.getRowTop(e)}else{let e=this.getRowHeight();e!==i-this.cellHeightDiff&&(i=e)}return i-=this.cellHeightDiff,Math.ceil(i)}setDifference(e,t){return new Set(Array.from(e).filter((e=>!t.has(e))))}getCellNodeBox(e,t){var i;if(!this.cellExists(e,t))return null;let s=this.getFrozenRowOffset(e),o=this.getRowTop(e)-s,l=o+this._options.rowHeight-1,n=0;for(let e=0;e<t;e++)!this.columns[e]||this.columns[e].hidden||(n+=this.columns[e].width||0,this._options.frozenColumn===e&&(n=0));return{top:o,left:n,bottom:l,right:n+((null==(i=this.columns[t])?void 0:i.width)||0)}}absBox(e){let t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let i=e.offsetParent;for(;(e=e.parentNode)!==document.body&&e&&e.parentNode;){let s=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&"visible"!==s.overflowY&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&"visible"!==s.overflowX&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){var e;let t=null;if(window.getSelection){let i=window.getSelection();(null!=(e=null==i?void 0:i.rangeCount)?e:0)>0&&(t=i.getRangeAt(0))}return t}setTextSelection(e){if(window.getSelection&&e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}sanitizeHtmlString(e,t){if(!this._options.sanitizer||"string"!=typeof e)return e;let i=this._options.sanitizer(e);return!t&&this._options.logSanitizedHtml&&this.logMessageCount<=this.logMessageMaxCount&&i!==e&&(this.logMessageCount,this.logMessageMaxCount,this.logMessageCount++),i}getRowspan(e,t){let i=1,s=this.getItemMetadaWhenExists(e);return null!=s&&s.columns&&Object.keys(s.columns).forEach((e=>{let o=Number(e);if(o===t){let e=s.columns[o];i=Number((null==e?void 0:e.rowspan)||1)}})),i}findFocusableRow(e,t,i){let s=e,o=this._colsWithRowSpanCache[t]||new Set,l=!1;return Array.from(o).forEach((o=>{let[n,r]=o.split(":").map(Number);!l&&e>=n&&e<=r&&(s="up"===i?n:r,this.canCellBeActive(s,t)&&(l=!0))})),s<0&&(s=0),s}findFirstFocusableCell(e){let t=0,i=e,s=-1;for(;t<this.columns.length;){let o=this.getParentRowSpanByCell(e,t);if(i=null!==o&&o.start!==e?o.start:e,this.canCellBeActive(i,t)){s=t;break}t+=this.getColspan(i,t)}return{cell:s,row:i}}findLastFocusableCell(e){let t=0,i=e,s=-1;for(;t<this.columns.length;){let o=this.getParentRowSpanByCell(e,t);i=null!==o&&o.start!==e?o.start:e,this.canCellBeActive(i,t)&&(s=t),t+=this.getColspan(i,t)}return{cell:s,row:i}}rowsToRanges(e){let t=[],i=this.columns.length-1;for(let s=0;s<e.length;s++)t.push(new d(e[s],0,e[s],i));return t}findSpanStartingCell(e,t){let i=this.getParentRowSpanByCell(e,t),s=null!==i&&i.start!==e?i.start:e,o=0,l=0;for(;o<this.columns.length;){if(o+=this.getColspan(s,o),o>t)return o=l,{cell:o,row:s};l=o}return{cell:o,row:s}}gotoRight(e,t,i,s){if(t>=this.columns.length)return null;let o=t+1,l=i;do{let e=this.findSpanStartingCell(i,o);if(l=e.row,o=e.cell,this.canCellBeActive(l,o)&&o>t)break;o+=this.getColspan(l,e.cell)}while(o<this.columns.length);return o<this.columns.length?{row:l,cell:o,posX:o,posY:i}:null}gotoLeft(e,t,i,s){if(t<=0)return null;let o=this.findFirstFocusableCell(e);if(null===o.cell||o.cell>=t)return null;let l,n={row:e,cell:o.cell,posX:o.cell,posY:i};for(;;){if(l=this.gotoRight(n.row,n.cell,n.posY,n.posX),!l)return null;if(l.cell>=t){let e=this.findFocusableRow(i,n.cell,"up");return e!==n.row&&(n.row=e),n}n=l}}gotoDown(e,t,i,s){let o,l=this.getDataLengthIncludingAddNew();do{for(e+=this.getRowspan(e,s),o=t=0;t<=s;)o=t,t+=this.getColspan(e,t)}while(e<=l&&!this.canCellBeActive(e,o));return e<=l?{row:e,cell:o,posX:s,posY:e}:null}gotoUp(e,t,i,s){let o;if(e<=0)return null;do{for(e=this.findFocusableRow(e-1,s,"up"),o=t=0;t<=s;)o=t,t+=this.getColspan(e,t)}while(e>=0&&!this.canCellBeActive(e,o));return t<=this.columns.length?{row:e,cell:o,posX:s,posY:e}:null}gotoNext(e,t,i,s){var o,l;if(!p.isDefined(e)&&!p.isDefined(t)&&(e=t=i=s=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let n=this.gotoRight(e,t,i,s);if(!n){let t;for(;!n&&++i<this.getDataLength()+(this._options.enableAddRow?1:0);)t=this.findFirstFocusableCell(i),null!==t.cell&&(n={row:e=null!=(l=null==(o=this.getParentRowSpanByCell(i,t.cell))?void 0:o.start)?l:i,cell:t.cell,posX:t.cell,posY:i})}return n}gotoPrev(e,t,i,s){var o,l;if(!p.isDefined(e)&&!p.isDefined(t)&&(e=i=this.getDataLengthIncludingAddNew()-1,t=s=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let n=this.gotoLeft(e,t,i,s);if(!n){let t;for(;!n&&--i>=0;)t=this.findLastFocusableCell(i),t.cell>-1&&(n={row:e=null!=(l=null==(o=this.getParentRowSpanByCell(i,t.cell))?void 0:o.start)?l:i,cell:t.cell,posX:t.cell,posY:i})}return n}gotoRowStart(e,t,i,s){let o=this.findFirstFocusableCell(e);return null===o.cell?null:{row:o.row,cell:o.cell,posX:o.cell,posY:e}}gotoRowEnd(e,t,i,s){let o=this.findLastFocusableCell(e);return-1===o.cell?null:{row:o.row,cell:o.cell,posX:o.cell,posY:e}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigateTopStart(){return this.navigateToRow(0),this.navigate("home")}navigateBottomEnd(){return this.navigateBottom(),this.navigate("end")}navigate(e){var t;if(!this._options.enableCellNavigation||!this.activeCellNode&&"prev"!==e&&"next"!==e)return!1;if(null==(t=this.getEditorLock())||!t.commitCurrentEdit())return!0;this.setFocus(),this.unsetActiveCell();this.tabbingDirection={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];let i={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosY,this.activePosX);return this.navigateToPos(i)}navigateToPos(e){if(e){if(this.hasFrozenRows&&this._options.frozenBottom&&e.row===this.getDataLength())return;let t=e.row===this.getDataLength();return(!this._options.frozenBottom&&e.row>=this.actualFrozenRow||this._options.frozenBottom&&e.row<this.actualFrozenRow)&&this.scrollCellIntoView(e.row,e.cell,!t&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(e.row,e.cell)),this.activePosX=e.posX,this.activePosY=e.posY,!0}return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch(i){return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,s,o){this.initialized&&(e>this.getDataLength()||e<0||t>=this.columns.length||t<0||this._options.enableCellNavigation&&(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,s,o)))}setActiveRow(e,t,i){this.initialized&&(e>this.getDataLength()||e<0||(null!=t?t:0)>=this.columns.length||(null!=t?t:0)<0||(this.activeRow=e,i||this.scrollCellIntoView(e,t||0,!1)))}canCellBeActive(e,t){var i,s,o,l;if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden||(null!=(s=null==(i=this.getParentRowSpanByCell(e,t))?void 0:i.start)?s:e)!==e)return!1;let n=this.getItemMetadaWhenExists(e);if(void 0!==(null==n?void 0:n.focusable))return!!n.focusable;let r=null==n?void 0:n.columns;return void 0!==(null==(o=null==r?void 0:r[this.columns[t].id])?void 0:o.focusable)?!!r[this.columns[t].id].focusable:void 0!==(null==(l=null==r?void 0:r[t])?void 0:l.focusable)?!!r[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;let i=this.getItemMetadaWhenExists(e);if(void 0!==(null==i?void 0:i.selectable))return!!i.selectable;let s=(null==i?void 0:i.columns)&&(i.columns[this.columns[t].id]||i.columns[t]);return void 0!==(null==s?void 0:s.selectable)?!!s.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,s){var o;if(!this.initialized||!this.canCellBeActive(e,t)||null==(o=this.getEditorLock())||!o.commitCurrentEdit())return;this.scrollCellIntoView(e,t,!1);let l=this.getCellNode(e,t),n=this.columns[t],r=!!(this._options.editable&&null!=n&&n.editor&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(l,i||e===this.getDataLength()||this._options.autoEdit,null,r,s),this.currentEditor||this.setFocus()}}})})();
/**
 * @license
 * (c) 2009-present Michael Leibman
 * michael{dot}leibman{at}gmail{dot}com
 * http://github.com/mleibman/slickgrid
 *
 * Distributed under MIT license.
 * All rights reserved.
 *
 * SlickGrid v5.15.3
 *
 * NOTES:
 *     Cell/row DOM manipulations are done directly bypassing JS DOM manipulation methods.
 *     This increases the speed dramatically, but can only be done safely because there are no event handlers
 *     or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
 *     and do proper cleanup.
 */
"use strict";(()=>{var e=Object.defineProperty,t=(t,i,l)=>((t,i,l)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[i]=l)(t,"symbol"!=typeof i?i+"":i,l),i=Slick.Utils;window.Slick&&i.extend(!0,window,{Slick:{AutoTooltips:class{constructor(e){t(this,"pluginName","AutoTooltips"),t(this,"_grid"),t(this,"_options"),t(this,"_defaults",{enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:void 0,replaceExisting:!0}),this._options=i.extend(!0,{},this._defaults,e)}init(e){var t,i;this._grid=e,null!=(t=this._options)&&t.enableForCells&&this._grid.onMouseEnter.subscribe(this.handleMouseEnter.bind(this)),null!=(i=this._options)&&i.enableForHeaderCells&&this._grid.onHeaderMouseEnter.subscribe(this.handleHeaderMouseEnter.bind(this))}destroy(){var e,t;null!=(e=this._options)&&e.enableForCells&&this._grid.onMouseEnter.unsubscribe(this.handleMouseEnter.bind(this)),null!=(t=this._options)&&t.enableForHeaderCells&&this._grid.onHeaderMouseEnter.unsubscribe(this.handleHeaderMouseEnter.bind(this))}handleMouseEnter(e){var t,i,l,n,s;let o=this._grid.getCellFromEvent(e);if(o){let e,r=this._grid.getCellNode(o.row,o.cell);this._options&&r&&(!r.title||null!=(t=this._options)&&t.replaceExisting)&&(r.clientWidth<r.scrollWidth?(e=null!=(l=null==(i=r.textContent)?void 0:i.trim())?l:"",null!=(n=this._options)&&n.maxToolTipLength&&e.length>(null==(s=this._options)?void 0:s.maxToolTipLength)&&(e=e.substring(0,this._options.maxToolTipLength-3)+"...")):e="",r.title=e),r=null}}handleHeaderMouseEnter(e,t){var l;let n,s=t.column,o=e.target;if(o&&(n=o.closest(".slick-header-column"),n&&(null==s||!s.toolTip))){let e=o.clientWidth<n.clientWidth&&null!=(l=null==s?void 0:s.name)?l:"";n.title=i.getHtmlStringOutput(e,"innerHTML")}n=null}}}})})();
"use strict";(()=>{var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i),s=Slick.Utils;window.Slick&&s.extend(!0,window,{Slick:{CellRangeDecorator:class{constructor(e,i){this.grid=e,t(this,"pluginName","CellRangeDecorator"),t(this,"_options"),t(this,"_elem"),t(this,"_defaults",{selectionCssClass:"slick-range-decorator",selectionCss:{zIndex:"9999",border:"2px dashed red"},offset:{top:-1,left:-1,height:-2,width:-2}}),this._options=s.extend(!0,{},this._defaults,i)}destroy(){this.hide()}init(){}hide(){var e;null==(e=this._elem)||e.remove(),this._elem=null}show(e){var t;if(!this._elem){this._elem=document.createElement("div"),this._elem.className=this._options.selectionCssClass,Object.keys(this._options.selectionCss).forEach((e=>{this._elem.style[e]=this._options.selectionCss[e]})),this._elem.style.position="absolute";let e=this.grid.getActiveCanvasNode();e&&e.appendChild(this._elem)}let s=this.grid.getCellNodeBox(e.fromRow,e.fromCell),i=this.grid.getCellNodeBox(e.toRow,e.toCell);return s&&i&&null!=(t=this._options)&&t.offset&&(this._elem.style.top=`${s.top+this._options.offset.top}px`,this._elem.style.left=`${s.left+this._options.offset.left}px`,this._elem.style.height=`${i.bottom-s.top+this._options.offset.height}px`,this._elem.style.width=`${i.right-s.left+this._options.offset.width}px`),this._elem}}}})})();
"use strict";(()=>{var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s),i=Slick.Event,s=Slick.EventHandler,o=Slick.Range,l=Slick.Draggable,r=Slick.CellRangeDecorator,n=Slick.Utils;window.Slick&&n.extend(Slick,{CellRangeSelector:class{constructor(t){e(this,"pluginName","CellRangeSelector"),e(this,"onBeforeCellRangeSelected",new i("onBeforeCellRangeSelected")),e(this,"onCellRangeSelected",new i("onCellRangeSelected")),e(this,"onCellRangeSelecting",new i("onCellRangeSelecting")),e(this,"_grid"),e(this,"_currentlySelectedRange",null),e(this,"_canvas",null),e(this,"_decorator"),e(this,"_gridOptions"),e(this,"_activeCanvas"),e(this,"_dragging",!1),e(this,"_handler",new s),e(this,"_options"),e(this,"_defaults",{autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}}),e(this,"_rowOffset",0),e(this,"_columnOffset",0),e(this,"_isRightCanvas",!1),e(this,"_isBottomCanvas",!1),e(this,"_activeViewport"),e(this,"_autoScrollTimerId"),e(this,"_draggingMouseOffset"),e(this,"_moveDistanceForOneCell"),e(this,"_xDelayForNextCell",0),e(this,"_yDelayForNextCell",0),e(this,"_viewportHeight",0),e(this,"_viewportWidth",0),e(this,"_isRowMoveRegistered",!1),e(this,"_scrollLeft",0),e(this,"_scrollTop",0),this._options=n.extend(!0,{},this._defaults,t)}init(t){if(void 0===l)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');this._decorator=this._options.cellDecorator||new r(t,this._options),this._grid=t,n.addSlickEventPubSubWhenDefined(t.getPubSubService(),this),this._canvas=this._grid.getCanvasNode(),this._gridOptions=this._grid.getOptions(),this._handler.subscribe(this._grid.onScroll,this.handleScroll.bind(this)).subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this))}destroy(){var t;this._handler.unsubscribeAll(),this._activeCanvas=null,this._activeViewport=null,this._canvas=null,null==(t=this._decorator)||t.destroy()}getCellDecorator(){return this._decorator}handleScroll(t,e){this._scrollTop=e.scrollTop,this._scrollLeft=e.scrollLeft}handleDragInit(t){this._activeCanvas=this._grid.getActiveCanvasNode(t),this._activeViewport=this._grid.getActiveViewportNode(t);let e=this._grid.getDisplayedScrollbarDimensions();if(this._viewportWidth=this._activeViewport.offsetWidth-e.width,this._viewportHeight=this._activeViewport.offsetHeight-e.height,this._moveDistanceForOneCell={x:this._grid.getAbsoluteColumnMinWidth()/2,y:this._grid.getOptions().rowHeight/2},this._isRowMoveRegistered=this.hasRowMoveManager(),this._rowOffset=0,this._columnOffset=0,this._isBottomCanvas=this._activeCanvas.classList.contains("grid-canvas-bottom"),this._gridOptions.frozenRow>-1&&this._isBottomCanvas){let t=`.${this._grid.getUID()} .grid-canvas-${this._gridOptions.frozenBottom?"bottom":"top"}`,e=document.querySelector(t);e&&(this._rowOffset=e.clientHeight||0)}if(this._isRightCanvas=this._activeCanvas.classList.contains("grid-canvas-right"),this._gridOptions.frozenColumn>-1&&this._isRightCanvas){let t=document.querySelector(`.${this._grid.getUID()} .grid-canvas-left`);t&&(this._columnOffset=t.clientWidth||0)}t.stopImmediatePropagation(),t.preventDefault()}handleDragStart(t,e){var i,s;let l=this._grid.getCellFromEvent(t);if(l&&!1!==this.onBeforeCellRangeSelected.notify(l).getReturnValue()&&this._grid.canCellBeSelected(l.row,l.cell)&&(this._dragging=!0,t.stopImmediatePropagation()),!this._dragging)return;this._grid.focus();let r=n.offset(this._canvas),a=e.startX-(null!=(i=null==r?void 0:r.left)?i:0);this._gridOptions.frozenColumn>=0&&this._isRightCanvas&&(a+=this._scrollLeft);let h=e.startY-(null!=(s=null==r?void 0:r.top)?s:0);this._gridOptions.frozenRow>=0&&this._isBottomCanvas&&(h+=this._scrollTop);let g=this._grid.getCellFromPoint(a,h);return e.range={start:g,end:{}},this._currentlySelectedRange=e.range,this._decorator.show(new o(g.row,g.cell))}handleDrag(t,e){if(!this._dragging&&!this._isRowMoveRegistered)return;this._isRowMoveRegistered||t.stopImmediatePropagation();let i=t.getNativeEvent();if(this._options.autoScroll&&(this._draggingMouseOffset=this.getMouseOffsetViewport(i,e),this._draggingMouseOffset.isOutsideViewport))return this.handleDragOutsideViewport();this.stopIntervalTimer(),this.handleDragTo(i,e)}getMouseOffsetViewport(t,e){var i,s,o,l;let r=null!=(s=null==(i=null==t?void 0:t.touches)?void 0:i[0])?s:t,a=this._activeViewport.scrollLeft,h=this._activeViewport.scrollTop,g=a+this._viewportWidth,d=h+this._viewportHeight,_=n.offset(this._activeViewport),c=null!=(o=null==_?void 0:_.left)?o:0,f=null!=(l=null==_?void 0:_.top)?l:0,u=c+this._viewportWidth,v=f+this._viewportHeight,p={e:t,dd:e,viewport:{left:a,top:h,right:g,bottom:d,offset:{left:c,top:f,right:u,bottom:v}},offset:{x:0,y:0},isOutsideViewport:!1};return r.pageX<c?p.offset.x=r.pageX-c:r.pageX>u&&(p.offset.x=r.pageX-u),r.pageY<f?p.offset.y=f-r.pageY:r.pageY>v&&(p.offset.y=v-r.pageY),p.isOutsideViewport=!!p.offset.x||!!p.offset.y,p}handleDragOutsideViewport(){if(this._xDelayForNextCell=this._options.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.x)*this._options.accelerateInterval,this._yDelayForNextCell=this._options.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.y)*this._options.accelerateInterval,!this._autoScrollTimerId){let t=0,e=0;this._autoScrollTimerId=window.setInterval((()=>{let i=!1,s=!1;this._draggingMouseOffset.offset.x?(t+=this._options.minIntervalToShowNextCell,i=t>=this._xDelayForNextCell):t=0,this._draggingMouseOffset.offset.y?(e+=this._options.minIntervalToShowNextCell,s=e>=this._yDelayForNextCell):e=0,(i||s)&&(i&&(t=0),s&&(e=0),this.handleDragToNewPosition(i,s))}),this._options.minIntervalToShowNextCell)}}handleDragToNewPosition(t,e){let i=this._draggingMouseOffset.e.pageX,s=this._draggingMouseOffset.e.pageY,o=this._draggingMouseOffset.offset.x,l=this._draggingMouseOffset.offset.y,r=this._draggingMouseOffset.viewport.offset;t&&o&&(i=o>0?r.right+this._moveDistanceForOneCell.x:r.left-this._moveDistanceForOneCell.x),e&&l&&(s=l>0?r.top-this._moveDistanceForOneCell.y:r.bottom+this._moveDistanceForOneCell.y),this.handleDragTo({pageX:i,pageY:s},this._draggingMouseOffset.dd)}stopIntervalTimer(){this._autoScrollTimerId&&(window.clearInterval(this._autoScrollTimerId),this._autoScrollTimerId=void 0)}handleDragTo(t,e){var i,s,l,r,a,h;let g=null!=(s=null==(i=null==t?void 0:t.touches)?void 0:i[0])?s:t,d=n.offset(this._activeCanvas),_=this._grid.getCellFromPoint(g.pageX-(null!=(l=null==d?void 0:d.left)?l:0)+this._columnOffset,g.pageY-(null!=(r=null==d?void 0:d.top)?r:0)+this._rowOffset);if(!(this._gridOptions.frozenColumn>=0&&!this._isRightCanvas&&_.cell>this._gridOptions.frozenColumn||this._isRightCanvas&&_.cell<=this._gridOptions.frozenColumn||this._gridOptions.frozenRow>=0&&!this._isBottomCanvas&&_.row>=this._gridOptions.frozenRow||this._isBottomCanvas&&_.row<this._gridOptions.frozenRow)){if(this._options.autoScroll&&this._draggingMouseOffset){let t=this._grid.getCellNodeBox(_.row,_.cell);if(!t)return;let e=this._draggingMouseOffset.viewport;(t.left<e.left||t.right>e.right||t.top<e.top||t.bottom>e.bottom)&&this._grid.scrollCellIntoView(_.row,_.cell)}if(this._grid.canCellBeSelected(_.row,_.cell)&&null!=e&&e.range){e.range.end=_;let t=new o(null!=(a=e.range.start.row)?a:0,null!=(h=e.range.start.cell)?h:0,_.row,_.cell);this._decorator.show(t),this.onCellRangeSelecting.notify({range:t})}}}hasRowMoveManager(){return!(!this._grid.getPluginByName("RowMoveManager")&&!this._grid.getPluginByName("CrossGridRowMoveManager"))}handleDragEnd(t,e){var i,s;this._decorator.hide(),this._dragging&&(this._dragging=!1,t.stopImmediatePropagation(),this.stopIntervalTimer(),this.onCellRangeSelected.notify({range:new o(null!=(i=e.range.start.row)?i:0,null!=(s=e.range.start.cell)?s:0,e.range.end.row,e.range.end.cell)}))}getCurrentRange(){return this._currentlySelectedRange}}})})();
"use strict";(()=>{var e=Object.defineProperty,t=(t,o,l)=>((t,o,l)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l)(t,"symbol"!=typeof o?o+"":o,l),o=Slick.Event,l=Slick.Range,i=Slick.Utils;window.Slick&&i.extend(!0,window,{Slick:{CellExternalCopyManager:class{constructor(e){t(this,"pluginName","CellExternalCopyManager"),t(this,"onCopyCells",new o("onCopyCells")),t(this,"onCopyCancelled",new o("onCopyCancelled")),t(this,"onPasteCells",new o("onPasteCells")),t(this,"_grid"),t(this,"_bodyElement"),t(this,"_copiedRanges",null),t(this,"_clearCopyTI"),t(this,"_copiedCellStyle"),t(this,"_copiedCellStyleLayerKey"),t(this,"_onCopyInit"),t(this,"_onCopySuccess"),t(this,"_options"),t(this,"keyCodes",{C:67,V:86,ESC:27,INSERT:45}),this._options=e||{},this._copiedCellStyleLayerKey=this._options.copiedCellStyleLayerKey||"copy-manager",this._copiedCellStyle=this._options.copiedCellStyle||"copied",this._bodyElement=this._options.bodyElement||document.body,this._onCopyInit=this._options.onCopyInit||void 0,this._onCopySuccess=this._options.onCopySuccess||void 0}init(e){this._grid=e,i.addSlickEventPubSubWhenDefined(e.getPubSubService(),this),this._grid.onKeyDown.subscribe(this.handleKeyDown.bind(this));let t=e.getSelectionModel();if(!t)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())");t.onSelectedRangesChanged.subscribe((()=>{this._grid.getEditorLock().isActive()||this._grid.focus()}))}destroy(){this._grid.onKeyDown.unsubscribe(this.handleKeyDown.bind(this))}getHeaderValueForColumn(e){if(this._options.headerColumnValueExtractor){let t=i.getHtmlStringOutput(this._options.headerColumnValueExtractor(e));if(t)return t}return i.getHtmlStringOutput(e.name||"")}getDataItemValueForColumn(e,t,o){if("function"==typeof this._options.dataItemColumnValueExtractor){let o=this._options.dataItemColumnValueExtractor(e,t);if(o)return o}let l="";if(null!=t&&t.editor){let i=document.createElement("p"),n=new t.editor({container:i,column:t,event:o,position:{top:0,left:0},grid:this._grid});n.loadValue(e),l=n.serializeValue(),n.destroy(),i.remove()}else l=e[t.field||""];return l}setDataItemValueForColumn(e,t,o){if(t.denyPaste)return null;if(this._options.dataItemColumnValueSetter)return this._options.dataItemColumnValueSetter(e,t,o);if(t.editor){let l=document.createElement("div"),i=new t.editor({container:l,column:t,position:{top:0,left:0},grid:this._grid});i.loadValue(e),i.applyValue(e,o),i.destroy(),l.remove()}else e[t.field]=o}_createTextBox(e){let t=document.documentElement.scrollTop||document.body.scrollTop,o=document.createElement("textarea");return o.style.position="absolute",o.style.opacity="0",o.value=e,o.style.top=`${t}px`,this._bodyElement.appendChild(o),o.select(),o}_decodeTabularData(e,t){var o;let i=e.getColumns(),n=t.value.split(/[\n\f\r]/);""===n[n.length-1]&&n.pop();let s=0,a=[];this._bodyElement.removeChild(t);for(let e=0;e<n.length;e++)""!==n[e]?a[s++]=n[e].split("\t"):a[s++]=[""];let r,d,h=e.getActiveCell(),c=null==(o=e.getSelectionModel())?void 0:o.getSelectedRanges(),u=c&&c.length?c[0]:null;if(u)r=u.fromRow,d=u.fromCell;else{if(!h)return;r=h.row,d=h.cell}let p=!1,C=a.length,m=a.length?a[0].length:0;1===a.length&&1===a[0].length&&u&&(p=!0,C=u.toRow-u.fromRow+1,m=u.toCell-u.fromCell+1);let y=e.getData().length-(r||0),g=0;if(y<C&&"function"==typeof this._options.newRowCreator){let t=e.getData();for(g=1;g<=C-y;g++)t.push({});e.setData(t),e.render()}let f=(r||0)+C>e.getDataLength();if(this._options.newRowCreator&&f){let t=(r||0)+C-e.getDataLength();this._options.newRowCreator(t)}let _={isClipboardCommand:!0,clippedRange:a,oldValues:[],cellExternalCopyManager:this,_options:this._options,setDataItemValueForColumn:this.setDataItemValueForColumn.bind(this),markCopySelection:this.markCopySelection.bind(this),oneCellToMultiple:p,activeRow:r,activeCell:d,destH:C,destW:m,maxDestY:e.getDataLength(),maxDestX:e.getColumns().length,h:0,w:0,execute:()=>{var t;_.h=0;for(let t=0;t<_.destH;t++){_.oldValues[t]=[],_.w=0,_.h++;let o=0;for(let l=0;l<_.destW;l++){let n=r+t,s=d+l,h=i[s];if(h.hidden)_.destW++,o++;else if(_.w++,n<_.maxDestY&&s<_.maxDestX){let i=e.getDataItem(n);_.oldValues[t][l-o]=i[h.field],p?_.setDataItemValueForColumn(i,h,a[0][0]):_.setDataItemValueForColumn(i,h,a[t]?a[t][l-o]:""),e.updateCell(n,s),e.onCellChange.notify({row:n,cell:s,item:i,grid:e,column:{}})}}}let o=new l(r,d,r+_.h-1,d+_.w-1);this.markCopySelection([o]),null==(t=e.getSelectionModel())||t.setSelectedRanges([o]),this.onPasteCells.notify({ranges:[o]})},undo:()=>{var t;for(let t=0;t<_.destH;t++)for(let o=0;o<_.destW;o++){let l=r+t,n=d+o;if(l<_.maxDestY&&n<_.maxDestX){let s=e.getDataItem(l);p?_.setDataItemValueForColumn(s,i[n],_.oldValues[0][0]):_.setDataItemValueForColumn(s,i[n],_.oldValues[t][o]),e.updateCell(l,n),e.onCellChange.notify({row:l,cell:n,item:s,grid:e,column:{}})}}let o=new l(r,d,r+_.h-1,d+_.w-1);if(this.markCopySelection([o]),null==(t=e.getSelectionModel())||t.setSelectedRanges([o]),"function"==typeof this._options.onPasteCells&&this.onPasteCells.notify({ranges:[o]}),g>1){let t=e.getData();for(;g>1;g--)t.splice(t.length-1,1);e.setData(t),e.render()}}};"function"==typeof this._options.clipboardCommandHandler?this._options.clipboardCommandHandler(_):_.execute()}handleKeyDown(e){var t,o,l,i,n,s;let a;if(!this._grid.getEditorLock().isActive()||this._grid.getOptions().autoEdit){if(e.which===this.keyCodes.ESC&&this._copiedRanges&&(e.preventDefault(),this.clearCopySelection(),this.onCopyCancelled.notify({ranges:this._copiedRanges}),this._copiedRanges=null),(e.which===this.keyCodes.C||e.which===this.keyCodes.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&("function"==typeof this._onCopyInit&&this._onCopyInit.call(this),a=null!=(o=null==(t=this._grid.getSelectionModel())?void 0:t.getSelectedRanges())?o:[],0!==a.length)){this._copiedRanges=a,this.markCopySelection(a),this.onCopyCells.notify({ranges:a});let t=this._grid.getColumns(),o="";for(let l=0;l<a.length;l++){let i=a[l],n=[];for(let o=i.fromRow;o<i.toRow+1;o++){let l=[],s=this._grid.getDataItem(o);if(0===n.length&&this._options.includeHeaderWhenCopying){let e=[];for(let o=i.fromCell;o<i.toCell+1;o++)(t[o].name instanceof HTMLElement?t[o].name.innerHTML:t[o].name).length>0&&!t[o].hidden&&e.push(this.getHeaderValueForColumn(t[o])||"");n.push(e.join("\t"))}for(let o=i.fromCell;o<i.toCell+1;o++)(t[o].name instanceof HTMLElement?t[o].name.innerHTML:t[o].name).length>0&&!t[o].hidden&&l.push(this.getDataItemValueForColumn(s,t[o],e));n.push(l.join("\t"))}o+=n.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",o),!0;{let e=document.activeElement,t=this._createTextBox(o);if(t.focus(),window.setTimeout((()=>{this._bodyElement.removeChild(t),e&&e.focus()}),null!=(i=null==(l=this._options)?void 0:l.clipboardPasteDelay)?i:100),"function"==typeof this._onCopySuccess){let e=0;e=1===a.length?a[0].toRow+1-a[0].fromRow:a.length,this._onCopySuccess(e)}return!1}}if(!this._options.readOnlyMode&&(e.which===this.keyCodes.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===this.keyCodes.INSERT&&e.shiftKey&&!e.ctrlKey)){let e=document.activeElement,t=this._createTextBox("");return window.setTimeout((()=>{this._decodeTabularData(this._grid,t),null==e||e.focus()}),null!=(s=null==(n=this._options)?void 0:n.clipboardPasteDelay)?s:100),!1}}}markCopySelection(e){var t;this.clearCopySelection();let o=this._grid.getColumns(),l={};for(let t=0;t<e.length;t++)for(let i=e[t].fromRow;i<=e[t].toRow;i++){l[i]={};for(let n=e[t].fromCell;n<=e[t].toCell&&n<o.length;n++)l[i][o[n].id]=this._copiedCellStyle}this._grid.setCellCssStyles(this._copiedCellStyleLayerKey,l),window.clearTimeout(this._clearCopyTI),this._clearCopyTI=window.setTimeout((()=>{this.clearCopySelection()}),(null==(t=this._options)?void 0:t.clearCopySelectionDelay)||2e3)}clearCopySelection(){this._grid.removeCellCssStyles(this._copiedCellStyleLayerKey)}setIncludeHeaderWhenCopying(e){this._options.includeHeaderWhenCopying=e}}}})})();
"use strict";(()=>{var e=Object.defineProperty,t=(t,l,i)=>((t,l,i)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[l]=i)(t,"symbol"!=typeof l?l+"":l,i),l=Slick.Event,i=Slick.EventData,s=Slick.Range,o=Slick.CellRangeSelector,n=Slick.Utils;window.Slick&&n.extend(!0,window,{Slick:{CellSelectionModel:class{constructor(e){t(this,"pluginName","CellSelectionModel"),t(this,"onSelectedRangesChanged",new l("onSelectedRangesChanged")),t(this,"_cachedPageRowCount",0),t(this,"_dataView"),t(this,"_grid"),t(this,"_prevSelectedRow"),t(this,"_prevKeyDown",""),t(this,"_ranges",[]),t(this,"_selector"),t(this,"_options"),t(this,"_defaults",{selectActiveCell:!0}),void 0===e||void 0===e.cellRangeSelector?this._selector=new o({selectionCss:{border:"2px solid black"}}):this._selector=e.cellRangeSelector}init(e){this._options=n.extend(!0,{},this._defaults,this._options),this._grid=e,e.hasDataView()&&(this._dataView=e.getData()),this._grid.onActiveCellChanged.subscribe(this.handleActiveCellChange.bind(this)),this._grid.onKeyDown.subscribe(this.handleKeyDown.bind(this)),e.registerPlugin(this._selector),this._selector.onCellRangeSelected.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.subscribe(this.handleBeforeCellRangeSelected.bind(this))}destroy(){var e;this._grid.onActiveCellChanged.unsubscribe(this.handleActiveCellChange.bind(this)),this._grid.onKeyDown.unsubscribe(this.handleKeyDown.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._grid.unregisterPlugin(this._selector),null==(e=this._selector)||e.destroy()}removeInvalidRanges(e){let t=[];for(let l=0;l<e.length;l++){let i=e[l];this._grid.canCellBeSelected(i.fromRow,i.fromCell)&&this._grid.canCellBeSelected(i.toRow,i.toCell)&&t.push(i)}return t}rangesAreEqual(e,t){let l=e.length!==t.length;if(!l)for(let i=0;i<e.length;i++)if(e[i].fromCell!==t[i].fromCell||e[i].fromRow!==t[i].fromRow||e[i].toCell!==t[i].toCell||e[i].toRow!==t[i].toRow){l=!0;break}return!l}resetPageRowCount(){this._cachedPageRowCount=0}setSelectedRanges(e,t="SlickCellSelectionModel.setSelectedRanges"){if(!(this._ranges&&0!==this._ranges.length||e&&0!==e.length))return;let l=!this.rangesAreEqual(this._ranges,e);if(this._ranges=this.removeInvalidRanges(e),l){let e=new i(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,e)}}getSelectedRanges(){return this._ranges}refreshSelections(){this.setSelectedRanges(this.getSelectedRanges())}handleBeforeCellRangeSelected(e){if(this._grid.getEditorLock().isActive())return e.stopPropagation(),!1}handleCellRangeSelected(e,t){this._grid.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0),this.setSelectedRanges([t.range])}handleActiveCellChange(e,t){var l,i;this._prevSelectedRow=void 0;let o=n.isDefined(t.cell),r=n.isDefined(t.row);null!=(l=this._options)&&l.selectActiveCell&&r&&o?this.setSelectedRanges([new s(t.row,t.cell)]):(null==(i=this._options)||!i.selectActiveCell||!r&&!o)&&this.setSelectedRanges([])}isKeyAllowed(e,t){return["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","PageDown","PageUp","Home","End",...t?[]:["a","A"]].some((t=>t===e))}handleKeyDown(e){var t,l;let i,o,n=this._grid.getColumns().length,r=this._grid.getActiveCell(),h=0;if(h=this._dataView&&"getPagingInfo"in this._dataView?(null==(t=this._dataView)?void 0:t.getPagingInfo().pageSize)||this._dataView.getLength():this._grid.getDataLength(),r&&(e.shiftKey||e.ctrlKey)&&!e.altKey&&this.isKeyAllowed(e.key,e.shiftKey)){i=this.getSelectedRanges().slice(),i.length||i.push(new s(r.row,r.cell)),o=i.pop(),o.contains(r.row,r.cell)||(o=new s(r.row,r.cell));let t,a=o.toRow-o.fromRow,c=o.toCell-o.fromCell,d=0;e.ctrlKey&&"a"===(null==(l=e.key)?void 0:l.toLowerCase())&&(this._grid.setActiveCell(0,0,!1,!1,!0),r.row=0,r.cell=0,t=n-1,d=h-1);let g=r.row===o.fromRow?1:-1,w=r.cell===o.fromCell?1:-1,_=e.key.startsWith("Arrow");_&&!e.ctrlKey?("ArrowLeft"===e.key?c-=w:"ArrowRight"===e.key?c+=w:"ArrowUp"===e.key?a-=g:"ArrowDown"===e.key&&(a+=g),d=r.row+g*a):(this._cachedPageRowCount<1&&(this._cachedPageRowCount=this._grid.getViewportRowCount()),void 0===this._prevSelectedRow&&(this._prevSelectedRow=r.row),!e.ctrlKey&&e.shiftKey&&"Home"===e.key||e.ctrlKey&&e.shiftKey&&"ArrowLeft"===e.key?(t=0,d=r.row):!e.ctrlKey&&e.shiftKey&&"End"===e.key||e.ctrlKey&&e.shiftKey&&"ArrowRight"===e.key?(t=n-1,d=r.row):e.ctrlKey&&e.shiftKey&&"ArrowUp"===e.key?d=0:e.ctrlKey&&e.shiftKey&&"ArrowDown"===e.key?d=h-1:e.ctrlKey&&e.shiftKey&&"Home"===e.key?(t=0,d=0):e.ctrlKey&&e.shiftKey&&"End"===e.key?(t=n-1,d=h-1):"PageUp"===e.key?(this._prevSelectedRow>=0&&(d=this._prevSelectedRow-this._cachedPageRowCount),d<0&&(d=0)):"PageDown"===e.key&&(this._prevSelectedRow<=h-1&&(d=this._prevSelectedRow+this._cachedPageRowCount),d>h-1&&(d=h-1)),this._prevSelectedRow=d),null!=t||(t=r.cell+w*c);let R=new s(r.row,r.cell,d,t);if(this.removeInvalidRanges([R]).length){i.push(R);let e=g>0?R.toRow:R.fromRow,t=w>0?R.toCell:R.fromCell;_?(this._grid.scrollRowIntoView(e),this._grid.scrollCellIntoView(e,t)):(this._grid.scrollRowIntoView(d),this._grid.scrollCellIntoView(d,t))}else i.push(o);this.setSelectedRanges(i),e.preventDefault(),e.stopPropagation(),this._prevKeyDown=e.key}}}}})})();
"use strict";(()=>{var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s),i=Slick.keyCode,s=Slick.Utils,a=class t{constructor(t){this.args=t,e(this,"input"),e(this,"defaultValue"),e(this,"navOnLR"),this.init()}init(){this.navOnLR=this.args.grid.getOptions().editorCellNavOnLRKeys,this.input=s.createDomElement("input",{type:"text",className:"editor-text"},this.args.container),this.input.addEventListener("keydown",this.navOnLR?n:r),this.input.focus(),this.input.select(),this.args.compositeEditorOptions&&this.input.addEventListener("change",this.onChange.bind(this))}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.input.removeEventListener("keydown",this.navOnLR?n:r),this.input.removeEventListener("change",this.onChange.bind(this)),this.input.remove()}focus(){this.input.focus()}getDecimalPlaces(){let e=this.args.column.editorFixedDecimalPlaces;return s.isDefined(e)||(e=t.DefaultDecimalPlaces),e||0===e?e:null}loadValue(t){var e,i,s;this.defaultValue=t[this.args.column.field];let a=this.getDecimalPlaces();null!==a&&(this.defaultValue||0===this.defaultValue)&&null!=(e=this.defaultValue)&&e.toFixed&&(this.defaultValue=this.defaultValue.toFixed(a)),this.input.value=String(null!=(i=this.defaultValue)?i:""),this.input.defaultValue=String(null!=(s=this.defaultValue)?s:""),this.input.select()}serializeValue(){let e=parseFloat(this.input.value);t.AllowEmptyValue?!e&&0!==e&&(e=void 0):e=e||0;let i=this.getDecimalPlaces();return null!==i&&(e||0===e)&&e.toFixed&&(e=parseFloat(e.toFixed(i))),e}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(isNaN(this.input.value))return{valid:!1,msg:"Please enter a valid number"};if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}};e(a,"DefaultDecimalPlaces"),e(a,"AllowEmptyValue",!1);var l=a;function n(t){let e=t.selectionStart,s=t.target.value.length;(t.keyCode===i.LEFT&&e>0||t.keyCode===i.RIGHT&&e<s-1)&&t.stopImmediatePropagation()}function r(t){(t.keyCode===i.LEFT||t.keyCode===i.RIGHT)&&t.stopImmediatePropagation()}var o={Text:class{constructor(t){this.args=t,e(this,"input"),e(this,"defaultValue"),e(this,"navOnLR"),this.init()}init(){this.navOnLR=this.args.grid.getOptions().editorCellNavOnLRKeys,this.input=s.createDomElement("input",{type:"text",className:"editor-text"},this.args.container),this.input.addEventListener("keydown",this.navOnLR?n:r),this.input.focus(),this.input.select(),this.args.compositeEditorOptions&&this.input.addEventListener("change",this.onChange.bind(this))}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.input.removeEventListener("keydown",this.navOnLR?n:r),this.input.removeEventListener("change",this.onChange.bind(this)),this.input.remove()}focus(){this.input.focus()}getValue(){return this.input.value}setValue(t){this.input.value=t}loadValue(t){var e,i;this.defaultValue=t[this.args.column.field]||"",this.input.value=String(null!=(e=this.defaultValue)?e:""),this.input.defaultValue=String(null!=(i=this.defaultValue)?i:""),this.input.select()}serializeValue(){return this.input.value}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}},Integer:class{constructor(t){this.args=t,e(this,"input"),e(this,"defaultValue"),e(this,"navOnLR"),this.init()}init(){this.navOnLR=this.args.grid.getOptions().editorCellNavOnLRKeys,this.input=s.createDomElement("input",{type:"text",className:"editor-text"},this.args.container),this.input.addEventListener("keydown",this.navOnLR?n:r),this.input.focus(),this.input.select(),this.args.compositeEditorOptions&&this.input.addEventListener("change",this.onChange.bind(this))}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.input.removeEventListener("keydown",this.navOnLR?n:r),this.input.removeEventListener("change",this.onChange.bind(this)),this.input.remove()}focus(){this.input.focus()}loadValue(t){var e,i;this.defaultValue=t[this.args.column.field],this.input.value=String(null!=(e=this.defaultValue)?e:""),this.input.defaultValue=String(null!=(i=this.defaultValue)?i:""),this.input.select()}serializeValue(){return parseInt(this.input.value,10)||0}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(isNaN(this.input.value))return{valid:!1,msg:"Please enter a valid integer"};if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}},Float:l,Flatpickr:class{constructor(t){if(this.args=t,e(this,"input"),e(this,"defaultValue"),e(this,"flatpickrInstance"),this.init(),"undefined"==typeof flatpickr)throw new Error("Flatpickr not loaded but required in SlickGrid.Editors, refer to Flatpickr documentation: https://flatpickr.js.org/getting-started/")}init(){var t,e,i;this.input=s.createDomElement("input",{type:"text",className:"editor-text"},this.args.container),this.input.focus(),this.input.select();let a=null==(t=this.args.column.params)?void 0:t.editorOptions;this.flatpickrInstance=flatpickr(this.input,{closeOnSelect:!0,allowInput:!0,altInput:!0,altFormat:null!=(e=null==a?void 0:a.altFormat)?e:"m/d/Y",dateFormat:null!=(i=null==a?void 0:a.dateFormat)?i:"m/d/Y",onChange:()=>{var t,e;if(this.args.compositeEditorOptions){let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}}}),this.args.compositeEditorOptions||window.setTimeout((()=>{this.show(),this.focus()}),50),s.width(this.input,s.width(this.input)-(this.args.compositeEditorOptions?28:18))}destroy(){this.hide(),this.flatpickrInstance&&this.flatpickrInstance.destroy(),this.input.remove()}show(){!this.args.compositeEditorOptions&&this.flatpickrInstance&&this.flatpickrInstance.open()}hide(){!this.args.compositeEditorOptions&&this.flatpickrInstance&&this.flatpickrInstance.close()}focus(){this.input.focus()}loadValue(t){var e,i;this.defaultValue=t[this.args.column.field],this.input.value=String(null!=(e=this.defaultValue)?e:""),this.input.defaultValue=String(null!=(i=this.defaultValue)?i:""),this.input.select(),this.flatpickrInstance&&this.flatpickrInstance.setDate(this.defaultValue)}serializeValue(){return this.input.value}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}},YesNoSelect:class{constructor(t){this.args=t,e(this,"select"),e(this,"defaultValue"),this.init()}init(){this.select=s.createDomElement("select",{tabIndex:0,className:"editor-yesno"},this.args.container),s.createDomElement("option",{value:"yes",textContent:"Yes"},this.select),s.createDomElement("option",{value:"no",textContent:"No"},this.select),this.select.focus(),this.args.compositeEditorOptions&&this.select.addEventListener("change",this.onChange.bind(this))}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.select.removeEventListener("change",this.onChange.bind(this)),this.select.remove()}focus(){this.select.focus()}loadValue(t){this.select.value=(this.defaultValue=t[this.args.column.field])?"yes":"no"}serializeValue(){return"yes"===this.select.value}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return this.select.value!==this.defaultValue}validate(){return{valid:!0,msg:null}}},Checkbox:class{constructor(t){this.args=t,e(this,"input"),e(this,"defaultValue"),this.init()}init(){this.input=s.createDomElement("input",{className:"editor-checkbox",type:"checkbox",value:"true"},this.args.container),this.input.focus(),this.args.compositeEditorOptions&&this.input.addEventListener("change",this.onChange.bind(this))}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}destroy(){this.input.removeEventListener("change",this.onChange.bind(this)),this.input.remove()}focus(){this.input.focus()}loadValue(t){this.defaultValue=!!t[this.args.column.field],this.defaultValue?this.input.checked=!0:this.input.checked=!1}serializeValue(){return this.input.checked}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return this.serializeValue()!==this.defaultValue}validate(){return{valid:!0,msg:null}}},PercentComplete:class{constructor(t){this.args=t,e(this,"input"),e(this,"defaultValue"),e(this,"picker"),e(this,"slider"),this.init()}sliderInputHandler(t){this.input.value=t.target.value}sliderChangeHandler(){var t,e;if(this.args.compositeEditorOptions){let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}}init(){var t;this.input=s.createDomElement("input",{className:"editor-percentcomplete",type:"text"},this.args.container),s.width(this.input,this.args.container.clientWidth-25),this.picker=s.createDomElement("div",{className:"editor-percentcomplete-picker"},this.args.container),s.createDomElement("span",{className:"editor-percentcomplete-picker-icon"},this.picker);let e=s.createDomElement("div",{className:"editor-percentcomplete-helper"},this.picker),i=s.createDomElement("div",{className:"editor-percentcomplete-wrapper"},e);s.createDomElement("div",{className:"editor-percentcomplete-slider"},i),this.slider=s.createDomElement("input",{className:"editor-percentcomplete-slider",type:"range",value:String(null!=(t=this.defaultValue)?t:"")},i);let a=s.createDomElement("div",{className:"editor-percentcomplete-buttons"},i);s.createDomElement("button",{value:"0",className:"slick-btn slick-btn-default",textContent:"Not started"},a),a.appendChild(document.createElement("br")),s.createDomElement("button",{value:"50",className:"slick-btn slick-btn-default",textContent:"In Progress"},a),a.appendChild(document.createElement("br")),s.createDomElement("button",{value:"100",className:"slick-btn slick-btn-default",textContent:"Complete"},a),this.input.focus(),this.input.select(),this.slider.addEventListener("input",this.sliderInputHandler.bind(this)),this.slider.addEventListener("change",this.sliderChangeHandler.bind(this));let l=this.picker.querySelectorAll(".editor-percentcomplete-buttons button");[].forEach.call(l,(t=>{t.addEventListener("click",this.onClick.bind(this))}))}onClick(t){var e,i;this.input.value=String(null!=(e=t.target.value)?e:""),this.slider.value=String(null!=(i=t.target.value)?i:"")}destroy(){var t,e;null==(t=this.slider)||t.removeEventListener("input",this.sliderInputHandler.bind(this)),null==(e=this.slider)||e.removeEventListener("change",this.sliderChangeHandler.bind(this)),this.picker.querySelectorAll(".editor-percentcomplete-buttons button").forEach((t=>t.removeEventListener("click",this.onClick.bind(this)))),this.input.remove(),this.picker.remove()}focus(){this.input.focus()}loadValue(t){var e;this.defaultValue=t[this.args.column.field],this.slider.value=String(null!=(e=this.defaultValue)?e:""),this.input.value=String(this.defaultValue),this.input.select()}serializeValue(){return parseInt(this.input.value,10)||0}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&(parseInt(this.input.value,10)||0)!==this.defaultValue}validate(){return isNaN(parseInt(this.input.value,10))?{valid:!1,msg:"Please enter a valid positive number"}:{valid:!0,msg:null}}},LongText:class{constructor(t){this.args=t,e(this,"input"),e(this,"wrapper"),e(this,"defaultValue"),e(this,"selectionStart",0),this.init()}init(){let t=this.args.compositeEditorOptions;this.args.grid.getOptions().editorCellNavOnLRKeys;let e=t?this.args.container:document.body;if(this.wrapper=s.createDomElement("div",{className:"slick-large-editor-text"},e),t?(this.wrapper.style.position="relative",s.setStyleSize(this.wrapper,"padding",0),s.setStyleSize(this.wrapper,"border",0)):this.wrapper.style.position="absolute",this.input=s.createDomElement("textarea",{rows:5,style:{background:"white",width:"250px",height:"80px",border:"0",outline:"0"}},this.wrapper),t)this.input.addEventListener("change",this.onChange.bind(this));else{let t=s.createDomElement("div",{style:"text-align:right"},this.wrapper);s.createDomElement("button",{id:"save",className:"slick-btn slick-btn-primary",textContent:"Save"},t),s.createDomElement("button",{id:"cancel",className:"slick-btn slick-btn-default",textContent:"Cancel"},t),this.wrapper.querySelector("#save").addEventListener("click",this.save.bind(this)),this.wrapper.querySelector("#cancel").addEventListener("click",this.cancel.bind(this)),this.input.addEventListener("keydown",this.handleKeyDown.bind(this)),this.position(this.args.position)}this.input.focus(),this.input.select()}onChange(){var t,e;let i=this.args.grid.getActiveCell();this.validate().valid&&this.applyValue(this.args.item,this.serializeValue()),this.applyValue(this.args.compositeEditorOptions.formValues,this.serializeValue()),this.args.grid.onCompositeEditorChange.notify({row:null!=(t=null==i?void 0:i.row)?t:0,cell:null!=(e=null==i?void 0:i.cell)?e:0,item:this.args.item,column:this.args.column,formValues:this.args.compositeEditorOptions.formValues,grid:this.args.grid,editors:this.args.compositeEditorOptions.editors})}handleKeyDown(t){if(t.which===i.ENTER&&t.ctrlKey)this.save();else if(t.which===i.ESCAPE)t.preventDefault(),this.cancel();else if(t.which===i.TAB&&t.shiftKey)t.preventDefault(),this.args.grid.navigatePrev();else if(t.which===i.TAB)t.preventDefault(),this.args.grid.navigateNext();else if((t.which===i.LEFT||t.which===i.RIGHT)&&this.args.grid.getOptions().editorCellNavOnLRKeys){let e=this.selectionStart,s=t.target.value.length;t.keyCode===i.LEFT&&0===e&&this.args.grid.navigatePrev(),t.keyCode===i.RIGHT&&e>=s-1&&this.args.grid.navigateNext()}}save(){(this.args.grid.getOptions()||{}).autoCommitEdit?this.args.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}cancel(){var t;this.input.value=String(null!=(t=this.defaultValue)?t:""),this.args.cancelChanges()}hide(){s.hide(this.wrapper)}show(){s.show(this.wrapper)}position(t){s.setStyleSize(this.wrapper,"top",(t.top||0)-5),s.setStyleSize(this.wrapper,"left",(t.left||0)-2)}destroy(){this.args.compositeEditorOptions?this.input.removeEventListener("change",this.onChange.bind(this)):(this.wrapper.querySelector("#save").removeEventListener("click",this.save.bind(this)),this.wrapper.querySelector("#cancel").removeEventListener("click",this.cancel.bind(this)),this.input.removeEventListener("keydown",this.handleKeyDown.bind(this))),this.wrapper.remove()}focus(){this.input.focus()}loadValue(t){this.input.value=this.defaultValue=t[this.args.column.field],this.input.select()}serializeValue(){return this.input.value}applyValue(t,e){t[this.args.column.field]=e}isValueChanged(){return!(""===this.input.value&&!s.isDefined(this.defaultValue))&&this.input.value!==this.defaultValue}validate(){if(this.args.column.validator){let t=this.args.column.validator(this.input.value,this.args);if(!t.valid)return t}return{valid:!0,msg:null}}}};window.Slick&&s.extend(Slick,{Editors:o})})();
"use strict";(()=>{var e=Slick.Utils,s={PercentComplete:(s,n,t)=>e.isDefined(t)&&""!==t?t<50?`<span style="color:red;font-weight:bold;">${t}%</span>`:`<span style="color:green">${t}%</span>`:"-",PercentCompleteBar:(s,n,t)=>{if(!e.isDefined(t)||""===t)return"";let r;return r=t<30?"red":t<70?"silver":"green",`<span class="percent-complete-bar" style="background:${r};width:${t}%" title="${t}%"></span>`},YesNo:(e,s,n)=>n?"Yes":"No",Checkmark:(e,s,n)=>n?'<span class="sgi sgi-check"></span>':"",Checkbox:(e,s,n)=>`<span class="sgi sgi-checkbox-${n?"intermediate":"blank-outline"}"></span>`};window.Slick&&e.extend(Slick,{Formatters:s})})();