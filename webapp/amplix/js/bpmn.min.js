IG$._FC_datagrid=$s.extend(IG$._baseFC,{objtype:"datagrid",events:[{name:"actionClicked",params:[{name:"view",type:"object"},{name:"action",type:"string"},{name:"record",type:"record",label:"record"},{name:"rowindex",type:"integer",label:"rowIndex"},{name:"colindex",type:"integer",label:"columnIndex"}]},{name:"cellclick",params:[{name:"view",type:"object"},{name:"node",type:"object"},{name:"colindex",type:"integer",label:"columnIndex"},{name:"record",type:"record",label:"record"},{name:"rowindex",type:"integer",label:"rowIndex"}]}],properties:[{name:"columns",type:"columns"},{name:"height",type:"integer"}],resize:function(){var e,t,n=this,i=n.ui,a=n.datagrid;i&&(e=i.innerWidth(),t=i.innerHeight(),e&&t&&(e!=n._pw||t!=n._ph)&&(a.setSize(e,t),n._pw=e,n._ph=t))},create:function(e){var t,n=this,i=n.fmodel;n.fitem,n.mcap,i.title;return t=$("<div class='df-datagrid'></div>").appendTo(e),n.datagrid=new IG$.v$pnl({instance:n.instance,renderTo:t[0],layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"m_grid",store:{},flex:1,columns:[]}],listeners:{cellclick:function(e,t,i,a,o,r){n.trigger("cellclick",{view:e,node:t,colindex:i,record:a,rowindex:o,event:r})},scope:n}}),n.ui=t,n.set_height(),setTimeout((function(){n.set_columns()}),10),t},set_columns:function(){var e=this,t=e.fmodel,n=e.datagrid.down("[name=m_grid]"),i=[];e._has_deep_idx=[],$.each(t.columns,(function(t,n){var a={text:n.text||n.name,dataIndex:n.name};"actions"==n.type&&n.actions&&n.actions.length&&(a.xtype="actioncolumn",a.items=[],$.each(n.actions,(function(t,n){var i={iconCls:"icon-grid-"+n,handler:function(t,i,a){e.trigger("actionClicked",{view:t,action:n,node:t.store.data.items[i],rowindex:i,colindex:a})},scope:this};a.items.push(i)}))),a.dataIndex.indexOf(".")>0&&e._has_deep_idx.push(n),n.width&&(a.width=n.width),i.push(a)})),n.reconfigure(n.store,i)},set_height:function(){var e=this,t=(e.fitem,e.fmodel.options.height);e.ui.css({minHeight:t?t+"px":"30px"}),t&&e.container&&e.container.innerHeight(t)},setValue:function(e){var t=this.datagrid.down("[name=m_grid]");this._has_deep_idx&&this._has_deep_idx.length&&e&&$.each(this._has_deep_idx,(function(t,n){var i=n.name.split(".");$.each(e,(function(e,t){var a=t;$.each(i,(function(e,t){if(a&&(a=a[t]),!a)return!1})),t[n.name]=a}))})),t.store.loadData(e)},$setProp:function(e,t,n){switch(t){case"columns":this.set_columns();break;case"height":this.set_height()}IG$._baseFC.prototype.$setProp.call(this,e,t,n)}}),IG$.$FCinst.datagrid=new IG$._FC_datagrid;
IG$.bpmnForm=$s.extend(IG$.v$pnl,{scroll:!1,closable:!0,layout:"fit",_atimer:100,ru_init_f:function(){var n=this,e=new IG$._rpc$;e.init(n,{ack:"bpmn",payload:{option:"initialize"},mbody:{}},n,(function(e){n.uid?n.ru_lc():(n._mc={meta_type:"bpmn_form",content:{meta_type:"bpmn_form",cube_objects:[],form_items:[]}},n.ru_idr())})),e.send()},ru_idr:function(){var n,e,t,i=this,o=i.mainarea.el.dom,s=i._mc.content;s.form_items=s.form_items||[],t={model:{filter_items:s.form_items}},$(o).empty(),i.container=n=$("<div class='bpmn-form-content'></div>").appendTo(o),i.container.addClass("igc_view_mode"),i.formview=e=new IG$.dynFilterView(i.instance,n,t,s,2),e.callback=new IG$.callBackObj(i,(function(){})),e.init_f(!0),e.container.bind({i_ready:function(){(i._mc.content.events?i._mc.content.events.onload:null)&&i._proc_events(i._mc.content.events.onload,"onload")},i_c_event:function(n,e,t,o,s){var a=t.model,c=a&&a.events?a.events[o]:null;c&&i._proc_events(c,t.fuid)}})},_proc_events:function(n,e){var t=[];this.$actions&&this.$actions.length,n.actions&&($.each(n.actions,(function(n,e){t.push(e)})),this.$actions=t,this._do_actions())},_do_actions:function(){var n,e=this;e.$actions&&e.$actions.length?(n=e.$actions.shift(),e.setLoading(!0),e._proc_action(n)):e.setLoading(!1)},_proc_action:function(n,e){var t=this,i=!0,o=n.options||{};switch(n.purpose){case"thread_start":for(n.$actions=[];;){var s=t.$actions[0];if(!s)break;if("thread_end"==s.purpose){t.$actions.shift();break}"thread_start"==s.purpose||(t.$actions.shift(),n.$actions.push(s))}if(n.$actions.length){var a=new IG$.callBackObj(this,(function(i,o){!0===o&&(n.has_error=o),$.each(n.$actions,(function(o,s){if(s==i)return n.$actions.splice(o,1),0==n.$actions.length&&(n.has_error?t._close_actions():t._do_next(n,e)),!1}))}));n.has_error=!1,$.each(n.$actions,(function(n,e){t._proc_action(e,a)})),i=!1}break;case"rest":t=this;var c=new IG$._rpc$;c.init(t,{ack:"bpmn",payload:{option:"rest_call"},mbody:{service_uid:o.rest_service_uid,endpoint:o.endpoint_name,method:o.endpoint_method}},t,(function(i){t._do_next(n,e)}),(function(i){e?e.execute(n,!0):t._close_actions()})),c.send();break;case"messagebox":t.setLoading(!1),IG$.confirmMessages(ig$.appname,o.message||"",(function(i){if("yes"==i){if(t.$actions[0]&&"message_cond_ok"==t.$actions[0].purpose)for(t.$actions.shift();;){if(!(a=t.$actions[0]))break;if("message_cond_cancel"==a.purpose)o=!0,t.$actions.shift();else{if("message_cond_end"==a.purpose){t.$actions.shift();break}o&&t.$actions.shift()}}t._do_next(n,e)}else{var o;if($.each(t.$actions,(function(n,e){return"message_cond_end"==e.purpose||"message_cond_cancel"==e.purpose?(o=!0,!1):void 0})),o){for(var s=!1;;){var a;if(!(a=t.$actions[0]))break;if("message_cond_end"==a.purpose){t.$actions.shift();break}"message_cond_cancel"==a.purpose?(s=!0,t.$actions.shift()):s||t.$actions.shift()}t._do_next(n,e)}else t._close_actions()}})),i=!1}return i&&!e&&t._do_next(n),i},_do_next:function(n,e){var t=this;e?e.execute(n,!1):setTimeout((function(){t._do_actions()}),t._atimer)},_close_actions:function(){this.setLoading(!1),this.$actions=null},ru_lc:function(){var n=this,e=new IG$._rpc$;e.init(n,{ack:"content",payload:{uid:n.uid},mbody:{}},n,(function(e){n._mc=e,n.ru_idr()})),e.send()},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:10,flex:1,items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1,layout:"border",items:[{xtype:"container",name:"mainarea",region:"center",flex:1,listeners:{resize:function(n,e,t,i){e&&t&&this.formview&&this.formview.updateDisplay()},scope:this}}]}]}]}],listeners:{afterrender:function(){this.mainarea=this.down("[name=mainarea]"),this.ru_init_f()},scope:this}}),IG$.bpmnForm.superclass.initComponent.call(this)}});