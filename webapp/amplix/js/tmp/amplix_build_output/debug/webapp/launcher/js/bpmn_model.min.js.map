{"version":3,"sources":["jquery.jsPlumb-2.1.2.js","bflow.js","bpmn_prop.js","bpmn_modeler.js","bpmn_tasks.js","bpmn_monitor.js","bpmn_form.js"],"names":["Math","sgn","x","Vectors","v1","v2","y","v","sqrt","s","flatnessTolerance","pow","_distanceFromCurve","point","curve","candidates","w","_convertToBezier","degree","length","numSolutions","_findRoots","dist","t","i","_bezier","newDist","location","distance","higherDegree","c","d","cdTable","z","row","column","parseFloat","n","m","k","lb","max","ub","min","j","depth","left_count","right_count","left","right","left_t","right_t","_getCrossingCount","_isFlatEnough","_computeXIntercept","sign","old_sign","n_crossings","intercept_1","intercept_2","left_intercept","a","b","a2","b2","max_distance_above","max_distance_below","value","XNM","YNM","XMK","temp","_curveFunctionCache","_pointOnPath","cc","order","fns","c_term","t_term","one_minus_t_term","_termFunc","terms","p","push","_getCurveFunctions","_x","_y","_dist","p1","p2","_isPoint","_pointAlongPath","prev","tally","curLoc","direction","cur","abs","_gradientAtPoint","slice","dy","dx","Infinity","atan","this","jsBezier","distanceFromCurve","gradientAtPoint","gradientAtPointAlongCurveFrom","nearestPointOnCurve","td","pointOnCurve","pointAlongCurveFrom","perpendicularToCurveAt","_theta2","sin","cos","locationAlongCurveFrom","getLength","call","window","Biltong","_isa","Object","prototype","toString","_pointHelper","fn","_gradient","gradient","_p1","_p2","_quadrant","normal","lineLength","quadrant","_segmentMultipliers","theta","PI","intersects","r1","r2","x1","x2","y1","y2","h","a1","b1","encloses","allowSharedEdges","v3","v4","_inverseSegmentMultipliers","pointOnLine","fromPoint","toPoint","segmentMultiplier","perpendicularLineTo","theta2","root","Sniff","navigator","userAgent","toLowerCase","indexOf","matchesSelector","el","selector","ctx","possibles","parentNode","querySelectorAll","_gel","constructor","String","document","getElementById","_t","e","srcElement","target","_pi","obj","doCompute","path","end","out","_one","_d","l","splice","guid","_store","event","g","__ta","__tauid","_curryChildFilter","children","evt","split","_fn","pathInfo","apply","arguments","registerExtraFunction","newFn","__taExtra","DefaultHandler","isTouchDevice","touchMap","tfn","_bind","getAttribute","setAttribute","_tapProfiles","tap","touches","taps","dbltap","contextmenu","TapHandler","clickThreshold","dblClickThreshold","isMouseDevice","__taTapHandler","tt","down","downSelectors","clearSingle","clearDouble","finished","setTimeout","tc","_touchCount","eventId","hasOwnProperty","pLoop","__taUnstore","meeHelper","type","__tamee","MouseEnterExitHandler","activeElements","over","mouseenter","mouseexit","relatedTarget","toElement","documentElement","mousedown","mouseup","mousemove","iev","rv","appName","ua","RegExp","exec","$1","isIELT9","_genLoc","prefix","ts","_touches","_getTouch","_pageLocation","clientX","scrollLeft","clientY","scrollTop","idx","item","changedTouches","targetTouches","originalFn","addEventListener","attachEvent","key","_unbind","_each","_el","_unstore","removeEventListener","detachEvent","__taTouchProxy","Window","top","tagName","Mottle","params","mouseEnterExitHandler","tapHandler","_smartClicks","smartClicks","_doBind","__taSmartClicks","__tad","__tau","SmartClickHandler","remove","removeChild","on","off","trigger","originalEvent","payload","originalIsMouse","MouseEvent","eventToBind","bindingAMouseEvent","pl","sl","cl","_clientLocation","screenX","screenY","_decorate","_evt","eventGenerators","TouchEvent","touch","createTouch","createTouchList","initTouchEvent","MouseEvents","initMouseEvent","createEvent","evtName","dispatchEvent","createEventObject","eventType","eventName","fireEvent","consume","doNotPreventDefault","stopPropagation","returnValue","preventDefault","pageLocation","setForceTouchEvents","setForceMouseEvents","_suggest","list","head","unshift","_vanquish","_isString","f","isIE9","_pl","pageX","pageY","_classes","draggable","droppable","drag","selected","active","hover","noSelect","ghostProxy","_events","_devNull","_true","_foreach","from","_setDroppablesActive","dd","val","andHover","setActive","updatePosition","setHover","_consume","Super","css","scope","addClass","_class","uuid","_uuid","enabled","setEnabled","isEnabled","toggleEnabled","setScope","scopes","addScope","removeScope","toggleScope","katavorio","TRUE","FALSE","Drag","rightButtonCanDrag","constrain","downAt","posAtDown","pagePosAtDown","pageDelta","moving","consumeStartEvent","dragEl","clone","_multipleDrop","scroll","multipleDrop","isConstrained","useGhostProxy","snapThreshold","_snap","pos","thresholdX","thresholdY","_dxl","floor","_dxt","_dyl","_dyt","posses","posseRoles","toGrid","grid","snap","getPosition","setPosition","setUseGhostProxy","revertFunction","negativeFilter","allowNegative","_setConstrain","constrainRect","size","bind","containment","setConstrain","setRevert","_filters","_setFilter","setFilter","_exclude","_katavorioId","addFilter","removeFilter","clearAllFilters","canDrag","matchingDroppables","intersectingDroppables","downListener","elem","box","body","docElem","clientTop","clientLeft","which","button","_f","_testFilter","_katavorio","getInputFilterSelector","_inputFilter","cloneNode","style","position","getBoundingClientRect","pageYOffset","pageXOffset","round","appendChild","moveListener","upListener","markSelection","markPosses","_dispatch","consumeFilteredEvents","mark","ignoreZoom","getZoom","moveBy","updateSelection","updatePosses","unbind","removeClass","unmark","unmarkSelection","unmarkPosses","stop","notifySelectionDragStop","notifyPosseDragStop","getFilters","abort","getDragElement","listeners","start","beforeStart","revert","events","ghostProxyOffsets","notifyStart","force","positions","sel","getSelection","dPos","finalPos","selection","andNotify","getSize","getMatchingDroppables","dragClass","cs","notifySelectionDragStart","doNotCheckDroppables","offsetLeft","offsetTop","drop","desiredLoc","cPos","gp","rect","pageRect","focusDropElement","pagePosition","canDrop","isHover","destroy","handle","filter","filterExclude","Drop","_activeClass","activeClass","_hoverClass","hoverClass","allowLoopback","_katavorioDragHover","replace","r","random","Katavorio","katavorioParams","_selection","_selectionMap","_dragsByScope","_dropsByScope","_zoom","_reg","map","_obj","_unreg","_prepareParams","_m","_dd","_p","_mistletoe","existingDrag","_css","overrideCss","_scope","inputFilterSelector","setInputFilterSelector","o","_katavorioDrag","_katavorioDrop","select","deselect","_s","deselectAll","_posses","members","_posseAction","setZoom","_scopeManip","kObj","_kObj","snapToGrid","getDragsForScope","getDropsForScope","_destroy","elementRemoved","destroyDraggable","destroyDroppable","reset","_processOneSpec","_spec","dontAddExisting","posseId","id","posse","name","addToPosse","spec","setPosse","diff","l1","l2","_difference","Array","removeFromPosse","TypeError","removeFromAllPosses","setPosseState","state","_iss","_isb","_iso","_isd","_isf","exports","jsPlumbUtil","isArray","isString","isBoolean","isNull","isObject","isDate","isFunction","isEmpty","isNumber","Date","getTime","merge","collations","ar","cMap","inObj","term","lc","str","array","match","_getArray","functionChain","successValue","failValue","populate","model","values","functionPrefix","fromString","matches","substring","getValue","findWithFunction","removeWithFunction","addWithFunction","hashFunction","addToList","insertAtStart","suggest","insertAtHead","extend","child","parent","_protoFn","_makeFn","protoFn","_oneSet","logEnabled","log","console","wrap","wrappedFunction","newFunction","returnOnThisValue","EventGenerator","_listeners","eventsSuspended","eventsToDieOn","ready","listener","__jsPlumb","fire","_gone","ret","shouldFireEvent","eventOrListener","getListener","forEvent","setSuspendEvents","isSuspendEvents","silently","cleanupListeners","cleanup","sizeElement","height","width","rendererTypes","connectorTypes","_ju","_timestamp","_updateHoverStyle","component","_jsPlumb","paintStyle","hoverPaintStyle","mergedHoverStyle","jsPlumb","fillStyle","_splitType","_mapType","typeId","_applyTypes","doNotRepaint","getDefaultType","getTypeDescriptor","defType","types","tid","instance","getType","applyType","repaint","jsPlumbUIComponent","idPrefix","parameters","paintStyleInUse","beforeDetach","beforeDrop","overlayPlacements","Defaults","HoverClass","typeCache","cacheTypeItem","getCachedTypeItem","getId","overlays","oo","defaultOverlayKeys","fo","convertToFullOverlaySpec","_defaultType","getDefaultScope","appendToDefaultType","create","isDetachAllowed","connection","isDropAllowed","sourceId","targetId","dropEndpoint","source","checkCondition","domListeners","setListenerComponent","_removeTypeCssHelper","typeIndex","cssClass","canvas","getParameter","setParameter","getParameters","setParameters","getClass","hasClass","clazz","updateClasses","classesToAdd","classesToRemove","setType","clearTypes","reapplyTypes","hasType","addType","_cont","removeType","toggleType","setPaintStyle","setHoverPaintStyle","getPaintStyle","getHoverPaintStyle","ignoreAttachedElements","timestamp","currentlyDragging","isHoverSuspended","method","isSuspendDrawing","recalc","getAttachedElements","sourceElement","affectedElements","_updateAttachedElements","_jsPlumbInstanceIndex","jsPlumbInstance","_defaults","Anchor","Anchors","ConnectionsDetachable","ConnectionOverlays","Connector","Container","DoNotThrowErrors","DragOptions","DropOptions","Endpoint","EndpointOverlays","Endpoints","EndpointStyle","EndpointStyles","EndpointHoverStyle","EndpointHoverStyles","HoverPaintStyle","LabelStyle","color","LogEnabled","Overlays","MaxConnections","PaintStyle","lineWidth","strokeStyle","ReattachConnections","RenderMode","Scope","_connectionTypes","_endpointTypes","_currentInstance","_instanceIndex","getInstanceIndex","_bb","_initialDefaults","_info","nodeType","text","getElement","_getId","repaintEverything","_container","_containerDelegations","unbindContainer","setContainer","each","conn","moveParent","selectEndpoints","ep","previousContainer","eventAliases","endpointclick","endpointdblclick","_oneDelegateHandler","componentType","jp","alias","_addOneDelegate","_oneDelegate","elId","managedElements","getContainer","initialized","importDefaults","restoreDefaults","connections","endpointsByElement","endpointsByUUID","offsets","offsetTimestamps","draggableStates","connectionBeingDragged","sizes","_suspendDrawing","_suspendedAt","DEFAULT_SCOPE","_curIdStamp","_idstamp","_appendElement","appendToRoot","_draw","element","ui","clearEdits","headless","repaintEls","getDragManager","getElementsForDraggable","_updateOffset","offset","anchorManager","redraw","_getEndpoint","_prepareConnectionParams","referenceParams","endpoint","sourceEndpoint","targetEndpoint","uuids","isFull","connectionType","connectorOverlays","connectorPointerEvents","_addEndpoint","def","addEndpoint","_mergeOverrides","anchor","anchors","endpoints","endpointStyles","endpointStyle","endpointHoverStyles","endpointHoverStyle","_oneElementDef","defs","matchType","newConnection","tep","newEndpoint","_doNotDeleteOnDetach","_deleteOnDetach","uniqueEndpoint","finalEndpoint","sourceEndpointDefinitions","targetEndpointDefinitions","e1","e2","s1","s2","_scopeMatch","_newConnection","connectionFunc","ConnectionType","getDefaultConnectionType","_newEndpoint","finaliseConnection","_finaliseConnection","con","isDetachable","initDraggable","jpc","doInformAnchorManager","suspendedEndpoint","pending","isTemporarySource","doNotFireConnectionEvent","eventArgs","endpointFunc","EndpointType","fireDetachEvent","elementId","_manage","endpointAdded","_operation","func","ii","jj","_setVisible","alsoChangeEndpoints","setVisible","info","oidx","isVisible","doNotCreateIfNotFound","undefined","setConnectionBeingDragged","isConnectionBeingDragged","getManagedElements","getRenderMode","connectorClass","connectorOutlineClass","editableConnectorClass","connectedClass","endpointClass","endpointConnectedClass","endpointFullClass","endpointDropAllowedClass","endpointDropForbiddenClass","overlayClass","draggingClass","elementDraggingClass","sourceElementDraggingClass","targetElementDraggingClass","endpointAnchorClassPrefix","hoverSourceClass","hoverTargetClass","dragSelectClass","Connectors","svg","ConnectorRenderers","SVG","results","inputs","_ensureContainer","myOffset","paint","anchorLoc","compute","xy","wh","addEndpoints","animate","properties","options","animationSupported","del","stepFunction","animEvents","step","completeFunction","complete","revalidate","doAnimate","conditionName","args","connect","stTypes","epDefs","_set","sid","sep","_st","cId","oldEndpoint","evtParams","index","originalSourceId","newSourceId","originalTargetId","newTargetId","addConnection","makeEndpoint","detachFromConnection","fireMoveEvent","setSource","sourceChanged","setTarget","updateOtherEndpoint","deleteEndpoint","object","dontUpdateHover","deleteAttachedObjects","deleteObject","deleteEveryEndpoint","_is","setSuspendDrawing","doFireEvent","connType","connectionDetached","unregisterEndpoint","newEndpoints","detach","firstArgIsConnection","forceDetach","ignoreTarget","detachFrom","detachAllConnections","detachAll","detachEveryConnection","batch","result","endpointCount","connectionCount","unravelConnection","unravelEndpoint","_c","doNotCleanup","isDraggable","dragOptions","isDragSupported","isAlreadyDraggable","dragEvent","dragEvents","stopEvent","startEvent","_del","_ancestor","getDragAncestor","_noOffset","_ancestorOffset","_started","getOffset","setHoverSuspended","getUIPosition","_e","elements","uip","dragEnded","disabled","register","_initDraggableIfNecessary","initDroppable","setter","_setOperation","getter","_getOperation","prepareList","input","doNotGetIds","filterList","missingIsFalse","getConnections","flat","sources","targets","_addOne","ss","proxies","originalEp","_curryEach","executor","_curryGet","_makeCommonSelectHandler","get","setters","getters","_makeConnectionSelectHandler","common","setDetachable","setReattach","setConnector","isReattach","_makeEndpointSelectHandler","setAnchor","noElementFilters","either","sourceMatchExact","targetMatchExact","inner","_ep","noMatchSource","isSource","noMatchTarget","isTarget","getAllConnections","getEndpoint","getEndpoints","getDefaultEndpointType","Connection","appendElement","_hoverSuspended","hide","changeEndpoints","idstamp","connectorsInitialized","registerConnectorType","connector","candidate","can","offsetParent","manage","_transient","updateOffset","bottom","centerx","centery","init","getRenderModes","_oneType","renderer","AnchorManager","makeAnchor","pp","_a","msg","specimen","newAnchor","getOrientation","DynamicAnchor","anchorParams","orientation","makeAnchors","makeDynamicAnchor","anchorSelector","_makeElementDropHandler","elInfo","dropOptions","proxyComponent","_drop","EndpointDropHandler","targetCount","maxConnections","onDrop","locked","isRedrop","suspendedElement","eps","deriveEndpointAndAnchorSpec","join","_mtNew","positionFinder","dropPosition","elPosition","elSize","ap","constructorParams","maybeCleanup","dropEvent","_drag","_jsPlumbRelatedElement","makeTarget","deleteEndpointsOnDetach","_doOne","elid","_def","targetDef","unmakeTarget","doNotClearArrays","makeSource","aae","onMaxConnections","existingStop","endpointAddedButNoDragYet","anchorDef","oldAnchor","oldConnection","mouseDownListener","_instance","negate","ok","getSelector","selectorFilter","sourceCount","elxy","getPositionOnElement","tempEndpointParams","_delTempEndpoint","extract","att","setDragFilter","unmakeSource","eldefs","unmakeEverySource","_getScope","_setScope","getScope","getSourceScope","getTargetScope","setSourceScope","setTargetScope","setDragScope","setDropScope","unmakeEveryTarget","_setEnabled","toggle","_first","toggleSourceEnabled","isSourceEnabled","setSourceEnabled","toggleTargetEnabled","isTargetEnabled","setTargetEnabled","_elEach","isIdAlready","removeAllEndpoints","recurse","ebe","childNodes","_doRemove","clearFor","removeFloatingConnection","floatingConnections","removeElement","ae","empty","dontRemoveFocus","removeAllGroups","removeGroupManager","doReset","_clearObject","clear","setDefaultScope","setDraggable","setElementDraggable","dontPrependDefault","bits","as","setId","newId","doNotSetAttribute","sConns","tConns","setElementId","setReferenceElement","changeId","_conns","epIdx","setDebugLog","debugLog","repaintAfterwards","curVal","getSuspendedAt","doNotRepaintAfterwards","_wasSuspended","doWhileSuspended","getCachedData","show","toggleVisible","toggleDraggable","addListener","registerConnectionType","to","registerConnectionTypes","registerEndpointType","registerEndpointTypes","typeDescriptor","setIdChanged","oldId","setParent","newParent","_dom","_id","_pdom","_pid","o1","o2","names","getFloatingAnchorIndex","isFloating","getInstance","define","module","SVGAngle","implementation","hasFeature","DragManager","_draggables","_dlist","_delements","_elementsWithEndpoints","_draggablesForElements","parentOffset","_oneLevel","cEl","cid","cOff","updateOffsets","childOffsetOverrides","domEl","cel","pid","pLoc","cLoc","endpointDeleted","ancestor","pId","currentChildLocation","current","clearParent","revalidateParent","childOffset","co","de","aid","_setClassName","cn","className","baseVal","_getClassName","_classManip","curClasses","add","classes","screenLocation","clientLocation","dragManager","recalculateOffsets","createElement","tag","atts","createElementNS","ns","attName","setAttributes","node","classList","contains","toAdd","toRemove","setClass","prop","getStyle","getComputedStyle","getPropertyValue","currentStyle","relativeToRoot","container","op","_maybeAdjustScroll","zoom","offsetWidth","offsetHeight","getAbsolutePosition","setAbsolutePosition","animateFrom","animateOptions","getWidth","getHeight","_jp","_internalLabelOverlayId","OverlayCapableJsPlumbUIComponent","overlayPositions","label","labelLocation","defaultLabelLocation","labelStyle","keep","existing","updateFrom","reattach","addOverlay","removeOverlay","overlay","_newOverlay","_processOverlay","getOverlay","getOverlays","hideOverlay","hideOverlays","showOverlay","showOverlays","removeAllOverlays","overlayId","dontCleanup","removeOverlays","bgCanvas","isAppendedAtTopLevel","getLabel","lo","getLabelOverlay","setLabel","Function","setLocation","_params","mergedParams","Label","_makeLabelOverlay","setAbsoluteOverlayPosition","getAbsoluteOverlayPosition","_clazzManip","action","dontUpdateOverlays","typeParameters","connectorStyle","connectorHoverStyle","connectorHoverClass","connectorTooltip","visible","floatingEndpoint","dragProxy","connectionCost","connectionsDirected","currentAnchorClass","_updateAnchorClass","oldAnchorClass","getCssClass","anchorClass","prepareAnchor","currentAnchor","setPreparedAnchor","continuousAnchorFactory","internalHover","prepareEndpoint","rm","endpointArgs","tooltip","setEndpoint","setPreparedEndpoint","reattachConnections","connectionsDetachable","detachable","dragAllowedWhenFull","_forceDeleteOnDetach","connectionIndex","endpointBeingDeleted","actuallyDetached","_forceDetach","unaffectedConns","setElement","parentId","curId","rehomeEndpoint","makeInPlaceCopy","loc","getCurrentLocation","acc","inPlaceAnchor","hideOnDrag","reference","connectorSelector","setStyle","anchorPoint","connectorPaintStyle","dimensions","isDynamic","elementWithPrecedence","findConnectionToUseForDynamicAnchor","oIdx","oId","oInfo","oOffset","oWH","txy","twh","tElement","draw","draggingInitialised","placeholderInfo","existingJpc","existingJpcParams","_dragHandler","placeholder","stopped","_ui","stopDrag","_makeConnectionDragHandler","beforeStartEvent","startParams","_continue","beforeDrag","ipco","canvasElement","ips","_makeDraggablePlaceholder","dragId","endpointToFloat","centerAnchor","referenceAnchor","referenceCanvas","FloatingAnchor","_makeFloatingEndpoint","_savedAnchor","data","anchorIdx","dragScope","getDragScope","suspendedElementId","suspendedElementType","referenceEndpoint","getDropEvent","deleteConnectionNow","floatingElement","floatingId","floatingIndex","fe","_forceReattach","deleteAfterDragStop","visibility","beforeStartParams","anchorParamsToUse","_initDropTarget","isTransient","isDropSupported","overEvent","outEvent","dhParams","getDragObject","_jpc","bb","doNotChangeConnections","doNotNotifyOtherEndpoint","display","isConnectedTo","found","getConnectionCost","setConnectionCost","areConnectionsDirected","setConnectionsDirected","_elId","setDragAllowedWhenFull","allowed","equals","getUuid","computeAnchor","existingConnection","_doContinue","continueFunction","optionalData","aParam","originalSourceEndpoint","newSourceEndpoint","originalTargetEndpoint","newTargetEndpoint","mergeData","makeConnector","renderMode","connectorName","connectorArgs","forComponent","_makeAnchor","_updateConnectedClass","_jsPlumbConnections","previousConnection","editable","editorParams","lastPaintedAt","editableRequested","setEditable","isEditable","isEditing","eS","eT","_detachable","_reattach","myInfo","myWH","otherInfo","otherOffset","otherWH","initialTimestamp","cost","directed","geometry","setGeometry","getData","setData","_types","test","updateConnectedClass","typeMap","_anchors","informEndpoints","getUuids","getCost","setCost","isDirected","getConnector","getGeometry","prepareConnector","connectorSpec","setPreparedConnector","doNotChangeListenerComponent","previous","previousClasses","transfer","tId","sId","sourceInfo","targetInfo","sE","tE","sAnchorP","tAnchorP","resetBounds","sourcePos","targetPos","overlayExtents","minX","minY","maxX","maxY","outlineWidth","extents","xmin","bounds","ymin","xmax","ymax","es","outlineColor","ehs","drawEndpoints","_amEndpoints","continuousAnchorLocations","userDefinedContinuousAnchorLocations","continuousAnchorOrientations","Orientation","axes","connectionsByElementId","self","anchorLists","calculateOrientation","sd","sourceAnchor","targetAnchor","atan2","midpoints","dim","sf","tf","sort","sourceEdge","targetEdge","isContinuous","isEdgeSupported","currySort","reverseAngles","edgeSortFunctions","placeAnchors","_anchorLists","cd","sS","sO","placeSomeAnchors","desc","elementDimensions","elementPosition","unsortedConnections","isHorizontal","otherMultiplier","horizontal","reverse","other","xp","yp","placeAnchorsOnLine","_setAnchorLocation","anchorPos","weAreSource","weAreTarget","addFloatingConnection","doRegisterTarget","registerConnection","otherIndex","otherEndpoint","otherAnchor","removeEndpointFromAnchorLists","eId","connInfo","doNotRedraw","removeConnection","getConnectionsFor","getEndpointsFor","_updateAnchorList","lists","aBoolean","otherElId","edgeId","connsToPaint","endpointsToPaint","firstMatchingElIdx","endpointId","listToAddTo","listToRemoveFrom","_continuousAnchorEdge","rIdx","insertIdx","sourceElId","oldTargetId","sIndex","tIndex","originalId","newElement","tIdx","currentId","offsetToUI","doNotRecalcEndpoint","endpointConnections","connectionsToPaint","anchorsToUpdate","orientationCache","sourceContinuous","targetContinuous","oKey","getDefaultFace","fc","ContinuousAnchor","faces","clockwise","availableFaces","opposites","clockwiseOptions","antiClockwiseOptions","secondBest","lastChoice","verifyEdge","edge","clearUserDefinedLocation","setUserDefinedLocation","userDefinedLocation","lastReturnValue","ao","getUserDefinedLocation","ref","refCanvas","_lastResult","_endpoint","getAnchors","_curAnchor","_lastAnchor","_distance","cx","cy","ax","ay","acx","acy","_anchorSelector","minIdx","minDist","udl","_curryAnchor","ox","oy","fnInit","DynamicAnchors","AutoDefault","_curryContinuousAnchor","Continuous","pf","AnchorPositionFinders","Fixed","dp","Grid","gx","gy","mx","my","Perimeter","anchorCount","shape","Error","_circle","_path","segments","anchorsPerFace","_computeFace","fractionalLength","_shape","_rectangle","_shapes","Circle","Ellipse","Diamond","Rectangle","Square","Triangle","Path","points","tl","da","rotation","amountInDegrees","_rotate","_jg","Segments","AbstractSegment","findClosestPointOnPath","getBounds","Straight","m2","getGradient","getCoordinates","setCoordinates","coords","pointOnPath","absolute","_","pointAlongPathFrom","farAwayPoint","within","closest","_x1","_y1","fractionInSegment","Arc","_calcAngle","TWO_PI","radius","anticlockwise","ac","startAngle","endAngle","ea","sweep","circumference","frac","gentleRound","ceil","angle","segment","sa","_calcAngleForLocation","arcSpan","dir","Bezier","cp1x","cp1y","cp2x","cp2y","_translateLocation","_curve","AbstractComponent","AbstractConnector","totalLength","segmentProportions","segmentProportionalLengths","stub","sourceStub","targetStub","gap","sourceGap","targetGap","userProvidedSegments","edited","paintInfo","ConnectorEditors","_setGeometry","internallyComputed","_getGeometry","hasBeenEdited","editor","isActive","overrideSetEditable","findSegmentForPoint","_findSegmentForLocation","inSegmentProportion","proportion","setSegments","_segs","_prepareCompute","swapX","swapY","lw","so","oIndex","sx","sy","tx","ty","oProduct","xSpan","ySpan","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","opposite","perpendicular","orthogonal","sourceAxis","anchorOrientation","getSegments","updateBounds","segBounds","seg","_compute","_updateSegmentProportions","addSegment","prepareCompute","maxStub","maxGap","_super","AbstractEndpoint","Dot","defaultOffset","defaultInnerRadius","DOMElementEndpoint","displayElements","getDisplayElements","appendDisplayElement","Image","_onload","onload","src","url","img","deleted","widthToUse","heightToUse","setImage","_img","margin","padding","outline","actuallyPaint","Blank","background","AbstractOverlay","endpointLoc","endpointLocation","incrementLocation","amount","getLocation","Arrow","foldback","computeMaxSize","elementCreated","currentConnectionPaintStyle","hxy","mid","tail","parseInt","fromLoc","__","cxy","PlainArrow","SingleLine","DoubleLine","_getDimensions","forceRefresh","cachedDimensions","getDimensions","AbstractDOMOverlay","detached","div","initialised","initiallyInvisible","webkitTransform","mozTransform","msTransform","oTransform","transform","absolutePosition","locToUse","minx","miny","clearCachedDimensions","containerExtents","Custom","GuideLines","tailLine","headLine","labelText","font","borderWidth","dStyle","borderStyle","border","update","lt","innerHTML","getEventManager","_mottle","callback","_jpi","GROUP_COLLAPSED_CLASS","GROUP_EXPANDED_CLASS","STOP","REVERT","GROUP_MANAGER","GROUP","EVT_CHILD_ADDED","GroupManager","_managedGroups","_connectionSourceMap","_connectionTargetMap","group","getMembers","_cleanupDetachedConnection","addGroup","manager","_updateConnectionsForGroup","addToGroup","doNotFireEvent","getGroup","removeFromGroup","groupId","getGroups","removeGroup","deleteMembers","expandGroup","getEl","_groups","_collapseConnection","collapseConnection","proxyEp","groupEl","groupElId","originalElementId","otherEl","shouldProxy","collapsed","getAnchor","isProxyEndpoint","collapseGroup","_collapseSet","conns","_expandConnection","expandConnection","originalElement","c1","c2","processed","oneSet","_jsPlumbGroup","_expandSet","repaintGroup","updateConnectionsForGroup","refreshAllGroups","Group","_isJsPlumbGroup","dragArea","ghost","orphan","prune","dropOverride","proxied","internal","endpointIndex","opts","groupManager","getGroupManager","currentGroup","elpos","cpos","overrideDrop","handleDroppedConnections","els","_isInsideParent","_findParent","leftEdge","rightEdge","topEdge","bottomEdge","_orphan","_unbindDragHandlers","_pruneOrOrphan","_revalidate","_bindDragHandlers","__el","targetGroup","manipulateDOM","removeAll","orphanAll","dragParams","toggleGroup","mgr","getGroupFor","Flowchart","midpoint","alwaysRespectStubs","lastx","lasty","cornerRadius","loopbackRadius","lx","ly","sgnx","sgny","segLength","_cloneArray","commonStubCalculator","stubCalculators","axis","pi","stubs","oss","oes","midx","midy","orientations","lineCalculators","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","_so","_to","otherFlipped","stub1","stub2","segmentIndexes","startStub","otherStartStub","endStub","otherEndStub","extent","otherAxis","comparator","toUpperCase","_val","next","radiusToUse","sgnEqual","writeSegments","AbstractBezierConnector","showLoopback","curviness","proximityLimit","isLoopbackCurrently","sp","tp","_w","_h","loopback","_computeBezier","majorAnchor","minorAnchor","getCurviness","_findControlPoint","sourceAnchorPosition","targetAnchorPosition","soo","too","_CP","_CP2","_sx","_sy","_tx","_ty","controlPoints","StateMachine","_controlPoint","_midx","_midy","svgAttributeMap","STROKE_DASHARRAY","DASHSTYLE","FILL","STROKE","NONE","_attr","attributes","_node","version","xmlns","_pos","_clearGradient","_applyStyles","uiComponent","gradientUnits","stops","styleToUse","stopColor","applyGradientTo","_updateGradient","parts","forEach","_appendAtIndex","insertBefore","attr","SvgComponent","pointerEventsSpec","originalArgs","svgParams","useDivWrapper","class","_superSetEditable","SegmentRenderer","getPath","outlineStyle","outlineStrokeWidth","bgPath","laf","SvgEndpoint","strokeWidth","makeNode","updateNode","AbstractSvgArrowOverlay","superclass","makePath","stroke","fill","isNaN","p1_1","p1_2","attachListeners","d1","d2","_jk","_getDragManager","category","enctype","pName","_animProps","ldist","tdist","duration","steps","linc","tinc","_int","setInterval","clearInterval","isElementDraggable","oc","specs","dm","addToDragSelection","removeFromDragSelection","clearDragSelection","_do","readyState","IG$","_baN","tnode","lnode","coordinates","$s","role","property","dsname","dsignoreeror","dsignoreerror","comment","tobj","me","_cs","emode","dul","dg","$","visualstates","appendTo","states","statview","sviewarea","sname","gval","sgraph","barlength","Number","visualStateClick","_bf","graphic","set_potential","potential","_I99","_I9a","option","ptype","mainarea","gpt","doc","mwidth","mheight","a_boxes","m_boxes","render","plumb","lnk","tgt","getBoxObject","link","lvalue","condition","ov","t1","t2","source_0","source_1","target_0","target_1","gf_mousemove","mpt","tw","j$ext","th","mw","mh","om","ot","gf_mouseup","getID","stat","lid","statdv","status","addBox","isnew","checkUID","lreq","_rpc$","ack","mbody","jdoc","suid","nuid","rs_addBox","send","dv","dvc","title","_app_cls","cls","dstype","bg","dv_dsname","dlayer","__tL","stopImmediatePropagation","removeBox","u1","rs_loadOption","nodelength","execute","s4","txt","titlearea","setDsN","html","bconfirm","confirmMessages","ig$","appname","rs_removeBox","twidth","theight","boxes","addLink","did1","did2","dashstyle","ptr_link","L1","itemobj","nodes","links","m1","pnames","variables","potentials","vobj","lobj","ab","probnet","vmap","toffset","dsdesc","dsmapper","dsreducer","dstname","dsscript","dsfname","dsskipexist","doctmpl","additional_properties","precision","unit","linkname","linknodes","cons","revealing_condition","lcond","elem_id","bpmnLinkCon","modal","region","layout","align","closable","resizable","autoHeight","_init","formalExpr","setValue","_confirm","close","_delete","modeler","detachNode","initComponent","IRm$","items","xtype","fieldLabel","buttons","bodyCls","handler","afterrender","bpmnFormConfig","p_main","form_options_value","form_width","form_height","setAllValues","confirm","getAllValues","bpmnProp","panel","hide_ierr","s_hist","init_f","p_dsoption","dsoption","sdp","p_base","p_advanced","_vmode","dpanel","loop_groups","groups","gid","subgroups","pmenu","popup","floating","move","resize","selType","selModel","mode","store","columns","dataIndex","flex","loadUsers","grd_users","req","getLayout","setActiveItem","address","selusers","u","userid","loadData","loadGroups","grd_groups","selgrps","loadDeligates","grd_deligates","programs","mod_type","di","java_class","getSelectionModel","setUsers","setGroups","setDeligates","concat","job","bind_form","bind_form_uid","bind_form_name","bind_form_type","uid","keepview","closedlg","rec","assignee","sn","candidate_groups","t_deligates_uid","__m","addEvents","_job_name","defaults","labelPosition","required","queryMode","displayField","valueField","autoSelect","fields","change","nvalue","ovalue","boxLabel","readOnly","hidden","dlg","metaSelectDlg","visibleItems","tree_options","callBackObj","checkLogin","$w","form_options","nvalues","itemclick","pw","ph","assi","dom","setWidth","showAt","_adjust","$ex","cgrp","bpmnModeler","v$pnl","_idr","_lc","_lcc","content","dt","bf","fmenu","topmenu","farea","setScrRect","bccall","l4","ev","moption","__dlg","_sustain","updateNetwork","setLinkOption","opt","nformula","has_condition","coverlay","b_first","_mc","opacity","helper","mp","mposition","nitem","$variable","setText","toolbarHandler","cmd","_save","_save_as","_execute","_migrate","_activate","_update_cnt","meta_type","alertmsg","do_upgrade","cnt_upgradable","invalid_processes","cnt_total_processes","cnt","nodemap","after_act","rsaveContent","ignoreclose","contentchanged","dlgitemsel","initpath","nodepath","saveAsNew","_rs_procMakeItem","rs_procMakeItem","showerror","reportoption","setTitle","borderColor","collapsible","collapseMode","tools","tbar","iconCls","bbar","hiddenstatusbar","api","m_explorer","mainPanel","vmode","changeApp","navigateTree","bpmnTasks","_upd_bpmn_task","complTask","task_detail","purpose","taskid","_la","process_def_id","task_def_key","node_option","_ipcnt","ispopup","DashboardViewDlg","bpmn","bpmn_task_rec","bpmn_detail","event_action","condition_params","setLoading","cwin","dlgresult","navigateApp","bpmnForm","detail","_claim","_unclaim","metadata","record","cellclick","view","rindex","bpmnTP","reason","clearInvalid","markInvalid","bpmnMonitor","is_all","selectedIndex","processdefid","act","delete_reason","grd_activity","_tp","processid"],"mappings":"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","file":"../../../../../../bpmn_model.min.js","sourcesContent":["/**\n * jsBezier-0.8\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * licensed under the MIT license.\n *\n * a set of Bezier curve functions that deal with Beziers, used by jsPlumb, and perhaps useful for other people.  These functions work with Bezier\n * curves of arbitrary degree.\n *\n * - functions are all in the 'jsBezier' namespace.\n *\n * - all input points should be in the format {x:.., y:..}. all output points are in this format too.\n *\n * - all input curves should be in the format [ {x:.., y:..}, {x:.., y:..}, {x:.., y:..}, {x:.., y:..} ]\n *\n * - 'location' as used as an input here refers to a decimal in the range 0-1 inclusive, which indicates a point some proportion along the length\n * of the curve.  location as output has the same format and meaning.\n *\n *\n * Function List:\n * --------------\n *\n * distanceFromCurve(point, curve)\n *\n *     Calculates the distance that the given point lies from the given Bezier.  Note that it is computed relative to the center of the Bezier,\n * so if you have stroked the curve with a wide pen you may wish to take that into account!  The distance returned is relative to the values\n * of the curve and the point - it will most likely be pixels.\n *\n * gradientAtPoint(curve, location)\n *\n *     Calculates the gradient to the curve at the given location, as a decimal between 0 and 1 inclusive.\n *\n * gradientAtPointAlongCurveFrom (curve, location)\n *\n *    Calculates the gradient at the point on the given curve that is 'distance' units from location.\n *\n * nearestPointOnCurve(point, curve)\n *\n *    Calculates the nearest point to the given point on the given curve.  The return value of this is a JS object literal, containing both the\n *point's coordinates and also the 'location' of the point (see above), for example:  { point:{x:551,y:150}, location:0.263365 }.\n *\n * pointOnCurve(curve, location)\n *\n *     Calculates the coordinates of the point on the given Bezier curve at the given location.\n *\n * pointAlongCurveFrom(curve, location, distance)\n *\n *     Calculates the coordinates of the point on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * locationAlongCurveFrom(curve, location, distance)\n *\n *     Calculates the location on the given curve that is 'distance' units from location.  'distance' should be in the same coordinate\n * space as that used to construct the Bezier curve.  For an HTML Canvas usage, for example, distance would be a measure of pixels.\n *\n * perpendicularToCurveAt(curve, location, length, distance)\n *\n *     Calculates the perpendicular to the given curve at the given location.  length is the length of the line you wish for (it will be centered\n * on the point at 'location'). distance is optional, and allows you to specify a point along the path from the given location as the center of\n * the perpendicular returned.  The return value of this is an array of two points: [ {x:...,y:...}, {x:...,y:...} ].\n *\n *\n */\n\n(function() {\n\n    var root = this;\n\n    if(typeof Math.sgn == \"undefined\") {\n        Math.sgn = function(x) { return x == 0 ? 0 : x > 0 ? 1 :-1; };\n    }\n\n    var Vectors = {\n            subtract     :     function(v1, v2) { return {x:v1.x - v2.x, y:v1.y - v2.y }; },\n            dotProduct    :     function(v1, v2) { return (v1.x * v2.x)  + (v1.y * v2.y); },\n            square        :    function(v) { return Math.sqrt((v.x * v.x) + (v.y * v.y)); },\n            scale        :    function(v, s) { return {x:v.x * s, y:v.y * s }; }\n        },\n\n        maxRecursion = 64,\n        flatnessTolerance = Math.pow(2.0,-maxRecursion-1);\n\n    /**\n     * Calculates the distance that the point lies from the curve.\n     *\n     * @param point a point in the form {x:567, y:3342}\n     * @param curve a Bezier curve in the form [{x:..., y:...}, {x:..., y:...}, {x:..., y:...}, {x:..., y:...}].  note that this is currently\n     * hardcoded to assume cubiz beziers, but would be better off supporting any degree.\n     * @return a JS object literal containing location and distance, for example: {location:0.35, distance:10}.  Location is analogous to the location\n     * argument you pass to the pointOnPath function: it is a ratio of distance travelled along the curve.  Distance is the distance in pixels from\n     * the point to the curve.\n     */\n    var _distanceFromCurve = function(point, curve) {\n        var candidates = [],\n            w = _convertToBezier(point, curve),\n            degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            numSolutions = _findRoots(w, higherDegree, candidates, 0),\n            v = Vectors.subtract(point, curve[0]), dist = Vectors.square(v), t = 0.0;\n\n        for (var i = 0; i < numSolutions; i++) {\n            v = Vectors.subtract(point, _bezier(curve, degree, candidates[i], null, null));\n            var newDist = Vectors.square(v);\n            if (newDist < dist) {\n                dist = newDist;\n                t = candidates[i];\n            }\n        }\n        v = Vectors.subtract(point, curve[degree]);\n        newDist = Vectors.square(v);\n        if (newDist < dist) {\n            dist = newDist;\n            t = 1.0;\n        }\n        return {location:t, distance:dist};\n    };\n    /**\n     * finds the nearest point on the curve to the given point.\n     */\n    var _nearestPointOnCurve = function(point, curve) {\n        var td = _distanceFromCurve(point, curve);\n        return {point:_bezier(curve, curve.length - 1, td.location, null, null), location:td.location};\n    };\n    var _convertToBezier = function(point, curve) {\n        var degree = curve.length - 1, higherDegree = (2 * degree) - 1,\n            c = [], d = [], cdTable = [], w = [],\n            z = [ [1.0, 0.6, 0.3, 0.1], [0.4, 0.6, 0.6, 0.4], [0.1, 0.3, 0.6, 1.0] ];\n\n        for (var i = 0; i <= degree; i++) c[i] = Vectors.subtract(curve[i], point);\n        for (var i = 0; i <= degree - 1; i++) {\n            d[i] = Vectors.subtract(curve[i+1], curve[i]);\n            d[i] = Vectors.scale(d[i], 3.0);\n        }\n        for (var row = 0; row <= degree - 1; row++) {\n            for (var column = 0; column <= degree; column++) {\n                if (!cdTable[row]) cdTable[row] = [];\n                cdTable[row][column] = Vectors.dotProduct(d[row], c[column]);\n            }\n        }\n        for (i = 0; i <= higherDegree; i++) {\n            if (!w[i]) w[i] = [];\n            w[i].y = 0.0;\n            w[i].x = parseFloat(i) / higherDegree;\n        }\n        var n = degree, m = degree-1;\n        for (var k = 0; k <= n + m; k++) {\n            var lb = Math.max(0, k - m),\n                ub = Math.min(k, n);\n            for (i = lb; i <= ub; i++) {\n                j = k - i;\n                w[i+j].y += cdTable[j][i] * z[j][i];\n            }\n        }\n        return w;\n    };\n    /**\n     * counts how many roots there are.\n     */\n    var _findRoots = function(w, degree, t, depth) {\n        var left = [], right = [],\n            left_count, right_count,\n            left_t = [], right_t = [];\n\n        switch (_getCrossingCount(w, degree)) {\n            case 0 : {\n                return 0;\n            }\n            case 1 : {\n                if (depth >= maxRecursion) {\n                    t[0] = (w[0].x + w[degree].x) / 2.0;\n                    return 1;\n                }\n                if (_isFlatEnough(w, degree)) {\n                    t[0] = _computeXIntercept(w, degree);\n                    return 1;\n                }\n                break;\n            }\n        }\n        _bezier(w, degree, 0.5, left, right);\n        left_count  = _findRoots(left,  degree, left_t, depth+1);\n        right_count = _findRoots(right, degree, right_t, depth+1);\n        for (var i = 0; i < left_count; i++) t[i] = left_t[i];\n        for (var i = 0; i < right_count; i++) t[i+left_count] = right_t[i];\n        return (left_count+right_count);\n    };\n    var _getCrossingCount = function(curve, degree) {\n        var n_crossings = 0, sign, old_sign;\n        sign = old_sign = Math.sgn(curve[0].y);\n        for (var i = 1; i <= degree; i++) {\n            sign = Math.sgn(curve[i].y);\n            if (sign != old_sign) n_crossings++;\n            old_sign = sign;\n        }\n        return n_crossings;\n    };\n    var _isFlatEnough = function(curve, degree) {\n        var  error,\n            intercept_1, intercept_2, left_intercept, right_intercept,\n            a, b, c, det, dInv, a1, b1, c1, a2, b2, c2;\n        a = curve[0].y - curve[degree].y;\n        b = curve[degree].x - curve[0].x;\n        c = curve[0].x * curve[degree].y - curve[degree].x * curve[0].y;\n\n        var max_distance_above = max_distance_below = 0.0;\n\n        for (var i = 1; i < degree; i++) {\n            var value = a * curve[i].x + b * curve[i].y + c;\n            if (value > max_distance_above)\n                max_distance_above = value;\n            else if (value < max_distance_below)\n                max_distance_below = value;\n        }\n\n        a1 = 0.0; b1 = 1.0; c1 = 0.0; a2 = a; b2 = b;\n        c2 = c - max_distance_above;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_1 = (b1 * c2 - b2 * c1) * dInv;\n        a2 = a; b2 = b; c2 = c - max_distance_below;\n        det = a1 * b2 - a2 * b1;\n        dInv = 1.0/det;\n        intercept_2 = (b1 * c2 - b2 * c1) * dInv;\n        left_intercept = Math.min(intercept_1, intercept_2);\n        right_intercept = Math.max(intercept_1, intercept_2);\n        error = right_intercept - left_intercept;\n        return (error < flatnessTolerance)? 1 : 0;\n    };\n    var _computeXIntercept = function(curve, degree) {\n        var XLK = 1.0, YLK = 0.0,\n            XNM = curve[degree].x - curve[0].x, YNM = curve[degree].y - curve[0].y,\n            XMK = curve[0].x - 0.0, YMK = curve[0].y - 0.0,\n            det = XNM*YLK - YNM*XLK, detInv = 1.0/det,\n            S = (XNM*YMK - YNM*XMK) * detInv;\n        return 0.0 + XLK * S;\n    };\n    var _bezier = function(curve, degree, t, left, right) {\n        var temp = [[]];\n        for (var j =0; j <= degree; j++) temp[0][j] = curve[j];\n        for (var i = 1; i <= degree; i++) {\n            for (var j =0 ; j <= degree - i; j++) {\n                if (!temp[i]) temp[i] = [];\n                if (!temp[i][j]) temp[i][j] = {};\n                temp[i][j].x = (1.0 - t) * temp[i-1][j].x + t * temp[i-1][j+1].x;\n                temp[i][j].y = (1.0 - t) * temp[i-1][j].y + t * temp[i-1][j+1].y;\n            }\n        }\n        if (left != null)\n            for (j = 0; j <= degree; j++) left[j]  = temp[j][0];\n        if (right != null)\n            for (j = 0; j <= degree; j++) right[j] = temp[degree-j][j];\n\n        return (temp[degree][0]);\n    };\n\n    var _curveFunctionCache = {};\n    var _getCurveFunctions = function(order) {\n        var fns = _curveFunctionCache[order];\n        if (!fns) {\n            fns = [];\n            var f_term = function() { return function(t) { return Math.pow(t, order); }; },\n                l_term = function() { return function(t) { return Math.pow((1-t), order); }; },\n                c_term = function(c) { return function(t) { return c; }; },\n                t_term = function() { return function(t) { return t; }; },\n                one_minus_t_term = function() { return function(t) { return 1-t; }; },\n                _termFunc = function(terms) {\n                    return function(t) {\n                        var p = 1;\n                        for (var i = 0; i < terms.length; i++) p = p * terms[i](t);\n                        return p;\n                    };\n                };\n\n            fns.push(new f_term());  // first is t to the power of the curve order\n            for (var i = 1; i < order; i++) {\n                var terms = [new c_term(order)];\n                for (var j = 0 ; j < (order - i); j++) terms.push(new t_term());\n                for (var j = 0 ; j < i; j++) terms.push(new one_minus_t_term());\n                fns.push(new _termFunc(terms));\n            }\n            fns.push(new l_term());  // last is (1-t) to the power of the curve order\n\n            _curveFunctionCache[order] = fns;\n        }\n\n        return fns;\n    };\n\n\n    /**\n     * calculates a point on the curve, for a Bezier of arbitrary order.\n     * @param curve an array of control points, eg [{x:10,y:20}, {x:50,y:50}, {x:100,y:100}, {x:120,y:100}].  For a cubic bezier this should have four points.\n     * @param location a decimal indicating the distance along the curve the point should be located at.  this is the distance along the curve as it travels, taking the way it bends into account.  should be a number from 0 to 1, inclusive.\n     */\n    var _pointOnPath = function(curve, location) {\n        var cc = _getCurveFunctions(curve.length - 1),\n            _x = 0, _y = 0;\n        for (var i = 0; i < curve.length ; i++) {\n            _x = _x + (curve[i].x * cc[i](location));\n            _y = _y + (curve[i].y * cc[i](location));\n        }\n\n        return {x:_x, y:_y};\n    };\n\n    var _dist = function(p1,p2) {\n        return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n    };\n\n    var _isPoint = function(curve) {\n        return curve[0].x == curve[1].x && curve[0].y == curve[1].y;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.  this method returns both the x,y location of the point and also\n     * its 'location' (proportion of travel along the path); the method below - _pointAlongPathFrom - calls this method and just returns the\n     * point.\n     */\n    var _pointAlongPath = function(curve, location, distance) {\n\n        if (_isPoint(curve)) {\n            return {\n                point:curve[0],\n                location:location\n            };\n        }\n\n        var prev = _pointOnPath(curve, location),\n            tally = 0,\n            curLoc = location,\n            direction = distance > 0 ? 1 : -1,\n            cur = null;\n\n        while (tally < Math.abs(distance)) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n        return {point:cur, location:curLoc};\n    };\n\n    var _length = function(curve) {\n        if (_isPoint(curve)) return 0;\n\n        var prev = _pointOnPath(curve, 0),\n            tally = 0,\n            curLoc = 0,\n            direction = 1,\n            cur = null;\n\n        while (curLoc < 1) {\n            curLoc += (0.005 * direction);\n            cur = _pointOnPath(curve, curLoc);\n            tally += _dist(cur, prev);\n            prev = cur;\n        }\n        return tally;\n    };\n\n    /**\n     * finds the point that is 'distance' along the path from 'location'.\n     */\n    var _pointAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).point;\n    };\n\n    /**\n     * finds the location that is 'distance' along the path from 'location'.\n     */\n    var _locationAlongPathFrom = function(curve, location, distance) {\n        return _pointAlongPath(curve, location, distance).location;\n    };\n\n    /**\n     * returns the gradient of the curve at the given location, which is a decimal between 0 and 1 inclusive.\n     *\n     * thanks // http://bimixual.org/AnimationLibrary/beziertangents.html\n     */\n    var _gradientAtPoint = function(curve, location) {\n        var p1 = _pointOnPath(curve, location),\n            p2 = _pointOnPath(curve.slice(0, curve.length - 1), location),\n            dy = p2.y - p1.y, dx = p2.x - p1.x;\n        return dy == 0 ? Infinity : Math.atan(dy / dx);\n    };\n\n    /**\n     returns the gradient of the curve at the point which is 'distance' from the given location.\n     if this point is greater than location 1, the gradient at location 1 is returned.\n     if this point is less than location 0, the gradient at location 0 is returned.\n     */\n    var _gradientAtPointAlongPathFrom = function(curve, location, distance) {\n        var p = _pointAlongPath(curve, location, distance);\n        if (p.location > 1) p.location = 1;\n        if (p.location < 0) p.location = 0;\n        return _gradientAtPoint(curve, p.location);\n    };\n\n    /**\n     * calculates a line that is 'length' pixels long, perpendicular to, and centered on, the path at 'distance' pixels from the given location.\n     * if distance is not supplied, the perpendicular for the given location is computed (ie. we set distance to zero).\n     */\n    var _perpendicularToPathAt = function(curve, location, length, distance) {\n        distance = distance == null ? 0 : distance;\n        var p = _pointAlongPath(curve, location, distance),\n            m = _gradientAtPoint(curve, p.location),\n            _theta2 = Math.atan(-1 / m),\n            y =  length / 2 * Math.sin(_theta2),\n            x =  length / 2 * Math.cos(_theta2);\n        return [{x:p.point.x + x, y:p.point.y + y}, {x:p.point.x - x, y:p.point.y - y}];\n    };\n\n    this.jsBezier = {\n        distanceFromCurve : _distanceFromCurve,\n        gradientAtPoint : _gradientAtPoint,\n        gradientAtPointAlongCurveFrom : _gradientAtPointAlongPathFrom,\n        nearestPointOnCurve : _nearestPointOnCurve,\n        pointOnCurve : _pointOnPath,\n        pointAlongCurveFrom : _pointAlongPathFrom,\n        perpendicularToCurveAt : _perpendicularToPathAt,\n        locationAlongCurveFrom:_locationAlongPathFrom,\n        getLength:_length\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/**\n * Biltong v0.3\n *\n * Various geometry functions written as part of jsPlumb and perhaps useful for others.\n *\n * Copyright (c) 2016 jsPlumb\n * https://jsplumbtoolkit.com\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var Biltong = root.Biltong = {};\n\n    var _isa = function(a) { return Object.prototype.toString.call(a) === \"[object Array]\"; },\n        _pointHelper = function(p1, p2, fn) {\n            p1 = _isa(p1) ? p1 : [p1.x, p1.y];\n            p2 = _isa(p2) ? p2 : [p2.x, p2.y];\n            return fn(p1, p2);\n        },\n        /**\n         * @name Biltong.gradient\n         * @function\n         * @desc Calculates the gradient of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a line between the two points.\n         */\n        _gradient = Biltong.gradient = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] == _p1[0])\n                    return _p2[1] > _p1[1] ? Infinity : -Infinity;\n                else if (_p2[1] == _p1[1])\n                    return _p2[0] > _p1[0] ? 0 : -0;\n                else\n                    return (_p2[1] - _p1[1]) / (_p2[0] - _p1[0]);\n            });\n        },\n        /**\n         * @name Biltong.normal\n         * @function\n         * @desc Calculates the gradient of a normal to a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The gradient of a normal to a line between the two points.\n         */\n        _normal = Biltong.normal = function(p1, p2) {\n            return -1 / _gradient(p1, p2);\n        },\n        /**\n         * @name Biltong.lineLength\n         * @function\n         * @desc Calculates the length of a line between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The length of a line between the two points.\n         */\n        _lineLength = Biltong.lineLength = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                return Math.sqrt(Math.pow(_p2[1] - _p1[1], 2) + Math.pow(_p2[0] - _p1[0], 2));\n            });\n        },\n        /**\n         * @name Biltong.quadrant\n         * @function\n         * @desc Calculates the quadrant in which the angle between the two points lies.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Integer} The quadrant - 1 for upper right, 2 for lower right, 3 for lower left, 4 for upper left.\n         */\n        _quadrant = Biltong.quadrant = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                if (_p2[0] > _p1[0]) {\n                    return (_p2[1] > _p1[1]) ? 2 : 1;\n                }\n                else if (_p2[0] == _p1[0]) {\n                    return _p2[1] > _p1[1] ? 2 : 1;\n                }\n                else {\n                    return (_p2[1] > _p1[1]) ? 3 : 4;\n                }\n            });\n        },\n        /**\n         * @name Biltong.theta\n         * @function\n         * @desc Calculates the angle between the two points.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Float} The angle between the two points.\n         */\n        _theta = Biltong.theta = function(p1, p2) {\n            return _pointHelper(p1, p2, function(_p1, _p2) {\n                var m = _gradient(_p1, _p2),\n                    t = Math.atan(m),\n                    s = _quadrant(_p1, _p2);\n                if ((s == 4 || s== 3)) t += Math.PI;\n                if (t < 0) t += (2 * Math.PI);\n\n                return t;\n            });\n        },\n        /**\n         * @name Biltong.intersects\n         * @function\n         * @desc Calculates whether or not the two rectangles intersect.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @return {Boolean} True if the rectangles intersect, false otherwise.\n         */\n        _intersects = Biltong.intersects = function(r1, r2) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h;\n\n            return  ( (x1 <= a1 && a1 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a2 && a2 <= x2) && (y1 <= b1 && b1 <= y2) ) ||\n                ( (x1 <= a1 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (x1 <= a2 && a1 <= x2) && (y1 <= b2 && b2 <= y2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x2 && x2 <= a2) && (b1 <= y1 && y1 <= b2) ) ||\n                ( (a1 <= x1 && x1 <= a2) && (b1 <= y2 && y2 <= b2) ) ||\n                ( (a1 <= x2 && x1 <= a2) && (b1 <= y2 && y2 <= b2) );\n        },\n        /**\n         * @name Biltong.encloses\n         * @function\n         * @desc Calculates whether or not r2 is completely enclosed by r1.\n         * @param {Rectangle} r1 First rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Rectangle} r2 Second rectangle, as a js object in the form `{x:.., y:.., w:.., h:..}`\n         * @param {Boolean} [allowSharedEdges=false] If true, the concept of enclosure allows for one or more edges to be shared by the two rectangles.\n         * @return {Boolean} True if r1 encloses r2, false otherwise.\n         */\n        _encloses = Biltong.encloses = function(r1, r2, allowSharedEdges) {\n            var x1 = r1.x, x2 = r1.x + r1.w, y1 = r1.y, y2 = r1.y + r1.h,\n                a1 = r2.x, a2 = r2.x + r2.w, b1 = r2.y, b2 = r2.y + r2.h,\n                c = function(v1, v2, v3, v4) { return allowSharedEdges ? v1 <= v2 && v3>= v4 : v1 < v2 && v3 > v4; };\n\n            return c(x1,a1,x2,a2) && c(y1,b1,y2,b2);\n        },\n        _segmentMultipliers = [null, [1, -1], [1, 1], [-1, 1], [-1, -1] ],\n        _inverseSegmentMultipliers = [null, [-1, -1], [-1, 1], [1, 1], [1, -1] ],\n        /**\n         * @name Biltong.pointOnLine\n         * @function\n         * @desc Calculates a point on the line from `fromPoint` to `toPoint` that is `distance` units along the length of the line.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Point} Point on the line, in the form `{ x:..., y:... }`.\n         */\n        _pointOnLine = Biltong.pointOnLine = function(fromPoint, toPoint, distance) {\n            var m = _gradient(fromPoint, toPoint),\n                s = _quadrant(fromPoint, toPoint),\n                segmentMultiplier = distance > 0 ? _segmentMultipliers[s] : _inverseSegmentMultipliers[s],\n                theta = Math.atan(m),\n                y = Math.abs(distance * Math.sin(theta)) * segmentMultiplier[1],\n                x =  Math.abs(distance * Math.cos(theta)) * segmentMultiplier[0];\n            return { x:fromPoint.x + x, y:fromPoint.y + y };\n        },\n        /**\n         * @name Biltong.perpendicularLineTo\n         * @function\n         * @desc Calculates a line of length `length` that is perpendicular to the line from `fromPoint` to `toPoint` and passes through `toPoint`.\n         * @param {Point} p1 First point, either as a 2 entry array or object with `left` and `top` properties.\n         * @param {Point} p2 Second point, either as a 2 entry array or object with `left` and `top` properties.\n         * @return {Line} Perpendicular line, in the form `[ { x:..., y:... }, { x:..., y:... } ]`.\n         */\n        _perpendicularLineTo = Biltong.perpendicularLineTo = function(fromPoint, toPoint, length) {\n            var m = _gradient(fromPoint, toPoint),\n                theta2 = Math.atan(-1 / m),\n                y =  length / 2 * Math.sin(theta2),\n                x =  length / 2 * Math.cos(theta2);\n            return [{x:toPoint.x + x, y:toPoint.y + y}, {x:toPoint.x - x, y:toPoint.y - y}];\n        };\n}).call(typeof window !== 'undefined' ? window : this);\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        Sniff = {\n            android: navigator.userAgent.toLowerCase().indexOf(\"android\") > -1\n        },\n        matchesSelector = function (el, selector, ctx) {\n            ctx = ctx || el.parentNode;\n            var possibles = ctx.querySelectorAll(selector);\n            for (var i = 0; i < possibles.length; i++) {\n                if (possibles[i] === el) {\n                    return true;\n                }\n            }\n            return false;\n        },\n        _gel = function (el) {\n            return (typeof el == \"string\" || el.constructor === String) ? document.getElementById(el) : el;\n        },\n        _t = function (e) {\n            return e.srcElement || e.target;\n        },\n    //\n    // gets path info for the given event - the path from target to obj, in the event's bubble chain. if doCompute\n    // is false we just return target for the path.\n    //\n        _pi = function(e, target, obj, doCompute) {\n            if (!doCompute) return { path:[target], end:1 };\n            else if (typeof e.path !== \"undefined\") {\n                return { path: e.path, end: e.path.indexOf(obj) };\n            } else {\n                var out = { path:[], end:-1 }, _one = function(el) {\n                    out.path.push(el);\n                    if (el === obj) {\n                        out.end = out.path.length - 1;\n                    }\n                    else if (el.parentNode != null) {\n                        _one(el.parentNode)\n                    }\n                };\n                _one(target);\n                return out;\n            }\n        },\n        _d = function (l, fn) {\n            for (var i = 0, j = l.length; i < j; i++) {\n                if (l[i] == fn) break;\n            }\n            if (i < l.length) l.splice(i, 1);\n        },\n        guid = 1,\n    //\n    // this function generates a guid for every handler, sets it on the handler, then adds\n    // it to the associated object's map of handlers for the given event. this is what enables us\n    // to unbind all events of some type, or all events (the second of which can be requested by the user,\n    // but it also used by Mottle when an element is removed.)\n        _store = function (obj, event, fn) {\n            var g = guid++;\n            obj.__ta = obj.__ta || {};\n            obj.__ta[event] = obj.__ta[event] || {};\n            // store each handler with a unique guid.\n            obj.__ta[event][g] = fn;\n            // set the guid on the handler.\n            fn.__tauid = g;\n            return g;\n        },\n        _unstore = function (obj, event, fn) {\n            obj.__ta && obj.__ta[event] && delete obj.__ta[event][fn.__tauid];\n            // a handler might have attached extra functions, so we unbind those too.\n            if (fn.__taExtra) {\n                for (var i = 0; i < fn.__taExtra.length; i++) {\n                    _unbind(obj, fn.__taExtra[i][0], fn.__taExtra[i][1]);\n                }\n                fn.__taExtra.length = 0;\n            }\n            // a handler might have attached an unstore callback\n            fn.__taUnstore && fn.__taUnstore();\n        },\n        _curryChildFilter = function (children, obj, fn, evt) {\n            if (children == null) return fn;\n            else {\n                var c = children.split(\",\"),\n                    _fn = function (e) {\n                        _fn.__tauid = fn.__tauid;\n                        var t = _t(e), target = t;  // t is the target element on which the event occurred. it is the\n                        // element we will wish to pass to any callbacks.\n                        var pathInfo = _pi(e, t, obj, children != null)\n                        if (pathInfo.end != -1) {\n                            for (var p = 0; p < pathInfo.end; p++) {\n                                target = pathInfo.path[p];\n                                for (var i = 0; i < c.length; i++) {\n                                    if (matchesSelector(target, c[i], obj)) {\n                                        fn.apply(target, arguments);\n                                    }\n                                }\n                            }\n                        }\n                    };\n                registerExtraFunction(fn, evt, _fn);\n                return _fn;\n            }\n        },\n    //\n    // registers an 'extra' function on some event listener function we were given - a function that we\n    // created and bound to the element as part of our housekeeping, and which we want to unbind and remove\n    // whenever the given function is unbound.\n        registerExtraFunction = function (fn, evt, newFn) {\n            fn.__taExtra = fn.__taExtra || [];\n            fn.__taExtra.push([evt, newFn]);\n        },\n        DefaultHandler = function (obj, evt, fn, children) {\n            if (isTouchDevice && touchMap[evt]) {\n                var tfn = _curryChildFilter(children, obj, fn, touchMap[evt]);\n                _bind(obj, touchMap[evt], tfn , fn);\n            }\n            if (evt === \"focus\" && obj.getAttribute(\"tabindex\") == null) {\n                obj.setAttribute(\"tabindex\", \"1\");\n            }\n            _bind(obj, evt, _curryChildFilter(children, obj, fn, evt), fn);\n        },\n        SmartClickHandler = function (obj, evt, fn, children) {\n            if (obj.__taSmartClicks == null) {\n                var down = function (e) {\n                        obj.__tad = _pageLocation(e);\n                    },\n                    up = function (e) {\n                        obj.__tau = _pageLocation(e);\n                    },\n                    click = function (e) {\n                        if (obj.__tad && obj.__tau && obj.__tad[0] === obj.__tau[0] && obj.__tad[1] === obj.__tau[1]) {\n                            for (var i = 0; i < obj.__taSmartClicks.length; i++)\n                                obj.__taSmartClicks[i].apply(_t(e), [ e ]);\n                        }\n                    };\n                DefaultHandler(obj, \"mousedown\", down, children);\n                DefaultHandler(obj, \"mouseup\", up, children);\n                DefaultHandler(obj, \"click\", click, children);\n                obj.__taSmartClicks = [];\n            }\n\n            // store in the list of callbacks\n            obj.__taSmartClicks.push(fn);\n            // the unstore function removes this function from the object's listener list for this type.\n            fn.__taUnstore = function () {\n                _d(obj.__taSmartClicks, fn);\n            };\n        },\n        _tapProfiles = {\n            \"tap\": {touches: 1, taps: 1},\n            \"dbltap\": {touches: 1, taps: 2},\n            \"contextmenu\": {touches: 2, taps: 1}\n        },\n        TapHandler = function (clickThreshold, dblClickThreshold) {\n            return function (obj, evt, fn, children) {\n                // if event is contextmenu, for devices which are mouse only, we want to\n                // use the default bind.\n                if (evt == \"contextmenu\" && isMouseDevice)\n                    DefaultHandler(obj, evt, fn, children);\n                else {\n                    // the issue here is that this down handler gets registered only for the\n                    // child nodes in the first registration. in fact it should be registered with\n                    // no child selector and then on down we should cycle through the registered\n                    // functions to see if one of them matches. on mouseup we should execute ALL of\n                    // the functions whose children are either null or match the element.\n                    if (obj.__taTapHandler == null) {\n                        var tt = obj.__taTapHandler = {\n                            tap: [],\n                            dbltap: [],\n                            contextmenu: [],\n                            down: false,\n                            taps: 0,\n                            downSelectors: []\n                        };\n                        var down = function (e) {\n                                var target = _t(e), pathInfo = _pi(e, target, obj, children != null), finished = false;\n                                for (var p = 0; p < pathInfo.end; p++) {\n                                    if (finished) return;\n                                    target = pathInfo.path[p];\n                                    for (var i = 0; i < tt.downSelectors.length; i++) {\n                                        if (tt.downSelectors[i] == null || matchesSelector(target, tt.downSelectors[i], obj)) {\n                                            tt.down = true;\n                                            setTimeout(clearSingle, clickThreshold);\n                                            setTimeout(clearDouble, dblClickThreshold);\n                                            finished = true;\n                                            break; // we only need one match on mousedown\n                                        }\n                                    }\n                                }\n                            },\n                            up = function (e) {\n                                if (tt.down) {\n                                    var target = _t(e), pathInfo;\n                                    tt.taps++;\n                                    var tc = _touchCount(e);\n                                    for (var eventId in _tapProfiles) {\n                                        if (_tapProfiles.hasOwnProperty(eventId)) {\n                                            var p = _tapProfiles[eventId];\n                                            if (p.touches === tc && (p.taps === 1 || p.taps === tt.taps)) {\n                                                for (var i = 0; i < tt[eventId].length; i++) {\n                                                    pathInfo = _pi(e, target, obj, tt[eventId][i][1] != null);\n                                                    for (var pLoop = 0; pLoop < pathInfo.end; pLoop++) {\n                                                        target = pathInfo.path[pLoop];\n                                                        // this is a single event registration handler.\n                                                        if (tt[eventId][i][1] == null || matchesSelector(target, tt[eventId][i][1], obj)) {\n                                                            tt[eventId][i][0].apply(target, [ e ]);\n                                                            break;\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            },\n                            clearSingle = function () {\n                                tt.down = false;\n                            },\n                            clearDouble = function () {\n                                tt.taps = 0;\n                            };\n\n                        DefaultHandler(obj, \"mousedown\", down);\n                        DefaultHandler(obj, \"mouseup\", up);\n                    }\n                    // add this child selector (it can be null, that's fine).\n                    obj.__taTapHandler.downSelectors.push(children);\n\n                    obj.__taTapHandler[evt].push([fn, children]);\n                    // the unstore function removes this function from the object's listener list for this type.\n                    fn.__taUnstore = function () {\n                        _d(obj.__taTapHandler[evt], fn);\n                    };\n                }\n            };\n        },\n        meeHelper = function (type, evt, obj, target) {\n            for (var i in obj.__tamee[type]) {\n                if (obj.__tamee[type].hasOwnProperty(i)) {\n                    obj.__tamee[type][i].apply(target, [ evt ]);\n                }\n            }\n        },\n        MouseEnterExitHandler = function () {\n            var activeElements = [];\n            return function (obj, evt, fn, children) {\n                if (!obj.__tamee) {\n                    // __tamee holds a flag saying whether the mouse is currently \"in\" the element, and a list of\n                    // both mouseenter and mouseexit functions.\n                    obj.__tamee = { over: false, mouseenter: [], mouseexit: [] };\n                    // register over and out functions\n                    var over = function (e) {\n                            var t = _t(e);\n                            if ((children == null && (t == obj && !obj.__tamee.over)) || (matchesSelector(t, children, obj) && (t.__tamee == null || !t.__tamee.over))) {\n                                meeHelper(\"mouseenter\", e, obj, t);\n                                t.__tamee = t.__tamee || {};\n                                t.__tamee.over = true;\n                                activeElements.push(t);\n                            }\n                        },\n                        out = function (e) {\n                            var t = _t(e);\n                            // is the current target one of the activeElements? and is the\n                            // related target NOT a descendant of it?\n                            for (var i = 0; i < activeElements.length; i++) {\n                                if (t == activeElements[i] && !matchesSelector((e.relatedTarget || e.toElement), \"*\", t)) {\n                                    t.__tamee.over = false;\n                                    activeElements.splice(i, 1);\n                                    meeHelper(\"mouseexit\", e, obj, t);\n                                }\n                            }\n                        };\n\n                    _bind(obj, \"mouseover\", _curryChildFilter(children, obj, over, \"mouseover\"), over);\n                    _bind(obj, \"mouseout\", _curryChildFilter(children, obj, out, \"mouseout\"), out);\n                }\n\n                fn.__taUnstore = function () {\n                    delete obj.__tamee[evt][fn.__tauid];\n                };\n\n                _store(obj, evt, fn);\n                obj.__tamee[evt][fn.__tauid] = fn;\n            };\n        },\n        isTouchDevice = \"ontouchstart\" in document.documentElement,\n        isMouseDevice = \"onmousedown\" in document.documentElement,\n        touchMap = { \"mousedown\": \"touchstart\", \"mouseup\": \"touchend\", \"mousemove\": \"touchmove\" },\n        touchstart = \"touchstart\", touchend = \"touchend\", touchmove = \"touchmove\",\n        iev = (function () {\n            var rv = -1;\n            if (navigator.appName == 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        isIELT9 = iev > -1 && iev < 9,\n        _genLoc = function (e, prefix) {\n            if (e == null) return [ 0, 0 ];\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = function (e) {\n            if (e == null) return [ 0, 0 ];\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                return _genLoc(e, \"page\");\n            }\n        },\n        _screenLocation = function (e) {\n            return _genLoc(e, \"screen\");\n        },\n        _clientLocation = function (e) {\n            return _genLoc(e, \"client\");\n        },\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _touchCount = function (e) {\n            return _touches(e).length;\n        },\n    //http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html\n        _bind = function (obj, type, fn, originalFn) {\n            _store(obj, type, fn);\n            originalFn.__tauid = fn.__tauid;\n            if (obj.addEventListener)\n                obj.addEventListener(type, fn, false);\n            else if (obj.attachEvent) {\n                var key = type + fn.__tauid;\n                obj[\"e\" + key] = fn;\n                // TODO look at replacing with .call(..)\n                obj[key] = function () {\n                    obj[\"e\" + key] && obj[\"e\" + key](window.event);\n                };\n                obj.attachEvent(\"on\" + type, obj[key]);\n            }\n        },\n        _unbind = function (obj, type, fn) {\n            if (fn == null) return;\n            _each(obj, function () {\n                var _el = _gel(this);\n                _unstore(_el, type, fn);\n                // it has been bound if there is a tauid. otherwise it was not bound and we can ignore it.\n                if (fn.__tauid != null) {\n                    if (_el.removeEventListener) {\n                        _el.removeEventListener(type, fn, false);\n                        if (isTouchDevice && touchMap[type]) _el.removeEventListener(touchMap[type], fn, false);\n                    }\n                    else if (this.detachEvent) {\n                        var key = type + fn.__tauid;\n                        _el[key] && _el.detachEvent(\"on\" + type, _el[key]);\n                        _el[key] = null;\n                        _el[\"e\" + key] = null;\n                    }\n                }\n\n                // if a touch event was also registered, deregister now.\n                if (fn.__taTouchProxy) {\n                    _unbind(obj, fn.__taTouchProxy[1], fn.__taTouchProxy[0]);\n                }\n            });\n        },\n        _each = function (obj, fn) {\n            if (obj == null) return;\n            // if a list (or list-like), use it. if a string, get a list\n            // by running the string through querySelectorAll. else, assume\n            // it's an Element.\n            // obj.top is \"unknown\" in IE8.\n            obj = (typeof Window !== \"undefined\" && (typeof obj.top !== \"unknown\" && obj == obj.top)) ? [ obj ] :\n                    (typeof obj !== \"string\") && (obj.tagName == null && obj.length != null) ? obj :\n                    typeof obj === \"string\" ? document.querySelectorAll(obj)\n                : [ obj ];\n\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i]);\n        };\n\n    /**\n     * Mottle offers support for abstracting out the differences\n     * between touch and mouse devices, plus \"smart click\" functionality\n     * (don't fire click if the mouse has moved between mousedown and mouseup),\n     * and synthesized click/tap events.\n     * @class Mottle\n     * @constructor\n     * @param {Object} params Constructor params\n     * @param {Number} [params.clickThreshold=250] Threshold, in milliseconds beyond which a touchstart followed by a touchend is not considered to be a click.\n     * @param {Number} [params.dblClickThreshold=450] Threshold, in milliseconds beyond which two successive tap events are not considered to be a click.\n     * @param {Boolean} [params.smartClicks=false] If true, won't fire click events if the mouse has moved between mousedown and mouseup. Note that this functionality\n     * requires that Mottle consume the mousedown event, and so may not be viable in all use cases.\n     */\n    root.Mottle = function (params) {\n        params = params || {};\n        var clickThreshold = params.clickThreshold || 250,\n            dblClickThreshold = params.dblClickThreshold || 450,\n            mouseEnterExitHandler = new MouseEnterExitHandler(),\n            tapHandler = new TapHandler(clickThreshold, dblClickThreshold),\n            _smartClicks = params.smartClicks,\n            _doBind = function (obj, evt, fn, children) {\n                if (fn == null) return;\n                _each(obj, function () {\n                    var _el = _gel(this);\n                    if (_smartClicks && evt === \"click\")\n                        SmartClickHandler(_el, evt, fn, children);\n                    else if (evt === \"tap\" || evt === \"dbltap\" || evt === \"contextmenu\") {\n                        tapHandler(_el, evt, fn, children);\n                    }\n                    else if (evt === \"mouseenter\" || evt == \"mouseexit\")\n                        mouseEnterExitHandler(_el, evt, fn, children);\n                    else\n                        DefaultHandler(_el, evt, fn, children);\n                });\n            };\n\n        /**\n         * Removes an element from the DOM, and deregisters all event handlers for it. You should use this\n         * to ensure you don't leak memory.\n         * @method remove\n         * @param {String|Element} el Element, or id of the element, to remove.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.remove = function (el) {\n            _each(el, function () {\n                var _el = _gel(this);\n                if (_el.__ta) {\n                    for (var evt in _el.__ta) {\n                        if (_el.__ta.hasOwnProperty(evt)) {\n                            for (var h in _el.__ta[evt]) {\n                                if (_el.__ta[evt].hasOwnProperty(h))\n                                    _unbind(_el, evt, _el.__ta[evt][h]);\n                            }\n                        }\n                    }\n                }\n                _el.parentNode && _el.parentNode.removeChild(_el);\n            });\n            return this;\n        };\n\n        /**\n         * Register an event handler, optionally as a delegate for some set of descendant elements. Note\n         * that this method takes either 3 or 4 arguments - if you supply 3 arguments it is assumed you have\n         * omitted the `children` parameter, and that the event handler should be bound directly to the given element.\n         * @method on\n         * @param {Element[]|Element|String} el Either an Element, or a CSS spec for a list of elements, or an array of Elements.\n         * @param {String} [children] Comma-delimited list of selectors identifying allowed children.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.on = function (el, event, children, fn) {\n            var _el = arguments[0],\n                _c = arguments.length == 4 ? arguments[2] : null,\n                _e = arguments[1],\n                _f = arguments[arguments.length - 1];\n\n            _doBind(_el, _e, _f, _c);\n            return this;\n        };\n\n        /**\n         * Cancel delegate event handling for the given function. Note that unlike with 'on' you do not supply\n         * a list of child selectors here: it removes event delegation from all of the child selectors for which the\n         * given function was registered (if any).\n         * @method off\n         * @param {Element[]|Element|String} el Element - or ID of element - from which to remove event listener.\n         * @param {String} event Event ID.\n         * @param {Function} fn Event handler function.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.off = function (el, event, fn) {\n            _unbind(el, event, fn);\n            return this;\n        };\n\n        /**\n         * Triggers some event for a given element.\n         * @method trigger\n         * @param {Element} el Element for which to trigger the event.\n         * @param {String} event Event ID.\n         * @param {Event} originalEvent The original event. Should be optional of course, but currently is not, due\n         * to the jsPlumb use case that caused this method to be added.\n         * @param {Object} [payload] Optional object to set as `payload` on the generated event; useful for message passing.\n         * @return {Mottle} The current Mottle instance; you can chain this method.\n         */\n        this.trigger = function (el, event, originalEvent, payload) {\n            // MouseEvent undefined in old IE; that's how we know it's a mouse event.  A fine Microsoft paradox.\n            var originalIsMouse = isMouseDevice && (typeof MouseEvent === \"undefined\" || originalEvent == null || originalEvent.constructor === MouseEvent);\n\n            var eventToBind = (isTouchDevice && !isMouseDevice && touchMap[event]) ? touchMap[event] : event,\n                bindingAMouseEvent = !(isTouchDevice && !isMouseDevice && touchMap[event]);\n\n            var pl = _pageLocation(originalEvent), sl = _screenLocation(originalEvent), cl = _clientLocation(originalEvent);\n            _each(el, function () {\n                var _el = _gel(this), evt;\n                originalEvent = originalEvent || {\n                    screenX: sl[0],\n                    screenY: sl[1],\n                    clientX: cl[0],\n                    clientY: cl[1]\n                };\n\n                var _decorate = function (_evt) {\n                    if (payload) _evt.payload = payload;\n                };\n\n                var eventGenerators = {\n                    \"TouchEvent\": function (evt) {\n                        var touch = document.createTouch(window, _el, 0, pl[0], pl[1],\n                            sl[0], sl[1],\n                            cl[0], cl[1],\n                            0, 0, 0, 0);\n\n                        // https://gist.github.com/sstephenson/448808\n                        var touches = document.createTouchList(touch);\n                        var targetTouches = document.createTouchList(touch);\n                        var changedTouches = document.createTouchList(touch);\n                        evt.initTouchEvent(eventToBind, true, true, window, null, sl[0], sl[1],\n                            cl[0], cl[1], false, false, false, false,\n                            touches, targetTouches, changedTouches, 1, 0);\n                    },\n                    \"MouseEvents\": function (evt) {\n                        evt.initMouseEvent(eventToBind, true, true, window, 0,\n                            sl[0], sl[1],\n                            cl[0], cl[1],\n                            false, false, false, false, 1, _el);\n\n                        if (Sniff.android) {\n                            // Android's touch events are not standard.\n                            var t = document.createTouch(window, _el, 0, pl[0], pl[1],\n                                sl[0], sl[1],\n                                cl[0], cl[1],\n                                0, 0, 0, 0);\n\n                            evt.touches = evt.targetTouches = evt.changedTouches = document.createTouchList(t);\n                        }\n                    }\n                };\n\n                if (document.createEvent) {\n\n                    var ite = !bindingAMouseEvent && !originalIsMouse && (isTouchDevice && touchMap[event] && !Sniff.android),\n                        evtName = ite ? \"TouchEvent\" : \"MouseEvents\";\n\n                    evt = document.createEvent(evtName);\n                    eventGenerators[evtName](evt);\n                    _decorate(evt);\n                    _el.dispatchEvent(evt);\n                }\n                else if (document.createEventObject) {\n                    evt = document.createEventObject();\n                    evt.eventType = evt.eventName = eventToBind;\n                    evt.screenX = sl[0];\n                    evt.screenY = sl[1];\n                    evt.clientX = cl[0];\n                    evt.clientY = cl[1];\n                    _decorate(evt);\n                    _el.fireEvent('on' + eventToBind, evt);\n                }\n            });\n            return this;\n        }\n    };\n\n    /**\n     * Static method to assist in 'consuming' an element: uses `stopPropagation` where available, or sets\n     * `e.returnValue=false` where it is not.\n     * @method Mottle.consume\n     * @param {Event} e Event to consume\n     * @param {Boolean} [doNotPreventDefault=false] If true, does not call `preventDefault()` on the event.\n     */\n    root.Mottle.consume = function (e, doNotPreventDefault) {\n        if (e.stopPropagation)\n            e.stopPropagation();\n        else\n            e.returnValue = false;\n\n        if (!doNotPreventDefault && e.preventDefault)\n            e.preventDefault();\n    };\n\n    /**\n     * Gets the page location corresponding to the given event. For touch events this means get the page location of the first touch.\n     * @method Mottle.pageLocation\n     * @param {Event} e Event to get page location for.\n     * @return {Number[]} [left, top] for the given event.\n     */\n    root.Mottle.pageLocation = _pageLocation;\n\n    /**\n     * Forces touch events to be turned \"on\". Useful for testing: even if you don't have a touch device, you can still\n     * trigger a touch event when this is switched on and it will be captured and acted on.\n     * @method setForceTouchEvents\n     * @param {Boolean} value If true, force touch events to be on.\n     */\n    root.Mottle.setForceTouchEvents = function (value) {\n        isTouchDevice = value;\n    };\n\n    /**\n     * Forces mouse events to be turned \"on\". Useful for testing: even if you don't have a mouse, you can still\n     * trigger a mouse event when this is switched on and it will be captured and acted on.\n     * @method setForceMouseEvents\n     * @param {Boolean} value If true, force mouse events to be on.\n     */\n    root.Mottle.setForceMouseEvents = function (value) {\n        isMouseDevice = value;\n    };\n\n}).call(typeof window === \"undefined\" ? this : window);\n\n/**\n drag/drop functionality for use with jsPlumb but with\n no knowledge of jsPlumb. supports multiple scopes (separated by whitespace), dragging\n multiple elements, constrain to parent, drop filters, drag start filters, custom\n css classes.\n\n a lot of the functionality of this script is expected to be plugged in:\n\n addClass\n removeClass\n\n addEvent\n removeEvent\n\n getPosition\n setPosition\n getSize\n\n indexOf\n intersects\n\n the name came from here:\n\n http://mrsharpoblunto.github.io/foswig.js/\n\n copyright 2016 jsPlumb\n */\n\n;(function() {\n\n    \"use strict\";\n    var root = this;\n\n    var _suggest = function(list, item, head) {\n        if (list.indexOf(item) === -1) {\n            head ? list.unshift(item) : list.push(item);\n            return true;\n        }\n        return false;\n    };\n\n    var _vanquish = function(list, item) {\n        var idx = list.indexOf(item);\n        if (idx != -1) list.splice(idx, 1);\n    };\n\n    var _difference = function(l1, l2) {\n        var d = [];\n        for (var i = 0; i < l1.length; i++) {\n            if (l2.indexOf(l1[i]) == -1)\n                d.push(l1[i]);\n        }\n        return d;\n    };\n\n    var _isString = function(f) {\n        return f == null ? false : (typeof f === \"string\" || f.constructor == String);\n    };\n\n    var getOffsetRect = function (elem) {\n        // (1)\n        var box = elem.getBoundingClientRect(),\n            body = document.body,\n            docElem = document.documentElement,\n        // (2)\n            scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n            scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n        // (3)\n            clientTop = docElem.clientTop || body.clientTop || 0,\n            clientLeft = docElem.clientLeft || body.clientLeft || 0,\n        // (4)\n            top  = box.top +  scrollTop - clientTop,\n            left = box.left + scrollLeft - clientLeft;\n\n        return { top: Math.round(top), left: Math.round(left) };\n    };\n\n    var matchesSelector = function(el, selector, ctx) {\n        ctx = ctx || el.parentNode;\n        var possibles = ctx.querySelectorAll(selector);\n        for (var i = 0; i < possibles.length; i++) {\n            if (possibles[i] === el)\n                return true;\n        }\n        return false;\n    };\n\n    var iev = (function() {\n            var rv = -1;\n            if (navigator.appName == 'Microsoft Internet Explorer') {\n                var ua = navigator.userAgent,\n                    re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n                if (re.exec(ua) != null)\n                    rv = parseFloat(RegExp.$1);\n            }\n            return rv;\n        })(),\n        DEFAULT_GRID_X = 50,\n        DEFAULT_GRID_Y = 50,\n        isIELT9 = iev > -1 && iev < 9,\n        isIE9 = iev == 9,\n        _pl = function(e) {\n            if (isIELT9) {\n                return [ e.clientX + document.documentElement.scrollLeft, e.clientY + document.documentElement.scrollTop ];\n            }\n            else {\n                var ts = _touches(e), t = _getTouch(ts, 0);\n                // for IE9 pageX might be null if the event was synthesized. We try for pageX/pageY first,\n                // falling back to clientX/clientY if necessary. In every other browser we want to use pageX/pageY.\n                return isIE9 ? [t.pageX || t.clientX, t.pageY || t.clientY] : [t.pageX, t.pageY];\n            }\n        },\n        _getTouch = function(touches, idx) { return touches.item ? touches.item(idx) : touches[idx]; },\n        _touches = function(e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        },\n        _classes = {\n            draggable:\"katavorio-draggable\",    // draggable elements\n            droppable:\"katavorio-droppable\",    // droppable elements\n            drag : \"katavorio-drag\",            // elements currently being dragged\n            selected:\"katavorio-drag-selected\", // elements in current drag selection\n            active : \"katavorio-drag-active\",   // droppables that are targets of a currently dragged element\n            hover : \"katavorio-drag-hover\",     // droppables over which a matching drag element is hovering\n            noSelect : \"katavorio-drag-no-select\", // added to the body to provide a hook to suppress text selection\n            ghostProxy:\"katavorio-ghost-proxy\"  // added to a ghost proxy element in use when a drag has exited the bounds of its parent.\n        },\n        _defaultScope = \"katavorio-drag-scope\",\n        _events = [ \"stop\", \"start\", \"drag\", \"drop\", \"over\", \"out\", \"beforeStart\" ],\n        _devNull = function() {},\n        _true = function() { return true; },\n        _foreach = function(l, fn, from) {\n            for (var i = 0; i < l.length; i++) {\n                if (l[i] != from)\n                    fn(l[i]);\n            }\n        },\n        _setDroppablesActive = function(dd, val, andHover, drag) {\n            _foreach(dd, function(e) {\n                e.setActive(val);\n                if (val) e.updatePosition();\n                if (andHover) e.setHover(drag, val);\n            });\n        },\n        _each = function(obj, fn) {\n            if (obj == null) return;\n            obj = !_isString(obj) && (obj.tagName == null && obj.length != null) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++)\n                fn.apply(obj[i], [ obj[i] ]);\n        },\n        _consume = function(e) {\n            if (e.stopPropagation) {\n                e.stopPropagation();\n                e.preventDefault();\n            }\n            else {\n                e.returnValue = false;\n            }\n        },\n        _defaultInputFilterSelector = \"input,textarea,select,button,option\",\n    //\n    // filters out events on all input elements, like textarea, checkbox, input, select.\n        _inputFilter = function(e, el, _katavorio) {\n            var t = e.srcElement || e.target;\n            return !matchesSelector(t, _katavorio.getInputFilterSelector(), el);\n        };\n\n    var Super = function(el, params, css, scope) {\n        this.params = params || {};\n        this.el = el;\n        this.params.addClass(this.el, this._class);\n        this.uuid = _uuid();\n        var enabled = true;\n        this.setEnabled = function(e) { enabled = e; };\n        this.isEnabled = function() { return enabled; };\n        this.toggleEnabled = function() { enabled = !enabled; };\n        this.setScope = function(scopes) {\n            this.scopes = scopes ? scopes.split(/\\s+/) : [ scope ];\n        };\n        this.addScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { m[s] = true;});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.removeScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) { delete m[s];});\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.toggleScope = function(scopes) {\n            var m = {};\n            _each(this.scopes, function(s) { m[s] = true;});\n            _each(scopes ? scopes.split(/\\s+/) : [], function(s) {\n                if (m[s]) delete m[s];\n                else m[s] = true;\n            });\n            this.scopes = [];\n            for (var i in m) this.scopes.push(i);\n        };\n        this.setScope(params.scope);\n        this.k = params.katavorio;\n        return params.katavorio;\n    };\n\n    var TRUE = function() { return true; };\n    var FALSE = function() { return false; };\n\n    var Drag = function(el, params, css, scope) {\n        this._class = css.draggable;\n        var k = Super.apply(this, arguments);\n        this.rightButtonCanDrag = this.params.rightButtonCanDrag;\n        var downAt = [0,0], posAtDown = null, pagePosAtDown = null, pageDelta = [0,0], moving = false,\n            consumeStartEvent = this.params.consumeStartEvent !== false,\n            dragEl = this.el,\n            clone = this.params.clone,\n            scroll = this.params.scroll,\n            _multipleDrop = params.multipleDrop !== false,\n            isConstrained = false,\n            useGhostProxy = params.ghostProxy === true ? TRUE : params.ghostProxy && typeof params.ghostProxy === \"function\" ? params.ghostProxy : FALSE,\n            ghostProxy = function(el) { return el.cloneNode(true); };\n\n        var snapThreshold = params.snapThreshold || 5,\n            _snap = function(pos, x, y, thresholdX, thresholdY) {\n                thresholdX = thresholdX || snapThreshold;\n                thresholdY = thresholdY || snapThreshold;\n                var _dx = Math.floor(pos[0] / x),\n                    _dxl = x * _dx,\n                    _dxt = _dxl + x,\n                    _x = Math.abs(pos[0] - _dxl) <= thresholdX ? _dxl : Math.abs(_dxt - pos[0]) <= thresholdX ? _dxt : pos[0];\n\n                var _dy = Math.floor(pos[1] / y),\n                    _dyl = y * _dy,\n                    _dyt = _dyl + y,\n                    _y = Math.abs(pos[1] - _dyl) <= thresholdY ? _dyl : Math.abs(_dyt - pos[1]) <= thresholdY ? _dyt : pos[1];\n\n                return [ _x, _y];\n            };\n\n        this.posses = [];\n        this.posseRoles = {};\n\n        this.toGrid = function(pos) {\n            if (this.params.grid == null) {\n                return pos;\n            }\n            else {\n                return _snap(pos, this.params.grid[0], this.params.grid[1]);\n            }\n        };\n\n        this.snap = function(x, y) {\n            if (dragEl == null) return;\n            x = x || (this.params.grid ? this.params.grid[0] : DEFAULT_GRID_X);\n            y = y || (this.params.grid ? this.params.grid[1] : DEFAULT_GRID_Y);\n            var p = this.params.getPosition(dragEl);\n            this.params.setPosition(dragEl, _snap(p, x, y, x, y));\n        };\n\n        this.setUseGhostProxy = function(val) {\n            useGhostProxy = val ? TRUE : FALSE;\n        };\n\n        var constrain;\n        var negativeFilter = function(pos) {\n            return (params.allowNegative === false) ? [ Math.max (0, pos[0]), Math.max(0, pos[1]) ] : pos;\n        };\n\n        var _setConstrain = function(value) {\n            constrain = typeof value === \"function\" ? value : value ? function(pos) {\n                return negativeFilter([\n                    Math.max(0, Math.min(constrainRect.w - this.size[0], pos[0])),\n                    Math.max(0, Math.min(constrainRect.h - this.size[1], pos[1]))\n                ]);\n            }.bind(this) : function(pos) { return negativeFilter(pos); };\n        }.bind(this);\n\n        _setConstrain(typeof this.params.constrain === \"function\" ? this.params.constrain  : (this.params.constrain || this.params.containment));\n\n\n        /**\n         * Sets whether or not the Drag is constrained. A value of 'true' means constrain to parent bounds; a function\n         * will be executed and returns true if the position is allowed.\n         * @param value\n         */\n        this.setConstrain = function(value) {\n            _setConstrain(value);\n        };\n\n        var revertFunction;\n        /**\n         * Sets a function to call on drag stop, which, if it returns true, indicates that the given element should\n         * revert to its position before the previous drag.\n         * @param fn\n         */\n        this.setRevert = function(fn) {\n            revertFunction = fn;\n        };\n\n        var _assignId = function(obj) {\n                if (typeof obj == \"function\") {\n                    obj._katavorioId = _uuid();\n                    return obj._katavorioId;\n                } else {\n                    return obj;\n                }\n            },\n        // a map of { spec -> [ fn, exclusion ] } entries.\n            _filters = {},\n            _testFilter = function(e) {\n                for (var key in _filters) {\n                    var f = _filters[key];\n                    var rv = f[0](e);\n                    if (f[1]) rv = !rv;\n                    if (!rv) return false;\n                }\n                return true;\n            },\n            _setFilter = this.setFilter = function(f, _exclude) {\n                if (f) {\n                    var key = _assignId(f);\n                    _filters[key] = [\n                        function(e) {\n                            var t = e.srcElement || e.target, m;\n                            if (_isString(f)) {\n                                m = matchesSelector(t, f, el);\n                            }\n                            else if (typeof f === \"function\") {\n                                m = f(e, el);\n                            }\n                            return m;\n                        },\n                            _exclude !== false\n                    ];\n\n                }\n            },\n            _addFilter = this.addFilter = _setFilter,\n            _removeFilter = this.removeFilter = function(f) {\n                var key = typeof f == \"function\" ? f._katavorioId : f;\n                delete _filters[key];\n            };\n\n        this.clearAllFilters = function() {\n            _filters = {};\n        };\n\n        this.canDrag = this.params.canDrag || _true;\n\n        var constrainRect,\n            matchingDroppables = [], intersectingDroppables = [];\n\n        this.downListener = function(e) {\n            var isNotRightClick = this.rightButtonCanDrag || (e.which !== 3 && e.button !== 2);\n            if (isNotRightClick && this.isEnabled() && this.canDrag()) {\n                var _f =  _testFilter(e) && _inputFilter(e, this.el, this.k);\n                if (_f) {\n                    if (!clone)\n                        dragEl = this.el;\n                    else {\n                        dragEl = this.el.cloneNode(true);\n                        dragEl.setAttribute(\"id\", null);\n                        dragEl.style.position = \"absolute\";\n                        // the clone node is added to the body; getOffsetRect gives us a value\n                        // relative to the body.\n                        var b = getOffsetRect(this.el);\n                        dragEl.style.left = b.left + \"px\";\n                        dragEl.style.top = b.top + \"px\";\n                        document.body.appendChild(dragEl);\n                    }\n                    consumeStartEvent && _consume(e);\n                    downAt = _pl(e);\n                    //\n                    this.params.bind(document, \"mousemove\", this.moveListener);\n                    this.params.bind(document, \"mouseup\", this.upListener);\n                    k.markSelection(this);\n                    k.markPosses(this);\n                    this.params.addClass(document.body, css.noSelect);\n                    _dispatch(\"beforeStart\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                }\n                else if (this.params.consumeFilteredEvents) {\n                    _consume(e);\n                }\n            }\n        }.bind(this);\n\n        this.moveListener = function(e) {\n            if (downAt) {\n                if (!moving) {\n                    var _continue = _dispatch(\"start\", {el:this.el, pos:posAtDown, e:e, drag:this});\n                    if (_continue !== false) {\n                        if (!downAt) return;\n                        this.mark(true);\n                        moving = true;\n                    }\n                }\n\n                // it is possible that the start event caused the drag to be aborted. So we check\n                // again that we are currently dragging.\n                if (downAt) {\n                    intersectingDroppables.length = 0;\n                    var pos = _pl(e), dx = pos[0] - downAt[0], dy = pos[1] - downAt[1],\n                        z = this.params.ignoreZoom ? 1 : k.getZoom();\n                    dx /= z;\n                    dy /= z;\n                    this.moveBy(dx, dy, e);\n                    k.updateSelection(dx, dy, this);\n                    k.updatePosses(dx, dy, this);\n                }\n            }\n        }.bind(this);\n\n        this.upListener = function(e) {\n            if (downAt) {\n                downAt = null;\n                this.params.unbind(document, \"mousemove\", this.moveListener);\n                this.params.unbind(document, \"mouseup\", this.upListener);\n                this.params.removeClass(document.body, css.noSelect);\n                this.unmark(e);\n                k.unmarkSelection(this, e);\n                k.unmarkPosses(this, e);\n                this.stop(e);\n                k.notifySelectionDragStop(this, e);\n                k.notifyPosseDragStop(this, e);\n                moving = false;\n                if (clone) {\n                    dragEl && dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\n                    dragEl = null;\n                }\n\n                if (revertFunction && revertFunction(this.el, this.params.getPosition(this.el)) === true) {\n                    this.params.setPosition(this.el, posAtDown);\n                    _dispatch(\"revert\", this.el);\n                }\n            }\n        }.bind(this);\n\n        this.getFilters = function() { return _filters; };\n\n        this.abort = function() {\n            if (downAt != null)\n                this.upListener();\n        };\n\n        this.getDragElement = function() {\n            return dragEl || this.el;\n        };\n\n        var listeners = {\"start\":[], \"drag\":[], \"stop\":[], \"over\":[], \"out\":[], \"beforeStart\":[], \"revert\":[] };\n        if (params.events.start) listeners.start.push(params.events.start);\n        if (params.events.beforeStart) listeners.beforeStart.push(params.events.beforeStart);\n        if (params.events.stop) listeners.stop.push(params.events.stop);\n        if (params.events.drag) listeners.drag.push(params.events.drag);\n        if (params.events.revert) listeners.revert.push(params.events.revert);\n\n        this.on = function(evt, fn) {\n            if (listeners[evt]) listeners[evt].push(fn);\n        };\n\n        this.off = function(evt, fn) {\n            if (listeners[evt]) {\n                var l = [];\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    if (listeners[evt][i] !== fn) l.push(listeners[evt][i]);\n                }\n                listeners[evt] = l;\n            }\n        };\n\n        var _dispatch = function(evt, value) {\n            if (listeners[evt]) {\n                for (var i = 0; i < listeners[evt].length; i++) {\n                    try {\n                        listeners[evt][i](value);\n                    }\n                    catch (e) { }\n                }\n            }\n        };\n\n        this.notifyStart = function(e) {\n            _dispatch(\"start\", {el:this.el, pos:this.params.getPosition(dragEl), e:e, drag:this});\n        };\n\n        this.stop = function(e, force) {\n            if (force || moving) {\n                var positions = [],\n                    sel = k.getSelection(),\n                    dPos = this.params.getPosition(dragEl);\n\n                if (sel.length > 1) {\n                    for (var i = 0; i < sel.length; i++) {\n                        var p = this.params.getPosition(sel[i].el);\n                        positions.push([ sel[i].el, { left: p[0], top: p[1] }, sel[i] ]);\n                    }\n                }\n                else {\n                    positions.push([ dragEl, {left:dPos[0], top:dPos[1]}, this ]);\n                }\n\n                _dispatch(\"stop\", {\n                    el: dragEl,\n                    pos: ghostProxyOffsets || dPos,\n                    finalPos:dPos,\n                    e: e,\n                    drag: this,\n                    selection:positions\n                });\n            }\n        };\n\n        this.mark = function(andNotify) {\n            posAtDown = this.params.getPosition(dragEl);\n            pagePosAtDown = this.params.getPosition(dragEl, true);\n            pageDelta = [pagePosAtDown[0] - posAtDown[0], pagePosAtDown[1] - posAtDown[1]];\n            this.size = this.params.getSize(dragEl);\n            matchingDroppables = k.getMatchingDroppables(this);\n            _setDroppablesActive(matchingDroppables, true, false, this);\n            this.params.addClass(dragEl, this.params.dragClass || css.drag);\n            //if (this.params.constrain || this.params.containment) {\n            var cs = this.params.getSize(dragEl.parentNode);\n            constrainRect = { w:cs[0], h:cs[1] };\n            //}\n            if (andNotify) {\n                k.notifySelectionDragStart(this);\n            }\n        };\n        var ghostProxyOffsets;\n        this.unmark = function(e, doNotCheckDroppables) {\n            _setDroppablesActive(matchingDroppables, false, true, this);\n\n\n            if (isConstrained && useGhostProxy(this.el)) {\n                ghostProxyOffsets = [dragEl.offsetLeft, dragEl.offsetTop];\n                this.el.parentNode.removeChild(dragEl);\n                dragEl = this.el;\n            }\n            else {\n                ghostProxyOffsets = null;\n            }\n\n            this.params.removeClass(dragEl, this.params.dragClass || css.drag);\n            matchingDroppables.length = 0;\n            isConstrained = false;\n            if (!doNotCheckDroppables) {\n                if (intersectingDroppables.length > 0 && ghostProxyOffsets) {\n                    params.setPosition(this.el, ghostProxyOffsets);\n                }\n                for (var i = 0; i < intersectingDroppables.length; i++) {\n                    var retVal = intersectingDroppables[i].drop(this, e);\n                    if (retVal === true) break;\n                }\n            }\n        };\n        this.moveBy = function(dx, dy, e) {\n            intersectingDroppables.length = 0;\n            var desiredLoc = this.toGrid([posAtDown[0] + dx, posAtDown[1] + dy]),\n                cPos = constrain(desiredLoc, dragEl);\n\n            if (useGhostProxy(this.el)) {\n                if (desiredLoc[0] != cPos[0] || desiredLoc[1] != cPos[1]) {\n                    if (!isConstrained) {\n                        var gp = ghostProxy(this.el);\n                        params.addClass(gp, _classes.ghostProxy);\n                        this.el.parentNode.appendChild(gp);\n                        dragEl = gp;\n                        isConstrained = true;\n                    }\n                    cPos = desiredLoc;\n                }\n                else {\n                    if (isConstrained) {\n                        this.el.parentNode.removeChild(dragEl);\n                        dragEl = this.el;\n                        isConstrained = false;\n                    }\n                }\n            }\n\n            var rect = { x:cPos[0], y:cPos[1], w:this.size[0], h:this.size[1]},\n                pageRect = { x:rect.x + pageDelta[0], y:rect.y + pageDelta[1], w:rect.w, h:rect.h},\n                focusDropElement = null;\n\n\n\n            this.params.setPosition(dragEl, cPos);\n            for (var i = 0; i < matchingDroppables.length; i++) {\n                var r2 = { x:matchingDroppables[i].pagePosition[0], y:matchingDroppables[i].pagePosition[1], w:matchingDroppables[i].size[0], h:matchingDroppables[i].size[1]};\n                if (this.params.intersects(pageRect, r2) && (_multipleDrop || focusDropElement == null || focusDropElement == matchingDroppables[i].el) && matchingDroppables[i].canDrop(this)) {\n                    if (!focusDropElement) focusDropElement = matchingDroppables[i].el;\n                    intersectingDroppables.push(matchingDroppables[i]);\n                    matchingDroppables[i].setHover(this, true, e);\n                }\n                else if (matchingDroppables[i].isHover()) {\n                    matchingDroppables[i].setHover(this, false, e);\n                }\n            }\n\n            _dispatch(\"drag\", {el:this.el, pos:cPos, e:e, drag:this});\n\n            /* test to see if the parent needs to be scrolled (future)\n             if (scroll) {\n             var pnsl = dragEl.parentNode.scrollLeft, pnst = dragEl.parentNode.scrollTop;\n             console.log(\"scroll!\", pnsl, pnst);\n             }*/\n        };\n        this.destroy = function() {\n            this.params.unbind(this.el, \"mousedown\", this.downListener);\n            this.params.unbind(document, \"mousemove\", this.moveListener);\n            this.params.unbind(document, \"mouseup\", this.upListener);\n            this.downListener = null;\n            this.upListener = null;\n            this.moveListener = null;\n        };\n\n        // init:register mousedown, and perhaps set a filter\n        this.params.bind(this.el, \"mousedown\", this.downListener);\n\n        // if handle provded, use that.  otherwise, try to set a filter.\n        // note that a `handle` selector always results in filterExclude being set to false, ie.\n        // the selector defines the handle element(s).\n        if (this.params.handle)\n            _setFilter(this.params.handle, false);\n        else\n            _setFilter(this.params.filter, this.params.filterExclude);\n    };\n\n    var Drop = function(el, params, css, scope) {\n        this._class = css.droppable;\n        this.params = params || {};\n        this._activeClass = this.params.activeClass || css.active;\n        this._hoverClass = this.params.hoverClass || css.hover;\n        Super.apply(this, arguments);\n        var hover = false;\n        this.allowLoopback = this.params.allowLoopback !== false;\n\n        this.setActive = function(val) {\n            this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._activeClass);\n        };\n\n        this.updatePosition = function() {\n            this.position = this.params.getPosition(this.el);\n            this.pagePosition = this.params.getPosition(this.el, true);\n            this.size = this.params.getSize(this.el);\n        };\n\n        this.canDrop = this.params.canDrop || function(drag) {\n            return true;\n        };\n\n        this.isHover = function() { return hover; };\n\n        this.setHover = function(drag, val, e) {\n            // if turning off hover but this was not the drag that caused the hover, ignore.\n            if (val || this.el._katavorioDragHover == null || this.el._katavorioDragHover == drag.el._katavorio) {\n                this.params[val ? \"addClass\" : \"removeClass\"](this.el, this._hoverClass);\n                //this.el._katavorioDragHover = val ? drag.el._katavorio : null;\n                this.el._katavorioDragHover = val ? drag.el._katavorio : null;\n                if (hover !== val)\n                    this.params.events[val ? \"over\" : \"out\"]({el:this.el, e:e, drag:drag, drop:this});\n                hover = val;\n            }\n        };\n\n        this.drop = function(drag, event) {\n            return this.params.events[\"drop\"]({ drag:drag, e:event, drop:this });\n        };\n\n        this.destroy = function() {\n            this._class = null;\n            this._activeClass = null;\n            this._hoverClass = null;\n            //this.params = null;\n            hover = null;\n            //this.el = null;\n        };\n    };\n\n    var _uuid = function() {\n        return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n            return v.toString(16);\n        }));\n    };\n\n    var _gel = function(el) {\n        if (el == null) return null;\n        el = (typeof el === \"string\" || el.constructor == String)  ? document.getElementById(el) : el;\n        if (el == null) return null;\n        el._katavorio = el._katavorio || _uuid();\n        return el;\n    };\n\n    root.Katavorio = function(katavorioParams) {\n\n        var _selection = [],\n            _selectionMap = {};\n\n        this._dragsByScope = {};\n        this._dropsByScope = {};\n        var _zoom = 1,\n            _reg = function(obj, map) {\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        map[_obj.scopes[i]] = map[_obj.scopes[i]] || [];\n                        map[_obj.scopes[i]].push(_obj);\n                    }\n                });\n            },\n            _unreg = function(obj, map) {\n                var c = 0;\n                _each(obj, function(_obj) {\n                    for(var i = 0; i < _obj.scopes.length; i++) {\n                        if (map[_obj.scopes[i]]) {\n                            var idx = katavorioParams.indexOf(map[_obj.scopes[i]], _obj);\n                            if (idx != -1) {\n                                map[_obj.scopes[i]].splice(idx, 1);\n                                c++;\n                            }\n                        }\n                    }\n                });\n\n                return c > 0 ;\n            },\n            _getMatchingDroppables = this.getMatchingDroppables = function(drag) {\n                var dd = [], _m = {};\n                for (var i = 0; i < drag.scopes.length; i++) {\n                    var _dd = this._dropsByScope[drag.scopes[i]];\n                    if (_dd) {\n                        for (var j = 0; j < _dd.length; j++) {\n                            if (_dd[j].canDrop(drag) &&  !_m[_dd[j].uuid] && (_dd[j].allowLoopback || _dd[j].el !== drag.el)) {\n                                _m[_dd[j].uuid] = true;\n                                dd.push(_dd[j]);\n                            }\n                        }\n                    }\n                }\n                return dd;\n            },\n            _prepareParams = function(p) {\n                p = p || {};\n                var _p = {\n                    events:{}\n                }, i;\n                for (i in katavorioParams) _p[i] = katavorioParams[i];\n                for (i in p) _p[i] = p[i];\n                // events\n\n                for (i = 0; i < _events.length; i++) {\n                    _p.events[_events[i]] = p[_events[i]] || _devNull;\n                }\n                _p.katavorio = this;\n                return _p;\n            }.bind(this),\n            _mistletoe = function(existingDrag, params) {\n                for (var i = 0; i < _events.length; i++) {\n                    if (params[_events[i]]) {\n                        existingDrag.on(_events[i], params[_events[i]]);\n                    }\n                }\n            }.bind(this),\n            _css = {},\n            overrideCss = katavorioParams.css || {},\n            _scope = katavorioParams.scope || _defaultScope;\n\n        // prepare map of css classes based on defaults frst, then optional overrides\n        for (var i in _classes) _css[i] = _classes[i];\n        for (var i in overrideCss) _css[i] = overrideCss[i];\n\n        var inputFilterSelector = katavorioParams.inputFilterSelector || _defaultInputFilterSelector;\n        /**\n         * Gets the selector identifying which input elements to filter from drag events.\n         * @method getInputFilterSelector\n         * @return {String} Current input filter selector.\n         */\n        this.getInputFilterSelector = function() { return inputFilterSelector; };\n\n        /**\n         * Sets the selector identifying which input elements to filter from drag events.\n         * @method setInputFilterSelector\n         * @param {String} selector Input filter selector to set.\n         * @return {Katavorio} Current instance; method may be chained.\n         */\n        this.setInputFilterSelector = function(selector) {\n            inputFilterSelector = selector;\n            return this;\n        };\n\n        this.draggable = function(el, params) {\n            var o = [];\n            _each(el, function(_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    if (_el._katavorioDrag == null) {\n                        var p = _prepareParams(params);\n                        _el._katavorioDrag = new Drag(_el, p, _css, _scope);\n                        _reg(_el._katavorioDrag, this._dragsByScope);\n                        o.push(_el._katavorioDrag);\n                        katavorioParams.addClass(_el, _css.draggable);\n                    }\n                    else {\n                        _mistletoe(_el._katavorioDrag, params);\n                    }\n                }\n            }.bind(this));\n            return o;\n\n        };\n\n        this.droppable = function(el, params) {\n            var o = [];\n            _each(el, function(_el) {\n                _el = _gel(_el);\n                if (_el != null) {\n                    var drop = new Drop(_el, _prepareParams(params), _css, _scope);\n                    _el._katavorioDrop = _el._katavorioDrop || [];\n                    _el._katavorioDrop.push(drop);\n                    _reg(drop, this._dropsByScope);\n                    o.push(drop);\n                    katavorioParams.addClass(_el, _css.droppable);\n                }\n            }.bind(this));\n            return o;\n        };\n\n        /**\n         * @name Katavorio#select\n         * @function\n         * @desc Adds an element to the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to add.\n         */\n        this.select = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorioDrag) {\n                    if (!_selectionMap[_el._katavorio]) {\n                        _selection.push(_el._katavorioDrag);\n                        _selectionMap[_el._katavorio] = [ _el, _selection.length - 1 ];\n                        katavorioParams.addClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        /**\n         * @name Katavorio#deselect\n         * @function\n         * @desc Removes an element from the current selection (for multiple node drag)\n         * @param {Element|String} DOM element - or id of the element - to remove.\n         */\n        this.deselect = function(el) {\n            _each(el, function() {\n                var _el = _gel(this);\n                if (_el && _el._katavorio) {\n                    var e = _selectionMap[_el._katavorio];\n                    if (e) {\n                        var _s = [];\n                        for (var i = 0; i < _selection.length; i++)\n                            if (_selection[i].el !== _el) _s.push(_selection[i]);\n                        _selection = _s;\n                        delete _selectionMap[_el._katavorio];\n                        katavorioParams.removeClass(_el, _css.selected);\n                    }\n                }\n            });\n            return this;\n        };\n\n        this.deselectAll = function() {\n            for (var i in _selectionMap) {\n                var d = _selectionMap[i];\n                katavorioParams.removeClass(d[0], _css.selected);\n            }\n\n            _selection.length = 0;\n            _selectionMap = {};\n        };\n\n        this.markSelection = function(drag) {\n            _foreach(_selection, function(e) { e.mark(); }, drag);\n        };\n\n        this.markPosses = function(drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.mark();\n                        }, drag);\n                    }\n                })\n            }\n        };\n\n        this.unmarkSelection = function(drag, event) {\n            _foreach(_selection, function(e) { e.unmark(event); }, drag);\n        };\n\n        this.unmarkPosses = function(drag, event) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (d) {\n                            d.unmark(event, true);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.getSelection = function() { return _selection.slice(0); };\n\n        this.updateSelection = function(dx, dy, drag) {\n            _foreach(_selection, function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        var _posseAction = function(fn, drag) {\n            if (drag.posses) {\n                _each(drag.posses, function(p) {\n                    if (drag.posseRoles[p] && _posses[p]) {\n                        _foreach(_posses[p].members, function (e) {\n                            fn(e);\n                        }, drag);\n                    }\n                });\n            }\n        };\n\n        this.updatePosses = function(dx, dy, drag) {\n            _posseAction(function(e) { e.moveBy(dx, dy); }, drag);\n        };\n\n        this.notifyPosseDragStop = function(drag, evt) {\n            _posseAction(function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStop = function(drag, evt) {\n            _foreach(_selection, function(e) { e.stop(evt, true); }, drag);\n        };\n\n        this.notifySelectionDragStart = function(drag, evt) {\n            _foreach(_selection, function(e) { e.notifyStart(evt);}, drag);\n        };\n\n        this.setZoom = function(z) { _zoom = z; };\n        this.getZoom = function() { return _zoom; };\n\n        // does the work of changing scopes\n        var _scopeManip = function(kObj, scopes, map, fn) {\n            _each(kObj, function(_kObj) {\n                _unreg(_kObj, map);  // deregister existing scopes\n                _kObj[fn](scopes); // set scopes\n                _reg(_kObj, map); // register new ones\n            });\n        };\n\n        _each([ \"set\", \"add\", \"remove\", \"toggle\"], function(v) {\n            this[v + \"Scope\"] = function(el, scopes) {\n                _scopeManip(el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n                _scopeManip(el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DragScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drag ? el : el._katavorioDrag, scopes, this._dragsByScope, v + \"Scope\");\n            }.bind(this);\n            this[v + \"DropScope\"] = function(el, scopes) {\n                _scopeManip(el.constructor === Drop ? el : el._katavorioDrop, scopes, this._dropsByScope, v + \"Scope\");\n            }.bind(this);\n        }.bind(this));\n\n        this.snapToGrid = function(x, y) {\n            for (var s in this._dragsByScope) {\n                _foreach(this._dragsByScope[s], function(d) { d.snap(x, y); });\n            }\n        };\n\n        this.getDragsForScope = function(s) { return this._dragsByScope[s]; };\n        this.getDropsForScope = function(s) { return this._dropsByScope[s]; };\n\n        var _destroy = function(el, type, map) {\n            el = _gel(el);\n            if (el[type]) {\n                if (_unreg(el[type], map)) {\n                    _each(el[type], function(kObj) { kObj.destroy() });\n                }\n\n                delete el[type];\n            }\n        };\n\n        this.elementRemoved = function(el) {\n            this.destroyDraggable(el);\n            this.destroyDroppable(el);\n        };\n\n        this.destroyDraggable = function(el) {\n            _destroy(el, \"_katavorioDrag\", this._dragsByScope);\n        };\n\n        this.destroyDroppable = function(el) {\n            _destroy(el, \"_katavorioDrop\", this._dropsByScope);\n        };\n\n        this.reset = function() {\n            this._dragsByScope = {};\n            this._dropsByScope = {};\n            _selection = [];\n            _selectionMap = {};\n            _posses = {};\n        };\n\n        // ----- groups\n        var _posses = {};\n\n        var _processOneSpec = function(el, _spec, dontAddExisting) {\n            var posseId = _isString(_spec) ? _spec : _spec.id;\n            var active = _isString(_spec) ? true : _spec.active !== false;\n            var posse = _posses[posseId] || (function() {\n                var g = {name:posseId, members:[]};\n                _posses[posseId] = g;\n                return g;\n            })();\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n\n                    if (dontAddExisting && _el._katavorioDrag.posseRoles[posse.name] != null) return;\n\n                    _suggest(posse.members, _el._katavorioDrag);\n                    _suggest(_el._katavorioDrag.posses, posse.name);\n                    _el._katavorioDrag.posseRoles[posse.name] = active;\n                }\n            });\n            return posse;\n        };\n\n        /**\n         * Add the given element to the posse with the given id, creating the group if it at first does not exist.\n         * @method addToPosse\n         * @param {Element} el Element to add.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) was/were added.\n         */\n        this.addToPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i]));\n            }\n\n            return posses.length == 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Sets the posse(s) for the element with the given id, creating those that do not yet exist, and removing from\n         * the element any current Posses that are not specified by this method call. This method will not change the\n         * active/passive state if it is given a posse in which the element is already a member.\n         * @method setPosse\n         * @param {Element} el Element to set posse(s) on.\n         * @param {String...|Object...} spec Variable args parameters. Each argument can be a either a String, indicating\n         * the ID of a Posse to which the element should be added as an active participant, or an Object containing\n         * `{ id:\"posseId\", active:false/true}`. In the latter case, if `active` is not provided it is assumed to be\n         * true.\n         * @returns {Posse|Posse[]} The Posse(s) to which the element(s) now belongs.\n         */\n        this.setPosse = function(el, spec) {\n\n            var posses = [];\n\n            for (var i = 1; i < arguments.length; i++) {\n                posses.push(_processOneSpec(el, arguments[i], true).name);\n            }\n\n            _each(el, function(_el) {\n                if (_el._katavorioDrag) {\n                    var diff = _difference(_el._katavorioDrag.posses, posses);\n                    var p = [];\n                    Array.prototype.push.apply(p, _el._katavorioDrag.posses);\n                    for (var i = 0; i < diff.length; i++) {\n                        this.removeFromPosse(_el, diff[i]);\n                    }\n                }\n            }.bind(this));\n\n            return posses.length == 1 ? posses[0] : posses;\n        };\n\n        /**\n         * Remove the given element from the given posse(s).\n         * @method removeFromPosse\n         * @param {Element} el Element to remove.\n         * @param {String...} posseId Varargs parameter: one value for each posse to remove the element from.\n         */\n        this.removeFromPosse = function(el, posseId) {\n            if (arguments.length < 2) throw new TypeError(\"No posse id provided for remove operation\");\n            for(var i = 1; i < arguments.length; i++) {\n                posseId = arguments[i];\n                _each(el, function (_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        var d = _el._katavorioDrag;\n                        _each(posseId, function (p) {\n                            _vanquish(_posses[p].members, d);\n                            _vanquish(d.posses, p);\n                            delete d.posseRoles[p];\n                        });\n                    }\n                });\n            }\n        };\n\n        /**\n         * Remove the given element from all Posses to which it belongs.\n         * @method removeFromAllPosses\n         * @param {Element|Element[]} el Element to remove from Posses.\n         */\n        this.removeFromAllPosses = function(el) {\n            _each(el, function(_el) {\n                if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                    var d = _el._katavorioDrag;\n                    _each(d.posses, function(p) {\n                        _vanquish(_posses[p].members, d);\n                    });\n                    d.posses.length = 0;\n                    d.posseRoles = {};\n                }\n            });\n        };\n\n        /**\n         * Changes the participation state for the element in the Posse with the given ID.\n         * @param {Element|Element[]} el Element(s) to change state for.\n         * @param {String} posseId ID of the Posse to change element state for.\n         * @param {Boolean} state True to make active, false to make passive.\n         */\n        this.setPosseState = function(el, posseId, state) {\n            var posse = _posses[posseId];\n            if (posse) {\n                _each(el, function(_el) {\n                    if (_el._katavorioDrag && _el._katavorioDrag.posses) {\n                        _el._katavorioDrag.posseRoles[posse.name] = state;\n                    }\n                });\n            }\n        };\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n *\n * Title:jsPlumb 2.1.1\n *\n * Provides a way to visually connect elements on an HTML page, using SVG.\n *\n * This file contains utility functions that run in both browsers and headless.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n\n;\n(function () {\n\n    var _isa = function (a) {\n            return Object.prototype.toString.call(a) === \"[object Array]\";\n        },\n        _isnum = function (n) {\n            return Object.prototype.toString.call(n) === \"[object Number]\";\n        },\n        _iss = function (s) {\n            return typeof s === \"string\";\n        },\n        _isb = function (s) {\n            return typeof s === \"boolean\";\n        },\n        _isnull = function (s) {\n            return s == null;\n        },\n        _iso = function (o) {\n            return o == null ? false : Object.prototype.toString.call(o) === \"[object Object]\";\n        },\n        _isd = function (o) {\n            return Object.prototype.toString.call(o) === \"[object Date]\";\n        },\n        _isf = function (o) {\n            return Object.prototype.toString.call(o) === \"[object Function]\";\n        },\n        _isNamedFunction = function(o) {\n            return _isf(o) && o.name != null && o.name.length > 0;\n        },\n        _ise = function (o) {\n            for (var i in o) {\n                if (o.hasOwnProperty(i)) return false;\n            }\n            return true;\n        };\n\n    var root = this;\n    var exports = root.jsPlumbUtil = {\n        isArray: _isa,\n        isString: _iss,\n        isBoolean: _isb,\n        isNull: _isnull,\n        isObject: _iso,\n        isDate: _isd,\n        isFunction: _isf,\n        isEmpty: _ise,\n        isNumber: _isnum,\n        clone: function (a) {\n            if (_iss(a)) return \"\" + a;\n            else if (_isb(a)) return !!a;\n            else if (_isd(a)) return new Date(a.getTime());\n            else if (_isf(a)) return a;\n            else if (_isa(a)) {\n                var b = [];\n                for (var i = 0; i < a.length; i++)\n                    b.push(this.clone(a[i]));\n                return b;\n            }\n            else if (_iso(a)) {\n                var c = {};\n                for (var j in a)\n                    c[j] = this.clone(a[j]);\n                return c;\n            }\n            else return a;\n        },\n        merge: function (a, b, collations) {\n            // first change the collations array - if present - into a lookup table, because its faster.\n            var cMap = {}, ar, i;\n            collations = collations || [];\n            for (i = 0; i < collations.length; i++)\n                cMap[collations[i]] = true;\n\n            var c = this.clone(a);\n            for (i in b) {\n                if (c[i] == null) {\n                    c[i] = b[i];\n                }\n                else if (_iss(b[i]) || _isb(b[i])) {\n                    if (!cMap[i]) {\n                        c[i] = b[i]; // if we dont want to collate, just copy it in.\n                    }\n                    else {\n                        ar = [];\n                        // if c's object is also an array we can keep its values.\n                        ar.push.apply(ar, _isa(c[i]) ? c[i] : [ c[i] ]);\n                        ar.push.apply(ar, _isa(b[i]) ? b[i] : [ b[i] ]);\n                        c[i] = ar;\n                    }\n                }\n                else {\n                    if (_isa(b[i])) {\n                        ar = [];\n                        // if c's object is also an array we can keep its values.\n                        if (_isa(c[i])) ar.push.apply(ar, c[i]);\n                        ar.push.apply(ar, b[i]);\n                        c[i] = ar;\n                    }\n                    else if (_iso(b[i])) {\n                        // overwite c's value with an object if it is not already one.\n                        if (!_iso(c[i]))\n                            c[i] = {};\n                        for (var j in b[i]) {\n                            c[i][j] = b[i][j];\n                        }\n                    }\n                }\n\n            }\n            return c;\n        },\n        replace: function (inObj, path, value) {\n            if (inObj == null) return;\n            var q = inObj, t = q;\n            path.replace(/([^\\.])+/g, function (term, lc, pos, str) {\n                var array = term.match(/([^\\[0-9]+){1}(\\[)([0-9+])/),\n                    last = pos + term.length >= str.length,\n                    _getArray = function () {\n                        return t[array[1]] || (function () {\n                            t[array[1]] = [];\n                            return t[array[1]];\n                        })();\n                    };\n\n                if (last) {\n                    // set term = value on current t, creating term as array if necessary.\n                    if (array)\n                        _getArray()[array[3]] = value;\n                    else\n                        t[term] = value;\n                }\n                else {\n                    // set to current t[term], creating t[term] if necessary.\n                    if (array) {\n                        var a = _getArray();\n                        t = a[array[3]] || (function () {\n                            a[array[3]] = {};\n                            return a[array[3]];\n                        })();\n                    }\n                    else\n                        t = t[term] || (function () {\n                            t[term] = {};\n                            return t[term];\n                        })();\n                }\n            });\n\n            return inObj;\n        },\n        //\n        // chain a list of functions, supplied by [ object, method name, args ], and return on the first\n        // one that returns the failValue. if none return the failValue, return the successValue.\n        //\n        functionChain: function (successValue, failValue, fns) {\n            for (var i = 0; i < fns.length; i++) {\n                var o = fns[i][0][fns[i][1]].apply(fns[i][0], fns[i][2]);\n                if (o === failValue) {\n                    return o;\n                }\n            }\n            return successValue;\n        },\n        // take the given model and expand out any parameters.\n        // 'functionPrefix' is optional, and if present, helps jsplumb figure out what to do if a value is a Function.\n        // if you do not provide it, jsplumb will run the given values through any functions it finds, and use the function's\n        // output as the value in the result. if you do provide the prefix, only functions that are named and have this prefix\n        // will be executed; other functions will be passed as values to the output.\n        populate: function (model, values, functionPrefix) {\n            // for a string, see if it has parameter matches, and if so, try to make the substitutions.\n            var getValue = function (fromString) {\n                    var matches = fromString.match(/(\\${.*?})/g);\n                    if (matches != null) {\n                        for (var i = 0; i < matches.length; i++) {\n                            var val = values[matches[i].substring(2, matches[i].length - 1)] || \"\";\n                            if (val != null) {\n                                fromString = fromString.replace(matches[i], val);\n                            }\n                        }\n                    }\n                    return fromString;\n                },\n            // process one entry.\n                _one = function (d) {\n                    if (d != null) {\n                        if (_iss(d)) {\n                            return getValue(d);\n                        }\n                        else if (_isf(d) && (functionPrefix == null || (d.name || \"\").indexOf(functionPrefix) === 0)) {\n                            return d(values);\n                        }\n                        else if (_isa(d)) {\n                            var r = [];\n                            for (var i = 0; i < d.length; i++)\n                                r.push(_one(d[i]));\n                            return r;\n                        }\n                        else if (_iso(d)) {\n                            var s = {};\n                            for (var j in d) {\n                                s[j] = _one(d[j]);\n                            }\n                            return s;\n                        }\n                        else {\n                            return d;\n                        }\n                    }\n                };\n\n            return _one(model);\n        },\n        findWithFunction: function (a, f) {\n            if (a)\n                for (var i = 0; i < a.length; i++) if (f(a[i])) return i;\n            return -1;\n        },\n        removeWithFunction: function (a, f) {\n            var idx = exports.findWithFunction(a, f);\n            if (idx > -1) a.splice(idx, 1);\n            return idx != -1;\n        },\n        remove: function (l, v) {\n            var idx = l.indexOf(v);\n            if (idx > -1) l.splice(idx, 1);\n            return idx != -1;\n        },\n        // TODO support insert index\n        addWithFunction: function (list, item, hashFunction) {\n            if (exports.findWithFunction(list, hashFunction) == -1) list.push(item);\n        },\n        addToList: function (map, key, value, insertAtStart) {\n            var l = map[key];\n            if (l == null) {\n                l = [];\n                map[key] = l;\n            }\n            l[insertAtStart ? \"unshift\" : \"push\"](value);\n            return l;\n        },\n        suggest : function(list, item, insertAtHead) {\n            if (list.indexOf(item) === -1) {\n                if (insertAtHead) {\n                    list.unshift(item);\n                } else {\n                    list.push(item);\n                }\n                return true;\n            }\n            return false;\n        },\n        //\n        // extends the given obj (which can be an array) with the given constructor function, prototype functions, and\n        // class members, any of which may be null.\n        //\n        extend: function (child, parent, _protoFn) {\n            var i;\n            parent = _isa(parent) ? parent : [ parent ];\n\n            for (i = 0; i < parent.length; i++) {\n                for (var j in parent[i].prototype) {\n                    if (parent[i].prototype.hasOwnProperty(j)) {\n                        child.prototype[j] = parent[i].prototype[j];\n                    }\n                }\n            }\n\n            var _makeFn = function (name, protoFn) {\n                return function () {\n                    for (i = 0; i < parent.length; i++) {\n                        if (parent[i].prototype[name])\n                            parent[i].prototype[name].apply(this, arguments);\n                    }\n                    return protoFn.apply(this, arguments);\n                };\n            };\n\n            var _oneSet = function (fns) {\n                for (var k in fns) {\n                    child.prototype[k] = _makeFn(k, fns[k]);\n                }\n            };\n\n            if (arguments.length > 2) {\n                for (i = 2; i < arguments.length; i++)\n                    _oneSet(arguments[i]);\n            }\n\n            return child;\n        },\n        uuid: function () {\n            return ('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n                return v.toString(16);\n            }));\n        },\n        logEnabled: true,\n        log: function () {\n            if (exports.logEnabled && typeof console != \"undefined\") {\n                try {\n                    var msg = arguments[arguments.length - 1];\n                    void 0;\n                }\n                catch (e) {\n                }\n            }\n        },\n\n        /**\n         * Wraps one function with another, creating a placeholder for the\n         * wrapped function if it was null. this is used to wrap the various\n         * drag/drop event functions - to allow jsPlumb to be notified of\n         * important lifecycle events without imposing itself on the user's\n         * drag/drop functionality.\n         * @method jsPlumbUtil.wrap\n         * @param {Function} wrappedFunction original function to wrap; may be null.\n         * @param {Function} newFunction function to wrap the original with.\n         * @param {Object} [returnOnThisValue] Optional. Indicates that the wrappedFunction should\n         * not be executed if the newFunction returns a value matching 'returnOnThisValue'.\n         * note that this is a simple comparison and only works for primitives right now.\n         */\n        wrap: function (wrappedFunction, newFunction, returnOnThisValue) {\n            wrappedFunction = wrappedFunction || function () {\n            };\n            newFunction = newFunction || function () {\n            };\n            return function () {\n                var r = null;\n                try {\n                    r = newFunction.apply(this, arguments);\n                } catch (e) {\n                    exports.log(\"jsPlumb function failed : \" + e);\n                }\n                if (returnOnThisValue == null || (r !== returnOnThisValue)) {\n                    try {\n                        r = wrappedFunction.apply(this, arguments);\n                    } catch (e) {\n                        exports.log(\"wrapped function failed : \" + e);\n                    }\n                }\n                return r;\n            };\n        }\n    };\n\n    exports.EventGenerator = function () {\n        var _listeners = {},\n            eventsSuspended = false,\n        // this is a list of events that should re-throw any errors that occur during their dispatch. it is current private.\n            eventsToDieOn = { \"ready\": true };\n\n        this.bind = function (event, listener, insertAtStart) {\n            var _one = function(evt) {\n                exports.addToList(_listeners, evt, listener, insertAtStart);\n                listener.__jsPlumb = listener.__jsPlumb || {};\n                listener.__jsPlumb[root.jsPlumbUtil.uuid()] = evt;\n            };\n\n            if (typeof event === \"string\") _one(event);\n            else if (event.length != null) {\n                for (var i = 0; i < event.length; i++) {\n                    _one(event[i]);\n                }\n            }\n\n            return this;\n        };\n\n        this.fire = function (event, value, originalEvent) {\n            if (!eventsSuspended && _listeners[event]) {\n                var l = _listeners[event].length, i = 0, _gone = false, ret = null;\n                if (!this.shouldFireEvent || this.shouldFireEvent(event, value, originalEvent)) {\n                    while (!_gone && i < l && ret !== false) {\n                        // doing it this way rather than catching and then possibly re-throwing means that an error propagated by this\n                        // method will have the whole call stack available in the debugger.\n                        if (eventsToDieOn[event])\n                            _listeners[event][i].apply(this, [ value, originalEvent]);\n                        else {\n                            try {\n                                ret = _listeners[event][i].apply(this, [ value, originalEvent ]);\n                            } catch (e) {\n                                exports.log(\"jsPlumb: fire failed for event \" + event + \" : \" + e);\n                            }\n                        }\n                        i++;\n                        if (_listeners == null || _listeners[event] == null)\n                            _gone = true;\n                    }\n                }\n            }\n            return this;\n        };\n\n        this.unbind = function (eventOrListener, listener) {\n\n            if (arguments.length === 0) {\n                _listeners = {};\n            }\n            else if (arguments.length === 1) {\n                if (typeof eventOrListener === \"string\")\n                    delete _listeners[eventOrListener];\n                else if (eventOrListener.__jsPlumb) {\n                    var evt;\n                    for (var i in eventOrListener.__jsPlumb) {\n                        evt = eventOrListener.__jsPlumb[i];\n                        exports.remove(_listeners[evt] || [], eventOrListener);\n                    }\n                }\n            }\n            else if (arguments.length === 2) {\n                exports.remove(_listeners[eventOrListener] || [], listener);\n            }\n\n            return this;\n        };\n\n        this.getListener = function (forEvent) {\n            return _listeners[forEvent];\n        };\n        this.setSuspendEvents = function (val) {\n            eventsSuspended = val;\n        };\n        this.isSuspendEvents = function () {\n            return eventsSuspended;\n        };\n        this.silently = function(fn) {\n            this.setSuspendEvents(true);\n            try {\n                fn();\n            }\n            catch (e) {\n                root.jsPlumbUtil.log(\"Cannot execute silent function \" + e);\n            }\n            this.setSuspendEvents(false);\n        };\n        this.cleanupListeners = function () {\n            for (var i in _listeners) {\n                _listeners[i] = null;\n            }\n        };\n    };\n\n    exports.EventGenerator.prototype = {\n        cleanup: function () {\n            this.cleanupListeners();\n        }\n    };\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n *\n * Title:jsPlumb 2.1.1\n *\n * Provides a way to visually connect elements on an HTML page, using SVG.\n *\n * This file contains utility functions that run in browsers only.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n ;(function() {\n\n  \"use strict\";\n\n   var root = this;\n   var exports = root.jsPlumbUtil;\n\n   exports.matchesSelector = function(el, selector, ctx) {\n       ctx = ctx || el.parentNode;\n       var possibles = ctx.querySelectorAll(selector);\n       for (var i = 0; i < possibles.length; i++) {\n           if (possibles[i] === el)\n               return true;\n       }\n       return false;\n   };\n\n   exports.consume = function(e, doNotPreventDefault) {\n       if (e.stopPropagation)\n           e.stopPropagation();\n       else\n           e.returnValue = false;\n\n       if (!doNotPreventDefault && e.preventDefault)\n            e.preventDefault();\n   };\n\n   /*\n    * Function: sizeElement\n    * Helper to size and position an element. You would typically use\n    * this when writing your own Connector or Endpoint implementation.\n    *\n    * Parameters:\n    *  x - [int] x position for the element origin\n    *  y - [int] y position for the element origin\n    *  w - [int] width of the element\n    *  h - [int] height of the element\n    *\n    */\n   exports.sizeElement = function(el, x, y, w, h) {\n       if (el) {\n           el.style.height = h + \"px\";\n           el.height = h;\n           el.style.width = w + \"px\";\n           el.width = w;\n           el.style.left = x + \"px\";\n           el.style.top = y + \"px\";\n       }\n   };\n\n\n }).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the core code.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n(function () {\n\n    \"use strict\";\n\n    var root = this;\n    var connectorTypes = [], rendererTypes;\n\n    var _ju = root.jsPlumbUtil,\n        _getOffset = function (el, _instance, relativeToRoot) {\n            return _instance.getOffset(el, relativeToRoot);\n        },\n\n        /**\n         * creates a timestamp, using milliseconds since 1970, but as a string.\n         */\n        _timestamp = function () {\n            return \"\" + (new Date()).getTime();\n        },\n\n    // helper method to update the hover style whenever it, or paintStyle, changes.\n    // we use paintStyle as the foundation and merge hoverPaintStyle over the\n    // top.\n        _updateHoverStyle = function (component) {\n            if (component._jsPlumb.paintStyle && component._jsPlumb.hoverPaintStyle) {\n                var mergedHoverStyle = {};\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.paintStyle);\n                jsPlumb.extend(mergedHoverStyle, component._jsPlumb.hoverPaintStyle);\n                delete component._jsPlumb.hoverPaintStyle;\n                // we want the fillStyle of paintStyle to override a gradient, if possible.\n                if (mergedHoverStyle.gradient && component._jsPlumb.paintStyle.fillStyle)\n                    delete mergedHoverStyle.gradient;\n                component._jsPlumb.hoverPaintStyle = mergedHoverStyle;\n            }\n        },\n        events = [\"tap\", \"dbltap\", \"click\", \"dblclick\", \"mouseover\", \"mouseout\", \"mousemove\", \"mousedown\", \"mouseup\", \"contextmenu\" ],\n        eventFilters = { \"mouseout\": \"mouseleave\", \"mouseexit\": \"mouseleave\" },\n        _updateAttachedElements = function (component, state, timestamp, sourceElement) {\n            var affectedElements = component.getAttachedElements();\n            if (affectedElements) {\n                for (var i = 0, j = affectedElements.length; i < j; i++) {\n                    if (!sourceElement || sourceElement != affectedElements[i])\n                        affectedElements[i].setHover(state, true, timestamp);            // tell the attached elements not to inform their own attached elements.\n                }\n            }\n        },\n        _splitType = function (t) {\n            return t == null ? null : t.split(\" \");\n        },\n        _mapType = function(map, obj, typeId) {\n            for (var i in obj)\n                map[i] = typeId;\n        },\n        _each = function(fn, obj) {\n            obj = _ju.isArray(obj) || (obj.length != null && !_ju.isString(obj)) ? obj : [ obj ];\n            for (var i = 0; i < obj.length; i++) {\n                try {\n                    fn.apply(obj[i], [ obj[i] ]);\n                }\n                catch (e) {\n                    _ju.log(\".each iteration failed : \" + e);\n                }\n            }\n        },\n        _applyTypes = function (component, params, doNotRepaint) {\n            if (component.getDefaultType) {\n                var td = component.getTypeDescriptor(), map = {};\n                var defType = component.getDefaultType();\n                var o = _ju.merge({}, defType);\n                _mapType(map, defType, \"__default\");\n                for (var i = 0, j = component._jsPlumb.types.length; i < j; i++) {\n                    var tid = component._jsPlumb.types[i];\n                    if (tid !== \"__default\") {\n                        var _t = component._jsPlumb.instance.getType(tid, td);\n                        if (_t != null) {\n                            o = _ju.merge(o, _t, [ \"cssClass\" ]);\n                            _mapType(map, _t, tid);\n                        }\n                    }\n                }\n\n                if (params) {\n                    o = _ju.populate(o, params, \"_\");\n                }\n\n                component.applyType(o, doNotRepaint, map);\n                if (!doNotRepaint) component.repaint();\n            }\n        },\n\n// ------------------------------ BEGIN jsPlumbUIComponent --------------------------------------------\n\n        jsPlumbUIComponent = root.jsPlumbUIComponent = function (params) {\n\n            _ju.EventGenerator.apply(this, arguments);\n\n            var self = this,\n                a = arguments,\n                idPrefix = self.idPrefix,\n                id = idPrefix + (new Date()).getTime();\n\n            this._jsPlumb = {\n                instance: params._jsPlumb,\n                parameters: params.parameters || {},\n                paintStyle: null,\n                hoverPaintStyle: null,\n                paintStyleInUse: null,\n                hover: false,\n                beforeDetach: params.beforeDetach,\n                beforeDrop: params.beforeDrop,\n                overlayPlacements: [],\n                hoverClass: params.hoverClass || params._jsPlumb.Defaults.HoverClass,\n                types: [],\n                typeCache:{}\n            };\n\n            this.cacheTypeItem = function(key, item, typeId) {\n                this._jsPlumb.typeCache[typeId] = this._jsPlumb.typeCache[typeId] || {};\n                this._jsPlumb.typeCache[typeId][key] = item;\n            };\n            this.getCachedTypeItem = function(key, typeId) {\n                return this._jsPlumb.typeCache[typeId] ? this._jsPlumb.typeCache[typeId][key] : null;\n            };\n\n            this.getId = function () {\n                return id;\n            };\n\n// ----------------------------- default type --------------------------------------------\n\n\n            var o = params.overlays || [], oo = {};\n            if (this.defaultOverlayKeys) {\n                for (var i = 0; i < this.defaultOverlayKeys.length; i++)\n                    Array.prototype.push.apply(o, this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]] || []);\n\n                for (i = 0; i < o.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = jsPlumb.convertToFullOverlaySpec(o[i]);\n                    oo[fo[1].id] = fo;\n                }\n            }\n\n            var _defaultType = {\n                overlays:oo,\n                parameters: params.parameters || {},\n                scope: params.scope || this._jsPlumb.instance.getDefaultScope()\n            };\n            this.getDefaultType = function() {\n                return _defaultType;\n            };\n            this.appendToDefaultType = function(obj) {\n                for (var i in obj) _defaultType[i] = obj[i];\n            };\n\n// ----------------------------- end default type --------------------------------------------\n\n            // all components can generate events\n\n            if (params.events) {\n                for (i in params.events)\n                    self.bind(i, params.events[i]);\n            }\n\n            // all components get this clone function.\n            // TODO issue 116 showed a problem with this - it seems 'a' that is in\n            // the clone function's scope is shared by all invocations of it, the classic\n            // JS closure problem.  for now, jsPlumb does a version of this inline where\n            // it used to call clone.  but it would be nice to find some time to look\n            // further at this.\n            this.clone = function () {\n                var o = Object.create(this.constructor.prototype);\n                this.constructor.apply(o, a);\n                return o;\n            }.bind(this);\n\n            // user can supply a beforeDetach callback, which will be executed before a detach\n            // is performed; returning false prevents the detach.\n            this.isDetachAllowed = function (connection) {\n                var r = true;\n                if (this._jsPlumb.beforeDetach) {\n                    try {\n                        r = this._jsPlumb.beforeDetach(connection);\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDetach callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            // user can supply a beforeDrop callback, which will be executed before a dropped\n            // connection is confirmed. user can return false to reject connection.\n            this.isDropAllowed = function (sourceId, targetId, scope, connection, dropEndpoint, source, target) {\n                var r = this._jsPlumb.instance.checkCondition(\"beforeDrop\", {\n                    sourceId: sourceId,\n                    targetId: targetId,\n                    scope: scope,\n                    connection: connection,\n                    dropEndpoint: dropEndpoint,\n                    source: source, target: target\n                });\n                if (this._jsPlumb.beforeDrop) {\n                    try {\n                        r = this._jsPlumb.beforeDrop({\n                            sourceId: sourceId,\n                            targetId: targetId,\n                            scope: scope,\n                            connection: connection,\n                            dropEndpoint: dropEndpoint,\n                            source: source, target: target\n                        });\n                    }\n                    catch (e) {\n                        _ju.log(\"jsPlumb: beforeDrop callback failed\", e);\n                    }\n                }\n                return r;\n            };\n\n            var boundListeners = [],\n                bindAListener = function (obj, type, fn) {\n                    boundListeners.push([obj, type, fn]);\n                    obj.bind(type, fn);\n                },\n                domListeners = [];\n\n            // sets the component associated with listener events. for instance, an overlay delegates\n            // its events back to a connector. but if the connector is swapped on the underlying connection,\n            // then this component must be changed. This is called by setConnector in the Connection class.\n            this.setListenerComponent = function (c) {\n                for (var i = 0; i < domListeners.length; i++)\n                    domListeners[i][3] = c;\n            };\n\n\n        };\n\n    var _removeTypeCssHelper = function (component, typeIndex) {\n        var typeId = component._jsPlumb.types[typeIndex],\n            type = component._jsPlumb.instance.getType(typeId, component.getTypeDescriptor());\n\n        if (type != null) {\n\n            if (type.cssClass && component.canvas)\n                component._jsPlumb.instance.removeClass(component.canvas, type.cssClass);\n        }\n    };\n\n    _ju.extend(root.jsPlumbUIComponent, _ju.EventGenerator, {\n\n        getParameter: function (name) {\n            return this._jsPlumb.parameters[name];\n        },\n\n        setParameter: function (name, value) {\n            this._jsPlumb.parameters[name] = value;\n        },\n\n        getParameters: function () {\n            return this._jsPlumb.parameters;\n        },\n\n        setParameters: function (p) {\n            this._jsPlumb.parameters = p;\n        },\n\n        getClass:function() {\n            return jsPlumb.getClass(this.canvas);\n        },\n\n        hasClass:function(clazz) {\n            return jsPlumb.hasClass(this.canvas, clazz);\n        },\n\n        addClass: function (clazz) {\n            jsPlumb.addClass(this.canvas, clazz);\n        },\n\n        removeClass: function (clazz) {\n            jsPlumb.removeClass(this.canvas, clazz);\n        },\n\n        updateClasses: function (classesToAdd, classesToRemove) {\n            jsPlumb.updateClasses(this.canvas, classesToAdd, classesToRemove);\n        },\n\n        setType: function (typeId, params, doNotRepaint) {\n            this.clearTypes();\n            this._jsPlumb.types = _splitType(typeId) || [];\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        getType: function () {\n            return this._jsPlumb.types;\n        },\n\n        reapplyTypes: function (params, doNotRepaint) {\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        hasType: function (typeId) {\n            return this._jsPlumb.types.indexOf(typeId) != -1;\n        },\n\n        addType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false;\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    if (!this.hasType(t[i])) {\n                        this._jsPlumb.types.push(t[i]);\n                        _cont = true;\n                    }\n                }\n                if (_cont) _applyTypes(this, params, doNotRepaint);\n            }\n        },\n\n        removeType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId), _cont = false, _one = function (tt) {\n                var idx = this._jsPlumb.types.indexOf(tt);\n                if (idx != -1) {\n                    // remove css class if necessary\n                    _removeTypeCssHelper(this, idx);\n                    this._jsPlumb.types.splice(idx, 1);\n                    return true;\n                }\n                return false;\n            }.bind(this);\n\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    _cont = _one(t[i]) || _cont;\n                }\n                if (_cont) _applyTypes(this, params, doNotRepaint);\n            }\n        },\n        clearTypes: function (params, doNotRepaint) {\n            var i = this._jsPlumb.types.length;\n            for (var j = 0; j < i; j++) {\n                _removeTypeCssHelper(this, 0);\n                this._jsPlumb.types.splice(0, 1);\n            }\n            _applyTypes(this, params, doNotRepaint);\n        },\n\n        toggleType: function (typeId, params, doNotRepaint) {\n            var t = _splitType(typeId);\n            if (t != null) {\n                for (var i = 0, j = t.length; i < j; i++) {\n                    var idx = this._jsPlumb.types.indexOf(t[i]);\n                    if (idx != -1) {\n                        _removeTypeCssHelper(this, idx);\n                        this._jsPlumb.types.splice(idx, 1);\n                    }\n                    else\n                        this._jsPlumb.types.push(t[i]);\n                }\n\n                _applyTypes(this, params, doNotRepaint);\n            }\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.hoverPaintStyle, doNotRepaint);\n            if (t.parameters) {\n                for (var i in t.parameters)\n                    this.setParameter(i, t.parameters[i]);\n            }\n            this._jsPlumb.paintStyleInUse = this.getPaintStyle();\n        },\n        setPaintStyle: function (style, doNotRepaint) {\n//                this._jsPlumb.paintStyle = jsPlumb.extend({}, style);\n// TODO figure out if we want components to clone paintStyle so as not to share it.\n            this._jsPlumb.paintStyle = style;\n            this._jsPlumb.paintStyleInUse = this._jsPlumb.paintStyle;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) this.repaint();\n        },\n        getPaintStyle: function () {\n            return this._jsPlumb.paintStyle;\n        },\n        setHoverPaintStyle: function (style, doNotRepaint) {\n            //this._jsPlumb.hoverPaintStyle = jsPlumb.extend({}, style);\n// TODO figure out if we want components to clone paintStyle so as not to share it.                \n            this._jsPlumb.hoverPaintStyle = style;\n            _updateHoverStyle(this);\n            if (!doNotRepaint) this.repaint();\n        },\n        getHoverPaintStyle: function () {\n            return this._jsPlumb.hoverPaintStyle;\n        },\n        destroy: function (force) {\n            if (force || this.typeId == null) {\n                this.cleanupListeners(); // this is on EventGenerator\n                this.clone = null;\n                this._jsPlumb = null;\n            }\n        },\n\n        isHover: function () {\n            return this._jsPlumb.hover;\n        },\n\n        setHover: function (hover, ignoreAttachedElements, timestamp) {\n            // while dragging, we ignore these events.  this keeps the UI from flashing and\n            // swishing and whatevering.\n            if (this._jsPlumb && !this._jsPlumb.instance.currentlyDragging && !this._jsPlumb.instance.isHoverSuspended()) {\n\n                this._jsPlumb.hover = hover;\n\n                if (this.canvas != null) {\n                    if (this._jsPlumb.instance.hoverClass != null) {\n                        var method = hover ? \"addClass\" : \"removeClass\";\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.instance.hoverClass);\n                    }\n                    if (this._jsPlumb.hoverClass != null) {\n                        this._jsPlumb.instance[method](this.canvas, this._jsPlumb.hoverClass);\n                    }\n                }\n                if (this._jsPlumb.hoverPaintStyle != null) {\n                    this._jsPlumb.paintStyleInUse = hover ? this._jsPlumb.hoverPaintStyle : this._jsPlumb.paintStyle;\n                    if (!this._jsPlumb.instance.isSuspendDrawing()) {\n                        timestamp = timestamp || _timestamp();\n                        this.repaint({timestamp: timestamp, recalc: false});\n                    }\n                }\n                // get the list of other affected elements, if supported by this component.\n                // for a connection, its the endpoints.  for an endpoint, its the connections! surprise.\n                if (this.getAttachedElements && !ignoreAttachedElements)\n                    _updateAttachedElements(this, hover, _timestamp(), this);\n            }\n        }\n    });\n\n// ------------------------------ END jsPlumbUIComponent --------------------------------------------\n\n    var _jsPlumbInstanceIndex = 0,\n        getInstanceIndex = function () {\n            var i = _jsPlumbInstanceIndex + 1;\n            _jsPlumbInstanceIndex++;\n            return i;\n        };\n\n    var jsPlumbInstance = root.jsPlumbInstance = function (_defaults) {\n\n        this.Defaults = {\n            Anchor: \"Bottom\",\n            Anchors: [ null, null ],\n            ConnectionsDetachable: true,\n            ConnectionOverlays: [ ],\n            Connector: \"Bezier\",\n            Container: null,\n            DoNotThrowErrors: false,\n            DragOptions: { },\n            DropOptions: { },\n            Endpoint: \"Dot\",\n            EndpointOverlays: [ ],\n            Endpoints: [ null, null ],\n            EndpointStyle: { fillStyle: \"#456\" },\n            EndpointStyles: [ null, null ],\n            EndpointHoverStyle: null,\n            EndpointHoverStyles: [ null, null ],\n            HoverPaintStyle: null,\n            LabelStyle: { color: \"black\" },\n            LogEnabled: false,\n            Overlays: [ ],\n            MaxConnections: 1,\n            PaintStyle: { lineWidth: 4, strokeStyle: \"#456\" },\n            ReattachConnections: false,\n            RenderMode: \"svg\",\n            Scope: \"jsPlumb_DefaultScope\"\n        };\n        if (_defaults) jsPlumb.extend(this.Defaults, _defaults);\n\n        this.logEnabled = this.Defaults.LogEnabled;\n        this._connectionTypes = {};\n        this._endpointTypes = {};\n\n        _ju.EventGenerator.apply(this);\n\n        var _currentInstance = this,\n            _instanceIndex = getInstanceIndex(),\n            _bb = _currentInstance.bind,\n            _initialDefaults = {},\n            _zoom = 1,\n            _info = function (el) {\n                if (el == null) return null;\n                else if (el.nodeType == 3 || el.nodeType == 8) {\n                    return { el:el, text:true };\n                }\n                else {\n                    var _el = _currentInstance.getElement(el);\n                    return { el: _el, id: (_ju.isString(el) && _el == null) ? el : _getId(_el) };\n                }\n            };\n\n        this.getInstanceIndex = function () {\n            return _instanceIndex;\n        };\n\n        this.setZoom = function (z, repaintEverything) {\n            _zoom = z;\n            _currentInstance.fire(\"zoom\", _zoom);\n            if (repaintEverything) _currentInstance.repaintEverything();\n            return true;\n        };\n        this.getZoom = function () {\n            return _zoom;\n        };\n\n        for (var i in this.Defaults)\n            _initialDefaults[i] = this.Defaults[i];\n\n        var _container, _containerDelegations = [];\n        this.unbindContainer = function() {\n            if (_container != null && _containerDelegations.length > 0) {\n                for (var i = 0; i < _containerDelegations.length; i++) {\n                    _currentInstance.off(_container, _containerDelegations[i][0], _containerDelegations[i][1]);\n                }\n            }\n        };\n        this.setContainer = function (c) {\n\n            this.unbindContainer();\n\n            // get container as dom element.\n            c = this.getElement(c);\n            // move existing connections and endpoints, if any.\n            this.select().each(function (conn) {\n                conn.moveParent(c);\n            });\n            this.selectEndpoints().each(function (ep) {\n                ep.moveParent(c);\n            });\n\n            // set container.\n            var previousContainer = _container;\n            _container = c;\n            _containerDelegations.length = 0;\n            var eventAliases = {\n                \"endpointclick\":\"endpointClick\",\n                \"endpointdblclick\":\"endpointDblClick\"\n            };\n\n            var _oneDelegateHandler = function (id, e, componentType) {\n                var t = e.srcElement || e.target,\n                    jp = (t && t.parentNode ? t.parentNode._jsPlumb : null) || (t ? t._jsPlumb : null) || (t && t.parentNode && t.parentNode.parentNode ? t.parentNode.parentNode._jsPlumb : null);\n                if (jp) {\n                    jp.fire(id, jp, e);\n                    var alias = componentType ? eventAliases[componentType + id] || id : id;\n                    // jsplumb also fires every event coming from components/overlays. That's what the test for `jp.component` is for.\n                    _currentInstance.fire(alias, jp.component || jp, e);\n                }\n            };\n\n            var _addOneDelegate = function(eventId, selector, fn) {\n                _containerDelegations.push([eventId, fn]);\n                _currentInstance.on(_container, eventId, selector, fn);\n            };\n\n            // delegate one event on the container to jsplumb elements. it might be possible to\n            // abstract this out: each of endpoint, connection and overlay could register themselves with\n            // jsplumb as \"component types\" or whatever, and provide a suitable selector. this would be\n            // done by the renderer (although admittedly from 2.0 onwards we're not supporting vml anymore)\n            var _oneDelegate = function (id) {\n                // connections.\n                _addOneDelegate(id, \".jsplumb-connector\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n                // endpoints. note they can have an enclosing div, or not.\n                //_addOneDelegate(id, \".jsplumb-endpoint, .jsplumb-endpoint > *, .jsplumb-endpoint svg *\", function (e) {\n                _addOneDelegate(id, \".jsplumb-endpoint\", function (e) {\n                    _oneDelegateHandler(id, e, \"endpoint\");\n                });\n                // overlays\n                _addOneDelegate(id, \".jsplumb-overlay\", function (e) {\n                    _oneDelegateHandler(id, e);\n                });\n            };\n\n            for (var i = 0; i < events.length; i++)\n                _oneDelegate(events[i]);\n\n            // managed elements\n            for (var elId in managedElements) {\n                var el = managedElements[elId].el;\n                if (el.parentNode === previousContainer) {\n                    previousContainer.removeChild(el);\n                    _container.appendChild(el);\n                }\n            }\n\n        };\n        this.getContainer = function () {\n            return _container;\n        };\n\n        this.bind = function (event, fn) {\n            if (\"ready\" === event && initialized) fn();\n            else _bb.apply(_currentInstance, [event, fn]);\n        };\n\n        _currentInstance.importDefaults = function (d) {\n            for (var i in d) {\n                _currentInstance.Defaults[i] = d[i];\n            }\n            if (d.Container)\n                _currentInstance.setContainer(d.Container);\n\n            return _currentInstance;\n        };\n\n        _currentInstance.restoreDefaults = function () {\n            _currentInstance.Defaults = jsPlumb.extend({}, _initialDefaults);\n            return _currentInstance;\n        };\n\n        var log = null,\n            initialized = false,\n        // TODO remove from window scope\n            connections = [],\n        // map of element id -> endpoint lists. an element can have an arbitrary\n        // number of endpoints on it, and not all of them have to be connected\n        // to anything.\n            endpointsByElement = {},\n            endpointsByUUID = {},\n            managedElements = {},\n            offsets = {},\n            offsetTimestamps = {},\n            draggableStates = {},\n            connectionBeingDragged = false,\n            sizes = [],\n            _suspendDrawing = false,\n            _suspendedAt = null,\n            DEFAULT_SCOPE = this.Defaults.Scope,\n            renderMode = null,  // will be set in init()\n            _curIdStamp = 1,\n            _idstamp = function () {\n                return \"\" + _curIdStamp++;\n            },\n\n        //\n        // appends an element to some other element, which is calculated as follows:\n        //\n        // 1. if Container exists, use that element.\n        // 2. if the 'parent' parameter exists, use that.\n        // 3. otherwise just use the root element.\n        //\n        //\n            _appendElement = function (el, parent) {\n                if (_container)\n                    _container.appendChild(el);\n                else if (!parent)\n                    this.appendToRoot(el);\n                else\n                    this.getElement(parent).appendChild(el);\n            }.bind(this),\n\n        //\n        // Draws an endpoint and its connections. this is the main entry point into drawing connections as well\n        // as endpoints, since jsPlumb is endpoint-centric under the hood.\n        //\n        // @param element element to draw (of type library specific element object)\n        // @param ui UI object from current library's event system. optional.\n        // @param timestamp timestamp for this paint cycle. used to speed things up a little by cutting down the amount of offset calculations we do.\n        // @param clearEdits defaults to false; indicates that mouse edits for connectors should be cleared\n        ///\n            _draw = function (element, ui, timestamp, clearEdits) {\n\n                // TODO is it correct to filter by headless at this top level? how would a headless adapter ever repaint?\n                // NO. it is not correct.\n                if (!jsPlumb.headless && !_suspendDrawing) {\n                    var id = _getId(element),\n                        repaintEls = _currentInstance.getDragManager().getElementsForDraggable(id);\n\n                    if (timestamp == null) timestamp = _timestamp();\n\n                    // update the offset of everything _before_ we try to draw anything.\n                    var o = _updateOffset({ elId: id, offset: ui, recalc: false, timestamp: timestamp });\n\n                    if (repaintEls) {\n                        for (var i in repaintEls) {\n                            _updateOffset({\n                                elId: repaintEls[i].id,\n                                offset: {\n                                    left: o.o.left + repaintEls[i].offset.left,\n                                    top: o.o.top + repaintEls[i].offset.top\n                                },\n                                recalc: false,\n                                timestamp: timestamp\n                            });\n                        }\n                    }\n\n                    _currentInstance.anchorManager.redraw(id, ui, timestamp, null, clearEdits);\n\n                    if (repaintEls) {\n                        for (var j in repaintEls) {\n                            _currentInstance.anchorManager.redraw(repaintEls[j].id, ui, timestamp, repaintEls[j].offset, clearEdits, true);\n                        }\n                    }\n                }\n            },\n\n        //\n        // gets an Endpoint by uuid.\n        //\n            _getEndpoint = function (uuid) {\n                return endpointsByUUID[uuid];\n            },\n\n            /**\n             * inits a draggable if it's not already initialised.\n             * TODO: somehow abstract this to the adapter, because the concept of \"draggable\" has no\n             * place on the server.\n             */\n            _initDraggableIfNecessary = function (element, isDraggable, dragOptions, id, fireEvent) {\n                // move to DragManager?\n                if (!jsPlumb.headless) {\n                    var _draggable = isDraggable == null ? false : isDraggable;\n                    if (_draggable) {\n                        if (jsPlumb.isDragSupported(element, _currentInstance)) {\n                            var options = dragOptions || _currentInstance.Defaults.DragOptions;\n                            options = jsPlumb.extend({}, options); // make a copy.\n                            if (!jsPlumb.isAlreadyDraggable(element, _currentInstance)) {\n                                var dragEvent = jsPlumb.dragEvents.drag,\n                                    stopEvent = jsPlumb.dragEvents.stop,\n                                    startEvent = jsPlumb.dragEvents.start,\n                                    _del = _currentInstance.getElement(element),\n                                    _ancestor = _currentInstance.getDragManager().getDragAncestor(_del),\n                                    _noOffset = {left: 0, top: 0},\n                                    _ancestorOffset = _noOffset,\n                                    _started = false;\n\n                                _manage(id, element);\n\n                                options[startEvent] = _ju.wrap(options[startEvent], function () {\n                                    _ancestorOffset = _ancestor != null ? _currentInstance.getOffset(_ancestor) : _noOffset;\n                                    _currentInstance.setHoverSuspended(true);\n                                    _currentInstance.select({source: element}).addClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.sourceElementDraggingClass, true);\n                                    _currentInstance.select({target: element}).addClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.targetElementDraggingClass, true);\n                                    _currentInstance.setConnectionBeingDragged(true);\n                                    if (options.canDrag) return dragOptions.canDrag();\n                                }, false);\n\n                                options[dragEvent] = _ju.wrap(options[dragEvent], function () {\n                                    // TODO: here we could actually use getDragObject, and then compute it ourselves,\n                                    // since every adapter does the same thing. but i'm not sure why YUI's getDragObject\n                                    // differs from getUIPosition so much\n                                    var ui = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom());\n                                    if (ui != null) {\n                                        // adjust by ancestor offset if there is one: this is for the case that a draggable\n                                        // is contained inside some other element that is not the Container.\n                                        ui.left += _ancestorOffset.left;\n                                        ui.top += _ancestorOffset.top;\n                                        _draw(element, ui, null, true);\n                                        if (_started) _currentInstance.addClass(element, \"jsplumb-dragged\");\n                                        _started = true;\n                                    }\n                                });\n                                options[stopEvent] = _ju.wrap(options[stopEvent], function () {\n                                    var elements = arguments[0].selection;\n                                    var uip = _currentInstance.getUIPosition(arguments);\n\n                                    // this is one element\n                                    var _one = function (_e) {\n                                        if (uip != null) _draw(_e[0], uip);\n                                        _currentInstance.removeClass(_e[0], \"jsplumb-dragged\");\n                                        _currentInstance.select({source: _e[0]}).removeClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.sourceElementDraggingClass, true);\n                                        _currentInstance.select({target: _e[0]}).removeClass(_currentInstance.elementDraggingClass + \" \" + _currentInstance.targetElementDraggingClass, true);\n                                        _currentInstance.getDragManager().dragEnded(_e[0]);\n                                    };\n\n                                    for (var i = 0; i < elements.length; i++)\n                                        _one(elements[i]);\n\n                                    // this is common across all\n                                    _started = false;\n                                    _currentInstance.setHoverSuspended(false);\n                                    _currentInstance.setConnectionBeingDragged(false);\n                                });\n                                var elId = _getId(element); // need ID\n                                draggableStates[elId] = true;\n                                var draggable = draggableStates[elId];\n                                options.disabled = draggable == null ? false : !draggable;\n                                _currentInstance.initDraggable(element, options);\n                                _currentInstance.getDragManager().register(element);\n                                if (fireEvent) _currentInstance.fire(\"elementDraggable\", {el:element, options:options});\n                            }\n                            else {\n                                // already draggable. attach any start, drag or stop listeners to the current Drag.\n                                if (dragOptions.force) {\n                                    _currentInstance.initDraggable(element, options);\n                                }\n                            }\n                        }\n                    }\n                }\n            },\n\n            _scopeMatch = function (e1, e2) {\n                var s1 = e1.scope.split(/\\s/), s2 = e2.scope.split(/\\s/);\n                for (var i = 0; i < s1.length; i++)\n                    for (var j = 0; j < s2.length; j++)\n                        if (s2[j] == s1[i]) return true;\n\n                return false;\n            },\n\n        /*\n         * prepares a final params object that can be passed to _newConnection, taking into account defaults, events, etc.\n         */\n            _prepareConnectionParams = function (params, referenceParams) {\n                var _p = jsPlumb.extend({ }, params);\n                if (referenceParams) jsPlumb.extend(_p, referenceParams);\n\n                // hotwire endpoints passed as source or target to sourceEndpoint/targetEndpoint, respectively.\n                if (_p.source) {\n                    if (_p.source.endpoint)\n                        _p.sourceEndpoint = _p.source;\n                    else\n                        _p.source = _currentInstance.getElement(_p.source);\n                }\n                if (_p.target) {\n                    if (_p.target.endpoint)\n                        _p.targetEndpoint = _p.target;\n                    else\n                        _p.target = _currentInstance.getElement(_p.target);\n                }\n\n                // test for endpoint uuids to connect\n                if (params.uuids) {\n                    _p.sourceEndpoint = _getEndpoint(params.uuids[0]);\n                    _p.targetEndpoint = _getEndpoint(params.uuids[1]);\n                }\n\n                // now ensure that if we do have Endpoints already, they're not full.\n                // source:\n                if (_p.sourceEndpoint && _p.sourceEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; source endpoint is full\");\n                    return;\n                }\n\n                // target:\n                if (_p.targetEndpoint && _p.targetEndpoint.isFull()) {\n                    _ju.log(_currentInstance, \"could not add connection; target endpoint is full\");\n                    return;\n                }\n\n                // if source endpoint mandates connection type and nothing specified in our params, use it.\n                if (!_p.type && _p.sourceEndpoint)\n                    _p.type = _p.sourceEndpoint.connectionType;\n\n                // copy in any connectorOverlays that were specified on the source endpoint.\n                // it doesnt copy target endpoint overlays.  i'm not sure if we want it to or not.\n                if (_p.sourceEndpoint && _p.sourceEndpoint.connectorOverlays) {\n                    _p.overlays = _p.overlays || [];\n                    for (var i = 0, j = _p.sourceEndpoint.connectorOverlays.length; i < j; i++) {\n                        _p.overlays.push(_p.sourceEndpoint.connectorOverlays[i]);\n                    }\n                }\n\n                // scope\n                if (_p.sourceEndpoint && _p.sourceEndpoint.scope) {\n                    _p.scope = _p.sourceEndpoint.scope;\n                }\n\n                // pointer events\n                if (!_p[\"pointer-events\"] && _p.sourceEndpoint && _p.sourceEndpoint.connectorPointerEvents)\n                    _p[\"pointer-events\"] = _p.sourceEndpoint.connectorPointerEvents;\n\n                var _mergeOverrides = function (def, values) {\n                    var m = jsPlumb.extend({}, def);\n                    for (var i in values) {\n                        if (values[i]) m[i] = values[i];\n                    }\n                    return m;\n                };\n\n                var _addEndpoint = function (el, def, idx) {\n                    return _currentInstance.addEndpoint(el, _mergeOverrides(def, {\n                        anchor: _p.anchors ? _p.anchors[idx] : _p.anchor,\n                        endpoint: _p.endpoints ? _p.endpoints[idx] : _p.endpoint,\n                        paintStyle: _p.endpointStyles ? _p.endpointStyles[idx] : _p.endpointStyle,\n                        hoverPaintStyle: _p.endpointHoverStyles ? _p.endpointHoverStyles[idx] : _p.endpointHoverStyle\n                    }));\n                };\n\n                // check for makeSource/makeTarget specs.\n\n                var _oneElementDef = function (type, idx, defs, matchType) {\n                    if (_p[type] && !_p[type].endpoint && !_p[type + \"Endpoint\"] && !_p.newConnection) {\n                        var tid = _getId(_p[type]), tep = defs[tid];\n\n                        tep = tep ? tep[matchType] : null;\n\n                        if (tep) {\n                            // if not enabled, return.\n                            if (!tep.enabled) return false;\n                            var newEndpoint = tep.endpoint != null && tep.endpoint._jsPlumb ? tep.endpoint : _addEndpoint(_p[type], tep.def, idx);\n                            if (newEndpoint.isFull()) return false;\n                            _p[type + \"Endpoint\"] = newEndpoint;\n                            newEndpoint._doNotDeleteOnDetach = false; // reset.\n                            newEndpoint._deleteOnDetach = true;\n                            if (tep.uniqueEndpoint) {\n                                if (!tep.endpoint) {\n                                    tep.endpoint = newEndpoint;\n                                    newEndpoint._deleteOnDetach = false;\n                                    newEndpoint._doNotDeleteOnDetach = true;\n                                }\n                                else\n                                    newEndpoint.finalEndpoint = tep.endpoint;\n                            }\n                        }\n                    }\n                };\n\n                if (_oneElementDef(\"source\", 0, this.sourceEndpointDefinitions, _p.type || \"default\") === false) return;\n                if (_oneElementDef(\"target\", 1, this.targetEndpointDefinitions, _p.type || \"default\") === false) return;\n\n                // last, ensure scopes match\n                if (_p.sourceEndpoint && _p.targetEndpoint)\n                    if (!_scopeMatch(_p.sourceEndpoint, _p.targetEndpoint)) _p = null;\n\n                return _p;\n            }.bind(_currentInstance),\n\n            _newConnection = function (params) {\n                var connectionFunc = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType();\n\n                params._jsPlumb = _currentInstance;\n                params.newConnection = _newConnection;\n                params.newEndpoint = _newEndpoint;\n                params.endpointsByUUID = endpointsByUUID;\n                params.endpointsByElement = endpointsByElement;\n                params.finaliseConnection = _finaliseConnection;\n                params.id = \"con_\" + _idstamp();\n                var con = new connectionFunc(params);\n\n                // if the connection is draggable, then maybe we need to tell the target endpoint to init the\n                // dragging code. it won't run again if it already configured to be draggable.\n                if (con.isDetachable()) {\n                    con.endpoints[0].initDraggable(\"_jsPlumbSource\");\n                    con.endpoints[1].initDraggable(\"_jsPlumbTarget\");\n                }\n\n                return con;\n            },\n\n        //\n        // adds the connection to the backing model, fires an event if necessary and then redraws\n        //\n            _finaliseConnection = _currentInstance.finaliseConnection = function (jpc, params, originalEvent, doInformAnchorManager) {\n                params = params || {};\n                // add to list of connections (by scope).\n                if (!jpc.suspendedEndpoint)\n                    connections.push(jpc);\n\n                jpc.pending = null;\n\n                // turn off isTemporarySource on the source endpoint (only viable on first draw)\n                jpc.endpoints[0].isTemporarySource = false;\n\n                // always inform the anchor manager\n                // except that if jpc has a suspended endpoint it's not true to say the\n                // connection is new; it has just (possibly) moved. the question is whether\n                // to make that call here or in the anchor manager.  i think perhaps here.\n                if (doInformAnchorManager !== false)\n                    _currentInstance.anchorManager.newConnection(jpc);\n\n                // force a paint\n                _draw(jpc.source);\n\n                // fire an event\n                if (!params.doNotFireConnectionEvent && params.fireEvent !== false) {\n\n                    var eventArgs = {\n                        connection: jpc,\n                        source: jpc.source, target: jpc.target,\n                        sourceId: jpc.sourceId, targetId: jpc.targetId,\n                        sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                    };\n\n                    _currentInstance.fire(\"connection\", eventArgs, originalEvent);\n                }\n            },\n\n        /*\n         factory method to prepare a new endpoint.  this should always be used instead of creating Endpoints\n         manually, since this method attaches event listeners and an id.\n         */\n            _newEndpoint = function (params, id) {\n                var endpointFunc = _currentInstance.Defaults.EndpointType || jsPlumb.Endpoint;\n                var _p = jsPlumb.extend({}, params);\n                _p._jsPlumb = _currentInstance;\n                _p.newConnection = _newConnection;\n                _p.newEndpoint = _newEndpoint;\n                _p.endpointsByUUID = endpointsByUUID;\n                _p.endpointsByElement = endpointsByElement;\n                _p.fireDetachEvent = fireDetachEvent;\n                _p.elementId = id || _getId(_p.source);\n                var ep = new endpointFunc(_p);\n                ep.id = \"ep_\" + _idstamp();\n                _manage(_p.elementId, _p.source);\n\n                if (!jsPlumb.headless)\n                    _currentInstance.getDragManager().endpointAdded(_p.source, id);\n\n                return ep;\n            },\n\n        /*\n         * performs the given function operation on all the connections found\n         * for the given element id; this means we find all the endpoints for\n         * the given element, and then for each endpoint find the connectors\n         * connected to it. then we pass each connection in to the given\n         * function.\n         */\n            _operation = function (elId, func, endpointFunc) {\n                var endpoints = endpointsByElement[elId];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, ii = endpoints.length; i < ii; i++) {\n                        for (var j = 0, jj = endpoints[i].connections.length; j < jj; j++) {\n                            var retVal = func(endpoints[i].connections[j]);\n                            // if the function passed in returns true, we exit.\n                            // most functions return false.\n                            if (retVal) return;\n                        }\n                        if (endpointFunc) endpointFunc(endpoints[i]);\n                    }\n                }\n            },\n\n            _setDraggable = function (element, draggable) {\n                return jsPlumb.each(element, function (el) {\n                    if (_currentInstance.isDragSupported(el)) {\n                        draggableStates[_currentInstance.getAttribute(el, \"id\")] = draggable;\n                        _currentInstance.setElementDraggable(el, draggable);\n                    }\n                });\n            },\n        /*\n         * private method to do the business of hiding/showing.\n         *\n         * @param el\n         *            either Id of the element in question or a library specific\n         *            object for the element.\n         * @param state\n         *            String specifying a value for the css 'display' property\n         *            ('block' or 'none').\n         */\n            _setVisible = function (el, state, alsoChangeEndpoints) {\n                state = state === \"block\";\n                var endpointFunc = null;\n                if (alsoChangeEndpoints) {\n                    endpointFunc = function (ep) {\n                        ep.setVisible(state, true, true);\n                    };\n                }\n                var info = _info(el);\n                _operation(info.id, function (jpc) {\n                    if (state && alsoChangeEndpoints) {\n                        // this test is necessary because this functionality is new, and i wanted to maintain backwards compatibility.\n                        // this block will only set a connection to be visible if the other endpoint in the connection is also visible.\n                        var oidx = jpc.sourceId === info.id ? 1 : 0;\n                        if (jpc.endpoints[oidx].isVisible()) jpc.setVisible(true);\n                    }\n                    else  // the default behaviour for show, and what always happens for hide, is to just set the visibility without getting clever.\n                        jpc.setVisible(state);\n                }, endpointFunc);\n            },\n        /*\n         * toggles the draggable state of the given element(s).\n         * el is either an id, or an element object, or a list of ids/element objects.\n         */\n            _toggleDraggable = function (el) {\n                var state;\n                jsPlumb.each(el, function (el) {\n                    var elId = _currentInstance.getAttribute(el, \"id\");\n                    state = draggableStates[elId] == null ? false : draggableStates[elId];\n                    state = !state;\n                    draggableStates[elId] = state;\n                    _currentInstance.setDraggable(el, state);\n                    return state;\n                }.bind(this));\n                return state;\n            },\n            /**\n             * private method to do the business of toggling hiding/showing.\n             */\n            _toggleVisible = function (elId, changeEndpoints) {\n                var endpointFunc = null;\n                if (changeEndpoints) {\n                    endpointFunc = function (ep) {\n                        var state = ep.isVisible();\n                        ep.setVisible(!state);\n                    };\n                }\n                _operation(elId, function (jpc) {\n                    var state = jpc.isVisible();\n                    jpc.setVisible(!state);\n                }, endpointFunc);\n            },\n\n        // TODO comparison performance\n            _getCachedData = function (elId) {\n                var o = offsets[elId];\n                if (!o)\n                    return _updateOffset({elId: elId});\n                else\n                    return {o: o, s: sizes[elId]};\n            },\n\n            /**\n             * gets an id for the given element, creating and setting one if\n             * necessary.  the id is of the form\n             *\n             *    jsPlumb_<instance index>_<index in instance>\n             *\n             * where \"index in instance\" is a monotonically increasing integer that starts at 0,\n             * for each instance.  this method is used not only to assign ids to elements that do not\n             * have them but also to connections and endpoints.\n             */\n            _getId = function (element, uuid, doNotCreateIfNotFound) {\n                if (_ju.isString(element)) return element;\n                if (element == null) return null;\n                var id = _currentInstance.getAttribute(element, \"id\");\n                if (!id || id === \"undefined\") {\n                    // check if fixed uuid parameter is given\n                    if (arguments.length == 2 && arguments[1] !== undefined)\n                        id = uuid;\n                    else if (arguments.length == 1 || (arguments.length == 3 && !arguments[2]))\n                        id = \"jsPlumb_\" + _instanceIndex + \"_\" + _idstamp();\n\n                    if (!doNotCreateIfNotFound) _currentInstance.setAttribute(element, \"id\", id);\n                }\n                return id;\n            };\n\n        this.setConnectionBeingDragged = function (v) {\n            connectionBeingDragged = v;\n        };\n        this.isConnectionBeingDragged = function () {\n            return connectionBeingDragged;\n        };\n\n        /**\n         * Returns a map of all the elements this jsPlumbInstance is currently managing.\n         * @returns {Object} Map of [id-> {el, endpoint[], connection, position}] information.\n         */\n        this.getManagedElements = function() {\n            return managedElements;\n        };\n\n        this.getRenderMode = function() { return \"svg\"; };\n\n        this.connectorClass = \"jsplumb-connector\";\n        this.connectorOutlineClass = \"jsplumb-connector-outline\";\n        this.editableConnectorClass = \"jsplumb-connector-editable\";\n        this.connectedClass = \"jsplumb-connected\";\n        this.hoverClass = \"jsplumb-hover\";\n        this.endpointClass = \"jsplumb-endpoint\";\n        this.endpointConnectedClass = \"jsplumb-endpoint-connected\";\n        this.endpointFullClass = \"jsplumb-endpoint-full\";\n        this.endpointDropAllowedClass = \"jsplumb-endpoint-drop-allowed\";\n        this.endpointDropForbiddenClass = \"jsplumb-endpoint-drop-forbidden\";\n        this.overlayClass = \"jsplumb-overlay\";\n        this.draggingClass = \"jsplumb-dragging\";\n        this.elementDraggingClass = \"jsplumb-element-dragging\";\n        this.sourceElementDraggingClass = \"jsplumb-source-element-dragging\";\n        this.targetElementDraggingClass = \"jsplumb-target-element-dragging\";\n        this.endpointAnchorClassPrefix = \"jsplumb-endpoint-anchor\";\n        this.hoverSourceClass = \"jsplumb-source-hover\";\n        this.hoverTargetClass = \"jsplumb-target-hover\";\n        this.dragSelectClass = \"jsplumb-drag-select\";\n\n        this.Anchors = {};\n        this.Connectors = {  \"svg\": {} };\n        this.Endpoints = { \"svg\": {} };\n        this.Overlays = { \"svg\": {} } ;\n        this.ConnectorRenderers = {};\n        this.SVG = \"svg\";\n\n// --------------------------- jsPlumbInstance public API ---------------------------------------------------------\n\n\n        this.addEndpoint = function (el, params, referenceParams) {\n            referenceParams = referenceParams || {};\n            var p = jsPlumb.extend({}, referenceParams);\n            jsPlumb.extend(p, params);\n            p.endpoint = p.endpoint || _currentInstance.Defaults.Endpoint;\n            p.paintStyle = p.paintStyle || _currentInstance.Defaults.EndpointStyle;\n\n            var results = [],\n                inputs = (_ju.isArray(el) || (el.length != null && !_ju.isString(el))) ? el : [ el ];\n\n            for (var i = 0, j = inputs.length; i < j; i++) {\n                p.source = _currentInstance.getElement(inputs[i]);\n                _ensureContainer(p.source);\n\n                var id = _getId(p.source), e = _newEndpoint(p, id);\n\n                // SP new. here we have introduced a class-wide element manager, which is responsible\n                // for getting object dimensions and width/height, and for updating these values only\n                // when necessary (after a drag, or on a forced refresh call).\n                var myOffset = _manage(id, p.source).info.o;\n                _ju.addToList(endpointsByElement, id, e);\n\n                if (!_suspendDrawing) {\n                    e.paint({\n                        anchorLoc: e.anchor.compute({ xy: [ myOffset.left, myOffset.top ], wh: sizes[id], element: e, timestamp: _suspendedAt }),\n                        timestamp: _suspendedAt\n                    });\n                }\n\n                results.push(e);\n                e._doNotDeleteOnDetach = true; // mark this as being added via addEndpoint.\n            }\n\n            return results.length == 1 ? results[0] : results;\n        };\n\n        this.addEndpoints = function (el, endpoints, referenceParams) {\n            var results = [];\n            for (var i = 0, j = endpoints.length; i < j; i++) {\n                var e = _currentInstance.addEndpoint(el, endpoints[i], referenceParams);\n                if (_ju.isArray(e))\n                    Array.prototype.push.apply(results, e);\n                else results.push(e);\n            }\n            return results;\n        };\n\n        this.animate = function (el, properties, options) {\n            if (!this.animationSupported) return false;\n\n            options = options || {};\n            var del = _currentInstance.getElement(el),\n                id = _getId(del),\n                stepFunction = jsPlumb.animEvents.step,\n                completeFunction = jsPlumb.animEvents.complete;\n\n            options[stepFunction] = _ju.wrap(options[stepFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            // onComplete repaints, just to make sure everything looks good at the end of the animation.\n            options[completeFunction] = _ju.wrap(options[completeFunction], function () {\n                _currentInstance.revalidate(id);\n            });\n\n            _currentInstance.doAnimate(del, properties, options);\n        };\n\n        /**\n         * checks for a listener for the given condition, executing it if found, passing in the given value.\n         * condition listeners would have been attached using \"bind\" (which is, you could argue, now overloaded, since\n         * firing click events etc is a bit different to what this does).  i thought about adding a \"bindCondition\"\n         * or something, but decided against it, for the sake of simplicity. jsPlumb will never fire one of these\n         * condition events anyway.\n         */\n        this.checkCondition = function (conditionName, args) {\n            var l = _currentInstance.getListener(conditionName),\n                r = true;\n\n            if (l && l.length > 0) {\n                var values = Array.prototype.slice.call(arguments, 1);\n                try {\n                    for (var i = 0, j = l.length; i < j; i++) {\n                        r = r && l[i].apply(l[i], values);\n                    }\n                }\n                catch (e) {\n                    _ju.log(_currentInstance, \"cannot check condition [\" + conditionName + \"]\" + e);\n                }\n            }\n            return r;\n        };\n\n        this.connect = function (params, referenceParams) {\n            // prepare a final set of parameters to create connection with\n            var _p = _prepareConnectionParams(params, referenceParams), jpc;\n            // TODO probably a nicer return value if the connection was not made.  _prepareConnectionParams\n            // will return null (and log something) if either endpoint was full.  what would be nicer is to\n            // create a dedicated 'error' object.\n            if (_p) {\n                if (_p.source == null && _p.sourceEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - source does not exist\");\n                    return;\n                }\n                if (_p.target == null && _p.targetEndpoint == null) {\n                    _ju.log(\"Cannot establish connection - target does not exist\");\n                    return;\n                }\n                _ensureContainer(_p.source);\n                // create the connection.  it is not yet registered\n                jpc = _newConnection(_p);\n                // now add it the model, fire an event, and redraw\n                _finaliseConnection(jpc, _p);\n            }\n            return jpc;\n        };\n\n        var stTypes = [\n            { el: \"source\", elId: \"sourceId\", epDefs: \"sourceEndpointDefinitions\" },\n            { el: \"target\", elId: \"targetId\", epDefs: \"targetEndpointDefinitions\" }\n        ];\n\n        var _set = function (c, el, idx, doNotRepaint) {\n            var ep, _st = stTypes[idx], cId = c[_st.elId], cEl = c[_st.el], sid, sep,\n                oldEndpoint = c.endpoints[idx];\n\n            var evtParams = {\n                index: idx,\n                originalSourceId: idx === 0 ? cId : c.sourceId,\n                newSourceId: c.sourceId,\n                originalTargetId: idx == 1 ? cId : c.targetId,\n                newTargetId: c.targetId,\n                connection: c\n            };\n\n            if (el.constructor == jsPlumb.Endpoint) { // TODO here match the current endpoint class; users can change it {\n                ep = el;\n                ep.addConnection(c);\n                el = ep.element;\n            }\n            else {\n                sid = _getId(el);\n                sep = this[_st.epDefs][sid];\n\n                if (sid === c[_st.elId])\n                    ep = null;  // dont change source/target if the element is already the one given.\n                else if (sep) {\n                    for (var t in sep) {\n                        if (!sep[t].enabled) return;\n                        ep = sep[t].endpoint != null && sep[t].endpoint._jsPlumb ? sep[t].endpoint : this.addEndpoint(el, sep[t].def);\n                        if (sep[t].uniqueEndpoint) sep[t].endpoint = ep;\n                        ep._doNotDeleteOnDetach = false;\n                        ep._deleteOnDetach = true;\n                        ep.addConnection(c);\n                    }\n                }\n                else {\n                    ep = c.makeEndpoint(idx === 0, el, sid);\n                    ep._doNotDeleteOnDetach = false;\n                    ep._deleteOnDetach = true;\n                }\n            }\n\n            if (ep != null) {\n                oldEndpoint.detachFromConnection(c);\n                c.endpoints[idx] = ep;\n                c[_st.el] = ep.element;\n                c[_st.elId] = ep.elementId;\n                evtParams[idx === 0 ? \"newSourceId\" : \"newTargetId\"] = ep.elementId;\n\n                fireMoveEvent(evtParams);\n\n                if (!doNotRepaint)\n                    c.repaint();\n            }\n\n            evtParams.element = el;\n            return evtParams;\n\n        }.bind(this);\n\n        this.setSource = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 0, doNotRepaint);\n            this.anchorManager.sourceChanged(p.originalSourceId, p.newSourceId, connection, p.el);\n        };\n        this.setTarget = function (connection, el, doNotRepaint) {\n            var p = _set(connection, el, 1, doNotRepaint);\n            this.anchorManager.updateOtherEndpoint(p.originalSourceId, p.originalTargetId, p.newTargetId, connection);\n        };\n\n        this.deleteEndpoint = function (object, dontUpdateHover, deleteAttachedObjects) {\n            var endpoint = (typeof object === \"string\") ? endpointsByUUID[object] : object;\n            if (endpoint) {\n                _currentInstance.deleteObject({ endpoint: endpoint, dontUpdateHover: dontUpdateHover, deleteAttachedObjects:deleteAttachedObjects });\n            }\n            return _currentInstance;\n        };\n\n        this.deleteEveryEndpoint = function () {\n            var _is = _currentInstance.setSuspendDrawing(true);\n            for (var id in endpointsByElement) {\n                var endpoints = endpointsByElement[id];\n                if (endpoints && endpoints.length) {\n                    for (var i = 0, j = endpoints.length; i < j; i++) {\n                        _currentInstance.deleteEndpoint(endpoints[i], true);\n                    }\n                }\n            }\n            endpointsByElement = {};\n            // SP new\n            managedElements = {};\n            endpointsByUUID = {};\n            offsets = {};\n            offsetTimestamps = {};\n            _currentInstance.anchorManager.reset();\n            _currentInstance.getDragManager().reset();\n            if (!_is) _currentInstance.setSuspendDrawing(false);\n            return _currentInstance;\n        };\n\n        var fireDetachEvent = function (jpc, doFireEvent, originalEvent) {\n            // may have been given a connection, or in special cases, an object\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\n                argIsConnection = jpc.constructor == connType,\n                params = argIsConnection ? {\n                    connection: jpc,\n                    source: jpc.source, target: jpc.target,\n                    sourceId: jpc.sourceId, targetId: jpc.targetId,\n                    sourceEndpoint: jpc.endpoints[0], targetEndpoint: jpc.endpoints[1]\n                } : jpc;\n\n            if (doFireEvent)\n                _currentInstance.fire(\"connectionDetached\", params, originalEvent);\n\n            _currentInstance.anchorManager.connectionDetached(params);\n        };\n\n        var fireMoveEvent = _currentInstance.fireMoveEvent = function (params, evt) {\n            _currentInstance.fire(\"connectionMoved\", params, evt);\n        };\n\n        this.unregisterEndpoint = function (endpoint) {\n            //if (endpoint._jsPlumb == null) return;\n            if (endpoint._jsPlumb.uuid) endpointsByUUID[endpoint._jsPlumb.uuid] = null;\n            _currentInstance.anchorManager.deleteEndpoint(endpoint);\n            // TODO at least replace this with a removeWithFunction call.\n            for (var e in endpointsByElement) {\n                var endpoints = endpointsByElement[e];\n                if (endpoints) {\n                    var newEndpoints = [];\n                    for (var i = 0, j = endpoints.length; i < j; i++)\n                        if (endpoints[i] != endpoint) newEndpoints.push(endpoints[i]);\n\n                    endpointsByElement[e] = newEndpoints;\n                }\n                if (endpointsByElement[e].length < 1) {\n                    delete endpointsByElement[e];\n                }\n            }\n        };\n\n        this.detach = function () {\n\n            if (arguments.length === 0) return;\n            var connType = _currentInstance.Defaults.ConnectionType || _currentInstance.getDefaultConnectionType(),\n                firstArgIsConnection = arguments[0].constructor == connType,\n                params = arguments.length == 2 ? firstArgIsConnection ? (arguments[1] || {}) : arguments[0] : arguments[0],\n                fireEvent = (params.fireEvent !== false),\n                forceDetach = params.forceDetach,\n                conn = firstArgIsConnection ? arguments[0] : params.connection,\n                deleteAttachedObjects = firstArgIsConnection ? null : params.deleteAttachedObjects;\n\n            if (conn) {\n                if (forceDetach || _ju.functionChain(true, false, [\n                    [ conn.endpoints[0], \"isDetachAllowed\", [ conn ] ],\n                    [ conn.endpoints[1], \"isDetachAllowed\", [ conn ] ],\n                    [ conn, \"isDetachAllowed\", [ conn ] ],\n                    [ _currentInstance, \"checkCondition\", [ \"beforeDetach\", conn ] ]\n                ])) {\n\n                    conn.endpoints[0].detach({\n                        connection:conn,\n                        ignoreTarget:false,\n                        forceDetach:true,\n                        fireEvent:fireEvent,\n                        deleteAttachedObjects:deleteAttachedObjects\n                    });\n                }\n            }\n            else {\n                var _p = jsPlumb.extend({}, params); // a backwards compatibility hack: source should be thought of as 'params' in this case.\n                // test for endpoint uuids to detach\n                if (_p.uuids) {\n                    _getEndpoint(_p.uuids[0]).detachFrom(_getEndpoint(_p.uuids[1]), fireEvent);\n                } else if (_p.sourceEndpoint && _p.targetEndpoint) {\n                    _p.sourceEndpoint.detachFrom(_p.targetEndpoint);\n                } else {\n                    var sourceId = _getId(_currentInstance.getElement(_p.source)),\n                        targetId = _getId(_currentInstance.getElement(_p.target));\n                    _operation(sourceId, function (jpc) {\n                        if ((jpc.sourceId == sourceId && jpc.targetId == targetId) || (jpc.targetId == sourceId && jpc.sourceId == targetId)) {\n                            if (_currentInstance.checkCondition(\"beforeDetach\", jpc)) {\n                                jpc.endpoints[0].detach({\n                                    connection:jpc,\n                                    ignoreTarget:false,\n                                    forceDetach:true,\n                                    fireEvent:fireEvent\n                                });\n                            }\n                        }\n                    });\n                }\n            }\n        };\n\n        this.detachAllConnections = function (el, params) {\n            params = params || {};\n            el = _currentInstance.getElement(el);\n            var id = _getId(el),\n                endpoints = endpointsByElement[id];\n            if (endpoints && endpoints.length) {\n                for (var i = 0, j = endpoints.length; i < j; i++) {\n                    endpoints[i].detachAll(params.fireEvent !== false, params.forceDetach);\n                }\n            }\n            return _currentInstance;\n        };\n\n        this.detachEveryConnection = function (params) {\n            params = params || {};\n            _currentInstance.batch(function () {\n                for (var id in endpointsByElement) {\n                    var endpoints = endpointsByElement[id];\n                    if (endpoints && endpoints.length) {\n                        for (var i = 0, j = endpoints.length; i < j; i++) {\n                            endpoints[i].detachAll(params.fireEvent !== false, params.forceDetach);\n                        }\n                    }\n                }\n                connections.length = 0;\n            });\n            return _currentInstance;\n        };\n\n        /// not public.  but of course its exposed. how to change this.\n        this.deleteObject = function (params) {\n            var result = {\n                    endpoints: {},\n                    connections: {},\n                    endpointCount: 0,\n                    connectionCount: 0\n                },\n                fireEvent = params.fireEvent !== false,\n                deleteAttachedObjects = params.deleteAttachedObjects !== false;\n\n            var unravelConnection = function (connection) {\n                if (connection != null && result.connections[connection.id] == null) {\n                    if (!params.dontUpdateHover && connection._jsPlumb != null) connection.setHover(false);\n                    result.connections[connection.id] = connection;\n                    result.connectionCount++;\n                    if (deleteAttachedObjects) {\n                        for (var j = 0; j < connection.endpoints.length; j++) {\n                            if (connection.endpoints[j]._deleteOnDetach)\n                                unravelEndpoint(connection.endpoints[j]);\n                        }\n                    }\n                }\n            };\n            var unravelEndpoint = function (endpoint) {\n                if (endpoint != null && result.endpoints[endpoint.id] == null) {\n                    if (!params.dontUpdateHover && endpoint._jsPlumb != null) endpoint.setHover(false);\n                    result.endpoints[endpoint.id] = endpoint;\n                    result.endpointCount++;\n\n                    if (deleteAttachedObjects) {\n                        for (var i = 0; i < endpoint.connections.length; i++) {\n                            var c = endpoint.connections[i];\n                            unravelConnection(c);\n                        }\n                    }\n                }\n            };\n\n            if (params.connection)\n                unravelConnection(params.connection);\n            else unravelEndpoint(params.endpoint);\n\n            // loop through connections\n            for (var i in result.connections) {\n                var c = result.connections[i];\n                if (c._jsPlumb) {\n                    _ju.removeWithFunction(connections, function (_c) {\n                        return c.id == _c.id;\n                    });\n\n                    fireDetachEvent(c, params.fireEvent === false ? false : !c.pending, params.originalEvent);\n                    var doNotCleanup = params.deleteAttachedObjects == null ? null : !params.deleteAttachedObjects;\n\n                    // SP GROUPS. this works but blows up lots of original tests\n                    c.endpoints[0].detachFromConnection(c, null, doNotCleanup);\n                    c.endpoints[1].detachFromConnection(c, null, doNotCleanup);\n\n                    // SP GROUPS. this does not work but makes all the original tests work.\n                    //c.endpoints[0].detachFromConnection(c);\n                    //c.endpoints[1].detachFromConnection(c);\n\n                    c.cleanup(true);\n                    c.destroy(true);\n                }\n            }\n\n            // loop through endpoints\n            for (var j in result.endpoints) {\n                var e = result.endpoints[j];\n                if (e._jsPlumb) {\n                    _currentInstance.unregisterEndpoint(e);\n                    // FIRE some endpoint deleted event?\n                    e.cleanup(true);\n                    e.destroy(true);\n                }\n            }\n\n            return result;\n        };\n\n        this.draggable = function (el, options) {\n            var info;\n            _each(function(_el) {\n                 info = _info(_el);\n                if (info.el) _initDraggableIfNecessary(info.el, true, options, info.id, true);\n            }, el);\n            return _currentInstance;\n        };\n\n        this.droppable = function(el, options) {\n            var info;\n            options = options || {};\n            options.allowLoopback = false;\n            _each(function(_el) {\n                info = _info(_el);\n                if (info.el) _currentInstance.initDroppable(info.el, options);\n            }, el);\n            return _currentInstance;\n        };\n\n        // helpers for select/selectEndpoints\n        var _setOperation = function (list, func, args, selector) {\n                for (var i = 0, j = list.length; i < j; i++) {\n                    list[i][func].apply(list[i], args);\n                }\n                return selector(list);\n            },\n            _getOperation = function (list, func, args) {\n                var out = [];\n                for (var i = 0, j = list.length; i < j; i++) {\n                    out.push([ list[i][func].apply(list[i], args), list[i] ]);\n                }\n                return out;\n            },\n            setter = function (list, func, selector) {\n                return function () {\n                    return _setOperation(list, func, arguments, selector);\n                };\n            },\n            getter = function (list, func) {\n                return function () {\n                    return _getOperation(list, func, arguments);\n                };\n            },\n            prepareList = function (input, doNotGetIds) {\n                var r = [];\n                if (input) {\n                    if (typeof input == 'string') {\n                        if (input === \"*\") return input;\n                        r.push(input);\n                    }\n                    else {\n                        if (doNotGetIds) r = input;\n                        else {\n                            if (input.length) {\n                                for (var i = 0, j = input.length; i < j; i++)\n                                    r.push(_info(input[i]).id);\n                            }\n                            else\n                                r.push(_info(input).id);\n                        }\n                    }\n                }\n                return r;\n            },\n            filterList = function (list, value, missingIsFalse) {\n                if (list === \"*\") return true;\n                return list.length > 0 ? list.indexOf(value) != -1 : !missingIsFalse;\n            };\n\n        // get some connections, specifying source/target/scope\n        this.getConnections = function (options, flat) {\n            if (!options) {\n                options = {};\n            } else if (options.constructor == String) {\n                options = { \"scope\": options };\n            }\n            var scope = options.scope || _currentInstance.getDefaultScope(),\n                scopes = prepareList(scope, true),\n                sources = prepareList(options.source),\n                targets = prepareList(options.target),\n                results = (!flat && scopes.length > 1) ? {} : [],\n                _addOne = function (scope, obj) {\n                    if (!flat && scopes.length > 1) {\n                        var ss = results[scope];\n                        if (ss == null) {\n                            ss = results[scope] = [];\n                        }\n                        ss.push(obj);\n                    } else results.push(obj);\n                };\n\n            for (var j = 0, jj = connections.length; j < jj; j++) {\n                var c = connections[j],\n                    sourceId = c.proxies && c.proxies[0] ? c.proxies[0].originalEp.elementId : c.sourceId,\n                    targetId = c.proxies && c.proxies[1] ? c.proxies[1].originalEp.elementId : c.targetId;\n\n                if (filterList(scopes, c.scope) && filterList(sources, sourceId) && filterList(targets, targetId))\n                    _addOne(c.scope, c);\n            }\n\n            return results;\n        };\n\n        var _curryEach = function (list, executor) {\n                return function (f) {\n                    for (var i = 0, ii = list.length; i < ii; i++) {\n                        f(list[i]);\n                    }\n                    return executor(list);\n                };\n            },\n            _curryGet = function (list) {\n                return function (idx) {\n                    return list[idx];\n                };\n            };\n\n        var _makeCommonSelectHandler = function (list, executor) {\n            var out = {\n                    length: list.length,\n                    each: _curryEach(list, executor),\n                    get: _curryGet(list)\n                },\n                setters = [\"setHover\", \"removeAllOverlays\", \"setLabel\", \"addClass\", \"addOverlay\", \"removeOverlay\",\n                    \"removeOverlays\", \"showOverlay\", \"hideOverlay\", \"showOverlays\", \"hideOverlays\", \"setPaintStyle\",\n                    \"setHoverPaintStyle\", \"setSuspendEvents\", \"setParameter\", \"setParameters\", \"setVisible\",\n                    \"repaint\", \"addType\", \"toggleType\", \"removeType\", \"removeClass\", \"setType\", \"bind\", \"unbind\" ],\n\n                getters = [\"getLabel\", \"getOverlay\", \"isHover\", \"getParameter\", \"getParameters\", \"getPaintStyle\",\n                    \"getHoverPaintStyle\", \"isVisible\", \"hasType\", \"getType\", \"isSuspendEvents\" ],\n                i, ii;\n\n            for (i = 0, ii = setters.length; i < ii; i++)\n                out[setters[i]] = setter(list, setters[i], executor);\n\n            for (i = 0, ii = getters.length; i < ii; i++)\n                out[getters[i]] = getter(list, getters[i]);\n\n            return out;\n        };\n\n        var _makeConnectionSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeConnectionSelectHandler);\n            return jsPlumb.extend(common, {\n                // setters\n                setDetachable: setter(list, \"setDetachable\", _makeConnectionSelectHandler),\n                setReattach: setter(list, \"setReattach\", _makeConnectionSelectHandler),\n                setConnector: setter(list, \"setConnector\", _makeConnectionSelectHandler),\n                detach: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++)\n                        _currentInstance.detach(list[i]);\n                },\n                // getters\n                isDetachable: getter(list, \"isDetachable\"),\n                isReattach: getter(list, \"isReattach\")\n            });\n        };\n\n        var _makeEndpointSelectHandler = function (list) {\n            var common = _makeCommonSelectHandler(list, _makeEndpointSelectHandler);\n            return jsPlumb.extend(common, {\n                setEnabled: setter(list, \"setEnabled\", _makeEndpointSelectHandler),\n                setAnchor: setter(list, \"setAnchor\", _makeEndpointSelectHandler),\n                isEnabled: getter(list, \"isEnabled\"),\n                detachAll: function () {\n                    for (var i = 0, ii = list.length; i < ii; i++)\n                        list[i].detachAll();\n                },\n                \"remove\": function () {\n                    for (var i = 0, ii = list.length; i < ii; i++)\n                        _currentInstance.deleteObject({endpoint: list[i]});\n                }\n            });\n        };\n\n        this.select = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            return _makeConnectionSelectHandler(params.connections || _currentInstance.getConnections(params, true));\n        };\n\n        this.selectEndpoints = function (params) {\n            params = params || {};\n            params.scope = params.scope || \"*\";\n            var noElementFilters = !params.element && !params.source && !params.target,\n                elements = noElementFilters ? \"*\" : prepareList(params.element),\n                sources = noElementFilters ? \"*\" : prepareList(params.source),\n                targets = noElementFilters ? \"*\" : prepareList(params.target),\n                scopes = prepareList(params.scope, true);\n\n            var ep = [];\n\n            for (var el in endpointsByElement) {\n                var either = filterList(elements, el, true),\n                    source = filterList(sources, el, true),\n                    sourceMatchExact = sources != \"*\",\n                    target = filterList(targets, el, true),\n                    targetMatchExact = targets != \"*\";\n\n                // if they requested 'either' then just match scope. otherwise if they requested 'source' (not as a wildcard) then we have to match only endpoints that have isSource set to to true, and the same thing with isTarget.\n                if (either || source || target) {\n                    inner:\n                        for (var i = 0, ii = endpointsByElement[el].length; i < ii; i++) {\n                            var _ep = endpointsByElement[el][i];\n                            if (filterList(scopes, _ep.scope, true)) {\n\n                                var noMatchSource = (sourceMatchExact && sources.length > 0 && !_ep.isSource),\n                                    noMatchTarget = (targetMatchExact && targets.length > 0 && !_ep.isTarget);\n\n                                if (noMatchSource || noMatchTarget)\n                                    continue inner;\n\n                                ep.push(_ep);\n                            }\n                        }\n                }\n            }\n\n            return _makeEndpointSelectHandler(ep);\n        };\n\n        // get all connections managed by the instance of jsplumb.\n        this.getAllConnections = function () {\n            return connections;\n        };\n        this.getDefaultScope = function () {\n            return DEFAULT_SCOPE;\n        };\n        // get an endpoint by uuid.\n        this.getEndpoint = _getEndpoint;\n        // get endpoints for some element.\n        this.getEndpoints = function (el) {\n            return endpointsByElement[_info(el).id];\n        };\n        // gets the default endpoint type. used when subclassing. see wiki.\n        this.getDefaultEndpointType = function () {\n            return jsPlumb.Endpoint;\n        };\n        // gets the default connection type. used when subclassing.  see wiki.\n        this.getDefaultConnectionType = function () {\n            return jsPlumb.Connection;\n        };\n        /*\n         * Gets an element's id, creating one if necessary. really only exposed\n         * for the lib-specific functionality to access; would be better to pass\n         * the current instance into the lib-specific code (even though this is\n         * a static call. i just don't want to expose it to the public API).\n         */\n        this.getId = _getId;\n\n        this.appendElement = _appendElement;\n\n        var _hoverSuspended = false;\n        this.isHoverSuspended = function () {\n            return _hoverSuspended;\n        };\n        this.setHoverSuspended = function (s) {\n            _hoverSuspended = s;\n        };\n\n        // set an element's connections to be hidden\n        this.hide = function (el, changeEndpoints) {\n            _setVisible(el, \"none\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // exposed for other objects to use to get a unique id.\n        this.idstamp = _idstamp;\n\n        this.connectorsInitialized = false;\n        this.registerConnectorType = function (connector, name) {\n            connectorTypes.push([connector, name]);\n        };\n\n        // ensure that, if the current container exists, it is a DOM element and not a selector.\n        // if it does not exist and `candidate` is supplied, the offset parent of that element will be set as the Container.\n        // this is used to do a better default behaviour for the case that the user has not set a container:\n        // addEndpoint, makeSource, makeTarget and connect all call this method with the offsetParent of the\n        // element in question (for connect it is the source element). So if no container is set, it is inferred\n        // to be the offsetParent of the first element the user tries to connect.\n        var _ensureContainer = function (candidate) {\n            if (!_container && candidate) {\n                var can = _currentInstance.getElement(candidate);\n                if (can.offsetParent) _currentInstance.setContainer(can.offsetParent);\n            }\n        };\n\n        var _getContainerFromDefaults = function () {\n            if (_currentInstance.Defaults.Container)\n                _currentInstance.setContainer(_currentInstance.Defaults.Container);\n        };\n\n        // check if a given element is managed or not. if not, add to our map. if drawing is not suspended then\n        // we'll also stash its dimensions; otherwise we'll do this in a lazy way through updateOffset.\n        var _manage = _currentInstance.manage = function (id, element, _transient) {\n            if (!managedElements[id]) {\n                managedElements[id] = {\n                    el: element,\n                    endpoints: [],\n                    connections: []\n                };\n\n                managedElements[id].info = _updateOffset({ elId: id, timestamp: _suspendedAt });\n                if (!_transient) {\n                    _currentInstance.fire(\"manageElement\", { id:id, info:managedElements[id].info, el:element });\n                }\n            }\n\n            return managedElements[id];\n        };\n\n        var _unmanage = function(id) {\n            if (managedElements[id]) {\n                delete managedElements[id];\n                _currentInstance.fire(\"unmanageElement\", id);\n            }\n        };\n\n        /**\n         * updates the offset and size for a given element, and stores the\n         * values. if 'offset' is not null we use that (it would have been\n         * passed in from a drag call) because it's faster; but if it is null,\n         * or if 'recalc' is true in order to force a recalculation, we get the current values.\n         */\n        var _updateOffset = this.updateOffset = function (params) {\n\n            var timestamp = params.timestamp, recalc = params.recalc, offset = params.offset, elId = params.elId, s;\n            if (_suspendDrawing && !timestamp) timestamp = _suspendedAt;\n            if (!recalc) {\n                if (timestamp && timestamp === offsetTimestamps[elId]) {\n                    return {o: params.offset || offsets[elId], s: sizes[elId]};\n                }\n            }\n            if (recalc || (!offset && offsets[elId] == null)) { // if forced repaint or no offset available, we recalculate.\n\n                // get the current size and offset, and store them\n                s = managedElements[elId] ? managedElements[elId].el : null;\n                if (s != null) {\n                    sizes[elId] = _currentInstance.getSize(s);\n                    offsets[elId] = _currentInstance.getOffset(s);\n                    offsetTimestamps[elId] = timestamp;\n                }\n            } else {\n                offsets[elId] = offset || offsets[elId];\n                if (sizes[elId] == null) {\n                    s = managedElements[elId].el;\n                    if (s != null) sizes[elId] = _currentInstance.getSize(s);\n                }\n                offsetTimestamps[elId] = timestamp;\n            }\n\n            if (offsets[elId] && !offsets[elId].right) {\n                offsets[elId].right = offsets[elId].left + sizes[elId][0];\n                offsets[elId].bottom = offsets[elId].top + sizes[elId][1];\n                offsets[elId].width = sizes[elId][0];\n                offsets[elId].height = sizes[elId][1];\n                offsets[elId].centerx = offsets[elId].left + (offsets[elId].width / 2);\n                offsets[elId].centery = offsets[elId].top + (offsets[elId].height / 2);\n            }\n\n            return {o: offsets[elId], s: sizes[elId]};\n        };\n\n        /**\n         * callback from the current library to tell us to prepare ourselves (attach\n         * mouse listeners etc; can't do that until the library has provided a bind method)\n         */\n        this.init = function () {\n            rendererTypes = root.jsPlumb.getRenderModes();\n\n            var _oneType = function (renderer, name, fn) {\n                root.jsPlumb.Connectors[renderer][name] = function () {\n                    fn.apply(this, arguments);\n                    root.jsPlumb.ConnectorRenderers[renderer].apply(this, arguments);\n                };\n                _ju.extend(root.jsPlumb.Connectors[renderer][name], [ fn, root.jsPlumb.ConnectorRenderers[renderer]]);\n            };\n\n            if (!root.jsPlumb.connectorsInitialized) {\n                for (var i = 0; i < connectorTypes.length; i++) {\n                    for (var j = 0; j < rendererTypes.length; j++) {\n                        _oneType(rendererTypes[j], connectorTypes[i][1], connectorTypes[i][0]);\n                    }\n\n                }\n                root.jsPlumb.connectorsInitialized = true;\n            }\n\n            if (!initialized) {\n                _getContainerFromDefaults();\n                _currentInstance.anchorManager = new root.jsPlumb.AnchorManager({jsPlumbInstance: _currentInstance});\n                initialized = true;\n                _currentInstance.fire(\"ready\", _currentInstance);\n            }\n        }.bind(this);\n\n        this.log = log;\n        this.jsPlumbUIComponent = jsPlumbUIComponent;\n\n        /*\n         * Creates an anchor with the given params.\n         *\n         *\n         * Returns: The newly created Anchor.\n         * Throws: an error if a named anchor was not found.\n         */\n        this.makeAnchor = function () {\n            var pp, _a = function (t, p) {\n                if (root.jsPlumb.Anchors[t]) return new root.jsPlumb.Anchors[t](p);\n                if (!_currentInstance.Defaults.DoNotThrowErrors)\n                    throw { msg: \"jsPlumb: unknown anchor type '\" + t + \"'\" };\n            };\n            if (arguments.length === 0) return null;\n            var specimen = arguments[0], elementId = arguments[1], jsPlumbInstance = arguments[2], newAnchor = null;\n            // if it appears to be an anchor already...\n            if (specimen.compute && specimen.getOrientation) return specimen;  //TODO hazy here about whether it should be added or is already added somehow.\n            // is it the name of an anchor type?\n            else if (typeof specimen == \"string\") {\n                newAnchor = _a(arguments[0], {elementId: elementId, jsPlumbInstance: _currentInstance});\n            }\n            // is it an array? it will be one of:\n            //         an array of [spec, params] - this defines a single anchor, which may be dynamic, but has parameters.\n            //        an array of arrays - this defines some dynamic anchors\n            //        an array of numbers - this defines a single anchor.\n            else if (_ju.isArray(specimen)) {\n                if (_ju.isArray(specimen[0]) || _ju.isString(specimen[0])) {\n                    // if [spec, params] format\n                    if (specimen.length == 2 && _ju.isObject(specimen[1])) {\n                        // if first arg is a string, its a named anchor with params\n                        if (_ju.isString(specimen[0])) {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance}, specimen[1]);\n                            newAnchor = _a(specimen[0], pp);\n                        }\n                        // otherwise first arg is array, second is params. we treat as a dynamic anchor, which is fine\n                        // even if the first arg has only one entry. you could argue all anchors should be implicitly dynamic in fact.\n                        else {\n                            pp = root.jsPlumb.extend({elementId: elementId, jsPlumbInstance: _currentInstance, anchors: specimen[0]}, specimen[1]);\n                            newAnchor = new root.jsPlumb.DynamicAnchor(pp);\n                        }\n                    }\n                    else\n                        newAnchor = new jsPlumb.DynamicAnchor({anchors: specimen, selector: null, elementId: elementId, jsPlumbInstance: _currentInstance});\n\n                }\n                else {\n                    var anchorParams = {\n                        x: specimen[0], y: specimen[1],\n                        orientation: (specimen.length >= 4) ? [ specimen[2], specimen[3] ] : [0, 0],\n                        offsets: (specimen.length >= 6) ? [ specimen[4], specimen[5] ] : [ 0, 0 ],\n                        elementId: elementId,\n                        jsPlumbInstance: _currentInstance,\n                        cssClass: specimen.length == 7 ? specimen[6] : null\n                    };\n                    newAnchor = new root.jsPlumb.Anchor(anchorParams);\n                    newAnchor.clone = function () {\n                        return new root.jsPlumb.Anchor(anchorParams);\n                    };\n                }\n            }\n\n            if (!newAnchor.id) newAnchor.id = \"anchor_\" + _idstamp();\n            return newAnchor;\n        };\n\n        /**\n         * makes a list of anchors from the given list of types or coords, eg\n         * [\"TopCenter\", \"RightMiddle\", \"BottomCenter\", [0, 1, -1, -1] ]\n         */\n        this.makeAnchors = function (types, elementId, jsPlumbInstance) {\n            var r = [];\n            for (var i = 0, ii = types.length; i < ii; i++) {\n                if (typeof types[i] == \"string\")\n                    r.push(root.jsPlumb.Anchors[types[i]]({elementId: elementId, jsPlumbInstance: jsPlumbInstance}));\n                else if (_ju.isArray(types[i]))\n                    r.push(_currentInstance.makeAnchor(types[i], elementId, jsPlumbInstance));\n            }\n            return r;\n        };\n\n        /**\n         * Makes a dynamic anchor from the given list of anchors (which may be in shorthand notation as strings or dimension arrays, or Anchor\n         * objects themselves) and the given, optional, anchorSelector function (jsPlumb uses a default if this is not provided; most people will\n         * not need to provide this - i think).\n         */\n        this.makeDynamicAnchor = function (anchors, anchorSelector) {\n            return new root.jsPlumb.DynamicAnchor({anchors: anchors, selector: anchorSelector, elementId: null, jsPlumbInstance: _currentInstance});\n        };\n\n// --------------------- makeSource/makeTarget ---------------------------------------------- \n\n        this.targetEndpointDefinitions = {};\n        var _setEndpointPaintStylesAndAnchor = function (ep, epIndex, _instance) {\n           /* ep.paintStyle = ep.paintStyle ||\n                _instance.Defaults.EndpointStyles[epIndex] ||\n                _instance.Defaults.EndpointStyle;\n\n            ep.hoverPaintStyle = ep.hoverPaintStyle ||\n                _instance.Defaults.EndpointHoverStyles[epIndex] ||\n                _instance.Defaults.EndpointHoverStyle;\n\n            ep.anchor = ep.anchor ||\n                _instance.Defaults.Anchors[epIndex] ||\n                _instance.Defaults.Anchor;\n\n            ep.endpoint = ep.endpoint ||\n                _instance.Defaults.Endpoints[epIndex] ||\n                _instance.Defaults.Endpoint;*/\n        };\n\n        // TODO put all the source stuff inside one parent, keyed by id.\n        this.sourceEndpointDefinitions = {};\n\n        var selectorFilter = function (evt, _el, selector, _instance, negate) {\n            var t = evt.target || evt.srcElement, ok = false,\n                sel = _instance.getSelector(_el, selector);\n            for (var j = 0; j < sel.length; j++) {\n                if (sel[j] == t) {\n                    ok = true;\n                    break;\n                }\n            }\n            return negate ? !ok : ok;\n        };\n\n        // SP target source refactor\n        var _makeElementDropHandler = function (elInfo, p, dropOptions, isSource, isTarget) {\n            var proxyComponent = new jsPlumbUIComponent(p);\n            var _drop = p._jsPlumb.EndpointDropHandler({\n                jsPlumb: _currentInstance,\n                enabled: function () {\n                    return elInfo.def.enabled;\n                },\n                isFull: function () {\n                    var targetCount = _currentInstance.select({target: elInfo.id}).length;\n                    return elInfo.def.maxConnections > 0 && targetCount >= elInfo.def.maxConnections;\n                },\n                element: elInfo.el,\n                elementId: elInfo.id,\n                isSource: isSource,\n                isTarget: isTarget,\n                addClass: function (clazz) {\n                    _currentInstance.addClass(elInfo.el, clazz);\n                },\n                removeClass: function (clazz) {\n                    _currentInstance.removeClass(elInfo.el, clazz);\n                },\n                onDrop: function (jpc) {\n                    var source = jpc.endpoints[0];\n                    source.anchor.locked = false;\n                },\n                isDropAllowed: function () {\n                    return proxyComponent.isDropAllowed.apply(proxyComponent, arguments);\n                },\n                isRedrop:function(jpc) {\n                    return (jpc.suspendedElement != null && jpc.suspendedEndpoint != null && jpc.suspendedEndpoint.element === elInfo.el);\n                },\n                getEndpoint: function (jpc) {\n\n                    // make a new Endpoint for the target, or get it from the cache if uniqueEndpoint\n                    // is set. if its a redrop the new endpoint will be immediately cleaned up.\n\n                    var newEndpoint = elInfo.def.endpoint;\n\n                    // if no cached endpoint, or there was one but it has been cleaned up\n                    // (ie. detached), create a new one\n                    if (newEndpoint == null || newEndpoint._jsPlumb == null) {\n                        var eps = _currentInstance.deriveEndpointAndAnchorSpec(jpc.getType().join(\" \"), true);\n                        var pp = eps.endpoints ? root.jsPlumb.extend(p, {\n                            endpoint:elInfo.def.def.endpoint || eps.endpoints[1]\n                        }) :p;\n                        if (eps.anchors) {\n                            pp = root.jsPlumb.extend(pp, {\n                                anchor:elInfo.def.def.anchor || eps.anchors[1]\n                            });\n                        }\n                        newEndpoint = _currentInstance.addEndpoint(elInfo.el, pp);\n                        newEndpoint._mtNew = true;\n                    }\n\n                    if (p.uniqueEndpoint) elInfo.def.endpoint = newEndpoint;  // may of course just store what it just pulled out. that's ok.\n                    // TODO test options to makeTarget to see if we should do this?\n                    newEndpoint._doNotDeleteOnDetach = false; // reset.\n                    newEndpoint._deleteOnDetach = true;\n\n                    // if connection is detachable, init the new endpoint to be draggable, to support that happening.\n                    if (jpc.isDetachable())\n                        newEndpoint.initDraggable();\n\n                    // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                    // out where to locate the anchor.\n                    if (newEndpoint.anchor.positionFinder != null) {\n                        var dropPosition = _currentInstance.getUIPosition(arguments, _currentInstance.getZoom()),\n                            elPosition = _currentInstance.getOffset(elInfo.el),\n                            elSize = _currentInstance.getSize(elInfo.el),\n                            ap = dropPosition == null ? [0,0] : newEndpoint.anchor.positionFinder(dropPosition, elPosition, elSize, newEndpoint.anchor.constructorParams);\n\n                        newEndpoint.anchor.x = ap[0];\n                        newEndpoint.anchor.y = ap[1];\n                        // now figure an orientation for it..kind of hard to know what to do actually. probably the best thing i can do is to\n                        // support specifying an orientation in the anchor's spec. if one is not supplied then i will make the orientation\n                        // be what will cause the most natural link to the source: it will be pointing at the source, but it needs to be\n                        // specified in one axis only, and so how to make that choice? i think i will use whichever axis is the one in which\n                        // the target is furthest away from the source.\n                    }\n\n                    return newEndpoint;\n                },\n                maybeCleanup: function (ep) {\n                    if (ep._mtNew && ep.connections.length === 0) {\n                        _currentInstance.deleteObject({endpoint: ep});\n                    }\n                    else\n                        delete ep._mtNew;\n                }\n            });\n\n            // wrap drop events as needed and initialise droppable\n            var dropEvent = root.jsPlumb.dragEvents.drop;\n            dropOptions.scope = dropOptions.scope || (p.scope || _currentInstance.Defaults.Scope);\n            dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], _drop, true);\n\n            // if target, return true from the over event. this will cause katavorio to stop setting drops to hover\n            // if multipleDrop is set to false.\n            if (isTarget) {\n                dropOptions[root.jsPlumb.dragEvents.over] = function () { return true; };\n            }\n\n            // vanilla jsplumb only\n            if (p.allowLoopback === false) {\n                dropOptions.canDrop = function (_drag) {\n                    var de = _drag.getDragElement()._jsPlumbRelatedElement;\n                    return de != elInfo.el;\n                };\n            }\n            _currentInstance.initDroppable(elInfo.el, dropOptions, \"internal\");\n\n            return _drop;\n\n        };\n\n        // see API docs\n        this.makeTarget = function (el, params, referenceParams) {\n\n            // put jsplumb ref into params without altering the params passed in\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n\n            // calculate appropriate paint styles and anchor from the params given\n            _setEndpointPaintStylesAndAnchor(p, 1, this);\n\n            var deleteEndpointsOnDetach = !(p.deleteEndpointsOnDetach === false),\n                maxConnections = p.maxConnections || -1,\n\n                _doOne = function (el) {\n\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    // decode the info for this element (id and element)\n                    var elInfo = _info(el),\n                        elid = elInfo.id,\n                        dropOptions = root.jsPlumb.extend({}, p.dropOptions || {}),\n                        type = \"default\";\n\n                    this.targetEndpointDefinitions[elid] = this.targetEndpointDefinitions[elid] || {};\n\n                    _ensureContainer(elid);\n\n                    // store the definition\n                    var _def = {\n                        def: root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n                    elInfo.def = _def;\n                    this.targetEndpointDefinitions[elid][type] = _def;\n                    _makeElementDropHandler(elInfo, p, dropOptions, p.isSource === true, true);\n                    // stash the definition on the drop\n                    elInfo.el._katavorioDrop[elInfo.el._katavorioDrop.length - 1].targetDef = _def;\n\n                }.bind(this);\n\n            // make an array if only given one element\n            var inputs = el.length && el.constructor != String ? el : [ el ];\n\n            // register each one in the list.\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(inputs[i]);\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeTarget = function (el, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            if (!doNotClearArrays) {\n                delete this.targetEndpointDefinitions[info.id];\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.makeSource = function (el, params, referenceParams) {\n            var p = root.jsPlumb.extend({_jsPlumb: this}, referenceParams);\n            root.jsPlumb.extend(p, params);\n            var type = p.connectionType || \"default\";\n            var aae = _currentInstance.deriveEndpointAndAnchorSpec(type);\n            p.endpoint = p.endpoint || aae.endpoints[0];\n            p.anchor = p.anchor || aae.anchors[0];\n            _setEndpointPaintStylesAndAnchor(p, 0, this);\n            var maxConnections = p.maxConnections || -1,\n                onMaxConnections = p.onMaxConnections,\n                _doOne = function (elInfo) {\n                    // get the element's id and store the endpoint definition for it.  jsPlumb.connect calls will look for one of these,\n                    // and use the endpoint definition if found.\n                    var elid = elInfo.id,\n                        _del = this.getElement(elInfo.el);\n\n                    this.sourceEndpointDefinitions[elid] = this.sourceEndpointDefinitions[elid] || {};\n                    _ensureContainer(elid);\n\n                    var _def = {\n                        def:root.jsPlumb.extend({}, p),\n                        uniqueEndpoint: p.uniqueEndpoint,\n                        maxConnections: maxConnections,\n                        enabled: true\n                    };\n\n\n                    this.sourceEndpointDefinitions[elid][type] = _def;\n                    elInfo.def = _def;\n\n                    var stopEvent = root.jsPlumb.dragEvents.stop,\n                        dragEvent = root.jsPlumb.dragEvents.drag,\n                        dragOptions = root.jsPlumb.extend({ }, p.dragOptions || {}),\n                        existingDrag = dragOptions.drag,\n                        existingStop = dragOptions.stop,\n                        ep = null,\n                        endpointAddedButNoDragYet = false;\n\n                    // set scope if its not set in dragOptions but was passed in in params\n                    dragOptions.scope = dragOptions.scope || p.scope;\n\n                    dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], function () {\n                        if (existingDrag) existingDrag.apply(this, arguments);\n                        endpointAddedButNoDragYet = false;\n                    });\n\n                    dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], function () {\n\n                        if (existingStop) existingStop.apply(this, arguments);\n                        this.currentlyDragging = false;\n                        if (ep._jsPlumb != null) { // if not cleaned up...\n\n                            // reset the anchor to the anchor that was initially provided. the one we were using to drag\n                            // the connection was just a placeholder that was located at the place the user pressed the\n                            // mouse button to initiate the drag.\n                            var anchorDef = p.anchor || this.Defaults.Anchor,\n                                oldAnchor = ep.anchor,\n                                oldConnection = ep.connections[0];\n\n                            var    newAnchor = this.makeAnchor(anchorDef, elid, this),\n                                _el = ep.element;\n\n                            // if the anchor has a 'positionFinder' set, then delegate to that function to find\n                            // out where to locate the anchor. issue 117.\n                            if (newAnchor.positionFinder != null) {\n                                var elPosition = _currentInstance.getOffset(_el),\n                                    elSize = this.getSize(_el),\n                                    dropPosition = { left: elPosition.left + (oldAnchor.x * elSize[0]), top: elPosition.top + (oldAnchor.y * elSize[1]) },\n                                    ap = newAnchor.positionFinder(dropPosition, elPosition, elSize, newAnchor.constructorParams);\n\n                                newAnchor.x = ap[0];\n                                newAnchor.y = ap[1];\n                            }\n\n                            ep.setAnchor(newAnchor, true);\n                            ep.repaint();\n                            this.repaint(ep.elementId);\n                            if (oldConnection != null) this.repaint(oldConnection.targetId);\n                        }\n                    }.bind(this));\n\n                    // when the user presses the mouse, add an Endpoint, if we are enabled.\n                    var mouseDownListener = function (e) {\n                        // on right mouse button, abort.\n                        if (e.which === 3 || e.button === 2) return;\n\n                        // TODO store def on element.\n                        var def = this.sourceEndpointDefinitions[elid][type];\n\n                        // if disabled, return.\n                        if (!def.enabled) return;\n\n                        elid = this.getId(this.getElement(elInfo.el)); // elid might have changed since this method was called to configure the element.\n\n                        // if a filter was given, run it, and return if it says no.\n                        if (p.filter) {\n                            var r = _ju.isString(p.filter) ? selectorFilter(e, elInfo.el, p.filter, this, p.filterExclude) : p.filter(e, elInfo.el);\n                            if (r === false) return;\n                        }\n\n                        // if maxConnections reached\n                        var sourceCount = this.select({source: elid}).length;\n                        if (def.maxConnections >= 0 && (sourceCount >= def.maxConnections)) {\n                            if (onMaxConnections) {\n                                onMaxConnections({\n                                    element: elInfo.el,\n                                    maxConnections: maxConnections\n                                }, e);\n                            }\n                            return false;\n                        }\n\n                        // find the position on the element at which the mouse was pressed; this is where the endpoint\n                        // will be located.\n                        var elxy = root.jsPlumb.getPositionOnElement(e, _del, _zoom);\n\n                        // we need to override the anchor in here, and force 'isSource', but we don't want to mess with\n                        // the params passed in, because after a connection is established we're going to reset the endpoint\n                        // to have the anchor we were given.\n                        var tempEndpointParams = {};\n                        root.jsPlumb.extend(tempEndpointParams, p);\n                        tempEndpointParams.isTemporarySource = true;\n                        tempEndpointParams.anchor = [ elxy[0], elxy[1] , 0, 0];\n                        tempEndpointParams.dragOptions = dragOptions;\n\n                        if (def.def.scope) tempEndpointParams.scope = def.def.scope;\n\n                        ep = this.addEndpoint(elid, tempEndpointParams);\n                        endpointAddedButNoDragYet = true;\n                        ep._doNotDeleteOnDetach = false; // reset.\n                        ep._deleteOnDetach = true;\n\n                        // if unique endpoint and it's already been created, push it onto the endpoint we create. at the end\n                        // of a successful connection we'll switch to that endpoint.\n                        // TODO this is the same code as the programmatic endpoints create on line 1050 ish\n                        if (def.uniqueEndpoint) {\n                            if (!def.endpoint) {\n                                def.endpoint = ep;\n                                ep._deleteOnDetach = false;\n                                ep._doNotDeleteOnDetach = true;\n                            }\n                            else\n                                ep.finalEndpoint = def.endpoint;\n                        }\n\n                        var _delTempEndpoint = function () {\n                            // this mouseup event is fired only if no dragging occurred, by jquery and yui, but for mootools\n                            // it is fired even if dragging has occurred, in which case we would blow away a perfectly\n                            // legitimate endpoint, were it not for this check.  the flag is set after adding an\n                            // endpoint and cleared in a drag listener we set in the dragOptions above.\n                            _currentInstance.off(ep.canvas, \"mouseup\", _delTempEndpoint);\n                            _currentInstance.off(elInfo.el, \"mouseup\", _delTempEndpoint);\n                            if (endpointAddedButNoDragYet) {\n                                endpointAddedButNoDragYet = false;\n                                _currentInstance.deleteEndpoint(ep);\n                            }\n                        };\n\n                        _currentInstance.on(ep.canvas, \"mouseup\", _delTempEndpoint);\n                        _currentInstance.on(elInfo.el, \"mouseup\", _delTempEndpoint);\n\n                        // optionally check for attributes to extract from the source element\n                        var payload = {};\n                        if (def.def.extract) {\n                            for (var att in def.def.extract) {\n                                var v = (e.srcElement || e.target).getAttribute(att);\n                                if (v) {\n                                    payload[def.def.extract[att]] = v;\n                                }\n                            }\n                        }\n\n                        // and then trigger its mousedown event, which will kick off a drag, which will start dragging\n                        // a new connection from this endpoint.\n                        _currentInstance.trigger(ep.canvas, \"mousedown\", e, payload);\n\n                        _ju.consume(e);\n\n                    }.bind(this);\n\n                    this.on(elInfo.el, \"mousedown\", mouseDownListener);\n                    _def.trigger = mouseDownListener;\n\n                    // if a filter was provided, set it as a dragFilter on the element,\n                    // to prevent the element drag function from kicking in when we want to\n                    // drag a new connection\n                    if (p.filter && (_ju.isString(p.filter) || _ju.isFunction(p.filter))) {\n                        _currentInstance.setDragFilter(elInfo.el, p.filter);\n                    }\n\n                    var dropOptions = root.jsPlumb.extend({}, p.dropOptions || {});\n\n                    _makeElementDropHandler(elInfo, p, dropOptions, true, p.isTarget === true);\n\n                }.bind(this);\n\n            var inputs = el.length && el.constructor != String ? el : [ el ];\n            for (var i = 0, ii = inputs.length; i < ii; i++) {\n                _doOne(_info(inputs[i]));\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeSource = function (el, connectionType, doNotClearArrays) {\n            var info = _info(el);\n            _currentInstance.destroyDroppable(info.el, \"internal\");\n            var eldefs = this.sourceEndpointDefinitions[info.id];\n            if (eldefs) {\n                for (var def in eldefs) {\n                    if (connectionType == null || connectionType === def) {\n                        var mouseDownListener = eldefs[def].trigger;\n                        if (mouseDownListener)\n                            _currentInstance.off(info.el, \"mousedown\", mouseDownListener);\n                        if (!doNotClearArrays) {\n                            delete this.sourceEndpointDefinitions[info.id][def];\n                        }\n                    }\n                }\n            }\n\n            return this;\n        };\n\n        // see api docs\n        this.unmakeEverySource = function () {\n            for (var i in this.sourceEndpointDefinitions)\n                _currentInstance.unmakeSource(i, null, true);\n\n            this.sourceEndpointDefinitions = {};\n            return this;\n        };\n\n        var _getScope = function (el, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) return eldefs[connectionType].def.scope || this.Defaults.Scope;\n            }\n        }.bind(this);\n\n        var _setScope = function (el, scope, types, connectionType) {\n            types = _ju.isArray(types) ? types : [ types ];\n            var id = _getId(el);\n            connectionType = connectionType || \"default\";\n            for (var i = 0; i < types.length; i++) {\n                var eldefs = this[types[i]][id];\n                if (eldefs && eldefs[connectionType]) {\n                    eldefs[connectionType].def.scope = scope;\n                }\n            }\n\n        }.bind(this);\n\n        this.getScope = function (el, scope) {\n            return _getScope(el, [ \"sourceEndpointDefinitions\", \"targetEndpointDefinitions\" ]);\n        };\n        this.getSourceScope = function (el) {\n            return _getScope(el, \"sourceEndpointDefinitions\");\n        };\n        this.getTargetScope = function (el) {\n            return _getScope(el, \"targetEndpointDefinitions\");\n        };\n        this.setScope = function (el, scope, connectionType) {\n            this.setSourceScope(el, scope, connectionType);\n            this.setTargetScope(el, scope, connectionType);\n        };\n        this.setSourceScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"sourceEndpointDefinitions\", connectionType);\n            // we get the source scope during the mousedown event, but we also want to set this.\n            this.setDragScope(el, scope);\n        };\n        this.setTargetScope = function (el, scope, connectionType) {\n            _setScope(el, scope, \"targetEndpointDefinitions\", connectionType);\n            this.setDropScope(el, scope);\n        };\n\n        // see api docs\n        this.unmakeEveryTarget = function () {\n            for (var i in this.targetEndpointDefinitions)\n                _currentInstance.unmakeTarget(i, true);\n\n            this.targetEndpointDefinitions = {};\n            return this;\n        };\n\n        // does the work of setting a source enabled or disabled.\n        var _setEnabled = function (type, el, state, toggle, connectionType) {\n            var a = type == \"source\" ? this.sourceEndpointDefinitions : this.targetEndpointDefinitions;\n            connectionType = connectionType || \"default\";\n\n\n            if (_ju.isString(el) && a[el] && a[el][connectionType]) {\n                a[el][connectionType].enabled = toggle ? !a[el][connectionType].enabled : state;\n            }\n            else if (el.length) {\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    var info = _info(el[i]);\n                    if (a[info.id] && a[info.id][connectionType])\n                        a[info.id][connectionType].enabled = toggle ? !a[info.id][connectionType].enabled : state;\n                }\n            }\n            // otherwise a DOM element\n            else {\n                var id = _info(el).id;\n                if (a[id] && a[id][connectionType])\n                    a[id][connectionType].enabled = toggle ? !a[id][connectionType].enabled : state;\n            }\n            return this;\n        }.bind(this);\n\n        var _first = function (el, fn) {\n            if (_ju.isString(el) || !el.length)\n                return fn.apply(this, [ el ]);\n            else if (el.length)\n                return fn.apply(this, [ el[0] ]);\n\n        }.bind(this);\n\n        this.toggleSourceEnabled = function (el, connectionType) {\n            _setEnabled(\"source\", el, null, true, connectionType);\n            return this.isSourceEnabled(el, connectionType);\n        };\n\n        this.setSourceEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"source\", el, state, null, connectionType);\n        };\n        this.isSource = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.sourceEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isSourceEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var sep = this.sourceEndpointDefinitions[_info(_el).id];\n                return sep && sep[connectionType] && sep[connectionType].enabled === true;\n            }.bind(this));\n        };\n\n        this.toggleTargetEnabled = function (el, connectionType) {\n            _setEnabled(\"target\", el, null, true, connectionType);\n            return this.isTargetEnabled(el, connectionType);\n        };\n\n        this.isTarget = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var eldefs = this.targetEndpointDefinitions[_info(_el).id];\n                return eldefs != null && eldefs[connectionType] != null;\n            }.bind(this));\n        };\n        this.isTargetEnabled = function (el, connectionType) {\n            connectionType = connectionType || \"default\";\n            return _first(el, function (_el) {\n                var tep = this.targetEndpointDefinitions[_info(_el).id];\n                return tep && tep[connectionType] && tep[connectionType].enabled === true;\n            }.bind(this));\n        };\n        this.setTargetEnabled = function (el, state, connectionType) {\n            return _setEnabled(\"target\", el, state, null, connectionType);\n        };\n\n// --------------------- end makeSource/makeTarget ----------------------------------------------                 \n\n        this.ready = function (fn) {\n            _currentInstance.bind(\"ready\", fn);\n        };\n\n        var _elEach = function(el, fn) {\n            // support both lists...\n            if (typeof el == 'object' && el.length)\n                for (var i = 0, ii = el.length; i < ii; i++) {\n                    fn(el[i]);\n                }\n            else // ...and single strings or elements.\n                fn(el);\n\n            return _currentInstance;\n        };\n\n        // repaint some element's endpoints and connections\n        this.repaint = function (el, ui, timestamp) {\n            return _elEach(el, function(_el) {\n                _draw(_el, ui, timestamp);\n            });\n        };\n\n        this.revalidate = function (el, timestamp, isIdAlready) {\n            return _elEach(el, function(_el) {\n                var elId = isIdAlready ? _el : _currentInstance.getId(_el);\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp:timestamp });\n                _currentInstance.repaint(_el);\n            });\n        };\n\n        // repaint every endpoint and connection.\n        this.repaintEverything = function () {\n            // TODO this timestamp causes continuous anchors to not repaint properly.\n            // fix this. do not just take out the timestamp. it runs a lot faster with\n            // the timestamp included.\n            var timestamp = _timestamp(), elId;\n\n            for (elId in endpointsByElement) {\n                _currentInstance.updateOffset({ elId: elId, recalc: true, timestamp: timestamp });\n            }\n\n            for (elId in endpointsByElement) {\n                _draw(elId, null, timestamp);\n            }\n\n            return this;\n        };\n\n        this.removeAllEndpoints = function (el, recurse, affectedElements) {\n            affectedElements = affectedElements || [];\n            var _one = function (_el) {\n                var info = _info(_el),\n                    ebe = endpointsByElement[info.id],\n                    i, ii;\n\n                if (ebe) {\n                    affectedElements.push(info);\n                    for (i = 0, ii = ebe.length; i < ii; i++)\n                        _currentInstance.deleteEndpoint(ebe[i], false);\n                }\n                delete endpointsByElement[info.id];\n\n                if (recurse) {\n                    if (info.el && info.el.nodeType != 3 && info.el.nodeType != 8) {\n                        for (i = 0, ii = info.el.childNodes.length; i < ii; i++) {\n                            _one(info.el.childNodes[i]);\n                        }\n                    }\n                }\n\n            };\n            _one(el);\n            return this;\n        };\n\n        var _doRemove = function(info, affectedElements) {\n            _currentInstance.removeAllEndpoints(info.id, true, affectedElements);\n            var _one = function(_info) {\n                _currentInstance.getDragManager().elementRemoved(_info.id);\n                _currentInstance.anchorManager.clearFor(_info.id);\n                _currentInstance.anchorManager.removeFloatingConnection(_info.id);\n\n                if (_currentInstance.isSource(_info.el)) _currentInstance.unmakeSource(_info.el);\n                if (_currentInstance.isTarget(_info.el)) _currentInstance.unmakeTarget(_info.el);\n                _currentInstance.destroyDraggable(_info.el);\n                _currentInstance.destroyDroppable(_info.el);\n\n\n                delete _currentInstance.floatingConnections[_info.id];\n                delete managedElements[_info.id];\n                delete offsets[_info.id];\n                if (_info.el) {\n                    _currentInstance.removeElement(_info.el);\n                    _info.el._jsPlumb = null;\n                }\n            };\n\n            // remove all affected child elements\n            for (var ae = 1; ae < affectedElements.length; ae++) {\n                _one(affectedElements[ae]);\n            }\n            // and always remove the requested one from the dom.\n            _one(info);\n        };\n\n        /**\n         * Remove the given element, including cleaning up all endpoints registered for it.\n         * This is exposed in the public API but also used internally by jsPlumb when removing the\n         * element associated with a connection drag.\n         */\n        this.remove = function (el, doNotRepaint) {\n            var info = _info(el), affectedElements = [];\n            if (info.text) {\n                info.el.parentNode.removeChild(info.el);\n            }\n            else if (info.id) {\n                _currentInstance.batch(function () {\n                    _doRemove(info, affectedElements);\n                }, doNotRepaint === false);\n            }\n            return _currentInstance;\n        };\n\n        this.empty = function (el, doNotRepaint) {\n            var affectedElements = [];\n            var _one = function(el, dontRemoveFocus) {\n                var info = _info(el);\n                if (info.text) {\n                    info.el.parentNode.removeChild(info.el);\n                }\n                else if (info.el) {\n                    while(info.el.childNodes.length > 0) {\n                        _one(info.el.childNodes[0]);\n                    }\n                    if (!dontRemoveFocus) _doRemove(info, affectedElements);\n                }\n            };\n\n            _currentInstance.batch(function() {\n                _one(el, true);\n            }, doNotRepaint === false);\n\n            return _currentInstance;\n        };\n\n        this.reset = function () {\n            _currentInstance.silently(function() {\n                _currentInstance.removeAllGroups();\n                _currentInstance.removeGroupManager();\n                _currentInstance.deleteEveryEndpoint();\n                _currentInstance.unbind();\n                this.targetEndpointDefinitions = {};\n                this.sourceEndpointDefinitions = {};\n                connections.length = 0;\n                if (this.doReset) this.doReset();\n            }.bind(this));\n        };\n\n        var _clearObject = function (obj) {\n            if (obj.canvas && obj.canvas.parentNode)\n                obj.canvas.parentNode.removeChild(obj.canvas);\n            obj.cleanup();\n            obj.destroy();\n        };\n\n        this.clear = function () {\n            _currentInstance.select().each(_clearObject);\n            _currentInstance.selectEndpoints().each(_clearObject);\n\n            endpointsByElement = {};\n            endpointsByUUID = {};\n        };\n\n        this.setDefaultScope = function (scope) {\n            DEFAULT_SCOPE = scope;\n            return _currentInstance;\n        };\n\n        // sets whether or not some element should be currently draggable.\n        this.setDraggable = _setDraggable;\n\n        this.deriveEndpointAndAnchorSpec = function(type, dontPrependDefault) {\n            var bits = ((dontPrependDefault ? \"\" : \"default \") + type).split(/[\\s]/), eps = null, ep = null, a = null, as = null;\n            for (var i = 0; i < bits.length; i++) {\n                var _t = _currentInstance.getType(bits[i], \"connection\");\n                if (_t) {\n                    if (_t.endpoints) eps = _t.endpoints;\n                    if (_t.endpoint) ep = _t.endpoint;\n                    if (_t.anchors) as = _t.anchors;\n                    if (_t.anchor) a = _t.anchor;\n                }\n            }\n            return { endpoints: eps ? eps : [ ep, ep ], anchors: as ? as : [a, a ]};\n        };\n\n        // sets the id of some element, changing whatever we need to to keep track.\n        this.setId = function (el, newId, doNotSetAttribute) {\n            //\n            var id;\n\n            if (_ju.isString(el)) {\n                id = el;\n            }\n            else {\n                el = this.getElement(el);\n                id = this.getId(el);\n            }\n\n            var sConns = this.getConnections({source: id, scope: '*'}, true),\n                tConns = this.getConnections({target: id, scope: '*'}, true);\n\n            newId = \"\" + newId;\n\n            if (!doNotSetAttribute) {\n                el = this.getElement(id);\n                this.setAttribute(el, \"id\", newId);\n            }\n            else\n                el = this.getElement(newId);\n\n            endpointsByElement[newId] = endpointsByElement[id] || [];\n            for (var i = 0, ii = endpointsByElement[newId].length; i < ii; i++) {\n                endpointsByElement[newId][i].setElementId(newId);\n                endpointsByElement[newId][i].setReferenceElement(el);\n            }\n            delete endpointsByElement[id];\n\n            this.sourceEndpointDefinitions[newId] = this.sourceEndpointDefinitions[id];\n            delete this.sourceEndpointDefinitions[id];\n            this.targetEndpointDefinitions[newId] = this.targetEndpointDefinitions[id];\n            delete this.targetEndpointDefinitions[id];\n\n            this.anchorManager.changeId(id, newId);\n            this.getDragManager().changeId(id, newId);\n            managedElements[newId] = managedElements[id];\n            delete managedElements[id];\n\n            var _conns = function (list, epIdx, type) {\n                for (var i = 0, ii = list.length; i < ii; i++) {\n                    list[i].endpoints[epIdx].setElementId(newId);\n                    list[i].endpoints[epIdx].setReferenceElement(el);\n                    list[i][type + \"Id\"] = newId;\n                    list[i][type] = el;\n                }\n            };\n            _conns(sConns, 0, \"source\");\n            _conns(tConns, 1, \"target\");\n\n            this.repaint(newId);\n        };\n\n        this.setDebugLog = function (debugLog) {\n            log = debugLog;\n        };\n\n        this.setSuspendDrawing = function (val, repaintAfterwards) {\n            var curVal = _suspendDrawing;\n            _suspendDrawing = val;\n            if (val) _suspendedAt = new Date().getTime(); else _suspendedAt = null;\n            if (repaintAfterwards) this.repaintEverything();\n            return curVal;\n        };\n\n        // returns whether or not drawing is currently suspended.\n        this.isSuspendDrawing = function () {\n            return _suspendDrawing;\n        };\n\n        // return timestamp for when drawing was suspended.\n        this.getSuspendedAt = function () {\n            return _suspendedAt;\n        };\n\n        this.batch = function (fn, doNotRepaintAfterwards) {\n            var _wasSuspended = this.isSuspendDrawing();\n            if (!_wasSuspended)\n                this.setSuspendDrawing(true);\n            try {\n                fn();\n            }\n            catch (e) {\n                _ju.log(\"Function run while suspended failed\", e);\n            }\n            if (!_wasSuspended)\n                this.setSuspendDrawing(false, !doNotRepaintAfterwards);\n        };\n\n        this.doWhileSuspended = this.batch;\n\n        this.getCachedData = _getCachedData;\n        this.timestamp = _timestamp;\n        this.show = function (el, changeEndpoints) {\n            _setVisible(el, \"block\", changeEndpoints);\n            return _currentInstance;\n        };\n\n        // TODO: update this method to return the current state.\n        this.toggleVisible = _toggleVisible;\n        this.toggleDraggable = _toggleDraggable;\n        this.addListener = this.bind;\n    };\n\n    _ju.extend(root.jsPlumbInstance, _ju.EventGenerator, {\n        setAttribute: function (el, a, v) {\n            this.setAttribute(el, a, v);\n        },\n        getAttribute: function (el, a) {\n            return this.getAttribute(root.jsPlumb.getElement(el), a);\n        },\n        convertToFullOverlaySpec: function(spec) {\n            if (_ju.isString(spec)) {\n                spec = [ spec, { } ];\n            }\n            spec[1].id = spec[1].id || _ju.uuid();\n            return spec;\n        },\n        registerConnectionType: function (id, type) {\n            this._connectionTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._connectionTypes[id].overlays = to;\n            }\n        },\n        registerConnectionTypes: function (types) {\n            for (var i in types)\n                this.registerConnectionType(i, types[i]);\n        },\n        registerEndpointType: function (id, type) {\n            this._endpointTypes[id] = root.jsPlumb.extend({}, type);\n            if (type.overlays) {\n                var to = {};\n                for (var i = 0; i < type.overlays.length; i++) {\n                    // if a string, convert to object representation so that we can store the typeid on it.\n                    // also assign an id.\n                    var fo = this.convertToFullOverlaySpec(type.overlays[i]);\n                    to[fo[1].id] = fo;\n                }\n                this._endpointTypes[id].overlays = to;\n            }\n        },\n        registerEndpointTypes: function (types) {\n            for (var i in types)\n                //this._endpointTypes[i] = jsPlumb.extend({}, types[i]);\n                this.registerEndpointType(i, types[i]);\n        },\n        getType: function (id, typeDescriptor) {\n            return typeDescriptor === \"connection\" ? this._connectionTypes[id] : this._endpointTypes[id];\n        },\n        setIdChanged: function (oldId, newId) {\n            this.setId(oldId, newId, true);\n        },\n        // set parent: change the parent for some node and update all the registrations we need to.\n        setParent: function (el, newParent) {\n            var _dom = this.getElement(el),\n                _id = this.getId(_dom),\n                _pdom = this.getElement(newParent),\n                _pid = this.getId(_pdom);\n\n            _dom.parentNode.removeChild(_dom);\n            _pdom.appendChild(_dom);\n            this.getDragManager().setParent(_dom, _id, _pdom, _pid);\n        },\n        extend: function (o1, o2, names) {\n            var i;\n            if (names) {\n                for (i = 0; i < names.length; i++)\n                    o1[names[i]] = o2[names[i]];\n            }\n            else\n                for (i in o2) o1[i] = o2[i];\n            return o1;\n        },\n        floatingConnections: {},\n        getFloatingAnchorIndex: function (jpc) {\n            return jpc.endpoints[0].isFloating() ? 0 : jpc.endpoints[1].isFloating() ? 1 : -1;\n        }\n    });\n\n// --------------------- static instance + AMD registration -------------------------------------------    \n\n// create static instance and assign to window if window exists.    \n    var jsPlumb = new jsPlumbInstance();\n    // register on 'root' (lets us run on server or browser)\n    root.jsPlumb = jsPlumb;\n    // add 'getInstance' method to static instance\n    jsPlumb.getInstance = function (_defaults) {\n        var j = new jsPlumbInstance(_defaults);\n        j.init();\n        return j;\n    };\n    jsPlumb.each = function (spec, fn) {\n        if (spec == null) return;\n        if (typeof spec === \"string\")\n            fn(jsPlumb.getElement(spec));\n        else if (spec.length != null) {\n            for (var i = 0; i < spec.length; i++)\n                fn(jsPlumb.getElement(spec[i]));\n        }\n        else\n            fn(spec); // assume it's an element.\n    };\n// maybe register static instance as an AMD module, and getInstance method too.\n    if (typeof define === \"function\") {\n        define(\"jsplumb\", [], function () {\n            return jsPlumb;\n        });\n        define(\"jsplumbinstance\", [], function () {\n            return jsPlumb.getInstance();\n        });\n    }\n    // CommonJS\n    if (typeof exports !== 'undefined') {\n        exports.jsPlumb = jsPlumb;\n    }\n\n    // npm\n    if (typeof module !== \"undefined\") {\n        module.exports = jsPlumb;\n    }\n\n// --------------------- end static instance + AMD registration -------------------------------------------        \n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n *\n * Title:jsPlumb 2.1.1\n *\n * Provides a way to visually connect elements on an HTML page, using SVG.\n *\n * This file contains the base functionality for DOM type adapters.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    var root = this, _ju = root.jsPlumbUtil;\n\n    var svgAvailable = !!window.SVGAngle || document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\"),\n\n        _genLoc = function (e, prefix) {\n            if (e == null) return [ 0, 0 ];\n            var ts = _touches(e), t = _getTouch(ts, 0);\n            return [t[prefix + \"X\"], t[prefix + \"Y\"]];\n        },\n        _pageLocation = function (e) {\n            if (e == null) return [ 0, 0 ];\n            return _genLoc(e, \"page\");\n        },\n        _screenLocation = function (e) {\n            return _genLoc(e, \"screen\");\n        },\n        _clientLocation = function (e) {\n            return _genLoc(e, \"client\");\n        },\n        _getTouch = function (touches, idx) {\n            return touches.item ? touches.item(idx) : touches[idx];\n        },\n        _touches = function (e) {\n            return e.touches && e.touches.length > 0 ? e.touches :\n                    e.changedTouches && e.changedTouches.length > 0 ? e.changedTouches :\n                    e.targetTouches && e.targetTouches.length > 0 ? e.targetTouches :\n                [ e ];\n        };\n\n    /**\n     Manages dragging for some instance of jsPlumb.\n\n     TODO instead of this being accessed directly, it should subscribe to events on the jsPlumb instance: every method\n     in here is called directly by jsPlumb. But what should happen is that we have unpublished events that this listens\n     to.  The only trick is getting one of these instantiated with every jsPlumb instance: it needs to have a hook somehow.\n     Basically the general idea is to pull ALL the drag code out (prototype method registrations plus this) into a\n     dedicated drag script), that does not necessarily need to be included.\n\n\n     */\n    var DragManager = function (_currentInstance) {\n        var _draggables = {}, _dlist = [], _delements = {}, _elementsWithEndpoints = {},\n        // elementids mapped to the draggable to which they belong.\n            _draggablesForElements = {};\n\n        /**\n         register some element as draggable.  right now the drag init stuff is done elsewhere, and it is\n         possible that will continue to be the case.\n         */\n        this.register = function (el) {\n            var id = _currentInstance.getId(el),\n                parentOffset = _currentInstance.getOffset(el);\n\n            if (!_draggables[id]) {\n                _draggables[id] = el;\n                _dlist.push(el);\n                _delements[id] = {};\n            }\n\n            // look for child elements that have endpoints and register them against this draggable.\n            var _oneLevel = function (p) {\n                if (p) {\n                    for (var i = 0; i < p.childNodes.length; i++) {\n                        if (p.childNodes[i].nodeType != 3 && p.childNodes[i].nodeType != 8) {\n                            var cEl = jsPlumb.getElement(p.childNodes[i]),\n                                cid = _currentInstance.getId(p.childNodes[i], null, true);\n                            if (cid && _elementsWithEndpoints[cid] && _elementsWithEndpoints[cid] > 0) {\n                                var cOff = _currentInstance.getOffset(cEl);\n                                _delements[id][cid] = {\n                                    id: cid,\n                                    offset: {\n                                        left: cOff.left - parentOffset.left,\n                                        top: cOff.top - parentOffset.top\n                                    }\n                                };\n                                _draggablesForElements[cid] = id;\n                            }\n                            _oneLevel(p.childNodes[i]);\n                        }\n                    }\n                }\n            };\n\n            _oneLevel(el);\n        };\n\n        // refresh the offsets for child elements of this element.\n        this.updateOffsets = function (elId, childOffsetOverrides) {\n            if (elId != null) {\n                childOffsetOverrides = childOffsetOverrides || {};\n                var domEl = jsPlumb.getElement(elId),\n                    id = _currentInstance.getId(domEl),\n                    children = _delements[id],\n                    parentOffset = _currentInstance.getOffset(domEl);\n\n                if (children) {\n                    for (var i in children) {\n                        if (children.hasOwnProperty(i)) {\n                            var cel = jsPlumb.getElement(i),\n                                cOff = childOffsetOverrides[i] || _currentInstance.getOffset(cel);\n\n                            // do not update if we have a value already and we'd just be writing 0,0\n                            if (cel.offsetParent == null && _delements[id][i] != null) continue;\n\n                            _delements[id][i] = {\n                                id: i,\n                                offset: {\n                                    left: cOff.left - parentOffset.left,\n                                    top: cOff.top - parentOffset.top\n                                }\n                            };\n                            _draggablesForElements[i] = id;\n                        }\n                    }\n                }\n            }\n        };\n\n        /**\n         notification that an endpoint was added to the given el.  we go up from that el's parent\n         node, looking for a parent that has been registered as a draggable. if we find one, we add this\n         el to that parent's list of elements to update on drag (if it is not there already)\n         */\n        this.endpointAdded = function (el, id) {\n\n            id = id || _currentInstance.getId(el);\n\n            var b = document.body,\n                p = el.parentNode;\n\n            _elementsWithEndpoints[id] = _elementsWithEndpoints[id] ? _elementsWithEndpoints[id] + 1 : 1;\n\n            while (p != null && p != b) {\n                var pid = _currentInstance.getId(p, null, true);\n                if (pid && _draggables[pid]) {\n                    var pLoc = _currentInstance.getOffset(p);\n\n                    if (_delements[pid][id] == null) {\n                        var cLoc = _currentInstance.getOffset(el);\n                        _delements[pid][id] = {\n                            id: id,\n                            offset: {\n                                left: cLoc.left - pLoc.left,\n                                top: cLoc.top - pLoc.top\n                            }\n                        };\n                        _draggablesForElements[id] = pid;\n                    }\n                    break;\n                }\n                p = p.parentNode;\n            }\n        };\n\n        this.endpointDeleted = function (endpoint) {\n            if (_elementsWithEndpoints[endpoint.elementId]) {\n                _elementsWithEndpoints[endpoint.elementId]--;\n                if (_elementsWithEndpoints[endpoint.elementId] <= 0) {\n                    for (var i in _delements) {\n                        if (_delements.hasOwnProperty(i) && _delements[i]) {\n                            delete _delements[i][endpoint.elementId];\n                            delete _draggablesForElements[endpoint.elementId];\n                        }\n                    }\n                }\n            }\n        };\n\n        this.changeId = function (oldId, newId) {\n            _delements[newId] = _delements[oldId];\n            _delements[oldId] = {};\n            _draggablesForElements[newId] = _draggablesForElements[oldId];\n            _draggablesForElements[oldId] = null;\n        };\n\n        this.getElementsForDraggable = function (id) {\n            return _delements[id];\n        };\n\n        this.elementRemoved = function (elementId) {\n            var elId = _draggablesForElements[elementId];\n            if (elId) {\n                delete _delements[elId][elementId];\n                delete _draggablesForElements[elementId];\n            }\n        };\n\n        this.reset = function () {\n            _draggables = {};\n            _dlist = [];\n            _delements = {};\n            _elementsWithEndpoints = {};\n        };\n\n        //\n        // notification drag ended. We check automatically if need to update some\n        // ancestor's offsets.\n        //\n        this.dragEnded = function (el) {\n            if (el.offsetParent != null) {\n                var id = _currentInstance.getId(el),\n                    ancestor = _draggablesForElements[id];\n\n                if (ancestor) this.updateOffsets(ancestor);\n            }\n        };\n\n        this.setParent = function (el, elId, p, pId, currentChildLocation) {\n            var current = _draggablesForElements[elId];\n            if (!_delements[pId]) {\n                _delements[pId] = {};\n            }\n            var pLoc = _currentInstance.getOffset(p),\n                cLoc = currentChildLocation || _currentInstance.getOffset(el);\n            if (current) {\n                delete _delements[current][elId];\n            }\n\n            _delements[pId][elId] = {\n                id:elId,\n                offset : {\n                    left: cLoc.left - pLoc.left,\n                    top: cLoc.top - pLoc.top\n                }\n            };\n            _draggablesForElements[elId] = pId;\n        };\n\n        this.clearParent = function(el, elId) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                delete _delements[current][elId];\n                delete _draggablesForElements[elId];\n            }\n        };\n\n        this.revalidateParent = function(el, elId, childOffset) {\n            var current = _draggablesForElements[elId];\n            if (current) {\n                var co = {};\n                co[elId] = childOffset;\n                this.updateOffsets(current, co);\n                _currentInstance.revalidate(current);\n            }\n        };\n\n        this.getDragAncestor = function (el) {\n            var de = jsPlumb.getElement(el),\n                id = _currentInstance.getId(de),\n                aid = _draggablesForElements[id];\n\n            if (aid)\n                return jsPlumb.getElement(aid);\n            else\n                return null;\n        };\n\n    };\n\n    var trim = function (str) {\n            return str == null ? null : (str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, ''));\n        },\n        _setClassName = function (el, cn) {\n            cn = trim(cn);\n            if (typeof el.className.baseVal != \"undefined\")  // SVG\n                el.className.baseVal = cn;\n            else\n                el.className = cn;\n        },\n        _getClassName = function (el) {\n            return (typeof el.className.baseVal == \"undefined\") ? el.className : el.className.baseVal;\n        },\n        _classManip = function (el, classesToAdd, classesToRemove) {\n            classesToAdd = classesToAdd == null ? [] : _ju.isArray(classesToAdd) ? classesToAdd : classesToAdd.split(/\\s+/);\n            classesToRemove = classesToRemove == null ? [] : _ju.isArray(classesToRemove) ? classesToRemove : classesToRemove.split(/\\s+/);\n\n            var className = _getClassName(el),\n                curClasses = className.split(/\\s+/);\n\n            var _oneSet = function (add, classes) {\n                for (var i = 0; i < classes.length; i++) {\n                    if (add) {\n                        if (curClasses.indexOf(classes[i]) == -1)\n                            curClasses.push(classes[i]);\n                    }\n                    else {\n                        var idx = curClasses.indexOf(classes[i]);\n                        if (idx != -1)\n                            curClasses.splice(idx, 1);\n                    }\n                }\n            };\n\n            _oneSet(true, classesToAdd);\n            _oneSet(false, classesToRemove);\n\n            _setClassName(el, curClasses.join(\" \"));\n        };\n\n    root.jsPlumb.extend(root.jsPlumbInstance.prototype, {\n\n        headless: false,\n\n        pageLocation: _pageLocation,\n        screenLocation: _screenLocation,\n        clientLocation: _clientLocation,\n\n        getDragManager:function() {\n            if (this.dragManager == null)\n                this.dragManager = new DragManager(this);\n\n            return this.dragManager;\n        },\n\n        recalculateOffsets:function(elId) {\n            this.getDragManager().updateOffsets(elId);\n        },\n\n        createElement:function(tag, style, clazz, atts) {\n            return this.createElementNS(null, tag, style, clazz, atts);\n        },\n\n        createElementNS:function(ns, tag, style, clazz, atts) {\n            var e = ns == null ? document.createElement(tag) : document.createElementNS(ns, tag);\n            var i;\n            style = style || {};\n            for (i in style)\n                e.style[i] = style[i];\n\n            if (clazz)\n                e.className = clazz;\n\n            atts = atts || {};\n            for (i in atts)\n                e.setAttribute(i, \"\" + atts[i]);\n\n            return e;\n        },\n\n        getAttribute: function (el, attName) {\n            return el.getAttribute != null ? el.getAttribute(attName) : null;\n        },\n\n        setAttribute: function (el, a, v) {\n            if (el.setAttribute != null) el.setAttribute(a, v);\n        },\n\n        setAttributes: function (el, atts) {\n            for (var i in atts)\n                if (atts.hasOwnProperty(i)) el.setAttribute(i, atts[i]);\n        },\n        appendToRoot: function (node) {\n            document.body.appendChild(node);\n        },\n        getRenderModes: function () {\n            return [ \"svg\"  ];\n        },\n        getClass:_getClassName,\n        addClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, clazz);\n            });\n        },\n        hasClass: function (el, clazz) {\n            el = jsPlumb.getElement(el);\n            if (el.classList) return el.classList.contains(clazz);\n            else {\n                return _getClassName(el).indexOf(clazz) != -1;\n            }\n        },\n        removeClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, null, clazz);\n            });\n        },\n        updateClasses: function (el, toAdd, toRemove) {\n            jsPlumb.each(el, function (e) {\n                _classManip(e, toAdd, toRemove);\n            });\n        },\n        setClass: function (el, clazz) {\n            jsPlumb.each(el, function (e) {\n                _setClassName(e, clazz);\n            });\n        },\n        setPosition: function (el, p) {\n            el.style.left = p.left + \"px\";\n            el.style.top = p.top + \"px\";\n        },\n        getPosition: function (el) {\n            var _one = function (prop) {\n                var v = el.style[prop];\n                return v ? v.substring(0, v.length - 2) : 0;\n            };\n            return {\n                left: _one(\"left\"),\n                top: _one(\"top\")\n            };\n        },\n        getStyle:function(el, prop) {\n            if (typeof window.getComputedStyle !== 'undefined') {\n                return getComputedStyle(el, null).getPropertyValue(prop);\n            } else {\n                return el.currentStyle[prop];\n            }\n        },\n        getSelector: function (ctx, spec) {\n            var sel = null;\n            if (arguments.length == 1) {\n                sel = ctx.nodeType != null ? ctx : document.querySelectorAll(ctx);\n            }\n            else\n                sel = ctx.querySelectorAll(spec);\n\n            return sel;\n        },\n        getOffset:function(el, relativeToRoot, container) {\n            el = jsPlumb.getElement(el);\n            container = container || this.getContainer();\n            var out = {\n                    left: el.offsetLeft,\n                    top: el.offsetTop\n                },\n                op = (relativeToRoot  || (container != null && (el != container && el.offsetParent != container))) ?  el.offsetParent : null,\n                _maybeAdjustScroll = function(offsetParent) {\n                    if (offsetParent != null && offsetParent !== document.body && (offsetParent.scrollTop > 0 || offsetParent.scrollLeft > 0)) {\n                        out.left -= offsetParent.scrollLeft;\n                        out.top -= offsetParent.scrollTop;\n                    }\n                }.bind(this);\n\n            while (op != null) {\n                out.left += op.offsetLeft;\n                out.top += op.offsetTop;\n                _maybeAdjustScroll(op);\n                op = relativeToRoot ? op.offsetParent :\n                        op.offsetParent == container ? null : op.offsetParent;\n            }\n\n            // if container is scrolled and the element (or its offset parent) is not absolute or fixed, adjust accordingly.\n            if (container != null && !relativeToRoot && (container.scrollTop > 0 || container.scrollLeft > 0)) {\n                var pp = el.offsetParent != null ? this.getStyle(el.offsetParent, \"position\") : \"static\",\n                    p = this.getStyle(el, \"position\");\n                if (p !== \"absolute\" && p !== \"fixed\" && pp !== \"absolute\" && pp != \"fixed\") {\n                    out.left -= container.scrollLeft;\n                    out.top -= container.scrollTop;\n                }\n            }\n            return out;\n        },\n        //\n        // return x+y proportion of the given element's size corresponding to the location of the given event.\n        //\n        getPositionOnElement: function (evt, el, zoom) {\n            var box = typeof el.getBoundingClientRect !== \"undefined\" ? el.getBoundingClientRect() : { left: 0, top: 0, width: 0, height: 0 },\n                body = document.body,\n                docElem = document.documentElement,\n                scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop,\n                scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n                clientTop = docElem.clientTop || body.clientTop || 0,\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\n                pst = 0,\n                psl = 0,\n                top = box.top + scrollTop - clientTop + (pst * zoom),\n                left = box.left + scrollLeft - clientLeft + (psl * zoom),\n                cl = jsPlumb.pageLocation(evt),\n                w = box.width || (el.offsetWidth * zoom),\n                h = box.height || (el.offsetHeight * zoom),\n                x = (cl[0] - left) / w,\n                y = (cl[1] - top) / h;\n\n            return [ x, y ];\n        },\n\n        /**\n         * Gets the absolute position of some element as read from the left/top properties in its style.\n         * @method getAbsolutePosition\n         * @param {Element} el The element to retrieve the absolute coordinates from. **Note** this is a DOM element, not a selector from the underlying library.\n         * @return {Number[]} [left, top] pixel values.\n         */\n        getAbsolutePosition: function (el) {\n            var _one = function (s) {\n                var ss = el.style[s];\n                if (ss) return parseFloat(ss.substring(0, ss.length - 2));\n            };\n            return [ _one(\"left\"), _one(\"top\") ];\n        },\n\n        /**\n         * Sets the absolute position of some element by setting the left/top properties in its style.\n         * @method setAbsolutePosition\n         * @param {Element} el The element to set the absolute coordinates on. **Note** this is a DOM element, not a selector from the underlying library.\n         * @param {Number[]} xy x and y coordinates\n         * @param {Number[]} [animateFrom] Optional previous xy to animate from.\n         * @param {Object} [animateOptions] Options for the animation.\n         */\n        setAbsolutePosition: function (el, xy, animateFrom, animateOptions) {\n            if (animateFrom) {\n                this.animate(el, {\n                    left: \"+=\" + (xy[0] - animateFrom[0]),\n                    top: \"+=\" + (xy[1] - animateFrom[1])\n                }, animateOptions);\n            }\n            else {\n                el.style.left = xy[0] + \"px\";\n                el.style.top = xy[1] + \"px\";\n            }\n        },\n        /**\n         * gets the size for the element, in an array : [ width, height ].\n         */\n        getSize: function (el) {\n            return [ el.offsetWidth, el.offsetHeight ];\n        },\n        getWidth: function (el) {\n            return el.offsetWidth;\n        },\n        getHeight: function (el) {\n            return el.offsetHeight;\n        }\n\n    });\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n *\n * Title:jsPlumb 2.1.1\n *\n * Provides a way to visually connect elements on an HTML page, using SVG.\n *\n * This file contains code for components that support overlays.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // ------------------------------ BEGIN OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n    var _internalLabelOverlayId = \"__label\",\n    // this is a shortcut helper method to let people add a label as\n    // overlay.\n        _makeLabelOverlay = function (component, params) {\n\n            var _params = {\n                    cssClass: params.cssClass,\n                    labelStyle: component.labelStyle,\n                    id: _internalLabelOverlayId,\n                    component: component,\n                    _jsPlumb: component._jsPlumb.instance  // TODO not necessary, since the instance can be accessed through the component.\n                },\n                mergedParams = _jp.extend(_params, params);\n\n            return new _jp.Overlays[component._jsPlumb.instance.getRenderMode()].Label(mergedParams);\n        },\n        _processOverlay = function (component, o) {\n            var _newOverlay = null;\n            if (_ju.isArray(o)) {    // this is for the shorthand [\"Arrow\", { width:50 }] syntax\n                // there's also a three arg version:\n                // [\"Arrow\", { width:50 }, {location:0.7}]\n                // which merges the 3rd arg into the 2nd.\n                var type = o[0],\n                // make a copy of the object so as not to mess up anyone else's reference...\n                    p = _jp.extend({component: component, _jsPlumb: component._jsPlumb.instance}, o[1]);\n                if (o.length == 3) _jp.extend(p, o[2]);\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][type](p);\n            } else if (o.constructor == String) {\n                _newOverlay = new _jp.Overlays[component._jsPlumb.instance.getRenderMode()][o]({component: component, _jsPlumb: component._jsPlumb.instance});\n            } else {\n                _newOverlay = o;\n            }\n\n            _newOverlay.id = _newOverlay.id || _ju.uuid();\n            component.cacheTypeItem(\"overlay\", _newOverlay, _newOverlay.id);\n            //component._jsPlumb.overlays.push(_newOverlay);\n            component._jsPlumb.overlays[_newOverlay.id] = _newOverlay;\n\n            return _newOverlay;\n        };\n\n    _jp.OverlayCapableJsPlumbUIComponent = function (params) {\n\n        root.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.overlays = {};\n        this._jsPlumb.overlayPositions = {};\n\n        if (params.label) {\n            this.getDefaultType().overlays[_internalLabelOverlayId] = [\"Label\", {\n                label: params.label,\n                location: params.labelLocation || this.defaultLabelLocation || 0.5,\n                labelStyle: params.labelStyle || this._jsPlumb.instance.Defaults.LabelStyle,\n                id:_internalLabelOverlayId\n            }];\n        }\n\n        this.setListenerComponent = function (c) {\n            if (this._jsPlumb) {\n                for (var i in this._jsPlumb.overlays)\n                    this._jsPlumb.overlays[i].setListenerComponent(c);\n            }\n        };\n    };\n\n    _jp.OverlayCapableJsPlumbUIComponent.applyType = function (component, t) {\n        if (t.overlays) {\n            // loop through the ones in the type. if already present on the component,\n            // dont remove or re-add.\n            var keep = {}, i;\n\n            for (i in t.overlays) {\n\n                var existing = component._jsPlumb.overlays[t.overlays[i][1].id];\n                if (existing) {\n                    // maybe update from data, if there were parameterised values for instance.\n                    existing.updateFrom(t.overlays[i][1]);\n                    keep[t.overlays[i][1].id] = true;\n                }\n                else {\n                    var c = component.getCachedTypeItem(\"overlay\", t.overlays[i][1].id);\n                    if (c != null) {\n                        c.reattach(component._jsPlumb.instance);\n                        c.setVisible(true);\n                        // maybe update from data, if there were parameterised values for instance.\n                        c.updateFrom(t.overlays[i][1]);\n                        component._jsPlumb.overlays[c.id] = c;\n                    }\n                    else {\n                        c = component.addOverlay(t.overlays[i], true);\n                    }\n                    keep[c.id] = true;\n                }\n            }\n\n            // now loop through the full overlays and remove those that we dont want to keep\n            for (i in component._jsPlumb.overlays) {\n                if (keep[component._jsPlumb.overlays[i].id] == null)\n                    component.removeOverlay(component._jsPlumb.overlays[i].id, true); // remove overlay but dont clean it up.\n                    // that would remove event listeners etc; overlays are never discarded by the types stuff, they are\n                    // just detached/reattached.\n            }\n        }\n    };\n\n    _ju.extend(_jp.OverlayCapableJsPlumbUIComponent, root.jsPlumbUIComponent, {\n\n        setHover: function (hover, ignoreAttachedElements) {\n            if (this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][hover ? \"addClass\" : \"removeClass\"](this._jsPlumb.instance.hoverClass);\n                }\n            }\n        },\n        addOverlay: function (overlay, doNotRepaint) {\n            var o = _processOverlay(this, overlay);\n            if (!doNotRepaint) this.repaint();\n            return o;\n        },\n        getOverlay: function (id) {\n            return this._jsPlumb.overlays[id];\n        },\n        getOverlays: function () {\n            return this._jsPlumb.overlays;\n        },\n        hideOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) o.hide();\n        },\n        hideOverlays: function () {\n            for (var i in this._jsPlumb.overlays)\n                this._jsPlumb.overlays[i].hide();\n        },\n        showOverlay: function (id) {\n            var o = this.getOverlay(id);\n            if (o) o.show();\n        },\n        showOverlays: function () {\n            for (var i in this._jsPlumb.overlays)\n                this._jsPlumb.overlays[i].show();\n        },\n        removeAllOverlays: function (doNotRepaint) {\n            for (var i in this._jsPlumb.overlays) {\n                if (this._jsPlumb.overlays[i].cleanup) this._jsPlumb.overlays[i].cleanup();\n            }\n\n            this._jsPlumb.overlays = {};\n            this._jsPlumb.overlayPositions = null;\n            if (!doNotRepaint)\n                this.repaint();\n        },\n        removeOverlay: function (overlayId, dontCleanup) {\n            var o = this._jsPlumb.overlays[overlayId];\n            if (o) {\n                o.setVisible(false);\n                if (!dontCleanup && o.cleanup) o.cleanup();\n                delete this._jsPlumb.overlays[overlayId];\n                if (this._jsPlumb.overlayPositions)\n                    delete this._jsPlumb.overlayPositions[overlayId];\n            }\n        },\n        removeOverlays: function () {\n            for (var i = 0, j = arguments.length; i < j; i++)\n                this.removeOverlay(arguments[i]);\n        },\n        moveParent: function (newParent) {\n            if (this.bgCanvas) {\n                this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n                newParent.appendChild(this.bgCanvas);\n            }\n\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n                newParent.appendChild(this.canvas);\n\n                for (var i in this._jsPlumb.overlays) {\n                    if (this._jsPlumb.overlays[i].isAppendedAtTopLevel) {\n                        var el = this._jsPlumb.overlays[i].getElement();\n                        el.parentNode.removeChild(el);\n                        newParent.appendChild(el);\n                    }\n                }\n            }\n        },\n        getLabel: function () {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            return lo != null ? lo.getLabel() : null;\n        },\n        getLabelOverlay: function () {\n            return this.getOverlay(_internalLabelOverlayId);\n        },\n        setLabel: function (l) {\n            var lo = this.getOverlay(_internalLabelOverlayId);\n            if (!lo) {\n                var params = l.constructor == String || l.constructor == Function ? { label: l } : l;\n                lo = _makeLabelOverlay(this, params);\n                this._jsPlumb.overlays[_internalLabelOverlayId] = lo;\n            }\n            else {\n                if (l.constructor == String || l.constructor == Function) lo.setLabel(l);\n                else {\n                    if (l.label) lo.setLabel(l.label);\n                    if (l.location) lo.setLocation(l.location);\n                }\n            }\n\n            if (!this._jsPlumb.instance.isSuspendDrawing())\n                this.repaint();\n        },\n        cleanup: function (force) {\n            for (var i in this._jsPlumb.overlays) {\n                this._jsPlumb.overlays[i].cleanup(force);\n                this._jsPlumb.overlays[i].destroy(force);\n            }\n            if (force) {\n                this._jsPlumb.overlays = {};\n                this._jsPlumb.overlayPositions = null;\n            }\n        },\n        setVisible: function (v) {\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n        },\n        setAbsoluteOverlayPosition: function (overlay, xy) {\n            this._jsPlumb.overlayPositions[overlay.id] = xy;\n        },\n        getAbsoluteOverlayPosition: function (overlay) {\n            return this._jsPlumb.overlayPositions ? this._jsPlumb.overlayPositions[overlay.id] : null;\n        },\n        _clazzManip:function(action, clazz, dontUpdateOverlays) {\n            if (!dontUpdateOverlays) {\n                for (var i in this._jsPlumb.overlays) {\n                    this._jsPlumb.overlays[i][action + \"Class\"](clazz);\n                }\n            }\n        },\n        addClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"add\", clazz, dontUpdateOverlays)\n        },\n        removeClass:function(clazz, dontUpdateOverlays) {\n            this._clazzManip(\"remove\", clazz, dontUpdateOverlays)\n        }\n    });\n\n// ------------------------------ END OverlayCapablejsPlumbUIComponent --------------------------------------------\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the code for Endpoints.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    // create the drag handler for a connection\n    var _makeConnectionDragHandler = function (endpoint, placeholder, _jsPlumb) {\n        var stopped = false;\n        return {\n            drag: function () {\n                if (stopped) {\n                    stopped = false;\n                    return true;\n                }\n\n                if (placeholder.element) {\n                    var _ui = _jsPlumb.getUIPosition(arguments, _jsPlumb.getZoom());\n                    if (_ui != null) jsPlumb.setPosition(placeholder.element, _ui);\n                    _jsPlumb.repaint(placeholder.element, _ui);\n                    // always repaint the source endpoint, because only continuous/dynamic anchors cause the endpoint\n                    // to be repainted, so static anchors need to be told (or the endpoint gets dragged around)\n                    endpoint.paint({anchorPoint:endpoint.anchor.getCurrentLocation({element:endpoint.element})});\n                }\n            },\n            stopDrag: function () {\n                stopped = true;\n            }\n        };\n    };\n\n    // creates a placeholder div for dragging purposes, adds it, and pre-computes its offset.\n    var _makeDraggablePlaceholder = function (placeholder, _jsPlumb, ipco, ips) {\n        var n = jsPlumb.createElement(\"div\", { position : \"absolute\" });\n        _jsPlumb.appendElement(n);\n        var id = _jsPlumb.getId(n);\n        jsPlumb.setPosition(n, ipco);\n        n.style.width = ips[0] + \"px\";\n        n.style.height = ips[1] + \"px\";\n        _jsPlumb.manage(id, n, true); // TRANSIENT MANAGE\n        // create and assign an id, and initialize the offset.\n        placeholder.id = id;\n        placeholder.element = n;\n    };\n\n    // create a floating endpoint (for drag connections)\n    var _makeFloatingEndpoint = function (paintStyle, referenceAnchor, endpoint, referenceCanvas, sourceElement, _jsPlumb, _newEndpoint, scope) {\n        var floatingAnchor = new _jp.FloatingAnchor({ reference: referenceAnchor, referenceCanvas: referenceCanvas, jsPlumbInstance: _jsPlumb });\n        //setting the scope here should not be the way to fix that mootools issue.  it should be fixed by not\n        // adding the floating endpoint as a droppable.  that makes more sense anyway!\n        // TRANSIENT MANAGE\n        return _newEndpoint({\n            paintStyle: paintStyle,\n            endpoint: endpoint,\n            anchor: floatingAnchor,\n            source: sourceElement,\n            scope: scope\n        });\n    };\n\n    var typeParameters = [ \"connectorStyle\", \"connectorHoverStyle\", \"connectorOverlays\",\n        \"connector\", \"connectionType\", \"connectorClass\", \"connectorHoverClass\" ];\n\n    // a helper function that tries to find a connection to the given element, and returns it if so. if elementWithPrecedence is null,\n    // or no connection to it is found, we return the first connection in our list.\n    var findConnectionToUseForDynamicAnchor = function (ep, elementWithPrecedence) {\n        var idx = 0;\n        if (elementWithPrecedence != null) {\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId == elementWithPrecedence || ep.connections[i].targetId == elementWithPrecedence) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n\n        return ep.connections[idx];\n    };\n\n    _jp.Endpoint = function (params) {\n        var _jsPlumb = params._jsPlumb,\n            _newConnection = params.newConnection,\n            _newEndpoint = params.newEndpoint;\n\n        this.idPrefix = \"_jsplumb_e_\";\n        this.defaultLabelLocation = [ 0.5, 0.5 ];\n        this.defaultOverlayKeys = [\"Overlays\", \"EndpointOverlays\"];\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n// TYPE\n\n        this.appendToDefaultType({\n            connectionType:params.connectionType,\n            maxConnections: params.maxConnections == null ? this._jsPlumb.instance.Defaults.MaxConnections : params.maxConnections, // maximum number of connections this endpoint can be the source of.,\n            paintStyle: params.endpointStyle || params.paintStyle || params.style || this._jsPlumb.instance.Defaults.EndpointStyle || _jp.Defaults.EndpointStyle,\n            hoverPaintStyle: params.endpointHoverStyle || params.hoverPaintStyle || this._jsPlumb.instance.Defaults.EndpointHoverStyle || _jp.Defaults.EndpointHoverStyle,\n            connectorStyle: params.connectorStyle,\n            connectorHoverStyle: params.connectorHoverStyle,\n            connectorClass: params.connectorClass,\n            connectorHoverClass: params.connectorHoverClass,\n            connectorOverlays: params.connectorOverlays,\n            connector: params.connector,\n            connectorTooltip: params.connectorTooltip\n        });\n\n// END TYPE\n\n        this._jsPlumb.enabled = !(params.enabled === false);\n        this._jsPlumb.visible = true;\n        this.element = _jp.getElement(params.source);\n        this._jsPlumb.uuid = params.uuid;\n        this._jsPlumb.floatingEndpoint = null;\n        var inPlaceCopy = null;\n        if (this._jsPlumb.uuid) params.endpointsByUUID[this._jsPlumb.uuid] = this;\n        this.elementId = params.elementId;\n        this.dragProxy = params.dragProxy;\n\n        this._jsPlumb.connectionCost = params.connectionCost;\n        this._jsPlumb.connectionsDirected = params.connectionsDirected;\n        this._jsPlumb.currentAnchorClass = \"\";\n        this._jsPlumb.events = {};\n\n        var _updateAnchorClass = function () {\n            // stash old, get new\n            var oldAnchorClass = _jsPlumb.endpointAnchorClassPrefix + \"-\" + this._jsPlumb.currentAnchorClass;\n            this._jsPlumb.currentAnchorClass = this.anchor.getCssClass();\n            var anchorClass = _jsPlumb.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n\n            this.removeClass(oldAnchorClass);\n            this.addClass(anchorClass);\n            // add and remove at the same time to reduce the number of reflows.\n            jsPlumb.updateClasses(this.element, anchorClass, oldAnchorClass);\n        }.bind(this);\n\n        this.prepareAnchor = function(anchorParams) {\n            var a = this._jsPlumb.instance.makeAnchor(anchorParams, this.elementId, _jsPlumb);\n            a.bind(\"anchorChanged\", function (currentAnchor) {\n                this.fire(\"anchorChanged\", {endpoint: this, anchor: currentAnchor});\n                _updateAnchorClass();\n            }.bind(this));\n            return a;\n        };\n\n        this.setPreparedAnchor = function(anchor, doNotRepaint) {\n            this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);\n            this.anchor = anchor;\n            _updateAnchorClass();\n\n            if (!doNotRepaint)\n                this._jsPlumb.instance.repaint(this.elementId);\n\n            return this;\n        };\n\n        this.setAnchor = function (anchorParams, doNotRepaint) {\n            var a = this.prepareAnchor(anchorParams);\n            this.setPreparedAnchor(a, doNotRepaint);\n            return this;\n        };\n\n        var internalHover = function (state) {\n            if (this.connections.length > 0) {\n                for (var i = 0; i < this.connections.length; i++)\n                    this.connections[i].setHover(state, false);\n            }\n            else\n                this.setHover(state);\n        }.bind(this);\n\n        this.bind(\"mouseover\", function () {\n            internalHover(true);\n        });\n        this.bind(\"mouseout\", function () {\n            internalHover(false);\n        });\n\n        // ANCHOR MANAGER\n        if (!params._transient) // in place copies, for example, are transient.  they will never need to be retrieved during a paint cycle, because they dont move, and then they are deleted.\n            this._jsPlumb.instance.anchorManager.add(this, this.elementId);\n\n        this.prepareEndpoint = function(ep, typeId) {\n            var _e = function (t, p) {\n                var rm = _jsPlumb.getRenderMode();\n                if (_jp.Endpoints[rm][t]) return new _jp.Endpoints[rm][t](p);\n                if (!_jsPlumb.Defaults.DoNotThrowErrors)\n                    throw { msg: \"jsPlumb: unknown endpoint type '\" + t + \"'\" };\n            };\n\n            var endpointArgs = {\n                _jsPlumb: this._jsPlumb.instance,\n                cssClass: params.cssClass,\n                container: params.container,\n                tooltip: params.tooltip,\n                connectorTooltip: params.connectorTooltip,\n                endpoint: this\n            };\n\n            var endpoint;\n\n            if (_ju.isString(ep))\n                endpoint = _e(ep, endpointArgs);\n            else if (_ju.isArray(ep)) {\n                endpointArgs = _ju.merge(ep[1], endpointArgs);\n                endpoint = _e(ep[0], endpointArgs);\n            }\n            else {\n                endpoint = ep.clone();\n            }\n\n            // assign a clone function using a copy of endpointArgs. this is used when a drag starts: the endpoint that was dragged is cloned,\n            // and the clone is left in its place while the original one goes off on a magical journey.\n            // the copy is to get around a closure problem, in which endpointArgs ends up getting shared by\n            // the whole world.\n            //var argsForClone = jsPlumb.extend({}, endpointArgs);\n            endpoint.clone = function () {\n                // TODO this, and the code above, can be refactored to be more dry.\n                if (_ju.isString(ep))\n                    return _e(ep, endpointArgs);\n                else if (_ju.isArray(ep)) {\n                    endpointArgs = _ju.merge(ep[1], endpointArgs);\n                    return _e(ep[0], endpointArgs);\n                }\n            }.bind(this);\n\n            endpoint.typeId = typeId;\n            return endpoint;\n        };\n\n        this.setEndpoint = function(ep, doNotRepaint) {\n            var _ep = this.prepareEndpoint(ep);\n            this.setPreparedEndpoint(_ep, true);\n        };\n\n        this.setPreparedEndpoint = function (ep, doNotRepaint) {\n            if (this.endpoint != null) {\n                this.endpoint.cleanup();\n                this.endpoint.destroy();\n            }\n            this.endpoint = ep;\n            this.type = this.endpoint.type;\n            this.canvas = this.endpoint.canvas;\n        };\n\n        _jp.extend(this, params, typeParameters);\n\n        this.isSource = params.isSource || false;\n        this.isTemporarySource = params.isTemporarySource || false;\n        this.isTarget = params.isTarget || false;\n\n        this.connections = params.connections || [];\n        this.connectorPointerEvents = params[\"connector-pointer-events\"];\n\n        this.scope = params.scope || _jsPlumb.getDefaultScope();\n        this.timestamp = null;\n        this.reattachConnections = params.reattach || _jsPlumb.Defaults.ReattachConnections;\n        this.connectionsDetachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.connectionsDetachable === false || params.detachable === false)\n            this.connectionsDetachable = false;\n        this.dragAllowedWhenFull = params.dragAllowedWhenFull !== false;\n\n        if (params.onMaxConnections)\n            this.bind(\"maxConnections\", params.onMaxConnections);\n\n        //\n        // add a connection. not part of public API.\n        //\n        this.addConnection = function (connection) {\n            this.connections.push(connection);\n            this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n            this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n        };\n\n        this.detachFromConnection = function (connection, idx, doNotCleanup) {\n            idx = idx == null ? this.connections.indexOf(connection) : idx;\n            if (idx >= 0) {\n                this.connections.splice(idx, 1);\n                this[(this.connections.length > 0 ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointConnectedClass);\n                this[(this.isFull() ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointFullClass);\n            }\n\n            if ((this._forceDeleteOnDetach || (!doNotCleanup && this._deleteOnDetach)) && this.connections.length === 0) {\n                _jsPlumb.deleteObject({\n                    endpoint: this,\n                    fireEvent: false,\n                    //deleteAttachedObjects: false\n                    deleteAttachedObjects: doNotCleanup !== true\n                });\n            }\n        };\n\n        //this.detach = function (connection, ignoreTarget, forceDetach, fireEvent, originalEvent, endpointBeingDeleted, connectionIndex) {\n\n        this.detach = function (params) {\n            var connectionIndex = params.connectionIndex,\n                connection = params.connection,\n                ignoreTarget = params.ignoreTarget,\n                fireEvent = params.fireEvent,\n                originalEvent = params.originalEvent,\n                endpointBeingDeleted = params.endpointBeingDeleted,\n                forceDetach = params.forceDetach;\n\n            var idx = connectionIndex == null ? this.connections.indexOf(connection) : connectionIndex,\n                actuallyDetached = false;\n            fireEvent = (fireEvent !== false);\n\n            if (idx >= 0) {\n\n                if (forceDetach || connection._forceDetach || (connection.isDetachable() && connection.isDetachAllowed(connection) && this.isDetachAllowed(connection) && _jsPlumb.checkCondition(\"beforeDetach\", connection, endpointBeingDeleted) )) {\n\n                    _jsPlumb.deleteObject({\n                        connection: connection,\n                        fireEvent: (!ignoreTarget && fireEvent),\n                        originalEvent: originalEvent,\n                        deleteAttachedObjects:params.deleteAttachedObjects\n                        //deleteAttachedObjects:null\n                    });\n                    actuallyDetached = true;\n                }\n            }\n            return actuallyDetached;\n        };\n\n        this.detachAll = function (fireEvent, forceDetach) {\n            var unaffectedConns = [];\n            while (this.connections.length > 0) {\n                // TODO this could pass the index in to the detach method to save some time (index will always be zero in this while loop)\n                var actuallyDetached = this.detach({\n                    connection:this.connections[0],\n                    ignoreTarget:false,\n                    forceDetach:forceDetach === true,\n                    fireEvent:fireEvent !== false,\n                    originalEvent:null,\n                    endpointBeingDeleted:this,\n                    connectionIndex:0\n                });\n                if (!actuallyDetached) {\n                    unaffectedConns.push(this.connections[0]);\n                    this.connections.splice(0, 1);\n                }\n            }\n            this.connections = unaffectedConns;\n            return this;\n        };\n        this.detachFrom = function (targetEndpoint, fireEvent, originalEvent) {\n            var c = [];\n            for (var i = 0; i < this.connections.length; i++) {\n                if (this.connections[i].endpoints[1] == targetEndpoint || this.connections[i].endpoints[0] == targetEndpoint) {\n                    c.push(this.connections[i]);\n                }\n            }\n            for (var j = 0; j < c.length; j++) {\n                this.detach({\n                    connection:c[j],\n                    ignoreTarget:false,\n                    forceDetach:true,\n                    fireEvent:fireEvent,\n                    originalEvent:originalEvent\n                });\n            }\n            return this;\n        };\n\n        this.getElement = function () {\n            return this.element;\n        };\n\n        this.setElement = function (el) {\n            var parentId = this._jsPlumb.instance.getId(el),\n                curId = this.elementId;\n            // remove the endpoint from the list for the current endpoint's element\n            _ju.removeWithFunction(params.endpointsByElement[this.elementId], function (e) {\n                return e.id == this.id;\n            }.bind(this));\n            this.element = jsPlumb.getElement(el);\n            this.elementId = _jsPlumb.getId(this.element);\n            _jsPlumb.anchorManager.rehomeEndpoint(this, curId, this.element);\n            _jsPlumb.dragManager.endpointAdded(this.element);\n            _ju.addToList(params.endpointsByElement, parentId, this);\n            return this;\n        };\n\n        /**\n         * private but must be exposed.\n         */\n        this.makeInPlaceCopy = function () {\n            var loc = this.anchor.getCurrentLocation({element: this}),\n                o = this.anchor.getOrientation(this),\n                acc = this.anchor.getCssClass(),\n                inPlaceAnchor = {\n                    bind: function () {\n                    },\n                    compute: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getCurrentLocation: function () {\n                        return [ loc[0], loc[1] ];\n                    },\n                    getOrientation: function () {\n                        return o;\n                    },\n                    getCssClass: function () {\n                        return acc;\n                    }\n                };\n\n            return _newEndpoint({\n                dropOptions: params.dropOptions,\n                anchor: inPlaceAnchor,\n                source: this.element,\n                paintStyle: this.getPaintStyle(),\n                endpoint: params.hideOnDrag ? \"Blank\" : this.endpoint,\n                _transient: true,\n                scope: this.scope,\n                reference:this\n            });\n        };\n\n        /**\n         * returns a connection from the pool; used when dragging starts.  just gets the head of the array if it can.\n         */\n        this.connectorSelector = function () {\n            var candidate = this.connections[0];\n            // SP target source refactor\n            if (/*this.isTarget && */candidate) return candidate;\n            else {\n                return (this.connections.length < this._jsPlumb.maxConnections) || this._jsPlumb.maxConnections == -1 ? null : candidate;\n            }\n        };\n\n        this.setStyle = this.setPaintStyle;\n\n        this.paint = function (params) {\n            params = params || {};\n            var timestamp = params.timestamp, recalc = !(params.recalc === false);\n            if (!timestamp || this.timestamp !== timestamp) {\n\n                var info = _jsPlumb.updateOffset({ elId: this.elementId, timestamp: timestamp });\n\n                var xy = params.offset ? params.offset.o : info.o;\n                if (xy != null) {\n                    var ap = params.anchorPoint, connectorPaintStyle = params.connectorPaintStyle;\n                    if (ap == null) {\n                        var wh = params.dimensions || info.s,\n                            anchorParams = { xy: [ xy.left, xy.top ], wh: wh, element: this, timestamp: timestamp };\n                        if (recalc && this.anchor.isDynamic && this.connections.length > 0) {\n                            var c = findConnectionToUseForDynamicAnchor(this, params.elementWithPrecedence),\n                                oIdx = c.endpoints[0] == this ? 1 : 0,\n                                oId = oIdx === 0 ? c.sourceId : c.targetId,\n                                oInfo = _jsPlumb.getCachedData(oId),\n                                oOffset = oInfo.o, oWH = oInfo.s;\n                            anchorParams.txy = [ oOffset.left, oOffset.top ];\n                            anchorParams.twh = oWH;\n                            anchorParams.tElement = c.endpoints[oIdx];\n                        }\n                        ap = this.anchor.compute(anchorParams);\n                    }\n\n                    this.endpoint.compute(ap, this.anchor.getOrientation(this), this._jsPlumb.paintStyleInUse, connectorPaintStyle || this.paintStyleInUse);\n                    this.endpoint.paint(this._jsPlumb.paintStyleInUse, this.anchor);\n                    this.timestamp = timestamp;\n\n                    // paint overlays\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.endpoint, this._jsPlumb.paintStyleInUse);\n                                o.paint(this._jsPlumb.overlayPlacements[i]);\n                            }\n                        }\n                    }\n                }\n            }\n        };\n\n        this.getTypeDescriptor = function () {\n            return \"endpoint\";\n        };\n        this.isVisible = function () {\n            return this._jsPlumb.visible;\n        };\n\n        this.repaint = this.paint;\n\n        var draggingInitialised = false;\n        this.initDraggable = function () {\n\n            // is this a connection source? we make it draggable and have the\n            // drag listener maintain a connection with a floating endpoint.\n            if (!draggingInitialised && _jp.isDragSupported(this.element)) {\n                var placeholderInfo = { id: null, element: null },\n                    jpc = null,\n                    existingJpc = false,\n                    existingJpcParams = null,\n                    _dragHandler = _makeConnectionDragHandler(this, placeholderInfo, _jsPlumb),\n                    dragOptions = params.dragOptions || {},\n                    defaultOpts = {},\n                    startEvent = _jp.dragEvents.start,\n                    stopEvent = _jp.dragEvents.stop,\n                    dragEvent = _jp.dragEvents.drag,\n                    beforeStartEvent = _jp.dragEvents.beforeStart,\n                    payload;\n\n                // respond to beforeStart from katavorio; this will have, optionally, a payload of attribute values\n                // that were placed there by the makeSource mousedown listener.\n                var beforeStart = function(beforeStartParams) {\n                    payload = beforeStartParams.e.payload || {};\n                };\n\n                var start = function (startParams) {\n\n// -------------   first, get a connection to drag. this may be null, in which case we are dragging a new one.\n\n                    jpc = this.connectorSelector();\n\n// -------------------------------- now a bunch of tests about whether or not to proceed -------------------------\n\n                    var _continue = true;\n                    // if not enabled, return\n                    if (!this.isEnabled()) _continue = false;\n                    // if no connection and we're not a source - or temporarily a source, as is the case with makeSource - return.\n                    if (jpc == null && !this.isSource && !this.isTemporarySource) _continue = false;\n                    // otherwise if we're full and not allowed to drag, also return false.\n                    if (this.isSource && this.isFull() && !(jpc != null && this.dragAllowedWhenFull)) _continue = false;\n                    // if the connection was setup as not detachable or one of its endpoints\n                    // was setup as connectionsDetachable = false, or Defaults.ConnectionsDetachable\n                    // is set to false...\n                    if (jpc != null && !jpc.isDetachable(this)) _continue = false;\n\n                    var beforeDrag = _jsPlumb.checkCondition(jpc == null ? \"beforeDrag\" : \"beforeStartDetach\", {\n                        endpoint:this,\n                        source:this.element,\n                        sourceId:this.elementId,\n                        connection:jpc\n                    });\n                    if (beforeDrag === false) _continue = false;\n                    // else we might have been given some data. we'll pass it in to a new connection as 'data'.\n                    // here we also merge in the optional payload we were given on mousedown.\n                    else if (typeof beforeDrag === \"object\") {\n                        jsPlumb.extend(beforeDrag, payload || {});\n                    }\n                    else\n                        // or if no beforeDrag data, maybe use the payload on its own.\n                        beforeDrag = payload || {};\n\n                    if (_continue === false) {\n                        // this is for mootools and yui. returning false from this causes jquery to stop drag.\n                        // the events are wrapped in both mootools and yui anyway, but i don't think returning\n                        // false from the start callback would stop a drag.\n                        if (_jsPlumb.stopDrag) _jsPlumb.stopDrag(this.canvas);\n                        _dragHandler.stopDrag();\n                        return false;\n                    }\n\n// ---------------------------------------------------------------------------------------------------------------------\n\n                    // ok to proceed.\n\n                    // clear hover for all connections for this endpoint before continuing.\n                    for (var i = 0; i < this.connections.length; i++)\n                        this.connections[i].setHover(false);\n\n                    this.addClass(\"endpointDrag\");\n                    _jsPlumb.setConnectionBeingDragged(true);\n\n                    // if we're not full but there was a connection, make it null. we'll create a new one.\n                    if (jpc && !this.isFull() && this.isSource) jpc = null;\n\n                    _jsPlumb.updateOffset({ elId: this.elementId });\n\n// ----------------    make the element we will drag around, and position it -----------------------------\n\n                    var ipco = this._jsPlumb.instance.getOffset(this.canvas),\n                        canvasElement = this.canvas,\n                        ips = this._jsPlumb.instance.getSize(this.canvas);\n\n                    _makeDraggablePlaceholder(placeholderInfo, _jsPlumb, ipco, ips);\n\n                    // store the id of the dragging div and the source element. the drop function will pick these up.                   \n                    _jsPlumb.setAttributes(this.canvas, {\n                        \"dragId\": placeholderInfo.id,\n                        \"elId\": this.elementId\n                    });\n\n// ------------------- create an endpoint that will be our floating endpoint ------------------------------------\n\n                    var endpointToFloat = this.dragProxy || this.endpoint;\n                    if (this.dragProxy == null && this.connectionType != null) {\n                        var aae = this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);\n                        if (aae.endpoints[1]) endpointToFloat = aae.endpoints[1];\n                    }\n                    var centerAnchor = this._jsPlumb.instance.makeAnchor(\"Center\");\n                    centerAnchor.isFloating = true;\n                    this._jsPlumb.floatingEndpoint = _makeFloatingEndpoint(this.getPaintStyle(), centerAnchor, endpointToFloat, this.canvas, placeholderInfo.element, _jsPlumb, _newEndpoint, this.scope);\n                    var _savedAnchor = this._jsPlumb.floatingEndpoint.anchor;\n\n\n                    if (jpc == null) {\n\n                        this.setHover(false, false);\n                        // create a connection. one end is this endpoint, the other is a floating endpoint.                    \n                        jpc = _newConnection({\n                            sourceEndpoint: this,\n                            targetEndpoint: this._jsPlumb.floatingEndpoint,\n                            source: this.element,  // for makeSource with parent option.  ensure source element is represented correctly.\n                            target: placeholderInfo.element,\n                            anchors: [ this.anchor, this._jsPlumb.floatingEndpoint.anchor ],\n                            paintStyle: params.connectorStyle, // this can be null. Connection will use the default.\n                            hoverPaintStyle: params.connectorHoverStyle,\n                            connector: params.connector, // this can also be null. Connection will use the default.\n                            overlays: params.connectorOverlays,\n                            type: this.connectionType,\n                            cssClass: this.connectorClass,\n                            hoverClass: this.connectorHoverClass,\n                            scope:params.scope,\n                            data:beforeDrag\n                        });\n                        jpc.pending = true;\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.anchor = _savedAnchor;\n                        // fire an event that informs that a connection is being dragged\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // register the new connection on the drag manager. This connection, at this point, is 'pending',\n                        // and has as its target a temporary element (the 'placeholder'). If the connection subsequently\n                        // becomes established, the anchor manager is informed that the target of the connection has\n                        // changed.\n\n                        _jsPlumb.anchorManager.newConnection(jpc);\n\n                    } else {\n                        existingJpc = true;\n                        jpc.setHover(false);\n                        // new anchor idx\n                        var anchorIdx = jpc.endpoints[0].id == this.id ? 0 : 1;\n                        this.detachFromConnection(jpc, null, true);                         // detach from the connection while dragging is occurring. but dont cleanup automatically.\n\n                        // store the original scope (issue 57)\n                        var dragScope = _jsPlumb.getDragScope(canvasElement);\n                        _jsPlumb.setAttribute(this.canvas, \"originalScope\", dragScope);\n\n                        // fire an event that informs that a connection is being dragged. we do this before\n                        // replacing the original target with the floating element info.\n                        _jsPlumb.fire(\"connectionDrag\", jpc);\n\n                        // now we replace ourselves with the temporary div we created above:\n                        if (anchorIdx === 0) {\n                            existingJpcParams = [ jpc.source, jpc.sourceId, canvasElement, dragScope ];\n                            _jsPlumb.anchorManager.sourceChanged(jpc.endpoints[anchorIdx].elementId, placeholderInfo.id, jpc, placeholderInfo.element);\n\n                        } else {\n                            existingJpcParams = [ jpc.target, jpc.targetId, canvasElement, dragScope ];\n                            jpc.target = placeholderInfo.element;\n                            jpc.targetId = placeholderInfo.id;\n\n                            _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.endpoints[anchorIdx].elementId, jpc.targetId, jpc);\n                        }\n\n                        // store the original endpoint and assign the new floating endpoint for the drag.\n                        jpc.suspendedEndpoint = jpc.endpoints[anchorIdx];\n\n                        // PROVIDE THE SUSPENDED ELEMENT, BE IT A SOURCE OR TARGET (ISSUE 39)\n                        jpc.suspendedElement = jpc.endpoints[anchorIdx].getElement();\n                        jpc.suspendedElementId = jpc.endpoints[anchorIdx].elementId;\n                        jpc.suspendedElementType = anchorIdx === 0 ? \"source\" : \"target\";\n\n                        jpc.suspendedEndpoint.setHover(false);\n                        this._jsPlumb.floatingEndpoint.referenceEndpoint = jpc.suspendedEndpoint;\n                        jpc.endpoints[anchorIdx] = this._jsPlumb.floatingEndpoint;\n\n                        jpc.addClass(_jsPlumb.draggingClass);\n                        this._jsPlumb.floatingEndpoint.addClass(_jsPlumb.draggingClass);\n                    }\n\n                    // register it and register connection on it.\n                    _jsPlumb.floatingConnections[placeholderInfo.id] = jpc;\n                    // only register for the target endpoint; we will not be dragging the source at any time\n                    // before this connection is either discarded or made into a permanent connection.\n                    _ju.addToList(params.endpointsByElement, placeholderInfo.id, this._jsPlumb.floatingEndpoint);\n                    // tell jsplumb about it\n                    _jsPlumb.currentlyDragging = true;\n                }.bind(this);\n\n                var stop = function () {\n                    _jsPlumb.setConnectionBeingDragged(false);\n\n                    if (jpc && jpc.endpoints != null) {\n                        // get the actual drop event (decode from library args to stop function)\n                        var originalEvent = _jsPlumb.getDropEvent(arguments);\n                        // unlock the other endpoint (if it is dynamic, it would have been locked at drag start)\n                        var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n                        jpc.endpoints[idx === 0 ? 1 : 0].anchor.locked = false;\n                        // TODO: Dont want to know about css classes inside jsplumb, ideally.\n                        jpc.removeClass(_jsPlumb.draggingClass);\n\n                        // if we have the floating endpoint then the connection has not been dropped\n                        // on another endpoint.  If it is a new connection we throw it away. If it is an\n                        // existing connection we check to see if we should reattach it, throwing it away\n                        // if not.\n                        if (this._jsPlumb && (jpc.deleteConnectionNow || jpc.endpoints[idx] == this._jsPlumb.floatingEndpoint)) {\n                            // 6a. if the connection was an existing one...\n                            if (existingJpc && jpc.suspendedEndpoint) {\n                                // fix for issue35, thanks Sylvain Gizard: when firing the detach event make sure the\n                                // floating endpoint has been replaced.\n                                if (idx === 0) {\n                                    jpc.floatingElement = jpc.source;\n                                    jpc.floatingId = jpc.sourceId;\n                                    jpc.floatingEndpoint = jpc.endpoints[0];\n                                    jpc.floatingIndex = 0;\n                                    jpc.source = existingJpcParams[0];\n                                    jpc.sourceId = existingJpcParams[1];\n                                } else {\n                                    // keep a copy of the floating element; the anchor manager will want to clean up.\n                                    jpc.floatingElement = jpc.target;\n                                    jpc.floatingId = jpc.targetId;\n                                    jpc.floatingEndpoint = jpc.endpoints[1];\n                                    jpc.floatingIndex = 1;\n                                    jpc.target = existingJpcParams[0];\n                                    jpc.targetId = existingJpcParams[1];\n                                }\n\n                                var fe = this._jsPlumb.floatingEndpoint; // store for later removal.\n                                // restore the original scope (issue 57)\n                                _jsPlumb.setDragScope(existingJpcParams[2], existingJpcParams[3]);\n                                jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                                // IF the connection should be reattached, or the other endpoint refuses detach, then\n                                // reset the connection to its original state\n                                if (jpc.isReattach() || jpc._forceReattach || jpc._forceDetach || !jpc.endpoints[idx === 0 ? 1 : 0].detach({connection:jpc, ignoreTarget:false, forceDetach:false, fireEvent:true, originalEvent:originalEvent, endpointBeingDeleted:true})) {\n\n                                    jpc.setHover(false);\n                                    jpc._forceDetach = null;\n                                    jpc._forceReattach = null;\n                                    this._jsPlumb.floatingEndpoint.detachFromConnection(jpc);\n                                    jpc.suspendedEndpoint.addConnection(jpc);\n\n                                    // TODO this code is duplicated in lots of places...and there is nothing external\n                                    // in the code; it all refers to the connection itself. we could add a\n                                    // `checkSanity(connection)` method to anchorManager that did this.\n                                    if (idx == 1) {\n                                        _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\n                                    }\n                                    else {\n                                        _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\n                                    }\n\n                                    _jsPlumb.repaint(existingJpcParams[1]);\n                                }\n                                else {\n                                    _jsPlumb.deleteObject({endpoint: fe});\n                                }\n                            }\n                        }\n\n                        // makeTargets sets this flag, to tell us we have been replaced and should delete this object.\n                        if (this.deleteAfterDragStop) {\n                            _jsPlumb.deleteObject({endpoint: this});\n                        }\n                        else {\n                            if (this._jsPlumb) {\n                                 this.paint({recalc: false});\n                            }\n                        }\n\n                        // although the connection is no longer valid, there are use cases where this is useful.\n                        _jsPlumb.fire(\"connectionDragStop\", jpc, originalEvent);\n                        // fire this event to give people more fine-grained control (connectionDragStop fires a lot)\n                        if (jpc.pending) {\n                            _jsPlumb.fire(\"connectionAborted\", jpc, originalEvent);\n                        }\n                        // tell jsplumb that dragging is finished.\n                        _jsPlumb.currentlyDragging = false;\n                        jpc.suspendedElement = null;\n                        jpc.suspendedEndpoint = null;\n                        jpc = null;\n                    }\n\n                    // if no endpoints, jpc already cleaned up. but still we want to ensure we're reset properly.\n                    // remove the element associated with the floating endpoint\n                    // (and its associated floating endpoint and visual artefacts)\n                    if (placeholderInfo && placeholderInfo.element) {\n                        _jsPlumb.remove(placeholderInfo.element, false, false);\n                    }\n                    // remove the inplace copy\n                    if (inPlaceCopy) {\n                        _jsPlumb.deleteObject({endpoint: inPlaceCopy});\n                    }\n\n                    if (this._jsPlumb) {\n                        // make our canvas visible (TODO: hand off to library; we should not know about DOM)\n                        this.canvas.style.visibility = \"visible\";\n                        // unlock our anchor\n                        this.anchor.locked = false;\n                        // clear floating anchor.\n                        this._jsPlumb.floatingEndpoint = null;\n                    }\n\n                }.bind(this);\n\n                dragOptions = _jp.extend(defaultOpts, dragOptions);\n                dragOptions.scope = this.scope || dragOptions.scope;\n                dragOptions[beforeStartEvent] = _ju.wrap(dragOptions[beforeStartEvent], beforeStart, false);\n                dragOptions[startEvent] = _ju.wrap(dragOptions[startEvent], start, false);\n                // extracted drag handler function so can be used by makeSource\n                dragOptions[dragEvent] = _ju.wrap(dragOptions[dragEvent], _dragHandler.drag);\n                dragOptions[stopEvent] = _ju.wrap(dragOptions[stopEvent], stop);\n                dragOptions.multipleDrop = false;\n\n                dragOptions.canDrag = function () {\n                    return this.isSource || this.isTemporarySource || /*(this.isTarget && */this.connections.length > 0/*)*/;\n                }.bind(this);\n\n                _jsPlumb.initDraggable(this.canvas, dragOptions, \"internal\");\n\n                this.canvas._jsPlumbRelatedElement = this.element;\n\n                draggingInitialised = true;\n            }\n        };\n\n        var ep = params.endpoint || this._jsPlumb.instance.Defaults.Endpoint || _jp.Defaults.Endpoint;\n        this.setEndpoint(ep, true);\n        var anchorParamsToUse = params.anchor ? params.anchor : params.anchors ? params.anchors : (_jsPlumb.Defaults.Anchor || \"Top\");\n        this.setAnchor(anchorParamsToUse, true);\n\n        // finally, set type if it was provided\n        var type = [ \"default\", (params.type || \"\")].join(\" \");\n        this.addType(type, params.data, true);\n        this.canvas = this.endpoint.canvas;\n        this.canvas._jsPlumb = this;\n\n        this.initDraggable();\n\n        // pulled this out into a function so we can reuse it for the inPlaceCopy canvas; you can now drop detached connections\n        // back onto the endpoint you detached it from.\n        var _initDropTarget = function (canvas, isTransient, endpoint, referenceEndpoint) {\n\n            if (_jp.isDropSupported(this.element)) {\n                var dropOptions = params.dropOptions || _jsPlumb.Defaults.DropOptions || _jp.Defaults.DropOptions;\n                dropOptions = _jp.extend({}, dropOptions);\n                dropOptions.scope = dropOptions.scope || this.scope;\n                var dropEvent = _jp.dragEvents.drop,\n                    overEvent = _jp.dragEvents.over,\n                    outEvent = _jp.dragEvents.out,\n                    _ep = this,\n                    drop = _jsPlumb.EndpointDropHandler({\n                        getEndpoint: function () {\n                            return _ep;\n                        },\n                        jsPlumb: _jsPlumb,\n                        enabled: function () {\n                            return endpoint != null ? endpoint.isEnabled() : true;\n                        },\n                        isFull: function () {\n                            return endpoint.isFull();\n                        },\n                        element: this.element,\n                        elementId: this.elementId,\n                        isSource: this.isSource,\n                        isTarget: this.isTarget,\n                        addClass: function (clazz) {\n                            _ep.addClass(clazz);\n                        },\n                        removeClass: function (clazz) {\n                            _ep.removeClass(clazz);\n                        },\n                        isDropAllowed: function () {\n                            return _ep.isDropAllowed.apply(_ep, arguments);\n                        },\n                        reference:referenceEndpoint,\n                        isRedrop:function(jpc, dhParams) {\n                            return jpc.suspendedEndpoint && dhParams.reference && (jpc.suspendedEndpoint.id === dhParams.reference.id);\n                        }\n                    });\n\n                dropOptions[dropEvent] = _ju.wrap(dropOptions[dropEvent], drop, true);\n                dropOptions[overEvent] = _ju.wrap(dropOptions[overEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = _jsPlumb.floatingConnections[id];\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        // here we should fire the 'over' event if we are a target and this is a new connection,\n                        // or we are the same as the floating endpoint.\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id == _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            var bb = _jsPlumb.checkCondition(\"checkDropAllowed\", {\n                                sourceEndpoint: _jpc.endpoints[idx],\n                                targetEndpoint: this,\n                                connection: _jpc\n                            });\n                            this[(bb ? \"add\" : \"remove\") + \"Class\"](_jsPlumb.endpointDropAllowedClass);\n                            this[(bb ? \"remove\" : \"add\") + \"Class\"](_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.over(this.anchor, this);\n                        }\n                    }\n                }.bind(this));\n\n                dropOptions[outEvent] = _ju.wrap(dropOptions[outEvent], function () {\n                    var draggable = _jp.getDragObject(arguments),\n                        id = draggable == null ? null : _jsPlumb.getAttribute(_jp.getElement(draggable), \"dragId\"),\n                        _jpc = id ? _jsPlumb.floatingConnections[id] : null;\n\n                    if (_jpc != null) {\n                        var idx = _jsPlumb.getFloatingAnchorIndex(_jpc);\n                        var _cont = (this.isTarget && idx !== 0) || (_jpc.suspendedEndpoint && this.referenceEndpoint && this.referenceEndpoint.id == _jpc.suspendedEndpoint.id);\n                        if (_cont) {\n                            this.removeClass(_jsPlumb.endpointDropAllowedClass);\n                            this.removeClass(_jsPlumb.endpointDropForbiddenClass);\n                            _jpc.endpoints[idx].anchor.out();\n                        }\n                    }\n                }.bind(this));\n\n                _jsPlumb.initDroppable(canvas, dropOptions, \"internal\", isTransient);\n            }\n        }.bind(this);\n\n        // Initialise the endpoint's canvas as a drop target. The drop handler will take care of the logic of whether\n        // something can actually be dropped.\n        if (!this.anchor.isFloating)\n            _initDropTarget(this.canvas, !(params._transient || this.anchor.isFloating), this, params.reference);\n\n\n        return this;\n    };\n\n    _ju.extend(_jp.Endpoint, _jp.OverlayCapableJsPlumbUIComponent, {\n\n        setVisible: function (v, doNotChangeConnections, doNotNotifyOtherEndpoint) {\n            this._jsPlumb.visible = v;\n            if (this.canvas) this.canvas.style.display = v ? \"block\" : \"none\";\n            this[v ? \"showOverlays\" : \"hideOverlays\"]();\n            if (!doNotChangeConnections) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    this.connections[i].setVisible(v);\n                    if (!doNotNotifyOtherEndpoint) {\n                        var oIdx = this === this.connections[i].endpoints[0] ? 1 : 0;\n                        // only change the other endpoint if this is its only connection.\n                        if (this.connections[i].endpoints[oIdx].connections.length == 1) this.connections[i].endpoints[oIdx].setVisible(v, true, true);\n                    }\n                }\n            }\n        },\n        getAttachedElements: function () {\n            return this.connections;\n        },\n        applyType: function (t, doNotRepaint) {\n            this.setPaintStyle(t.endpointStyle || t.paintStyle, doNotRepaint);\n            this.setHoverPaintStyle(t.endpointHoverStyle || t.hoverPaintStyle, doNotRepaint);\n            if (t.maxConnections != null) this._jsPlumb.maxConnections = t.maxConnections;\n            if (t.scope) this.scope = t.scope;\n            _jp.extend(this, t, typeParameters);\n            if (t.cssClass != null && this.canvas) this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        isEnabled: function () {\n            return this._jsPlumb.enabled;\n        },\n        setEnabled: function (e) {\n            this._jsPlumb.enabled = e;\n        },\n        cleanup: function () {\n            var anchorClass = this._jsPlumb.instance.endpointAnchorClassPrefix + (this._jsPlumb.currentAnchorClass ? \"-\" + this._jsPlumb.currentAnchorClass : \"\");\n            jsPlumb.removeClass(this.element, anchorClass);\n            this.anchor = null;\n            this.endpoint.cleanup(true);\n            this.endpoint.destroy();\n            this.endpoint = null;\n            // drag/drop\n            this._jsPlumb.instance.destroyDraggable(this.canvas, \"internal\");\n            this._jsPlumb.instance.destroyDroppable(this.canvas, \"internal\");\n        },\n        setHover: function (h) {\n            if (this.endpoint && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged())\n                this.endpoint.setHover(h);\n        },\n        isFull: function () {\n            return this._jsPlumb.maxConnections === 0 ? true : !(this.isFloating() || this._jsPlumb.maxConnections < 0 || this.connections.length < this._jsPlumb.maxConnections);\n        },\n        /**\n         * private but needs to be exposed.\n         */\n        isFloating: function () {\n            return this.anchor != null && this.anchor.isFloating;\n        },\n        isConnectedTo: function (endpoint) {\n            var found = false;\n            if (endpoint) {\n                for (var i = 0; i < this.connections.length; i++) {\n                    if (this.connections[i].endpoints[1] == endpoint || this.connections[i].endpoints[0] == endpoint) {\n                        found = true;\n                        break;\n                    }\n                }\n            }\n            return found;\n        },\n        getConnectionCost: function () {\n            return this._jsPlumb.connectionCost;\n        },\n        setConnectionCost: function (c) {\n            this._jsPlumb.connectionCost = c;\n        },\n        areConnectionsDirected: function () {\n            return this._jsPlumb.connectionsDirected;\n        },\n        setConnectionsDirected: function (b) {\n            this._jsPlumb.connectionsDirected = b;\n        },\n        setElementId: function (_elId) {\n            this.elementId = _elId;\n            this.anchor.elementId = _elId;\n        },\n        setReferenceElement: function (_el) {\n            this.element = _jp.getElement(_el);\n        },\n        setDragAllowedWhenFull: function (allowed) {\n            this.dragAllowedWhenFull = allowed;\n        },\n        equals: function (endpoint) {\n            return this.anchor.equals(endpoint.anchor);\n        },\n        getUuid: function () {\n            return this._jsPlumb.uuid;\n        },\n        computeAnchor: function (params) {\n            return this.anchor.compute(params);\n        }\n    });\n\n    root.jsPlumbInstance.prototype.EndpointDropHandler = function (dhParams) {\n        return function (e) {\n\n            var _jsPlumb = dhParams.jsPlumb;\n\n            // remove the classes that are added dynamically. drop is neither forbidden nor allowed now that\n            // the drop is finishing.\n            dhParams.removeClass(_jsPlumb.endpointDropAllowedClass);\n            dhParams.removeClass(_jsPlumb.endpointDropForbiddenClass);\n\n            var originalEvent = _jsPlumb.getDropEvent(arguments),\n                draggable = _jsPlumb.getDragObject(arguments),\n                id = _jsPlumb.getAttribute(draggable, \"dragId\"),\n                elId = _jsPlumb.getAttribute(draggable, \"elId\"),\n                scope = _jsPlumb.getAttribute(draggable, \"originalScope\"),\n                jpc = _jsPlumb.floatingConnections[id];\n\n            // if no active connection, bail.\n            if (jpc == null) return;\n\n            // calculate if this is an existing connection.\n            var existingConnection = jpc.suspendedEndpoint != null;\n\n            // if suspended endpoint exists but has been cleaned up, bail. This means it's an existing connection\n            // that has been detached and will shortly be discarded.\n            if (existingConnection && jpc.suspendedEndpoint._jsPlumb == null) return;\n\n            // get the drop endpoint. for a normal connection this is just the one that would replace the currently\n            // floating endpoint. for a makeTarget this is a new endpoint that is created on drop. But we leave that to\n            // the handler to figure out.\n            var _ep = dhParams.getEndpoint(jpc);\n\n            // If we're not given an endpoint to use, bail.\n            if (_ep == null) return;\n\n            // if this is a drop back where the connection came from, mark it force reattach and\n            // return; the stop handler will reattach. without firing an event.\n            if (dhParams.isRedrop(jpc, dhParams)) {\n                jpc._forceReattach = true;\n                jpc.setHover(false);\n                if (dhParams.maybeCleanup) dhParams.maybeCleanup(_ep);\n                return;\n            }\n\n            // ensure we dont bother trying to drop sources on non-source eps, and same for target.\n            var idx = _jsPlumb.getFloatingAnchorIndex(jpc);\n            if ((idx === 0 && !dhParams.isSource)|| (idx === 1 && !dhParams.isTarget)){\n                if (dhParams.maybeCleanup) dhParams.maybeCleanup(_ep);\n                return;\n            }\n\n            if (dhParams.onDrop) dhParams.onDrop(jpc);\n\n            // restore the original scope if necessary (issue 57)\n            if (scope) _jsPlumb.setDragScope(draggable, scope);\n\n            // if the target of the drop is full, fire an event (we abort below)\n            // makeTarget: keep.\n            var isFull = dhParams.isFull(e);\n            if (isFull) {\n                _ep.fire(\"maxConnections\", {\n                    endpoint: this,\n                    connection: jpc,\n                    maxConnections: _ep._jsPlumb.maxConnections\n                }, originalEvent);\n            }\n            //\n            // if endpoint enabled, not full, and matches the index of the floating endpoint...\n            if (!isFull &&  dhParams.enabled()) {\n                var _doContinue = true;\n\n                // before testing for beforeDrop, reset the connection's source/target to be the actual DOM elements\n                // involved (that is, stash any temporary stuff used for dragging. but we need to keep it around in\n                // order that the anchor manager can clean things up properly).\n                if (idx === 0) {\n                    jpc.floatingElement = jpc.source;\n                    jpc.floatingId = jpc.sourceId;\n                    jpc.floatingEndpoint = jpc.endpoints[0];\n                    jpc.floatingIndex = 0;\n                    jpc.source = dhParams.element;\n                    jpc.sourceId = dhParams.elementId;\n                } else {\n                    jpc.floatingElement = jpc.target;\n                    jpc.floatingId = jpc.targetId;\n                    jpc.floatingEndpoint = jpc.endpoints[1];\n                    jpc.floatingIndex = 1;\n                    jpc.target = dhParams.element;\n                    jpc.targetId = dhParams.elementId;\n                }\n\n                // if this is an existing connection and detach is not allowed we won't continue. The connection's\n                // endpoints have been reinstated; everything is back to how it was.\n                if (existingConnection && jpc.suspendedEndpoint.id != _ep.id) {\n\n                    if (!jpc.isDetachAllowed(jpc) || !jpc.endpoints[idx].isDetachAllowed(jpc) || !jpc.suspendedEndpoint.isDetachAllowed(jpc) || !_jsPlumb.checkCondition(\"beforeDetach\", jpc))\n                        _doContinue = false;\n                }\n\n// ------------ wrap the execution path in a function so we can support asynchronous beforeDrop\n\n                var continueFunction = function (optionalData) {\n                    // remove this jpc from the current endpoint, which is a floating endpoint that we will\n                    // subsequently discard.\n                    jpc.endpoints[idx].detachFromConnection(jpc);\n\n                    // if there's a suspended endpoint, detach it from the connection.\n                    if (jpc.suspendedEndpoint) jpc.suspendedEndpoint.detachFromConnection(jpc);\n\n                    jpc.endpoints[idx] = _ep;\n                    _ep.addConnection(jpc);\n\n                    // copy our parameters in to the connection:\n                    var params = _ep.getParameters();\n                    for (var aParam in params)\n                        jpc.setParameter(aParam, params[aParam]);\n\n                    if (!existingConnection) {\n                        // if not an existing connection and\n                        if (params.draggable)\n                            _jsPlumb.initDraggable(this.element, dragOptions, \"internal\", _jsPlumb);\n                    }\n                    else {\n                        var suspendedElementId = jpc.suspendedEndpoint.elementId;\n                        _jsPlumb.fireMoveEvent({\n                            index: idx,\n                            originalSourceId: idx === 0 ? suspendedElementId : jpc.sourceId,\n                            newSourceId: idx === 0 ? _ep.elementId : jpc.sourceId,\n                            originalTargetId: idx == 1 ? suspendedElementId : jpc.targetId,\n                            newTargetId: idx == 1 ? _ep.elementId : jpc.targetId,\n                            originalSourceEndpoint: idx === 0 ? jpc.suspendedEndpoint : jpc.endpoints[0],\n                            newSourceEndpoint: idx === 0 ? _ep : jpc.endpoints[0],\n                            originalTargetEndpoint: idx == 1 ? jpc.suspendedEndpoint : jpc.endpoints[1],\n                            newTargetEndpoint: idx == 1 ? _ep : jpc.endpoints[1],\n                            connection: jpc\n                        }, originalEvent);\n                    }\n\n                    if (idx == 1) {\n                        _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\n                    }\n                    else {\n                        _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\n                    }\n\n                    // when makeSource has uniqueEndpoint:true, we want to create connections with new endpoints\n                    // that are subsequently deleted. So makeSource sets `finalEndpoint`, which is the Endpoint to\n                    // which the connection should be attached. The `detachFromConnection` call below results in the\n                    // temporary endpoint being cleaned up.\n                    if (jpc.endpoints[0].finalEndpoint) {\n                        var _toDelete = jpc.endpoints[0];\n                        _toDelete.detachFromConnection(jpc);\n                        jpc.endpoints[0] = jpc.endpoints[0].finalEndpoint;\n                        jpc.endpoints[0].addConnection(jpc);\n                    }\n\n                    // if optionalData was given, merge it onto the connection's data.\n                    if (_ju.isObject(optionalData)) {\n                        jpc.mergeData(optionalData);\n                    }\n                    // finalise will inform the anchor manager and also add to\n                    // connectionsByScope if necessary.\n                    _jsPlumb.finaliseConnection(jpc, null, originalEvent, false);\n                    jpc.setHover(false);\n\n                }.bind(this);\n\n                var dontContinueFunction = function () {\n                    // otherwise just put it back on the endpoint it was on before the drag.\n                    if (jpc.suspendedEndpoint) {\n                        jpc.endpoints[idx] = jpc.suspendedEndpoint;\n                        jpc.setHover(false);\n                        jpc._forceDetach = true;\n                        if (idx === 0) {\n                            jpc.source = jpc.suspendedEndpoint.element;\n                            jpc.sourceId = jpc.suspendedEndpoint.elementId;\n                        } else {\n                            jpc.target = jpc.suspendedEndpoint.element;\n                            jpc.targetId = jpc.suspendedEndpoint.elementId;\n                        }\n                        jpc.suspendedEndpoint.addConnection(jpc);\n\n                        // TODO checkSanity\n                        if (idx == 1) {\n                            _jsPlumb.anchorManager.updateOtherEndpoint(jpc.sourceId, jpc.floatingId, jpc.targetId, jpc);\n                        }\n                        else {\n                            _jsPlumb.anchorManager.sourceChanged(jpc.floatingId, jpc.sourceId, jpc, jpc.source);\n                        }\n\n                        _jsPlumb.repaint(jpc.sourceId);\n                        jpc._forceDetach = false;\n                    }\n                };\n\n// --------------------------------------\n                // now check beforeDrop.  this will be available only on Endpoints that are setup to\n                // have a beforeDrop condition (although, secretly, under the hood all Endpoints and\n                // the Connection have them, because they are on jsPlumbUIComponent.  shhh!), because\n                // it only makes sense to have it on a target endpoint.\n                _doContinue = _doContinue && dhParams.isDropAllowed(jpc.sourceId, jpc.targetId, jpc.scope, jpc, _ep);// && jpc.pending;\n\n                if (_doContinue) {\n                    continueFunction(_doContinue);\n                    return true;\n                }\n                else {\n                    dontContinueFunction();\n                }\n            }\n\n            if (dhParams.maybeCleanup) dhParams.maybeCleanup(_ep);\n\n            _jsPlumb.currentlyDragging = false;\n        };\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the code for Connections.\n *\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this,\n        _jp = root.jsPlumb,\n        _ju = root.jsPlumbUtil;\n\n    var makeConnector = function (_jsPlumb, renderMode, connectorName, connectorArgs, forComponent) {\n            if (!_jsPlumb.Defaults.DoNotThrowErrors && jsPlumb.Connectors[renderMode][connectorName] == null)\n                throw { msg: \"jsPlumb: unknown connector type '\" + connectorName + \"'\" };\n\n            return new _jp.Connectors[renderMode][connectorName](connectorArgs, forComponent);\n        },\n        _makeAnchor = function (anchorParams, elementId, _jsPlumb) {\n            return (anchorParams) ? _jsPlumb.makeAnchor(anchorParams, elementId, _jsPlumb) : null;\n        },\n        _updateConnectedClass = function (conn, element, _jsPlumb, remove) {\n            if (element != null) {\n                element._jsPlumbConnections = element._jsPlumbConnections || {};\n                if (remove)\n                    delete element._jsPlumbConnections[conn.id];\n                else\n                    element._jsPlumbConnections[conn.id] = true;\n\n                if (_ju.isEmpty(element._jsPlumbConnections)) {\n                    _jsPlumb.removeClass(element, _jsPlumb.connectedClass);\n                }\n                else\n                    _jsPlumb.addClass(element, _jsPlumb.connectedClass);\n            }\n        };\n\n    _jp.Connection = function (params) {\n        var _newEndpoint = params.newEndpoint;\n\n        this.id = params.id;\n        this.connector = null;\n        this.idPrefix = \"_jsplumb_c_\";\n        this.defaultLabelLocation = 0.5;\n        this.defaultOverlayKeys = [\"Overlays\", \"ConnectionOverlays\"];\n        // if a new connection is the result of moving some existing connection, params.previousConnection\n        // will have that Connection in it. listeners for the jsPlumbConnection event can look for that\n        // member and take action if they need to.\n        this.previousConnection = params.previousConnection;\n        this.source = _jp.getElement(params.source);\n        this.target = _jp.getElement(params.target);\n        // sourceEndpoint and targetEndpoint override source/target, if they are present. but \n        // source is not overridden if the Endpoint has declared it is not the final target of a connection;\n        // instead we use the source that the Endpoint declares will be the final source element.\n        if (params.sourceEndpoint) this.source = params.sourceEndpoint.getElement();\n        if (params.targetEndpoint) this.target = params.targetEndpoint.getElement();\n\n        _jp.OverlayCapableJsPlumbUIComponent.apply(this, arguments);\n\n        this.sourceId = this._jsPlumb.instance.getId(this.source);\n        this.targetId = this._jsPlumb.instance.getId(this.target);\n        this.scope = params.scope; // scope may have been passed in to the connect call. if it wasn't, we will pull it from the source endpoint, after having initialised the endpoints.            \n        this.endpoints = [];\n        this.endpointStyles = [];\n\n        var _jsPlumb = this._jsPlumb.instance;\n\n        _jsPlumb.manage(this.sourceId, this.source);\n        _jsPlumb.manage(this.targetId, this.target);\n\n        this._jsPlumb.visible = true;\n        this._jsPlumb.editable = params.editable === true;\n        this._jsPlumb.params = {\n            cssClass: params.cssClass,\n            container: params.container,\n            \"pointer-events\": params[\"pointer-events\"],\n            editorParams: params.editorParams,\n            overlays: params.overlays\n        };\n        this._jsPlumb.lastPaintedAt = null;\n\n        // listen to mouseover and mouseout events passed from the container delegate.\n        this.bind(\"mouseover\", function () {\n            this.setHover(true);\n        }.bind(this));\n        this.bind(\"mouseout\", function () {\n            this.setHover(false);\n        }.bind(this));\n\n        this.editableRequested = params.editable !== false;\n        this.setEditable = function(e) {\n            return this.connector ? this.connector.setEditable(e) : false;\n        };\n        this.isEditable = function() { return this.connector ? this.connector.isEditable() : false; };\n        this.isEditing = function() { return this.connector ? this.connector.isEditing() : false; };\n\n// INITIALISATION CODE\n\n        this.makeEndpoint = function (isSource, el, elId, ep) {\n            elId = elId || this._jsPlumb.instance.getId(el);\n            return this.prepareEndpoint(_jsPlumb, _newEndpoint, this, ep, isSource ? 0 : 1, params, el, elId);\n        };\n\n        // if type given, get the endpoint definitions mapping to that type from the jsplumb instance, and use those.\n        // we apply types at the end of this constructor but endpoints are only honoured in a type definition at\n        // create time.\n        if (params.type) {\n            params.endpoints = this._jsPlumb.instance.deriveEndpointAndAnchorSpec(params.type).endpoints;\n        }\n\n        var eS = this.makeEndpoint(true, this.source, this.sourceId, params.sourceEndpoint),\n            eT = this.makeEndpoint(false, this.target, this.targetId, params.targetEndpoint);\n\n        if (eS) _ju.addToList(params.endpointsByElement, this.sourceId, eS);\n        if (eT) _ju.addToList(params.endpointsByElement, this.targetId, eT);\n        // if scope not set, set it to be the scope for the source endpoint.\n        if (!this.scope) this.scope = this.endpoints[0].scope;\n\n        // if explicitly told to (or not to) delete endpoints on detach, override endpoint's preferences\n        if (params.deleteEndpointsOnDetach != null) {\n            this.endpoints[0]._deleteOnDetach = params.deleteEndpointsOnDetach;\n            this.endpoints[1]._deleteOnDetach = params.deleteEndpointsOnDetach;\n        }\n        else {\n            // otherwise, unless the endpoints say otherwise, mark them for deletion.\n            if (!this.endpoints[0]._doNotDeleteOnDetach) this.endpoints[0]._deleteOnDetach = true;\n            if (!this.endpoints[1]._doNotDeleteOnDetach) this.endpoints[1]._deleteOnDetach = true;\n        }\n\n// -------------------------- DEFAULT TYPE ---------------------------------------------\n\n        // DETACHABLE\n        var _detachable = _jsPlumb.Defaults.ConnectionsDetachable;\n        if (params.detachable === false) _detachable = false;\n        if (this.endpoints[0].connectionsDetachable === false) _detachable = false;\n        if (this.endpoints[1].connectionsDetachable === false) _detachable = false;\n        // REATTACH\n        var _reattach = params.reattach || this.endpoints[0].reattachConnections || this.endpoints[1].reattachConnections || _jsPlumb.Defaults.ReattachConnections;\n\n        this.appendToDefaultType({\n            detachable: _detachable,\n            reattach: _reattach,\n            paintStyle:this.endpoints[0].connectorStyle || this.endpoints[1].connectorStyle || params.paintStyle || _jsPlumb.Defaults.PaintStyle || jsPlumb.Defaults.PaintStyle,\n            hoverPaintStyle:this.endpoints[0].connectorHoverStyle || this.endpoints[1].connectorHoverStyle || params.hoverPaintStyle || _jsPlumb.Defaults.HoverPaintStyle || jsPlumb.Defaults.HoverPaintStyle\n        });\n\n\n        var _suspendedAt = _jsPlumb.getSuspendedAt();\n        if (!_jsPlumb.isSuspendDrawing()) {\n            // paint the endpoints\n            var myInfo = _jsPlumb.getCachedData(this.sourceId),\n                myOffset = myInfo.o, myWH = myInfo.s,\n                otherInfo = _jsPlumb.getCachedData(this.targetId),\n                otherOffset = otherInfo.o,\n                otherWH = otherInfo.s,\n                initialTimestamp = _suspendedAt || _jsPlumb.timestamp(),\n                anchorLoc = this.endpoints[0].anchor.compute({\n                    xy: [ myOffset.left, myOffset.top ], wh: myWH, element: this.endpoints[0],\n                    elementId: this.endpoints[0].elementId,\n                    txy: [ otherOffset.left, otherOffset.top ], twh: otherWH, tElement: this.endpoints[1],\n                    timestamp: initialTimestamp\n                });\n\n            this.endpoints[0].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n\n            anchorLoc = this.endpoints[1].anchor.compute({\n                xy: [ otherOffset.left, otherOffset.top ], wh: otherWH, element: this.endpoints[1],\n                elementId: this.endpoints[1].elementId,\n                txy: [ myOffset.left, myOffset.top ], twh: myWH, tElement: this.endpoints[0],\n                timestamp: initialTimestamp\n            });\n            this.endpoints[1].paint({ anchorLoc: anchorLoc, timestamp: initialTimestamp });\n        }\n\n        this.getTypeDescriptor = function () {\n            return \"connection\";\n        };\n        this.getAttachedElements = function () {\n            return this.endpoints;\n        };\n\n        this.isDetachable = function () {\n            return this._jsPlumb.detachable === true;\n        };\n        this.setDetachable = function (detachable) {\n            this._jsPlumb.detachable = detachable === true;\n        };\n        this.isReattach = function () {\n            return this._jsPlumb.reattach === true || this.endpoints[0].reattachConnections === true || this.endpoints[1].reattachConnections === true;\n        };\n        this.setReattach = function (reattach) {\n            this._jsPlumb.reattach = reattach === true;\n        };\n\n// END INITIALISATION CODE\n\n\n// COST + DIRECTIONALITY\n        // if cost not supplied, try to inherit from source endpoint\n        this._jsPlumb.cost = params.cost || this.endpoints[0].getConnectionCost();\n        this._jsPlumb.directed = params.directed;\n        // inherit directed flag if set no source endpoint\n        if (params.directed == null) this._jsPlumb.directed = this.endpoints[0].areConnectionsDirected();\n// END COST + DIRECTIONALITY\n\n// PARAMETERS\n        // merge all the parameters objects into the connection.  parameters set\n        // on the connection take precedence; then source endpoint params, then\n        // finally target endpoint params.\n        var _p = jsPlumb.extend({}, this.endpoints[1].getParameters());\n        _jp.extend(_p, this.endpoints[0].getParameters());\n        _jp.extend(_p, this.getParameters());\n        this.setParameters(_p);\n// END PARAMETERS\n\n// PAINTING\n\n        this.setConnector(this.endpoints[0].connector || this.endpoints[1].connector || params.connector || _jsPlumb.Defaults.Connector || _jp.Defaults.Connector, true);\n        if (params.geometry) {\n            this.connector.setGeometry(params.geometry);\n        }\n        var data = params.data == null || !_ju.isObject(params.data) ? {} : params.data;\n        this.getData = function() { return data; };\n        this.setData = function(d) { data = d || {}; };\n        this.mergeData = function(d) { data = jsPlumb.extend(data, d); };\n\n        // the very last thing we do is apply types, if there are any.\n        var _types = [ \"default\", this.endpoints[0].connectionType, this.endpoints[1].connectionType,  params.type ].join(\" \");\n        if (/[^\\s]/.test(_types))\n            this.addType(_types, params.data, true);\n\n        this.updateConnectedClass();\n\n// END PAINTING    \n    };\n\n    _ju.extend(_jp.Connection, _jp.OverlayCapableJsPlumbUIComponent, {\n        applyType: function (t, doNotRepaint, typeMap) {\n\n            // none of these things result in the creation of objects so can be ignored.\n            if (t.detachable != null) this.setDetachable(t.detachable);\n            if (t.reattach != null) this.setReattach(t.reattach);\n            if (t.scope) this.scope = t.scope;\n\n            if (t.cssClass != null && this.canvas) this._jsPlumb.instance.addClass(this.canvas, t.cssClass);\n\n            var _anchors = null;\n            // this also results in the creation of objects.\n            if (t.anchor) {\n                // note that even if the param was anchor, we store `anchors`.\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchor);\n                if (_anchors == null) {\n                    _anchors = [ this._jsPlumb.instance.makeAnchor(t.anchor), this._jsPlumb.instance.makeAnchor(t.anchor) ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchor);\n                }\n            }\n            else if (t.anchors) {\n                _anchors = this.getCachedTypeItem(\"anchors\", typeMap.anchors);\n                if (_anchors == null) {\n                    _anchors = [\n                        this._jsPlumb.instance.makeAnchor(t.anchors[0]),\n                        this._jsPlumb.instance.makeAnchor(t.anchors[1])\n                    ];\n                    this.cacheTypeItem(\"anchors\", _anchors, typeMap.anchors);\n                }\n            }\n            if (_anchors != null) {\n                this.endpoints[0].anchor = _anchors[0];\n                this.endpoints[1].anchor = _anchors[1];\n                if (this.endpoints[1].anchor.isDynamic) this._jsPlumb.instance.repaint(this.endpoints[1].elementId);\n            }\n\n            _jp.OverlayCapableJsPlumbUIComponent.applyType(this, t);\n        },\n        addClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].addClass(c);\n                this.endpoints[1].addClass(c);\n                if (this.suspendedEndpoint) this.suspendedEndpoint.addClass(c);\n            }\n            if (this.connector) {\n                this.connector.addClass(c);\n            }\n        },\n        removeClass: function (c, informEndpoints) {\n            if (informEndpoints) {\n                this.endpoints[0].removeClass(c);\n                this.endpoints[1].removeClass(c);\n                if (this.suspendedEndpoint) this.suspendedEndpoint.removeClass(c);\n            }\n            if (this.connector) {\n                this.connector.removeClass(c);\n            }\n        },\n        isVisible: function () {\n            return this._jsPlumb.visible;\n        },\n        setVisible: function (v) {\n            this._jsPlumb.visible = v;\n            if (this.connector)\n                this.connector.setVisible(v);\n            this.repaint();\n        },\n        cleanup: function () {\n            this.updateConnectedClass(true);\n            this.endpoints = null;\n            this.source = null;\n            this.target = null;\n            if (this.connector != null) {\n                this.connector.cleanup(true);\n                this.connector.destroy(true);\n            }\n            this.connector = null;\n        },\n        updateConnectedClass:function(remove) {\n            if (this._jsPlumb) {\n                _updateConnectedClass(this, this.source, this._jsPlumb.instance, remove);\n                _updateConnectedClass(this, this.target, this._jsPlumb.instance, remove);\n            }\n        },\n        setHover: function (state) {\n            if (this.connector && this._jsPlumb && !this._jsPlumb.instance.isConnectionBeingDragged()) {\n                this.connector.setHover(state);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.source, this._jsPlumb.instance.hoverSourceClass);\n                root.jsPlumb[state ? \"addClass\" : \"removeClass\"](this.target, this._jsPlumb.instance.hoverTargetClass);\n            }\n        },\n        getUuids:function() {\n            return [ this.endpoints[0].getUuid(), this.endpoints[1].getUuid() ];\n        },\n        getCost: function () {\n            return this._jsPlumb ? this._jsPlumb.cost : -Infinity;\n        },\n        setCost: function (c) {\n            this._jsPlumb.cost = c;\n        },\n        isDirected: function () {\n            return this._jsPlumb.directed === true;\n        },\n        getConnector: function () {\n            return this.connector;\n        },\n        getGeometry : function() { return this.connector ? this.connector.getGeometry() : null; },\n        setGeometry : function(g) { if (this.connector) this.connector.setGeometry(g); },\n        prepareConnector:function(connectorSpec, typeId) {\n            var connectorArgs = {\n                    _jsPlumb: this._jsPlumb.instance,\n                    cssClass: (this._jsPlumb.params.cssClass || \"\") + (this.isEditable() ? this._jsPlumb.instance.editableConnectorClass : \"\"),\n                    container: this._jsPlumb.params.container,\n                    \"pointer-events\": this._jsPlumb.params[\"pointer-events\"],\n                    editable:this.editableRequested\n                },\n                renderMode = this._jsPlumb.instance.getRenderMode(),\n                connector;\n\n            if (_ju.isString(connectorSpec))\n                connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec, connectorArgs, this); // lets you use a string as shorthand.\n            else if (_ju.isArray(connectorSpec)) {\n                if (connectorSpec.length == 1)\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], connectorArgs, this);\n                else\n                    connector = makeConnector(this._jsPlumb.instance, renderMode, connectorSpec[0], _ju.merge(connectorSpec[1], connectorArgs), this);\n            }\n            if (typeId != null) connector.typeId = typeId;\n            return connector;\n        },\n        setPreparedConnector: function(connector, doNotRepaint, doNotChangeListenerComponent, typeId) {\n\n            var previous, previousClasses = \"\";\n            // the connector will not be cleaned up if it was set as part of a type, because `typeId` will be set on it\n            // and we havent passed in `true` for \"force\" here.\n            if (this.connector != null) {\n                previous = this.connector;\n                previousClasses = previous.getClass();\n                this.connector.cleanup();\n                this.connector.destroy();\n            }\n\n            this.connector = connector;\n            if (typeId) {\n                this.cacheTypeItem(\"connector\", connector, typeId);\n            }\n\n            this.canvas = this.connector.canvas;\n            this.bgCanvas = this.connector.bgCanvas;\n\n            // put classes from prior connector onto the canvas\n            this.addClass(previousClasses);\n\n            // new: instead of binding listeners per connector, we now just have one delegate on the container.\n            // so for that handler we set the connection as the '_jsPlumb' member of the canvas element, and\n            // bgCanvas, if it exists, which it does right now in the VML renderer, so it won't from v 2.0.0 onwards.\n            if (this.canvas) this.canvas._jsPlumb = this;\n            if (this.bgCanvas) this.bgCanvas._jsPlumb = this;\n\n            if (previous != null) {\n                var o = this.getOverlays();\n                for (var i = 0; i < o.length; i++) {\n                    if (o[i].transfer) o[i].transfer(this.connector);\n                }\n            }\n\n            if (!doNotChangeListenerComponent) this.setListenerComponent(this.connector);\n            if (!doNotRepaint) this.repaint();\n        },\n        setConnector: function (connectorSpec, doNotRepaint, doNotChangeListenerComponent, typeId) {\n            var connector = this.prepareConnector(connectorSpec, typeId);\n            this.setPreparedConnector(connector, doNotRepaint, doNotChangeListenerComponent, typeId);\n        },\n        paint: function (params) {\n\n            if (!this._jsPlumb.instance.isSuspendDrawing() && this._jsPlumb.visible) {\n                params = params || {};\n                var timestamp = params.timestamp,\n                // if the moving object is not the source we must transpose the two references.\n                    swap = false,\n                    tId = swap ? this.sourceId : this.targetId, sId = swap ? this.targetId : this.sourceId,\n                    tIdx = swap ? 0 : 1, sIdx = swap ? 1 : 0;\n\n                if (timestamp == null || timestamp != this._jsPlumb.lastPaintedAt) {\n                    var sourceInfo = this._jsPlumb.instance.updateOffset({elId:sId}).o,\n                        targetInfo = this._jsPlumb.instance.updateOffset({elId:tId}).o,\n                        sE = this.endpoints[sIdx], tE = this.endpoints[tIdx];\n\n                    var sAnchorP = sE.anchor.getCurrentLocation({xy: [sourceInfo.left, sourceInfo.top], wh: [sourceInfo.width, sourceInfo.height], element: sE, timestamp: timestamp}),\n                        tAnchorP = tE.anchor.getCurrentLocation({xy: [targetInfo.left, targetInfo.top], wh: [targetInfo.width, targetInfo.height], element: tE, timestamp: timestamp});\n\n                    this.connector.resetBounds();\n\n                    this.connector.compute({\n                        sourcePos: sAnchorP,\n                        targetPos: tAnchorP,\n                        sourceEndpoint: this.endpoints[sIdx],\n                        targetEndpoint: this.endpoints[tIdx],\n                        lineWidth: this._jsPlumb.paintStyleInUse.lineWidth,\n                        sourceInfo: sourceInfo,\n                        targetInfo: targetInfo\n                    });\n\n                    var overlayExtents = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\n\n                    // compute overlays. we do this first so we can get their placements, and adjust the\n                    // container if needs be (if an overlay would be clipped)\n                    for (var i in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(i)) {\n                            var o = this._jsPlumb.overlays[i];\n                            if (o.isVisible()) {\n                                this._jsPlumb.overlayPlacements[i] = o.draw(this.connector, this._jsPlumb.paintStyleInUse, this.getAbsoluteOverlayPosition(o));\n                                overlayExtents.minX = Math.min(overlayExtents.minX, this._jsPlumb.overlayPlacements[i].minX);\n                                overlayExtents.maxX = Math.max(overlayExtents.maxX, this._jsPlumb.overlayPlacements[i].maxX);\n                                overlayExtents.minY = Math.min(overlayExtents.minY, this._jsPlumb.overlayPlacements[i].minY);\n                                overlayExtents.maxY = Math.max(overlayExtents.maxY, this._jsPlumb.overlayPlacements[i].maxY);\n                            }\n                        }\n                    }\n\n                    var lineWidth = parseFloat(this._jsPlumb.paintStyleInUse.lineWidth || 1) / 2,\n                        outlineWidth = parseFloat(this._jsPlumb.paintStyleInUse.lineWidth || 0),\n                        extents = {\n                            xmin: Math.min(this.connector.bounds.minX - (lineWidth + outlineWidth), overlayExtents.minX),\n                            ymin: Math.min(this.connector.bounds.minY - (lineWidth + outlineWidth), overlayExtents.minY),\n                            xmax: Math.max(this.connector.bounds.maxX + (lineWidth + outlineWidth), overlayExtents.maxX),\n                            ymax: Math.max(this.connector.bounds.maxY + (lineWidth + outlineWidth), overlayExtents.maxY)\n                        };\n                    // paint the connector.\n                    this.connector.paint(this._jsPlumb.paintStyleInUse, null, extents);\n                    // and then the overlays\n                    for (var j in this._jsPlumb.overlays) {\n                        if (this._jsPlumb.overlays.hasOwnProperty(j)) {\n                            var p = this._jsPlumb.overlays[j];\n                            if (p.isVisible()) {\n                                p.paint(this._jsPlumb.overlayPlacements[j], extents);\n                            }\n                        }\n                    }\n                }\n                this._jsPlumb.lastPaintedAt = timestamp;\n            }\n        },\n        repaint: function (params) {\n            params = params || {};\n            this.paint({ elId: this.sourceId, recalc: !(params.recalc === false), timestamp: params.timestamp});\n        },\n        prepareEndpoint: function (_jsPlumb, _newEndpoint, conn, existing, index, params, element, elementId) {\n            var e;\n            if (existing) {\n                conn.endpoints[index] = existing;\n                existing.addConnection(conn);\n            } else {\n                if (!params.endpoints) params.endpoints = [ null, null ];\n                var ep = params.endpoints[index] || params.endpoint || _jsPlumb.Defaults.Endpoints[index] || jsPlumb.Defaults.Endpoints[index] || _jsPlumb.Defaults.Endpoint || jsPlumb.Defaults.Endpoint;\n                if (!params.endpointStyles) params.endpointStyles = [ null, null ];\n                if (!params.endpointHoverStyles) params.endpointHoverStyles = [ null, null ];\n                var es = params.endpointStyles[index] || params.endpointStyle || _jsPlumb.Defaults.EndpointStyles[index] || jsPlumb.Defaults.EndpointStyles[index] || _jsPlumb.Defaults.EndpointStyle || jsPlumb.Defaults.EndpointStyle;\n                // Endpoints derive their fillStyle from the connector's strokeStyle, if no fillStyle was specified.\n                if (es.fillStyle == null && params.paintStyle != null)\n                    es.fillStyle = params.paintStyle.strokeStyle;\n\n                if (es.outlineColor == null && params.paintStyle != null)\n                    es.outlineColor = params.paintStyle.outlineColor;\n                if (es.outlineWidth == null && params.paintStyle != null)\n                    es.outlineWidth = params.paintStyle.outlineWidth;\n\n                var ehs = params.endpointHoverStyles[index] || params.endpointHoverStyle || _jsPlumb.Defaults.EndpointHoverStyles[index] || jsPlumb.Defaults.EndpointHoverStyles[index] || _jsPlumb.Defaults.EndpointHoverStyle || jsPlumb.Defaults.EndpointHoverStyle;\n                // endpoint hover fill style is derived from connector's hover stroke style\n                if (params.hoverPaintStyle != null) {\n                    if (ehs == null) ehs = {};\n                    if (ehs.fillStyle == null) {\n                        ehs.fillStyle = params.hoverPaintStyle.strokeStyle;\n                    }\n                }\n                var a = params.anchors ? params.anchors[index] :\n                        params.anchor ? params.anchor :\n                            _makeAnchor(_jsPlumb.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchors[index], elementId, _jsPlumb) ||\n                            _makeAnchor(_jsPlumb.Defaults.Anchor, elementId, _jsPlumb) ||\n                            _makeAnchor(_jp.Defaults.Anchor, elementId, _jsPlumb),\n                    u = params.uuids ? params.uuids[index] : null;\n\n                e = _newEndpoint({\n                    paintStyle: es, hoverPaintStyle: ehs, endpoint: ep, connections: [ conn ],\n                    uuid: u, anchor: a, source: element, scope: params.scope,\n                    reattach: params.reattach || _jsPlumb.Defaults.ReattachConnections,\n                    detachable: params.detachable || _jsPlumb.Defaults.ConnectionsDetachable\n                });\n                conn.endpoints[index] = e;\n\n                if (params.drawEndpoints === false) e.setVisible(false, true, true);\n\n            }\n            return e;\n        }\n\n    }); // END Connection class            \n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the code for creating and manipulating anchors.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jp = root.jsPlumb;\n\n    //\n    // manages anchors for all elements.\n    //\n    _jp.AnchorManager = function (params) {\n        var _amEndpoints = {},\n            continuousAnchorLocations = {},\n            userDefinedContinuousAnchorLocations = {},\n            continuousAnchorOrientations = {},\n            Orientation = { HORIZONTAL: \"horizontal\", VERTICAL: \"vertical\", DIAGONAL: \"diagonal\", IDENTITY: \"identity\" },\n            axes = [\"left\", \"top\", \"right\", \"bottom\"],\n            connectionsByElementId = {},\n            self = this,\n            anchorLists = {},\n            jsPlumbInstance = params.jsPlumbInstance,\n            floatingConnections = {},\n            calculateOrientation = function (sourceId, targetId, sd, td, sourceAnchor, targetAnchor) {\n\n                if (sourceId === targetId) return {\n                    orientation: Orientation.IDENTITY,\n                    a: [\"top\", \"top\"]\n                };\n\n                var theta = Math.atan2((td.centery - sd.centery), (td.centerx - sd.centerx)),\n                    theta2 = Math.atan2((sd.centery - td.centery), (sd.centerx - td.centerx));\n\n// --------------------------------------------------------------------------------------\n\n                // improved face calculation. get midpoints of each face for source and target, then put in an array with all combinations of\n                // source/target faces. sort this array by distance between midpoints. the entry at index 0 is our preferred option. we can\n                // go through the array one by one until we find an entry in which each requested face is supported.\n                var candidates = [], midpoints = { };\n                (function (types, dim) {\n                    for (var i = 0; i < types.length; i++) {\n                        midpoints[types[i]] = {\n                            \"left\": [ dim[i].left, dim[i].centery ],\n                            \"right\": [ dim[i].right, dim[i].centery ],\n                            \"top\": [ dim[i].centerx, dim[i].top ],\n                            \"bottom\": [ dim[i].centerx , dim[i].bottom]\n                        };\n                    }\n                })([ \"source\", \"target\" ], [ sd, td ]);\n\n                for (var sf = 0; sf < axes.length; sf++) {\n                    for (var tf = 0; tf < axes.length; tf++) {\n                        candidates.push({\n                            source: axes[sf],\n                            target: axes[tf],\n                            dist: Biltong.lineLength(midpoints.source[axes[sf]], midpoints.target[axes[tf]])\n                        });\n                    }\n                }\n\n                candidates.sort(function (a, b) {\n                    return a.dist < b.dist ? -1 : a.dist > b.dist ? 1 : 0;\n                });\n\n                // now go through this list and try to get an entry that satisfies both (there will be one, unless one of the anchors\n                // declares no available faces)\n                var sourceEdge = candidates[0].source, targetEdge = candidates[0].target;\n                for (var i = 0; i < candidates.length; i++) {\n\n                    if (!sourceAnchor.isContinuous || sourceAnchor.isEdgeSupported(candidates[i].source))\n                        sourceEdge = candidates[i].source;\n                    else\n                        sourceEdge = null;\n\n                    if (!targetAnchor.isContinuous || targetAnchor.isEdgeSupported(candidates[i].target))\n                        targetEdge = candidates[i].target;\n                    else {\n                        targetEdge = null;\n                    }\n\n                    if (sourceEdge != null && targetEdge != null) break;\n                }\n\n// --------------------------------------------------------------------------------------\n\n                return {\n                    a: [ sourceEdge, targetEdge ],\n                    theta: theta,\n                    theta2: theta2\n                };\n            },\n        // used by placeAnchors function\n            placeAnchorsOnLine = function (desc, elementDimensions, elementPosition, connections, horizontal, otherMultiplier, reverse) {\n                var a = [], step = elementDimensions[horizontal ? 0 : 1] / (connections.length + 1);\n\n                for (var i = 0; i < connections.length; i++) {\n                    var val = (i + 1) * step, other = otherMultiplier * elementDimensions[horizontal ? 1 : 0];\n                    if (reverse)\n                        val = elementDimensions[horizontal ? 0 : 1] - val;\n\n                    var dx = (horizontal ? val : other), x = elementPosition[0] + dx, xp = dx / elementDimensions[0],\n                        dy = (horizontal ? other : val), y = elementPosition[1] + dy, yp = dy / elementDimensions[1];\n\n                    a.push([ x, y, xp, yp, connections[i][1], connections[i][2] ]);\n                }\n\n                return a;\n            },\n        // used by edgeSortFunctions\n            currySort = function (reverseAngles) {\n                return function (a, b) {\n                    var r = true;\n                    if (reverseAngles) {\n                        r = a[0][0] < b[0][0];\n                    }\n                    else {\n                        r = a[0][0] > b[0][0];\n                    }\n                    return r === false ? -1 : 1;\n                };\n            },\n        // used by edgeSortFunctions\n            leftSort = function (a, b) {\n                // first get adjusted values\n                var p1 = a[0][0] < 0 ? -Math.PI - a[0][0] : Math.PI - a[0][0],\n                    p2 = b[0][0] < 0 ? -Math.PI - b[0][0] : Math.PI - b[0][0];\n                if (p1 > p2) return 1;\n                else return a[0][1] > b[0][1] ? 1 : -1;\n            },\n        // used by placeAnchors\n            edgeSortFunctions = {\n                \"top\": function (a, b) {\n                    return a[0] > b[0] ? 1 : -1;\n                },\n                \"right\": currySort(true),\n                \"bottom\": currySort(true),\n                \"left\": leftSort\n            },\n        // used by placeAnchors\n            _sortHelper = function (_array, _fn) {\n                return _array.sort(_fn);\n            },\n        // used by AnchorManager.redraw\n            placeAnchors = function (elementId, _anchorLists) {\n                var cd = jsPlumbInstance.getCachedData(elementId), sS = cd.s, sO = cd.o,\n                    placeSomeAnchors = function (desc, elementDimensions, elementPosition, unsortedConnections, isHorizontal, otherMultiplier, orientation) {\n                        if (unsortedConnections.length > 0) {\n                            var sc = _sortHelper(unsortedConnections, edgeSortFunctions[desc]), // puts them in order based on the target element's pos on screen\n                                reverse = desc === \"right\" || desc === \"top\",\n                                anchors = placeAnchorsOnLine(desc, elementDimensions,\n                                    elementPosition, sc,\n                                    isHorizontal, otherMultiplier, reverse);\n\n                            // takes a computed anchor position and adjusts it for parent offset and scroll, then stores it.\n                            var _setAnchorLocation = function (endpoint, anchorPos) {\n                                continuousAnchorLocations[endpoint.id] = [ anchorPos[0], anchorPos[1], anchorPos[2], anchorPos[3] ];\n                                continuousAnchorOrientations[endpoint.id] = orientation;\n                            };\n\n                            for (var i = 0; i < anchors.length; i++) {\n                                var c = anchors[i][4], weAreSource = c.endpoints[0].elementId === elementId, weAreTarget = c.endpoints[1].elementId === elementId;\n                                if (weAreSource)\n                                    _setAnchorLocation(c.endpoints[0], anchors[i]);\n                                if (weAreTarget)\n                                    _setAnchorLocation(c.endpoints[1], anchors[i]);\n                            }\n                        }\n                    };\n\n                placeSomeAnchors(\"bottom\", sS, [sO.left, sO.top], _anchorLists.bottom, true, 1, [0, 1]);\n                placeSomeAnchors(\"top\", sS, [sO.left, sO.top], _anchorLists.top, true, 0, [0, -1]);\n                placeSomeAnchors(\"left\", sS, [sO.left, sO.top], _anchorLists.left, false, 0, [-1, 0]);\n                placeSomeAnchors(\"right\", sS, [sO.left, sO.top], _anchorLists.right, false, 1, [1, 0]);\n            };\n\n        this.reset = function () {\n            _amEndpoints = {};\n            connectionsByElementId = {};\n            anchorLists = {};\n        };\n        this.addFloatingConnection = function (key, conn) {\n            floatingConnections[key] = conn;\n        };\n        this.removeFloatingConnection = function (key) {\n            delete floatingConnections[key];\n        };\n        this.newConnection = function (conn) {\n            var sourceId = conn.sourceId, targetId = conn.targetId,\n                ep = conn.endpoints,\n                doRegisterTarget = true,\n                registerConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                    if ((sourceId == targetId) && otherAnchor.isContinuous) {\n                        // remove the target endpoint's canvas.  we dont need it.\n                        conn._jsPlumb.instance.removeElement(ep[1].canvas);\n                        doRegisterTarget = false;\n                    }\n                    _ju.addToList(connectionsByElementId, elId, [c, otherEndpoint, otherAnchor.constructor == _jp.DynamicAnchor]);\n                };\n\n            registerConnection(0, ep[0], ep[0].anchor, targetId, conn);\n            if (doRegisterTarget)\n                registerConnection(1, ep[1], ep[1].anchor, sourceId, conn);\n        };\n        var removeEndpointFromAnchorLists = function (endpoint) {\n            (function (list, eId) {\n                if (list) {  // transient anchors dont get entries in this list.\n                    var f = function (e) {\n                        return e[4] == eId;\n                    };\n                    _ju.removeWithFunction(list.top, f);\n                    _ju.removeWithFunction(list.left, f);\n                    _ju.removeWithFunction(list.bottom, f);\n                    _ju.removeWithFunction(list.right, f);\n                }\n            })(anchorLists[endpoint.elementId], endpoint.id);\n        };\n        this.connectionDetached = function (connInfo, doNotRedraw) {\n            var connection = connInfo.connection || connInfo,\n                sourceId = connInfo.sourceId,\n                targetId = connInfo.targetId,\n                ep = connection.endpoints,\n                removeConnection = function (otherIndex, otherEndpoint, otherAnchor, elId, c) {\n                   _ju.removeWithFunction(connectionsByElementId[elId], function (_c) {\n                        return _c[0].id == c.id;\n                    });\n                };\n\n            removeConnection(1, ep[1], ep[1].anchor, sourceId, connection);\n            removeConnection(0, ep[0], ep[0].anchor, targetId, connection);\n            if (connection.floatingId) {\n                removeConnection(connection.floatingIndex, connection.floatingEndpoint, connection.floatingEndpoint.anchor, connection.floatingId, connection);\n                removeEndpointFromAnchorLists(connection.floatingEndpoint);\n            }\n\n            // remove from anchorLists            \n            removeEndpointFromAnchorLists(connection.endpoints[0]);\n            removeEndpointFromAnchorLists(connection.endpoints[1]);\n\n            if (!doNotRedraw) {\n                self.redraw(connection.sourceId);\n                if (connection.targetId !== connection.sourceId)\n                    self.redraw(connection.targetId);\n            }\n        };\n        this.add = function (endpoint, elementId) {\n            _ju.addToList(_amEndpoints, elementId, endpoint);\n        };\n        this.changeId = function (oldId, newId) {\n            connectionsByElementId[newId] = connectionsByElementId[oldId];\n            _amEndpoints[newId] = _amEndpoints[oldId];\n            delete connectionsByElementId[oldId];\n            delete _amEndpoints[oldId];\n        };\n        this.getConnectionsFor = function (elementId) {\n            return connectionsByElementId[elementId] || [];\n        };\n        this.getEndpointsFor = function (elementId) {\n            return _amEndpoints[elementId] || [];\n        };\n        this.deleteEndpoint = function (endpoint) {\n            _ju.removeWithFunction(_amEndpoints[endpoint.elementId], function (e) {\n                return e.id == endpoint.id;\n            });\n            removeEndpointFromAnchorLists(endpoint);\n        };\n        this.clearFor = function (elementId) {\n            delete _amEndpoints[elementId];\n            _amEndpoints[elementId] = [];\n        };\n        // updates the given anchor list by either updating an existing anchor's info, or adding it. this function\n        // also removes the anchor from its previous list, if the edge it is on has changed.\n        // all connections found along the way (those that are connected to one of the faces this function\n        // operates on) are added to the connsToPaint list, as are their endpoints. in this way we know to repaint\n        // them wthout having to calculate anything else about them.\n        var _updateAnchorList = function (lists, theta, order, conn, aBoolean, otherElId, idx, reverse, edgeId, elId, connsToPaint, endpointsToPaint) {\n            // first try to find the exact match, but keep track of the first index of a matching element id along the way.s\n            var exactIdx = -1,\n                firstMatchingElIdx = -1,\n                endpoint = conn.endpoints[idx],\n                endpointId = endpoint.id,\n                oIdx = [1, 0][idx],\n                values = [\n                    [ theta, order ],\n                    conn,\n                    aBoolean,\n                    otherElId,\n                    endpointId\n                ],\n                listToAddTo = lists[edgeId],\n                listToRemoveFrom = endpoint._continuousAnchorEdge ? lists[endpoint._continuousAnchorEdge] : null,\n                i,\n                candidate;\n\n            if (listToRemoveFrom) {\n                var rIdx = _ju.findWithFunction(listToRemoveFrom, function (e) {\n                    return e[4] == endpointId;\n                });\n                if (rIdx != -1) {\n                    listToRemoveFrom.splice(rIdx, 1);\n                    // get all connections from this list\n                    for (i = 0; i < listToRemoveFrom.length; i++) {\n                        candidate = listToRemoveFrom[i][1];\n                        _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                            return c.id == candidate.id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[idx], function (e) {\n                            return e.id == candidate.endpoints[idx].id;\n                        });\n                        _ju.addWithFunction(endpointsToPaint, listToRemoveFrom[i][1].endpoints[oIdx], function (e) {\n                            return e.id == candidate.endpoints[oIdx].id;\n                        });\n                    }\n                }\n            }\n\n            for (i = 0; i < listToAddTo.length; i++) {\n                candidate = listToAddTo[i][1];\n                if (params.idx == 1 && listToAddTo[i][3] === otherElId && firstMatchingElIdx == -1)\n                    firstMatchingElIdx = i;\n                _ju.addWithFunction(connsToPaint, candidate, function (c) {\n                    return c.id == candidate.id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[idx], function (e) {\n                    return e.id == candidate.endpoints[idx].id;\n                });\n                _ju.addWithFunction(endpointsToPaint, listToAddTo[i][1].endpoints[oIdx], function (e) {\n                    return e.id == candidate.endpoints[oIdx].id;\n                });\n            }\n            if (exactIdx != -1) {\n                listToAddTo[exactIdx] = values;\n            }\n            else {\n                var insertIdx = reverse ? firstMatchingElIdx != -1 ? firstMatchingElIdx : 0 : listToAddTo.length; // of course we will get this from having looked through the array shortly.\n                listToAddTo.splice(insertIdx, 0, values);\n            }\n\n            // store this for next time.\n            endpoint._continuousAnchorEdge = edgeId;\n        };\n\n        //\n        // find the entry in an endpoint's list for this connection and update its target endpoint\n        // with the current target in the connection.\n        // This method and sourceChanged need to be folder into one.\n        //\n        this.updateOtherEndpoint = function (sourceElId, oldTargetId, newTargetId, connection) {\n            var sIndex = _ju.findWithFunction(connectionsByElementId[sourceElId], function (i) {\n                    return i[0].id === connection.id;\n                }),\n                tIndex = _ju.findWithFunction(connectionsByElementId[oldTargetId], function (i) {\n                    return i[0].id === connection.id;\n                });\n\n            // update or add data for source\n            if (sIndex != -1) {\n                connectionsByElementId[sourceElId][sIndex][0] = connection;\n                connectionsByElementId[sourceElId][sIndex][1] = connection.endpoints[1];\n                connectionsByElementId[sourceElId][sIndex][2] = connection.endpoints[1].anchor.constructor == _jp.DynamicAnchor;\n            }\n\n            // remove entry for previous target (if there)\n            if (tIndex > -1) {\n                connectionsByElementId[oldTargetId].splice(tIndex, 1);\n                // add entry for new target\n                _ju.addToList(connectionsByElementId, newTargetId, [connection, connection.endpoints[0], connection.endpoints[0].anchor.constructor == _jp.DynamicAnchor]);\n            }\n\n            connection.updateConnectedClass();\n        };\n\n        //\n        // notification that the connection given has changed source from the originalId to the newId.\n        // This involves:\n        // 1. removing the connection from the list of connections stored for the originalId\n        // 2. updating the source information for the target of the connection\n        // 3. re-registering the connection in connectionsByElementId with the newId\n        //\n        this.sourceChanged = function (originalId, newId, connection, newElement) {\n            if (originalId !== newId) {\n\n                connection.sourceId = newId;\n                connection.source = newElement;\n\n                // remove the entry that points from the old source to the target\n                _ju.removeWithFunction(connectionsByElementId[originalId], function (info) {\n                    return info[0].id === connection.id;\n                });\n                // find entry for target and update it\n                var tIdx = _ju.findWithFunction(connectionsByElementId[connection.targetId], function (i) {\n                    return i[0].id === connection.id;\n                });\n                if (tIdx > -1) {\n                    connectionsByElementId[connection.targetId][tIdx][0] = connection;\n                    connectionsByElementId[connection.targetId][tIdx][1] = connection.endpoints[0];\n                    connectionsByElementId[connection.targetId][tIdx][2] = connection.endpoints[0].anchor.constructor == _jp.DynamicAnchor;\n                }\n                // add entry for new source\n                _ju.addToList(connectionsByElementId, newId, [connection, connection.endpoints[1], connection.endpoints[1].anchor.constructor == _jp.DynamicAnchor]);\n\n                // TODO SP not final on this yet. when a user drags an existing connection and it turns into a self\n                // loop, then this code hides the target endpoint (by removing it from the DOM) But I think this should\n                // occur only if the anchor is Continuous\n                if (connection.endpoints[1].anchor.isContinuous) {\n                    if (connection.source === connection.target) {\n                        connection._jsPlumb.instance.removeElement(connection.endpoints[1].canvas);\n                    }\n                    else {\n                        if (connection.endpoints[1].canvas.parentNode == null) {\n                            connection._jsPlumb.instance.appendElement(connection.endpoints[1].canvas);\n                        }\n                    }\n                }\n\n                connection.updateConnectedClass();\n            }\n        };\n\n        //\n        // moves the given endpoint from `currentId` to `element`.\n        // This involves:\n        //\n        // 1. changing the key in _amEndpoints under which the endpoint is stored\n        // 2. changing the source or target values in all of the endpoint's connections\n        // 3. changing the array in connectionsByElementId in which the endpoint's connections\n        //    are stored (done by either sourceChanged or updateOtherEndpoint)\n        //\n        this.rehomeEndpoint = function (ep, currentId, element) {\n            var eps = _amEndpoints[currentId] || [],\n                elementId = jsPlumbInstance.getId(element);\n\n            if (elementId !== currentId) {\n                var idx = eps.indexOf(ep);\n                if (idx > -1) {\n                    var _ep = eps.splice(idx, 1)[0];\n                    self.add(_ep, elementId);\n                }\n            }\n\n            for (var i = 0; i < ep.connections.length; i++) {\n                if (ep.connections[i].sourceId == currentId) {\n                    //ep.connections[i].sourceId = ep.elementId;\n                    //ep.connections[i].source = ep.element;\n                    self.sourceChanged(currentId, ep.elementId, ep.connections[i], ep.element);\n                }\n                else if (ep.connections[i].targetId == currentId) {\n                    ep.connections[i].targetId = ep.elementId;\n                    ep.connections[i].target = ep.element;\n                    self.updateOtherEndpoint(ep.connections[i].sourceId, currentId, ep.elementId, ep.connections[i]);\n                }\n            }\n        };\n\n        this.redraw = function (elementId, ui, timestamp, offsetToUI, clearEdits, doNotRecalcEndpoint) {\n\n            if (!jsPlumbInstance.isSuspendDrawing()) {\n                // get all the endpoints for this element\n                var ep = _amEndpoints[elementId] || [],\n                    endpointConnections = connectionsByElementId[elementId] || [],\n                    connectionsToPaint = [],\n                    endpointsToPaint = [],\n                    anchorsToUpdate = [];\n\n                timestamp = timestamp || jsPlumbInstance.timestamp();\n                // offsetToUI are values that would have been calculated in the dragManager when registering\n                // an endpoint for an element that had a parent (somewhere in the hierarchy) that had been\n                // registered as draggable.\n                offsetToUI = offsetToUI || {left: 0, top: 0};\n                if (ui) {\n                    ui = {\n                        left: ui.left + offsetToUI.left,\n                        top: ui.top + offsetToUI.top\n                    };\n                }\n\n                // valid for one paint cycle.\n                var myOffset = jsPlumbInstance.updateOffset({ elId: elementId, offset: ui, recalc: false, timestamp: timestamp }),\n                    orientationCache = {};\n\n                // actually, first we should compute the orientation of this element to all other elements to which\n                // this element is connected with a continuous anchor (whether both ends of the connection have\n                // a continuous anchor or just one)\n\n                for (var i = 0; i < endpointConnections.length; i++) {\n                    var conn = endpointConnections[i][0],\n                        sourceId = conn.sourceId,\n                        targetId = conn.targetId,\n                        sourceContinuous = conn.endpoints[0].anchor.isContinuous,\n                        targetContinuous = conn.endpoints[1].anchor.isContinuous;\n\n                    if (sourceContinuous || targetContinuous) {\n                        var oKey = sourceId + \"_\" + targetId,\n                            o = orientationCache[oKey],\n                            oIdx = conn.sourceId == elementId ? 1 : 0;\n\n                        if (sourceContinuous && !anchorLists[sourceId]) anchorLists[sourceId] = { top: [], right: [], bottom: [], left: [] };\n                        if (targetContinuous && !anchorLists[targetId]) anchorLists[targetId] = { top: [], right: [], bottom: [], left: [] };\n\n                        if (elementId != targetId) jsPlumbInstance.updateOffset({ elId: targetId, timestamp: timestamp });\n                        if (elementId != sourceId) jsPlumbInstance.updateOffset({ elId: sourceId, timestamp: timestamp });\n\n                        var td = jsPlumbInstance.getCachedData(targetId),\n                            sd = jsPlumbInstance.getCachedData(sourceId);\n\n                        if (targetId == sourceId && (sourceContinuous || targetContinuous)) {\n                            // here we may want to improve this by somehow determining the face we'd like\n                            // to put the connector on.  ideally, when drawing, the face should be calculated\n                            // by determining which face is closest to the point at which the mouse button\n                            // was released.  for now, we're putting it on the top face.\n                            _updateAnchorList( anchorLists[sourceId], -Math.PI / 2, 0, conn, false, targetId, 0, false, \"top\", sourceId, connectionsToPaint, endpointsToPaint);\n                            _updateAnchorList( anchorLists[targetId], -Math.PI / 2, 0, conn, false, sourceId, 1, false, \"top\", targetId, connectionsToPaint, endpointsToPaint);\n                        }\n                        else {\n                            if (!o) {\n                                o = calculateOrientation(sourceId, targetId, sd.o, td.o, conn.endpoints[0].anchor, conn.endpoints[1].anchor);\n                                orientationCache[oKey] = o;\n                                // this would be a performance enhancement, but the computed angles need to be clamped to\n                                //the (-PI/2 -> PI/2) range in order for the sorting to work properly.\n                                /*  orientationCache[oKey2] = {\n                                 orientation:o.orientation,\n                                 a:[o.a[1], o.a[0]],\n                                 theta:o.theta + Math.PI,\n                                 theta2:o.theta2 + Math.PI\n                                 };*/\n                            }\n                            if (sourceContinuous) _updateAnchorList(anchorLists[sourceId], o.theta, 0, conn, false, targetId, 0, false, o.a[0], sourceId, connectionsToPaint, endpointsToPaint);\n                            if (targetContinuous) _updateAnchorList(anchorLists[targetId], o.theta2, -1, conn, true, sourceId, 1, true, o.a[1], targetId, connectionsToPaint, endpointsToPaint);\n                        }\n\n                        if (sourceContinuous) _ju.addWithFunction(anchorsToUpdate, sourceId, function (a) {\n                            return a === sourceId;\n                        });\n                        if (targetContinuous) _ju.addWithFunction(anchorsToUpdate, targetId, function (a) {\n                            return a === targetId;\n                        });\n                        _ju.addWithFunction(connectionsToPaint, conn, function (c) {\n                            return c.id == conn.id;\n                        });\n                        if ((sourceContinuous && oIdx === 0) || (targetContinuous && oIdx === 1))\n                            _ju.addWithFunction(endpointsToPaint, conn.endpoints[oIdx], function (e) {\n                                return e.id == conn.endpoints[oIdx].id;\n                            });\n                    }\n                }\n\n                // place Endpoints whose anchors are continuous but have no Connections\n                for (i = 0; i < ep.length; i++) {\n                    if (ep[i].connections.length === 0 && ep[i].anchor.isContinuous) {\n                        if (!anchorLists[elementId]) anchorLists[elementId] = { top: [], right: [], bottom: [], left: [] };\n                        _updateAnchorList(anchorLists[elementId], -Math.PI / 2, 0, {endpoints: [ep[i], ep[i]], paint: function () {\n                        }}, false, elementId, 0, false, ep[i].anchor.getDefaultFace(), elementId, connectionsToPaint, endpointsToPaint);\n                        _ju.addWithFunction(anchorsToUpdate, elementId, function (a) {\n                            return a === elementId;\n                        });\n                    }\n                }\n\n\n                // now place all the continuous anchors we need to;\n                for (i = 0; i < anchorsToUpdate.length; i++) {\n                    placeAnchors(anchorsToUpdate[i], anchorLists[anchorsToUpdate[i]]);\n                }\n\n                // now that continuous anchors have been placed, paint all the endpoints for this element\n                // TODO performance: add the endpoint ids to a temp array, and then when iterating in the next\n                // loop, check that we didn't just paint that endpoint. we can probably shave off a few more milliseconds this way.\n                for (i = 0; i < ep.length; i++) {\n                    ep[i].paint({ timestamp: timestamp, offset: myOffset, dimensions: myOffset.s, recalc: doNotRecalcEndpoint !== true });\n                }\n\n                // ... and any other endpoints we came across as a result of the continuous anchors.\n                for (i = 0; i < endpointsToPaint.length; i++) {\n                    var cd = jsPlumbInstance.getCachedData(endpointsToPaint[i].elementId);\n                    endpointsToPaint[i].paint({ timestamp: timestamp, offset: cd, dimensions: cd.s });\n                }\n\n                // paint all the standard and \"dynamic connections\", which are connections whose other anchor is\n                // static and therefore does need to be recomputed; we make sure that happens only one time.\n\n                // TODO we could have compiled a list of these in the first pass through connections; might save some time.\n                for (i = 0; i < endpointConnections.length; i++) {\n                    var otherEndpoint = endpointConnections[i][1];\n                    if (otherEndpoint.anchor.constructor == _jp.DynamicAnchor) {\n                        otherEndpoint.paint({ elementWithPrecedence: elementId, timestamp: timestamp });\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id == endpointConnections[i][0].id;\n                        });\n                        // all the connections for the other endpoint now need to be repainted\n                        for (var k = 0; k < otherEndpoint.connections.length; k++) {\n                            if (otherEndpoint.connections[k] !== endpointConnections[i][0])\n                                _ju.addWithFunction(connectionsToPaint, otherEndpoint.connections[k], function (c) {\n                                    return c.id == otherEndpoint.connections[k].id;\n                                });\n                        }\n                    } else if (otherEndpoint.anchor.constructor == _jp.Anchor) {\n                        _ju.addWithFunction(connectionsToPaint, endpointConnections[i][0], function (c) {\n                            return c.id == endpointConnections[i][0].id;\n                        });\n                    }\n                }\n\n                // paint current floating connection for this element, if there is one.\n                var fc = floatingConnections[elementId];\n                if (fc)\n                    fc.paint({timestamp: timestamp, recalc: false, elId: elementId});\n\n                // paint all the connections\n                for (i = 0; i < connectionsToPaint.length; i++) {\n                    connectionsToPaint[i].paint({elId: elementId, timestamp: timestamp, recalc: false, clearEdits: clearEdits});\n                }\n            }\n        };\n\n        var ContinuousAnchor = function (anchorParams) {\n            _ju.EventGenerator.apply(this);\n            this.type = \"Continuous\";\n            this.isDynamic = true;\n            this.isContinuous = true;\n            var faces = anchorParams.faces || [\"top\", \"right\", \"bottom\", \"left\"],\n                clockwise = !(anchorParams.clockwise === false),\n                availableFaces = { },\n                opposites = { \"top\": \"bottom\", \"right\": \"left\", \"left\": \"right\", \"bottom\": \"top\" },\n                clockwiseOptions = { \"top\": \"right\", \"right\": \"bottom\", \"left\": \"top\", \"bottom\": \"left\" },\n                antiClockwiseOptions = { \"top\": \"left\", \"right\": \"top\", \"left\": \"bottom\", \"bottom\": \"right\" },\n                secondBest = clockwise ? clockwiseOptions : antiClockwiseOptions,\n                lastChoice = clockwise ? antiClockwiseOptions : clockwiseOptions,\n                cssClass = anchorParams.cssClass || \"\";\n\n            for (var i = 0; i < faces.length; i++) {\n                availableFaces[faces[i]] = true;\n            }\n\n            this.getDefaultFace = function () {\n                return faces.length === 0 ? \"top\" : faces[0];\n            };\n\n            // if the given edge is supported, returns it. otherwise looks for a substitute that _is_\n            // supported. if none supported we also return the request edge.\n            this.verifyEdge = function (edge) {\n                if (availableFaces[edge]) return edge;\n                else if (availableFaces[opposites[edge]]) return opposites[edge];\n                else if (availableFaces[secondBest[edge]]) return secondBest[edge];\n                else if (availableFaces[lastChoice[edge]]) return lastChoice[edge];\n                return edge; // we have to give them something.\n            };\n\n            this.isEdgeSupported = function (edge) {\n                return availableFaces[edge] === true;\n            };\n\n            this.compute = function (params) {\n                return userDefinedContinuousAnchorLocations[params.element.id] || continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getCurrentLocation = function (params) {\n                return userDefinedContinuousAnchorLocations[params.element.id] || continuousAnchorLocations[params.element.id] || [0, 0];\n            };\n            this.getOrientation = function (endpoint) {\n                return continuousAnchorOrientations[endpoint.id] || [0, 0];\n            };\n            this.clearUserDefinedLocation = function () {\n                delete userDefinedContinuousAnchorLocations[anchorParams.elementId];\n            };\n            this.setUserDefinedLocation = function (loc) {\n                userDefinedContinuousAnchorLocations[anchorParams.elementId] = loc;\n            };\n            this.getCssClass = function () {\n                return cssClass;\n            };\n        };\n\n        // continuous anchors\n        jsPlumbInstance.continuousAnchorFactory = {\n            get: function (params) {\n                return new ContinuousAnchor(params);\n            },\n            clear: function (elementId) {\n                delete userDefinedContinuousAnchorLocations[elementId];\n                delete continuousAnchorLocations[elementId];\n            }\n        };\n    };\n\n    /**\n     * Anchors model a position on some element at which an Endpoint may be located.  They began as a first class citizen of jsPlumb, ie. a user\n     * was required to create these themselves, but over time this has been replaced by the concept of referring to them either by name (eg. \"TopMiddle\"),\n     * or by an array describing their coordinates (eg. [ 0, 0.5, 0, -1 ], which is the same as \"TopMiddle\").  jsPlumb now handles all of the\n     * creation of Anchors without user intervention.\n     */\n    _jp.Anchor = function (params) {\n        this.x = params.x || 0;\n        this.y = params.y || 0;\n        this.elementId = params.elementId;\n        this.cssClass = params.cssClass || \"\";\n        this.userDefinedLocation = null;\n        this.orientation = params.orientation || [ 0, 0 ];\n        this.lastReturnValue = null;\n        this.offsets = params.offsets || [ 0, 0 ];\n        this.timestamp = null;\n\n        _ju.EventGenerator.apply(this);\n\n        this.compute = function (params) {\n\n            var xy = params.xy, wh = params.wh, timestamp = params.timestamp;\n\n            if (params.clearUserDefinedLocation)\n                this.userDefinedLocation = null;\n\n            if (timestamp && timestamp === self.timestamp)\n                return this.lastReturnValue;\n\n            if (this.userDefinedLocation != null) {\n                this.lastReturnValue = this.userDefinedLocation;\n            }\n            else {\n                this.lastReturnValue = [ xy[0] + (this.x * wh[0]) + this.offsets[0], xy[1] + (this.y * wh[1]) + this.offsets[1] ];\n            }\n\n            this.timestamp = timestamp;\n            return this.lastReturnValue;\n        };\n\n        this.getCurrentLocation = function (params) {\n            params = params || {};\n            return (this.lastReturnValue == null || (params.timestamp != null && this.timestamp != params.timestamp)) ? this.compute(params) : this.lastReturnValue;\n        };\n    };\n    _ju.extend(_jp.Anchor, _ju.EventGenerator, {\n        equals: function (anchor) {\n            if (!anchor) return false;\n            var ao = anchor.getOrientation(),\n                o = this.getOrientation();\n            return this.x == anchor.x && this.y == anchor.y && this.offsets[0] == anchor.offsets[0] && this.offsets[1] == anchor.offsets[1] && o[0] == ao[0] && o[1] == ao[1];\n        },\n        getUserDefinedLocation: function () {\n            return this.userDefinedLocation;\n        },\n        setUserDefinedLocation: function (l) {\n            this.userDefinedLocation = l;\n        },\n        clearUserDefinedLocation: function () {\n            this.userDefinedLocation = null;\n        },\n        getOrientation: function () {\n            return this.orientation;\n        },\n        getCssClass: function () {\n            return this.cssClass;\n        }\n    });\n\n    /**\n     * An Anchor that floats. its orientation is computed dynamically from\n     * its position relative to the anchor it is floating relative to.  It is used when creating\n     * a connection through drag and drop.\n     *\n     * TODO FloatingAnchor could totally be refactored to extend Anchor just slightly.\n     */\n    _jp.FloatingAnchor = function (params) {\n\n        _jp.Anchor.apply(this, arguments);\n\n        // this is the anchor that this floating anchor is referenced to for\n        // purposes of calculating the orientation.\n        var ref = params.reference,\n            // the canvas this refers to.\n            refCanvas = params.referenceCanvas,\n            size = _jp.getSize(refCanvas),\n            // these are used to store the current relative position of our\n            // anchor wrt the reference anchor. they only indicate\n            // direction, so have a value of 1 or -1 (or, very rarely, 0). these\n            // values are written by the compute method, and read\n            // by the getOrientation method.\n            xDir = 0, yDir = 0,\n            // temporary member used to store an orientation when the floating\n            // anchor is hovering over another anchor.\n            orientation = null,\n            _lastResult = null;\n\n        // clear from parent. we want floating anchor orientation to always be computed.\n        this.orientation = null;\n\n        // set these to 0 each; they are used by certain types of connectors in the loopback case,\n        // when the connector is trying to clear the element it is on. but for floating anchor it's not\n        // very important.\n        this.x = 0;\n        this.y = 0;\n\n        this.isFloating = true;\n\n        this.compute = function (params) {\n            var xy = params.xy,\n                result = [ xy[0] + (size[0] / 2), xy[1] + (size[1] / 2) ]; // return origin of the element. we may wish to improve this so that any object can be the drag proxy.\n            _lastResult = result;\n            return result;\n        };\n\n        this.getOrientation = function (_endpoint) {\n            if (orientation) return orientation;\n            else {\n                var o = ref.getOrientation(_endpoint);\n                // here we take into account the orientation of the other\n                // anchor: if it declares zero for some direction, we declare zero too. this might not be the most awesome. perhaps we can come\n                // up with a better way. it's just so that the line we draw looks like it makes sense. maybe this wont make sense.\n                return [ Math.abs(o[0]) * xDir * -1,\n                        Math.abs(o[1]) * yDir * -1 ];\n            }\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is hovering\n         * over another anchor; we want to assume that anchor's orientation\n         * for the duration of the hover.\n         */\n        this.over = function (anchor, endpoint) {\n            orientation = anchor.getOrientation(endpoint);\n        };\n\n        /**\n         * notification the endpoint associated with this anchor is no\n         * longer hovering over another anchor; we should resume calculating\n         * orientation as we normally do.\n         */\n        this.out = function () {\n            orientation = null;\n        };\n\n        this.getCurrentLocation = function (params) {\n            return _lastResult == null ? this.compute(params) : _lastResult;\n        };\n    };\n    _ju.extend(_jp.FloatingAnchor, _jp.Anchor);\n\n    var _convertAnchor = function (anchor, jsPlumbInstance, elementId) {\n        return anchor.constructor == _jp.Anchor ? anchor : jsPlumbInstance.makeAnchor(anchor, elementId, jsPlumbInstance);\n    };\n\n    /* \n     * A DynamicAnchor is an Anchor that contains a list of other Anchors, which it cycles\n     * through at compute time to find the one that is located closest to\n     * the center of the target element, and returns that Anchor's compute\n     * method result. this causes endpoints to follow each other with\n     * respect to the orientation of their target elements, which is a useful\n     * feature for some applications.\n     * \n     */\n    _jp.DynamicAnchor = function (params) {\n        _jp.Anchor.apply(this, arguments);\n\n        this.isDynamic = true;\n        this.anchors = [];\n        this.elementId = params.elementId;\n        this.jsPlumbInstance = params.jsPlumbInstance;\n\n        for (var i = 0; i < params.anchors.length; i++)\n            this.anchors[i] = _convertAnchor(params.anchors[i], this.jsPlumbInstance, this.elementId);\n\n        this.getAnchors = function () {\n            return this.anchors;\n        };\n        this.locked = false;\n        var _curAnchor = this.anchors.length > 0 ? this.anchors[0] : null,\n            _lastAnchor = _curAnchor,\n            self = this,\n\n        // helper method to calculate the distance between the centers of the two elements.\n            _distance = function (anchor, cx, cy, xy, wh) {\n                var ax = xy[0] + (anchor.x * wh[0]), ay = xy[1] + (anchor.y * wh[1]),\n                    acx = xy[0] + (wh[0] / 2), acy = xy[1] + (wh[1] / 2);\n                return (Math.sqrt(Math.pow(cx - ax, 2) + Math.pow(cy - ay, 2)) +\n                    Math.sqrt(Math.pow(acx - ax, 2) + Math.pow(acy - ay, 2)));\n            },\n        // default method uses distance between element centers.  you can provide your own method in the dynamic anchor\n        // constructor (and also to jsPlumb.makeDynamicAnchor). the arguments to it are four arrays:\n        // xy - xy loc of the anchor's element\n        // wh - anchor's element's dimensions\n        // txy - xy loc of the element of the other anchor in the connection\n        // twh - dimensions of the element of the other anchor in the connection.\n        // anchors - the list of selectable anchors\n            _anchorSelector = params.selector || function (xy, wh, txy, twh, anchors) {\n                var cx = txy[0] + (twh[0] / 2), cy = txy[1] + (twh[1] / 2);\n                var minIdx = -1, minDist = Infinity;\n                for (var i = 0; i < anchors.length; i++) {\n                    var d = _distance(anchors[i], cx, cy, xy, wh);\n                    if (d < minDist) {\n                        minIdx = i + 0;\n                        minDist = d;\n                    }\n                }\n                return anchors[minIdx];\n            };\n\n        this.compute = function (params) {\n            var xy = params.xy, wh = params.wh, txy = params.txy, twh = params.twh;\n\n            this.timestamp = params.timestamp;\n\n            var udl = self.getUserDefinedLocation();\n            if (udl != null) {\n                return udl;\n            }\n\n            // if anchor is locked or an opposite element was not given, we\n            // maintain our state. anchor will be locked\n            // if it is the source of a drag and drop.\n            if (this.locked || txy == null || twh == null)\n                return _curAnchor.compute(params);\n            else\n                params.timestamp = null; // otherwise clear this, i think. we want the anchor to compute.\n\n            _curAnchor = _anchorSelector(xy, wh, txy, twh, this.anchors);\n            this.x = _curAnchor.x;\n            this.y = _curAnchor.y;\n\n            if (_curAnchor != _lastAnchor)\n                this.fire(\"anchorChanged\", _curAnchor);\n\n            _lastAnchor = _curAnchor;\n\n            return _curAnchor.compute(params);\n        };\n\n        this.getCurrentLocation = function (params) {\n            return this.getUserDefinedLocation() || (_curAnchor != null ? _curAnchor.getCurrentLocation(params) : null);\n        };\n\n        this.getOrientation = function (_endpoint) {\n            return _curAnchor != null ? _curAnchor.getOrientation(_endpoint) : [ 0, 0 ];\n        };\n        this.over = function (anchor, endpoint) {\n            if (_curAnchor != null) _curAnchor.over(anchor, endpoint);\n        };\n        this.out = function () {\n            if (_curAnchor != null) _curAnchor.out();\n        };\n\n        this.getCssClass = function () {\n            return (_curAnchor && _curAnchor.getCssClass()) || \"\";\n        };\n    };\n    _ju.extend(_jp.DynamicAnchor, _jp.Anchor);\n\n// -------- basic anchors ------------------    \n    var _curryAnchor = function (x, y, ox, oy, type, fnInit) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([ x, y, ox, oy, 0, 0 ], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            if (fnInit) fnInit(a, params);\n            return a;\n        };\n    };\n\n    _curryAnchor(0.5, 0, 0, -1, \"TopCenter\");\n    _curryAnchor(0.5, 1, 0, 1, \"BottomCenter\");\n    _curryAnchor(0, 0.5, -1, 0, \"LeftMiddle\");\n    _curryAnchor(1, 0.5, 1, 0, \"RightMiddle\");\n\n    _curryAnchor(0.5, 0, 0, -1, \"Top\");\n    _curryAnchor(0.5, 1, 0, 1, \"Bottom\");\n    _curryAnchor(0, 0.5, -1, 0, \"Left\");\n    _curryAnchor(1, 0.5, 1, 0, \"Right\");\n    _curryAnchor(0.5, 0.5, 0, 0, \"Center\");\n    _curryAnchor(1, 0, 0, -1, \"TopRight\");\n    _curryAnchor(1, 1, 0, 1, \"BottomRight\");\n    _curryAnchor(0, 0, 0, -1, \"TopLeft\");\n    _curryAnchor(0, 1, 0, 1, \"BottomLeft\");\n\n// ------- dynamic anchors -------------------    \n\n    // default dynamic anchors chooses from Top, Right, Bottom, Left\n    _jp.Defaults.DynamicAnchors = function (params) {\n        return params.jsPlumbInstance.makeAnchors([\"TopCenter\", \"RightMiddle\", \"BottomCenter\", \"LeftMiddle\"], params.elementId, params.jsPlumbInstance);\n    };\n\n    // default dynamic anchors bound to name 'AutoDefault'\n    _jp.Anchors.AutoDefault = function (params) {\n        var a = params.jsPlumbInstance.makeDynamicAnchor(_jp.Defaults.DynamicAnchors(params));\n        a.type = \"AutoDefault\";\n        return a;\n    };\n\n// ------- continuous anchors -------------------    \n\n    var _curryContinuousAnchor = function (type, faces) {\n        _jp.Anchors[type] = function (params) {\n            var a = params.jsPlumbInstance.makeAnchor([\"Continuous\", { faces: faces }], params.elementId, params.jsPlumbInstance);\n            a.type = type;\n            return a;\n        };\n    };\n\n    _jp.Anchors.Continuous = function (params) {\n        return params.jsPlumbInstance.continuousAnchorFactory.get(params);\n    };\n\n    _curryContinuousAnchor(\"ContinuousLeft\", [\"left\"]);\n    _curryContinuousAnchor(\"ContinuousTop\", [\"top\"]);\n    _curryContinuousAnchor(\"ContinuousBottom\", [\"bottom\"]);\n    _curryContinuousAnchor(\"ContinuousRight\", [\"right\"]);\n\n// ------- position assign anchors -------------------    \n\n    // this anchor type lets you assign the position at connection time.\n    _curryAnchor(0, 0, 0, 0, \"Assign\", function (anchor, params) {\n        // find what to use as the \"position finder\". the user may have supplied a String which represents\n        // the id of a position finder in jsPlumb.AnchorPositionFinders, or the user may have supplied the\n        // position finder as a function.  we find out what to use and then set it on the anchor.\n        var pf = params.position || \"Fixed\";\n        anchor.positionFinder = pf.constructor == String ? params.jsPlumbInstance.AnchorPositionFinders[pf] : pf;\n        // always set the constructor params; the position finder might need them later (the Grid one does,\n        // for example)\n        anchor.constructorParams = params;\n    });\n\n    // these are the default anchor positions finders, which are used by the makeTarget function.  supplying\n    // a position finder argument to that function allows you to specify where the resulting anchor will\n    // be located\n    root.jsPlumbInstance.prototype.AnchorPositionFinders = {\n        \"Fixed\": function (dp, ep, es) {\n            return [ (dp.left - ep.left) / es[0], (dp.top - ep.top) / es[1] ];\n        },\n        \"Grid\": function (dp, ep, es, params) {\n            var dx = dp.left - ep.left, dy = dp.top - ep.top,\n                gx = es[0] / (params.grid[0]), gy = es[1] / (params.grid[1]),\n                mx = Math.floor(dx / gx), my = Math.floor(dy / gy);\n            return [ ((mx * gx) + (gx / 2)) / es[0], ((my * gy) + (gy / 2)) / es[1] ];\n        }\n    };\n\n// ------- perimeter anchors -------------------    \n\n    _jp.Anchors.Perimeter = function (params) {\n        params = params || {};\n        var anchorCount = params.anchorCount || 60,\n            shape = params.shape;\n\n        if (!shape) throw new Error(\"no shape supplied to Perimeter Anchor type\");\n\n        var _circle = function () {\n                var r = 0.5, step = Math.PI * 2 / anchorCount, current = 0, a = [];\n                for (var i = 0; i < anchorCount; i++) {\n                    var x = r + (r * Math.sin(current)),\n                        y = r + (r * Math.cos(current));\n                    a.push([ x, y, 0, 0 ]);\n                    current += step;\n                }\n                return a;\n            },\n            _path = function (segments) {\n                var anchorsPerFace = anchorCount / segments.length, a = [],\n                    _computeFace = function (x1, y1, x2, y2, fractionalLength) {\n                        anchorsPerFace = anchorCount * fractionalLength;\n                        var dx = (x2 - x1) / anchorsPerFace, dy = (y2 - y1) / anchorsPerFace;\n                        for (var i = 0; i < anchorsPerFace; i++) {\n                            a.push([\n                                    x1 + (dx * i),\n                                    y1 + (dy * i),\n                                0,\n                                0\n                            ]);\n                        }\n                    };\n\n                for (var i = 0; i < segments.length; i++)\n                    _computeFace.apply(null, segments[i]);\n\n                return a;\n            },\n            _shape = function (faces) {\n                var s = [];\n                for (var i = 0; i < faces.length; i++) {\n                    s.push([faces[i][0], faces[i][1], faces[i][2], faces[i][3], 1 / faces.length]);\n                }\n                return _path(s);\n            },\n            _rectangle = function () {\n                return _shape([\n                    [ 0, 0, 1, 0 ],\n                    [ 1, 0, 1, 1 ],\n                    [ 1, 1, 0, 1 ],\n                    [ 0, 1, 0, 0 ]\n                ]);\n            };\n\n        var _shapes = {\n                \"Circle\": _circle,\n                \"Ellipse\": _circle,\n                \"Diamond\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 0.5 ],\n                        [ 1, 0.5, 0.5, 1 ],\n                        [ 0.5, 1, 0, 0.5 ],\n                        [ 0, 0.5, 0.5, 0 ]\n                    ]);\n                },\n                \"Rectangle\": _rectangle,\n                \"Square\": _rectangle,\n                \"Triangle\": function () {\n                    return _shape([\n                        [ 0.5, 0, 1, 1 ],\n                        [ 1, 1, 0, 1 ],\n                        [ 0, 1, 0.5, 0]\n                    ]);\n                },\n                \"Path\": function (params) {\n                    var points = params.points, p = [], tl = 0;\n                    for (var i = 0; i < points.length - 1; i++) {\n                        var l = Math.sqrt(Math.pow(points[i][2] - points[i][0]) + Math.pow(points[i][3] - points[i][1]));\n                        tl += l;\n                        p.push([points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], l]);\n                    }\n                    for (var j = 0; j < p.length; j++) {\n                        p[j][4] = p[j][4] / tl;\n                    }\n                    return _path(p);\n                }\n            },\n            _rotate = function (points, amountInDegrees) {\n                var o = [], theta = amountInDegrees / 180 * Math.PI;\n                for (var i = 0; i < points.length; i++) {\n                    var _x = points[i][0] - 0.5,\n                        _y = points[i][1] - 0.5;\n\n                    o.push([\n                            0.5 + ((_x * Math.cos(theta)) - (_y * Math.sin(theta))),\n                            0.5 + ((_x * Math.sin(theta)) + (_y * Math.cos(theta))),\n                        points[i][2],\n                        points[i][3]\n                    ]);\n                }\n                return o;\n            };\n\n        if (!_shapes[shape]) throw new Error(\"Shape [\" + shape + \"] is unknown by Perimeter Anchor type\");\n\n        var da = _shapes[shape](params);\n        if (params.rotation) da = _rotate(da, params.rotation);\n        var a = params.jsPlumbInstance.makeDynamicAnchor(da);\n        a.type = \"Perimeter\";\n        return a;\n    };\n}).call(typeof window !== 'undefined' ? window : this);\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the default Connectors, Endpoint and Overlay definitions.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil, _jg = root.Biltong;\n\n    _jp.Segments = {\n\n        /*\n         * Class: AbstractSegment\n         * A Connector is made up of 1..N Segments, each of which has a Type, such as 'Straight', 'Arc',\n         * 'Bezier'. This is new from 1.4.2, and gives us a lot more flexibility when drawing connections: things such\n         * as rounded corners for flowchart connectors, for example, or a straight line stub for Bezier connections, are\n         * much easier to do now.\n         *\n         * A Segment is responsible for providing coordinates for painting it, and also must be able to report its length.\n         * \n         */\n        AbstractSegment: function (params) {\n            this.params = params;\n\n            /**\n             * Function: findClosestPointOnPath\n             * Finds the closest point on this segment to the given [x, y],\n             * returning both the x and y of the point plus its distance from\n             * the supplied point, and its location along the length of the\n             * path inscribed by the segment.  This implementation returns\n             * Infinity for distance and null values for everything else;\n             * subclasses are expected to override.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                return {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null\n                };\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(params.x1, params.x2),\n                    minY: Math.min(params.y1, params.y2),\n                    maxX: Math.max(params.x1, params.x2),\n                    maxY: Math.max(params.y1, params.y2)\n                };\n            };\n        },\n        Straight: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                length, m, m2, x1, x2, y1, y2,\n                _recalc = function () {\n                    length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n                    m = _jg.gradient({x: x1, y: y1}, {x: x2, y: y2});\n                    m2 = -1 / m;\n                };\n\n            this.type = \"Straight\";\n\n            this.getLength = function () {\n                return length;\n            };\n            this.getGradient = function () {\n                return m;\n            };\n\n            this.getCoordinates = function () {\n                return { x1: x1, y1: y1, x2: x2, y2: y2 };\n            };\n            this.setCoordinates = function (coords) {\n                x1 = coords.x1;\n                y1 = coords.y1;\n                x2 = coords.x2;\n                y2 = coords.y2;\n                _recalc();\n            };\n            this.setCoordinates({x1: params.x1, y1: params.y1, x2: params.x2, y2: params.y2});\n\n            this.getBounds = function () {\n                return {\n                    minX: Math.min(x1, x2),\n                    minY: Math.min(y1, y2),\n                    maxX: Math.max(x1, x2),\n                    maxY: Math.max(y1, y2)\n                };\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive. for the straight line segment this is simple maths.\n             */\n            this.pointOnPath = function (location, absolute) {\n                if (location === 0 && !absolute)\n                    return { x: x1, y: y1 };\n                else if (location == 1 && !absolute)\n                    return { x: x2, y: y2 };\n                else {\n                    var l = absolute ? location > 0 ? location : length + location : location * length;\n                    return _jg.pointOnLine({x: x1, y: y1}, {x: x2, y: y2}, l);\n                }\n            };\n\n            /**\n             * returns the gradient of the segment at the given point - which for us is constant.\n             */\n            this.gradientAtPoint = function (_) {\n                return m;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'distance' along the length of the path from 'location', where\n             * 'location' is a decimal from 0 to 1 inclusive, and 'distance' is a number of pixels.\n             * this hands off to jsPlumbUtil to do the maths, supplying two points and the distance.\n             */\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    farAwayPoint = distance <= 0 ? {x: x1, y: y1} : {x: x2, y: y2 };\n\n                /*\n                 location == 1 ? {\n                 x:x1 + ((x2 - x1) * 10),\n                 y:y1 + ((y1 - y2) * 10)\n                 } :\n                 */\n\n                if (distance <= 0 && Math.abs(distance) > 1) distance *= -1;\n\n                return _jg.pointOnLine(p, farAwayPoint, distance);\n            };\n\n            // is c between a and b?\n            var within = function (a, b, c) {\n                return c >= Math.min(a, b) && c <= Math.max(a, b);\n            };\n            // find which of a and b is closest to c\n            var closest = function (a, b, c) {\n                return Math.abs(c - a) < Math.abs(c - b) ? a : b;\n            };\n\n            /**\n             Function: findClosestPointOnPath\n             Finds the closest point on this segment to [x,y]. See\n             notes on this method in AbstractSegment.\n             */\n            this.findClosestPointOnPath = function (x, y) {\n                var out = {\n                    d: Infinity,\n                    x: null,\n                    y: null,\n                    l: null,\n                    x1: x1,\n                    x2: x2,\n                    y1: y1,\n                    y2: y2\n                };\n\n                if (m === 0) {\n                    out.y = y1;\n                    out.x = within(x1, x2, x) ? x : closest(x1, x2, x);\n                }\n                else if (m == Infinity || m == -Infinity) {\n                    out.x = x1;\n                    out.y = within(y1, y2, y) ? y : closest(y1, y2, y);\n                }\n                else {\n                    // closest point lies on normal from given point to this line.  \n                    var b = y1 - (m * x1),\n                        b2 = y - (m2 * x),\n                    // y1 = m.x1 + b and y1 = m2.x1 + b2\n                    // so m.x1 + b = m2.x1 + b2\n                    // x1(m - m2) = b2 - b\n                    // x1 = (b2 - b) / (m - m2)\n                        _x1 = (b2 - b) / (m - m2),\n                        _y1 = (m * _x1) + b;\n\n                    out.x = within(x1, x2, _x1) ? _x1 : closest(x1, x2, _x1);//_x1;\n                    out.y = within(y1, y2, _y1) ? _y1 : closest(y1, y2, _y1);//_y1;\n                }\n\n                var fractionInSegment = _jg.lineLength([ out.x, out.y ], [ x1, y1 ]);\n                out.d = _jg.lineLength([x, y], [out.x, out.y]);\n                out.l = fractionInSegment / length;\n                return out;\n            };\n        },\n\n        /*\n         Arc Segment. You need to supply:\n\n         r   -   radius\n         cx  -   center x for the arc\n         cy  -   center y for the arc\n         ac  -   whether the arc is anticlockwise or not. default is clockwise.\n\n         and then either:\n\n         startAngle  -   startAngle for the arc.\n         endAngle    -   endAngle for the arc.\n\n         or:\n\n         x1          -   x for start point\n         y1          -   y for start point\n         x2          -   x for end point\n         y2          -   y for end point\n\n         */\n        Arc: function (params) {\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments),\n                _calcAngle = function (_x, _y) {\n                    return _jg.theta([params.cx, params.cy], [_x, _y]);\n                },\n                _calcAngleForLocation = function (segment, location) {\n                    if (segment.anticlockwise) {\n                        var sa = segment.startAngle < segment.endAngle ? segment.startAngle + TWO_PI : segment.startAngle,\n                            s = Math.abs(sa - segment.endAngle);\n                        return sa - (s * location);\n                    }\n                    else {\n                        var ea = segment.endAngle < segment.startAngle ? segment.endAngle + TWO_PI : segment.endAngle,\n                            ss = Math.abs(ea - segment.startAngle);\n\n                        return segment.startAngle + (ss * location);\n                    }\n                },\n                TWO_PI = 2 * Math.PI;\n\n            this.radius = params.r;\n            this.anticlockwise = params.ac;\n            this.type = \"Arc\";\n\n            if (params.startAngle && params.endAngle) {\n                this.startAngle = params.startAngle;\n                this.endAngle = params.endAngle;\n                this.x1 = params.cx + (this.radius * Math.cos(params.startAngle));\n                this.y1 = params.cy + (this.radius * Math.sin(params.startAngle));\n                this.x2 = params.cx + (this.radius * Math.cos(params.endAngle));\n                this.y2 = params.cy + (this.radius * Math.sin(params.endAngle));\n            }\n            else {\n                this.startAngle = _calcAngle(params.x1, params.y1);\n                this.endAngle = _calcAngle(params.x2, params.y2);\n                this.x1 = params.x1;\n                this.y1 = params.y1;\n                this.x2 = params.x2;\n                this.y2 = params.y2;\n            }\n\n            if (this.endAngle < 0) this.endAngle += TWO_PI;\n            if (this.startAngle < 0) this.startAngle += TWO_PI;\n\n            // segment is used by vml     \n            //this.segment = _jg.quadrant([this.x1, this.y1], [this.x2, this.y2]);\n\n            // we now have startAngle and endAngle as positive numbers, meaning the\n            // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\n            // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\n\n            var ea = this.endAngle < this.startAngle ? this.endAngle + TWO_PI : this.endAngle;\n            this.sweep = Math.abs(ea - this.startAngle);\n            if (this.anticlockwise) this.sweep = TWO_PI - this.sweep;\n            var circumference = 2 * Math.PI * this.radius,\n                frac = this.sweep / TWO_PI,\n                length = circumference * frac;\n\n            this.getLength = function () {\n                return length;\n            };\n\n            this.getBounds = function () {\n                return {\n                    minX: params.cx - params.r,\n                    maxX: params.cx + params.r,\n                    minY: params.cy - params.r,\n                    maxY: params.cy + params.r\n                };\n            };\n\n            var VERY_SMALL_VALUE = 0.0000000001,\n                gentleRound = function (n) {\n                    var f = Math.floor(n), r = Math.ceil(n);\n                    if (n - f < VERY_SMALL_VALUE)\n                        return f;\n                    else if (r - n < VERY_SMALL_VALUE)\n                        return r;\n                    return n;\n                };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n\n                if (location === 0) {\n                    return { x: this.x1, y: this.y1, theta: this.startAngle };\n                }\n                else if (location == 1) {\n                    return { x: this.x2, y: this.y2, theta: this.endAngle };\n                }\n\n                if (absolute) {\n                    location = location / length;\n                }\n\n                var angle = _calcAngleForLocation(this, location),\n                    _x = params.cx + (params.r * Math.cos(angle)),\n                    _y = params.cy + (params.r * Math.sin(angle));\n\n                return { x: gentleRound(_x), y: gentleRound(_y), theta: angle };\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                var p = this.pointOnPath(location, absolute);\n                var m = _jg.normal([ params.cx, params.cy ], [p.x, p.y ]);\n                if (!this.anticlockwise && (m == Infinity || m == -Infinity)) m *= -1;\n                return m;\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                var p = this.pointOnPath(location, absolute),\n                    arcSpan = distance / circumference * 2 * Math.PI,\n                    dir = this.anticlockwise ? -1 : 1,\n                    startAngle = p.theta + (dir * arcSpan),\n                    startX = params.cx + (this.radius * Math.cos(startAngle)),\n                    startY = params.cy + (this.radius * Math.sin(startAngle));\n\n                return {x: startX, y: startY};\n            };\n        },\n\n        Bezier: function (params) {\n            this.curve = [\n                { x: params.x1, y: params.y1},\n                { x: params.cp1x, y: params.cp1y },\n                { x: params.cp2x, y: params.cp2y },\n                { x: params.x2, y: params.y2 }\n            ];\n\n            var _super = _jp.Segments.AbstractSegment.apply(this, arguments);\n            // although this is not a strictly rigorous determination of bounds\n            // of a bezier curve, it works for the types of curves that this segment\n            // type produces.\n            this.bounds = {\n                minX: Math.min(params.x1, params.x2, params.cp1x, params.cp2x),\n                minY: Math.min(params.y1, params.y2, params.cp1y, params.cp2y),\n                maxX: Math.max(params.x1, params.x2, params.cp1x, params.cp2x),\n                maxY: Math.max(params.y1, params.y2, params.cp1y, params.cp2y)\n            };\n\n            this.type = \"Bezier\";\n\n            var _translateLocation = function (_curve, location, absolute) {\n                if (absolute)\n                    location = root.jsBezier.locationAlongCurveFrom(_curve, location > 0 ? 0 : 1, location);\n\n                return location;\n            };\n\n            /**\n             * returns the point on the segment's path that is 'location' along the length of the path, where 'location' is a decimal from\n             * 0 to 1 inclusive.\n             */\n            this.pointOnPath = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointOnCurve(this.curve, location);\n            };\n\n            /**\n             * returns the gradient of the segment at the given point.\n             */\n            this.gradientAtPoint = function (location, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.gradientAtPoint(this.curve, location);\n            };\n\n            this.pointAlongPathFrom = function (location, distance, absolute) {\n                location = _translateLocation(this.curve, location, absolute);\n                return root.jsBezier.pointAlongCurveFrom(this.curve, location, distance);\n            };\n\n            this.getLength = function () {\n                return root.jsBezier.getLength(this.curve);\n            };\n\n            this.getBounds = function () {\n                return this.bounds;\n            };\n        }\n    };\n\n    /*\n     Class: AbstractComponent\n     Superclass for AbstractConnector and AbstractEndpoint.\n     */\n    var AbstractComponent = function () {\n        this.resetBounds = function () {\n            this.bounds = { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity };\n        };\n        this.resetBounds();\n    };\n\n    /*\n     * Class: AbstractConnector\n     * Superclass for all Connectors; here is where Segments are managed.  This is exposed on jsPlumb just so it\n     * can be accessed from other files. You should not try to instantiate one of these directly.\n     *\n     * When this class is asked for a pointOnPath, or gradient etc, it must first figure out which segment to dispatch\n     * that request to. This is done by keeping track of the total connector length as segments are added, and also\n     * their cumulative ratios to the total length.  Then when the right segment is found it is a simple case of dispatching\n     * the request to it (and adjusting 'location' so that it is relative to the beginning of that segment.)\n     */\n    _jp.Connectors.AbstractConnector = function (params) {\n\n        AbstractComponent.apply(this, arguments);\n\n        var segments = [],\n            totalLength = 0,\n            segmentProportions = [],\n            segmentProportionalLengths = [],\n            stub = params.stub || 0,\n            sourceStub = _ju.isArray(stub) ? stub[0] : stub,\n            targetStub = _ju.isArray(stub) ? stub[1] : stub,\n            gap = params.gap || 0,\n            sourceGap = _ju.isArray(gap) ? gap[0] : gap,\n            targetGap = _ju.isArray(gap) ? gap[1] : gap,\n            userProvidedSegments = null,\n            edited = false,\n            paintInfo = null,\n            geometry = null,\n            editable = params.editable !== false && jsPlumb.ConnectorEditors != null && jsPlumb.ConnectorEditors[this.type] != null;\n\n        var _setGeometry = this.setGeometry = function(g, internallyComputed) {\n            edited = (!internallyComputed);\n            geometry = g;\n        };\n        var _getGeometry = this.getGeometry = function() {\n            return geometry;\n        };\n\n        this.hasBeenEdited = function() { return edited; };\n        this.isEditing = function() { return this.editor != null && this.editor.isActive(); };\n        this.setEditable = function(e) {\n            // if this connector has an editor already, or\n            // if an editor for this connector's type is available, or\n            // if the child declares an overrideSetEditable and it does not return false, editable is true.\n            if (e && jsPlumb.ConnectorEditors != null && jsPlumb.ConnectorEditors[this.type] != null && (this.overrideSetEditable == null || this.overrideSetEditable())) {\n                editable = e;\n            } else {\n                editable = false;\n            }\n            return editable;\n        };\n        this.isEditable = function() { return editable; };\n\n        /**\n         * Function: findSegmentForPoint\n         * Returns the segment that is closest to the given [x,y],\n         * null if nothing found.  This function returns a JS\n         * object with:\n         *\n         *   d   -   distance from segment\n         *   l   -   proportional location in segment\n         *   x   -   x point on the segment\n         *   y   -   y point on the segment\n         *   s   -   the segment itself.\n         */\n        this.findSegmentForPoint = function (x, y) {\n            var out = { d: Infinity, s: null, x: null, y: null, l: null };\n            for (var i = 0; i < segments.length; i++) {\n                var _s = segments[i].findClosestPointOnPath(x, y);\n                if (_s.d < out.d) {\n                    out.d = _s.d;\n                    out.l = _s.l;\n                    out.x = _s.x;\n                    out.y = _s.y;\n                    out.s = segments[i];\n                    out.x1 = _s.x1;\n                    out.x2 = _s.x2;\n                    out.y1 = _s.y1;\n                    out.y2 = _s.y2;\n                    out.index = i;\n                }\n            }\n\n            return out;\n        };\n\n        var _updateSegmentProportions = function () {\n                var curLoc = 0;\n                for (var i = 0; i < segments.length; i++) {\n                    var sl = segments[i].getLength();\n                    segmentProportionalLengths[i] = sl / totalLength;\n                    segmentProportions[i] = [curLoc, (curLoc += (sl / totalLength)) ];\n                }\n            },\n\n            /**\n             * returns [segment, proportion of travel in segment, segment index] for the segment\n             * that contains the point which is 'location' distance along the entire path, where\n             * 'location' is a decimal between 0 and 1 inclusive. in this connector type, paths\n             * are made up of a list of segments, each of which contributes some fraction to\n             * the total length.\n             * From 1.3.10 this also supports the 'absolute' property, which lets us specify a location\n             * as the absolute distance in pixels, rather than a proportion of the total path.\n             */\n            _findSegmentForLocation = function (location, absolute) {\n                if (absolute) {\n                    location = location > 0 ? location / totalLength : (totalLength + location) / totalLength;\n                }\n                var idx = segmentProportions.length - 1, inSegmentProportion = 1;\n                for (var i = 0; i < segmentProportions.length; i++) {\n                    if (segmentProportions[i][1] >= location) {\n                        idx = i;\n                        // todo is this correct for all connector path types?\n                        inSegmentProportion = location == 1 ? 1 : location === 0 ? 0 : (location - segmentProportions[i][0]) / segmentProportionalLengths[i];\n                        break;\n                    }\n                }\n                return { segment: segments[idx], proportion: inSegmentProportion, index: idx };\n            },\n            _addSegment = function (conn, type, params) {\n                if (params.x1 == params.x2 && params.y1 == params.y2) return;\n                var s = new _jp.Segments[type](params);\n                segments.push(s);\n                totalLength += s.getLength();\n                conn.updateBounds(s);\n            },\n            _clearSegments = function () {\n                totalLength = segments.length = segmentProportions.length = segmentProportionalLengths.length = 0;\n            };\n\n        this.setSegments = function (_segs) {\n            userProvidedSegments = [];\n            totalLength = 0;\n            for (var i = 0; i < _segs.length; i++) {\n                userProvidedSegments.push(_segs[i]);\n                totalLength += _segs[i].getLength();\n            }\n        };\n\n        this.getLength = function() {\n            return totalLength;\n        };\n\n        var _prepareCompute = function (params) {\n            this.lineWidth = params.lineWidth;\n            var segment = _jg.quadrant(params.sourcePos, params.targetPos),\n                swapX = params.targetPos[0] < params.sourcePos[0],\n                swapY = params.targetPos[1] < params.sourcePos[1],\n                lw = params.lineWidth || 1,\n                so = params.sourceEndpoint.anchor.getOrientation(params.sourceEndpoint),\n                to = params.targetEndpoint.anchor.getOrientation(params.targetEndpoint),\n                x = swapX ? params.targetPos[0] : params.sourcePos[0],\n                y = swapY ? params.targetPos[1] : params.sourcePos[1],\n                w = Math.abs(params.targetPos[0] - params.sourcePos[0]),\n                h = Math.abs(params.targetPos[1] - params.sourcePos[1]);\n\n            // if either anchor does not have an orientation set, we derive one from their relative\n            // positions.  we fix the axis to be the one in which the two elements are further apart, and\n            // point each anchor at the other element.  this is also used when dragging a new connection.\n            if (so[0] === 0 && so[1] === 0 || to[0] === 0 && to[1] === 0) {\n                var index = w > h ? 0 : 1, oIndex = [1, 0][index];\n                so = [];\n                to = [];\n                so[index] = params.sourcePos[index] > params.targetPos[index] ? -1 : 1;\n                to[index] = params.sourcePos[index] > params.targetPos[index] ? 1 : -1;\n                so[oIndex] = 0;\n                to[oIndex] = 0;\n            }\n\n            var sx = swapX ? w + (sourceGap * so[0]) : sourceGap * so[0],\n                sy = swapY ? h + (sourceGap * so[1]) : sourceGap * so[1],\n                tx = swapX ? targetGap * to[0] : w + (targetGap * to[0]),\n                ty = swapY ? targetGap * to[1] : h + (targetGap * to[1]),\n                oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\n\n            var result = {\n                sx: sx, sy: sy, tx: tx, ty: ty, lw: lw,\n                xSpan: Math.abs(tx - sx),\n                ySpan: Math.abs(ty - sy),\n                mx: (sx + tx) / 2,\n                my: (sy + ty) / 2,\n                so: so, to: to, x: x, y: y, w: w, h: h,\n                segment: segment,\n                startStubX: sx + (so[0] * sourceStub),\n                startStubY: sy + (so[1] * sourceStub),\n                endStubX: tx + (to[0] * targetStub),\n                endStubY: ty + (to[1] * targetStub),\n                isXGreaterThanStubTimes2: Math.abs(sx - tx) > (sourceStub + targetStub),\n                isYGreaterThanStubTimes2: Math.abs(sy - ty) > (sourceStub + targetStub),\n                opposite: oProduct == -1,\n                perpendicular: oProduct === 0,\n                orthogonal: oProduct == 1,\n                sourceAxis: so[0] === 0 ? \"y\" : \"x\",\n                points: [x, y, w, h, sx, sy, tx, ty ]\n            };\n            result.anchorOrientation = result.opposite ? \"opposite\" : result.orthogonal ? \"orthogonal\" : \"perpendicular\";\n            return result;\n        };\n\n        this.getSegments = function () {\n            return segments;\n        };\n\n        this.updateBounds = function (segment) {\n            var segBounds = segment.getBounds();\n            this.bounds.minX = Math.min(this.bounds.minX, segBounds.minX);\n            this.bounds.maxX = Math.max(this.bounds.maxX, segBounds.maxX);\n            this.bounds.minY = Math.min(this.bounds.minY, segBounds.minY);\n            this.bounds.maxY = Math.max(this.bounds.maxY, segBounds.maxY);\n        };\n\n        var dumpSegmentsToConsole = function () {\n            void 0;\n            for (var i = 0; i < segments.length; i++) {\n                void 0;\n            }\n        };\n\n        this.pointOnPath = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.pointOnPath(seg.proportion, false) || [0, 0];\n        };\n\n        this.gradientAtPoint = function (location, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            return seg.segment && seg.segment.gradientAtPoint(seg.proportion, false) || 0;\n        };\n\n        this.pointAlongPathFrom = function (location, distance, absolute) {\n            var seg = _findSegmentForLocation(location, absolute);\n            // TODO what happens if this crosses to the next segment?\n            return seg.segment && seg.segment.pointAlongPathFrom(seg.proportion, distance, false) || [0, 0];\n        };\n\n        this.compute = function (params) {\n            paintInfo = _prepareCompute.call(this, params);\n\n            _clearSegments();\n            this._compute(paintInfo, params);\n            this.x = paintInfo.points[0];\n            this.y = paintInfo.points[1];\n            this.w = paintInfo.points[2];\n            this.h = paintInfo.points[3];\n            this.segment = paintInfo.segment;\n            _updateSegmentProportions();\n        };\n\n        return {\n            addSegment: _addSegment,\n            prepareCompute: _prepareCompute,\n            sourceStub: sourceStub,\n            targetStub: targetStub,\n            maxStub: Math.max(sourceStub, targetStub),\n            sourceGap: sourceGap,\n            targetGap: targetGap,\n            maxGap: Math.max(sourceGap, targetGap),\n            setGeometry:_setGeometry,\n            getGeometry:_getGeometry\n        };\n    };\n    _ju.extend(_jp.Connectors.AbstractConnector, AbstractComponent);\n\n    /**\n     * Class: Connectors.Straight\n     * The Straight connector draws a simple straight line between the two anchor points.  It does not have any constructor parameters.\n     */\n    var Straight = _jp.Connectors.Straight = function () {\n        this.type = \"Straight\";\n        var _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n\n        this._compute = function (paintInfo, _) {\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.sx, y1: paintInfo.sy, x2: paintInfo.startStubX, y2: paintInfo.startStubY});\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.startStubX, y1: paintInfo.startStubY, x2: paintInfo.endStubX, y2: paintInfo.endStubY});\n            _super.addSegment(this, \"Straight\", {x1: paintInfo.endStubX, y1: paintInfo.endStubY, x2: paintInfo.tx, y2: paintInfo.ty});\n        };\n    };\n    _ju.extend(_jp.Connectors.Straight, _jp.Connectors.AbstractConnector);\n    _jp.registerConnectorType(Straight, \"Straight\");\n\n\n    // ********************************* END OF CONNECTOR TYPES *******************************************************************\n\n    // ********************************* ENDPOINT TYPES *******************************************************************\n\n    _jp.Endpoints.AbstractEndpoint = function (params) {\n        AbstractComponent.apply(this, arguments);\n        var compute = this.compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var out = this._compute.apply(this, arguments);\n            this.x = out[0];\n            this.y = out[1];\n            this.w = out[2];\n            this.h = out[3];\n            this.bounds.minX = this.x;\n            this.bounds.minY = this.y;\n            this.bounds.maxX = this.x + this.w;\n            this.bounds.maxY = this.y + this.h;\n            return out;\n        };\n        return {\n            compute: compute,\n            cssClass: params.cssClass\n        };\n    };\n    _ju.extend(_jp.Endpoints.AbstractEndpoint, AbstractComponent);\n\n    /**\n     * Class: Endpoints.Dot\n     * A round endpoint, with default radius 10 pixels.\n     */\n\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    radius    -    radius of the endpoint.  defaults to 10 pixels.\n     */\n    _jp.Endpoints.Dot = function (params) {\n        this.type = \"Dot\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.radius = params.radius || 10;\n        this.defaultOffset = 0.5 * this.radius;\n        this.defaultInnerRadius = this.radius / 3;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.radius = endpointStyle.radius || this.radius;\n            var x = anchorPoint[0] - this.radius,\n                y = anchorPoint[1] - this.radius,\n                w = this.radius * 2,\n                h = this.radius * 2;\n\n            if (endpointStyle.strokeStyle) {\n                var lw = endpointStyle.lineWidth || 1;\n                x -= lw;\n                y -= lw;\n                w += (lw * 2);\n                h += (lw * 2);\n            }\n            return [ x, y, w, h, this.radius ];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Dot, _jp.Endpoints.AbstractEndpoint);\n\n    _jp.Endpoints.Rectangle = function (params) {\n        this.type = \"Rectangle\";\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {};\n        this.width = params.width || 20;\n        this.height = params.height || 20;\n\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || this.width,\n                height = endpointStyle.height || this.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n\n            return [ x, y, width, height];\n        };\n    };\n    _ju.extend(_jp.Endpoints.Rectangle, _jp.Endpoints.AbstractEndpoint);\n\n    var DOMElementEndpoint = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this._jsPlumb.displayElements = [];\n    };\n    _ju.extend(DOMElementEndpoint, _jp.jsPlumbUIComponent, {\n        getDisplayElements: function () {\n            return this._jsPlumb.displayElements;\n        },\n        appendDisplayElement: function (el) {\n            this._jsPlumb.displayElements.push(el);\n        }\n    });\n\n    /**\n     * Class: Endpoints.Image\n     * Draws an image as the Endpoint.\n     */\n    /**\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *    src    -    location of the image to use.\n\n     TODO: multiple references to self. not sure quite how to get rid of them entirely. perhaps self = null in the cleanup\n     function will suffice\n\n     TODO this class still might leak memory.\n\n     */\n    _jp.Endpoints.Image = function (params) {\n\n        this.type = \"Image\";\n        DOMElementEndpoint.apply(this, arguments);\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n\n        var _onload = params.onload,\n            src = params.src || params.url,\n            clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this._jsPlumb.img = new Image();\n        this._jsPlumb.ready = false;\n        this._jsPlumb.initialized = false;\n        this._jsPlumb.deleted = false;\n        this._jsPlumb.widthToUse = params.width;\n        this._jsPlumb.heightToUse = params.height;\n        this._jsPlumb.endpoint = params.endpoint;\n\n        this._jsPlumb.img.onload = function () {\n            if (this._jsPlumb != null) {\n                this._jsPlumb.ready = true;\n                this._jsPlumb.widthToUse = this._jsPlumb.widthToUse || this._jsPlumb.img.width;\n                this._jsPlumb.heightToUse = this._jsPlumb.heightToUse || this._jsPlumb.img.height;\n                if (_onload) {\n                    _onload(this);\n                }\n            }\n        }.bind(this);\n\n        /*\n         Function: setImage\n         Sets the Image to use in this Endpoint.\n\n         Parameters:\n         img         -   may be a URL or an Image object\n         onload      -   optional; a callback to execute once the image has loaded.\n         */\n        this._jsPlumb.endpoint.setImage = function (_img, onload) {\n            var s = _img.constructor == String ? _img : _img.src;\n            _onload = onload;\n            this._jsPlumb.img.src = s;\n\n            if (this.canvas != null)\n                this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n        }.bind(this);\n\n        this._jsPlumb.endpoint.setImage(src, _onload);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            this.anchorPoint = anchorPoint;\n            if (this._jsPlumb.ready) return [anchorPoint[0] - this._jsPlumb.widthToUse / 2, anchorPoint[1] - this._jsPlumb.heightToUse / 2,\n                this._jsPlumb.widthToUse, this._jsPlumb.heightToUse];\n            else return [0, 0, 0, 0];\n        };\n\n        this.canvas = jsPlumb.createElement(\"img\", {\n            position:\"absolute\",\n            margin:0,\n            padding:0,\n            outline:0\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        if (this._jsPlumb.widthToUse) this.canvas.setAttribute(\"width\", this._jsPlumb.widthToUse);\n        if (this._jsPlumb.heightToUse) this.canvas.setAttribute(\"height\", this._jsPlumb.heightToUse);\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.actuallyPaint = function (d, style, anchor) {\n            if (!this._jsPlumb.deleted) {\n                if (!this._jsPlumb.initialized) {\n                    this.canvas.setAttribute(\"src\", this._jsPlumb.img.src);\n                    this.appendDisplayElement(this.canvas);\n                    this._jsPlumb.initialized = true;\n                }\n                var x = this.anchorPoint[0] - (this._jsPlumb.widthToUse / 2),\n                    y = this.anchorPoint[1] - (this._jsPlumb.heightToUse / 2);\n                _ju.sizeElement(this.canvas, x, y, this._jsPlumb.widthToUse, this._jsPlumb.heightToUse);\n            }\n        };\n\n        this.paint = function (style, anchor) {\n            if (this._jsPlumb != null) {  // may have been deleted\n                if (this._jsPlumb.ready) {\n                    this.actuallyPaint(style, anchor);\n                }\n                else {\n                    root.setTimeout(function () {\n                        this.paint(style, anchor);\n                    }.bind(this), 200);\n                }\n            }\n        };\n    };\n    _ju.extend(_jp.Endpoints.Image, [ DOMElementEndpoint, _jp.Endpoints.AbstractEndpoint ], {\n        cleanup: function (force) {\n            if (force) {\n                this._jsPlumb.deleted = true;\n                if (this.canvas) this.canvas.parentNode.removeChild(this.canvas);\n                this.canvas = null;\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Blank\n     * An Endpoint that paints nothing (visible) on the screen.  Supports cssClass and hoverClass parameters like all Endpoints.\n     */\n    _jp.Endpoints.Blank = function (params) {\n        var _super = _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        this.type = \"Blank\";\n        DOMElementEndpoint.apply(this, arguments);\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            return [anchorPoint[0], anchorPoint[1], 10, 0];\n        };\n\n        var clazz = params.cssClass ? \" \" + params.cssClass : \"\";\n\n        this.canvas = jsPlumb.createElement(\"div\", {\n            display: \"block\",\n            width: \"1px\",\n            height: \"1px\",\n            background: \"transparent\",\n            position: \"absolute\"\n        }, this._jsPlumb.instance.endpointClass + clazz);\n\n        this._jsPlumb.instance.appendElement(this.canvas);\n\n        this.paint = function (style, anchor) {\n            _ju.sizeElement(this.canvas, this.x, this.y, this.w, this.h);\n        };\n    };\n    _ju.extend(_jp.Endpoints.Blank, [_jp.Endpoints.AbstractEndpoint, DOMElementEndpoint], {\n        cleanup: function () {\n            if (this.canvas && this.canvas.parentNode) {\n                this.canvas.parentNode.removeChild(this.canvas);\n            }\n        }\n    });\n\n    /*\n     * Class: Endpoints.Triangle\n     * A triangular Endpoint.\n     */\n    /*\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *     width    -    width of the triangle's base.  defaults to 55 pixels.\n     *     height    -    height of the triangle from base to apex.  defaults to 55 pixels.\n     */\n    _jp.Endpoints.Triangle = function (params) {\n        this.type = \"Triangle\";\n        _jp.Endpoints.AbstractEndpoint.apply(this, arguments);\n        params = params || {  };\n        params.width = params.width || 55;\n        params.height = params.height || 55;\n        this.width = params.width;\n        this.height = params.height;\n        this._compute = function (anchorPoint, orientation, endpointStyle, connectorPaintStyle) {\n            var width = endpointStyle.width || self.width,\n                height = endpointStyle.height || self.height,\n                x = anchorPoint[0] - (width / 2),\n                y = anchorPoint[1] - (height / 2);\n            return [ x, y, width, height ];\n        };\n    };\n// ********************************* END OF ENDPOINT TYPES *******************************************************************\n\n\n// ********************************* OVERLAY DEFINITIONS ***********************************************************************    \n\n    var AbstractOverlay = _jp.Overlays.AbstractOverlay = function (params) {\n        this.visible = true;\n        this.isAppendedAtTopLevel = true;\n        this.component = params.component;\n        this.loc = params.location == null ? 0.5 : params.location;\n        this.endpointLoc = params.endpointLocation == null ? [ 0.5, 0.5] : params.endpointLocation;\n        this.visible = params.visible !== false;\n    };\n    AbstractOverlay.prototype = {\n        cleanup: function (force) {\n            if (force) {\n                this.component = null;\n                this.canvas = null;\n                this.endpointLoc = null;\n            }\n        },\n        reattach:function(instance) {\n\n        },\n        setVisible: function (val) {\n            this.visible = val;\n            this.component.repaint();\n        },\n        isVisible: function () {\n            return this.visible;\n        },\n        hide: function () {\n            this.setVisible(false);\n        },\n        show: function () {\n            this.setVisible(true);\n        },\n        incrementLocation: function (amount) {\n            this.loc += amount;\n            this.component.repaint();\n        },\n        setLocation: function (l) {\n            this.loc = l;\n            this.component.repaint();\n        },\n        getLocation: function () {\n            return this.loc;\n        },\n        updateFrom:function() { }\n    };\n\n\n    /*\n     * Class: Overlays.Arrow\n     *\n     * An arrow overlay, defined by four points: the head, the two sides of the tail, and a 'foldback' point at some distance along the length\n     * of the arrow that lines from each tail point converge into.  The foldback point is defined using a decimal that indicates some fraction\n     * of the length of the arrow and has a default value of 0.623.  A foldback point value of 1 would mean that the arrow had a straight line\n     * across the tail.\n     */\n    /*\n     * Function: Constructor\n     *\n     * Parameters:\n     *\n     *     length - distance in pixels from head to tail baseline. default 20.\n     *     width - width in pixels of the tail baseline. default 20.\n     *     fillStyle - style to use when filling the arrow.  defaults to \"black\".\n     *     strokeStyle - style to use when stroking the arrow. defaults to null, which means the arrow is not stroked.\n     *     lineWidth - line width to use when stroking the arrow. defaults to 1, but only used if strokeStyle is not null.\n     *     foldback - distance (as a decimal from 0 to 1 inclusive) along the length of the arrow marking the point the tail points should fold back to.  defaults to 0.623.\n     *     location - distance (as a decimal from 0 to 1 inclusive) marking where the arrow should sit on the connector. defaults to 0.5.\n     *     direction - indicates the direction the arrow points in. valid values are -1 and 1; 1 is default.\n     */\n    _jp.Overlays.Arrow = function (params) {\n        this.type = \"Arrow\";\n        AbstractOverlay.apply(this, arguments);\n        this.isAppendedAtTopLevel = false;\n        params = params || {};\n\n        this.length = params.length || 20;\n        this.width = params.width || 20;\n        this.id = params.id;\n        var direction = (params.direction || 1) < 0 ? -1 : 1,\n            paintStyle = params.paintStyle || { lineWidth: 1 },\n        // how far along the arrow the lines folding back in come to. default is 62.3%.\n            foldback = params.foldback || 0.623;\n\n        this.computeMaxSize = function () {\n            return self.width * 1.5;\n        };\n\n        this.elementCreated = function(p, component) {\n            this.path = p;\n            if (params.events) {\n                for (var i in params.events) {\n                    jsPlumb.on(p, i, params.events[i]);\n                }\n            }\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle) {\n\n            var hxy, mid, txy, tail, cxy;\n            if (component.pointAlongPathFrom) {\n\n                if (_ju.isString(this.loc) || this.loc > 1 || this.loc < 0) {\n                    var l = parseInt(this.loc, 10),\n                        fromLoc = this.loc < 0 ? 1 : 0;\n                    hxy = component.pointAlongPathFrom(fromLoc, l, false);\n                    mid = component.pointAlongPathFrom(fromLoc, l - (direction * this.length / 2), false);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n                else if (this.loc == 1) {\n                    hxy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, -(this.length));\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n\n                    if (direction == -1) {\n                        var _ = txy;\n                        txy = hxy;\n                        hxy = _;\n                    }\n                }\n                else if (this.loc === 0) {\n                    txy = component.pointOnPath(this.loc);\n                    mid = component.pointAlongPathFrom(this.loc, this.length);\n                    hxy = _jg.pointOnLine(txy, mid, this.length);\n                    if (direction == -1) {\n                        var __ = txy;\n                        txy = hxy;\n                        hxy = __;\n                    }\n                }\n                else {\n                    hxy = component.pointAlongPathFrom(this.loc, direction * this.length / 2);\n                    mid = component.pointOnPath(this.loc);\n                    txy = _jg.pointOnLine(hxy, mid, this.length);\n                }\n\n                tail = _jg.perpendicularLineTo(hxy, txy, this.width);\n                cxy = _jg.pointOnLine(hxy, txy, foldback * this.length);\n\n                var d = { hxy: hxy, tail: tail, cxy: cxy },\n                    strokeStyle = paintStyle.strokeStyle || currentConnectionPaintStyle.strokeStyle,\n                    fillStyle = paintStyle.fillStyle || currentConnectionPaintStyle.strokeStyle,\n                    lineWidth = paintStyle.lineWidth || currentConnectionPaintStyle.lineWidth;\n\n                return {\n                    component: component,\n                    d: d,\n                    lineWidth: lineWidth,\n                    strokeStyle: strokeStyle,\n                    fillStyle: fillStyle,\n                    minX: Math.min(hxy.x, tail[0].x, tail[1].x),\n                    maxX: Math.max(hxy.x, tail[0].x, tail[1].x),\n                    minY: Math.min(hxy.y, tail[0].y, tail[1].y),\n                    maxY: Math.max(hxy.y, tail[0].y, tail[1].y)\n                };\n            }\n            else return {component: component, minX: 0, maxX: 0, minY: 0, maxY: 0};\n        };\n    };\n    _ju.extend(_jp.Overlays.Arrow, AbstractOverlay, {\n        updateFrom:function(d) {\n            this.length = d.length || this.length;\n            this.width = d.width|| this.width;\n            this.direction = d.direction != null ? d.direction : this.direction;\n            this.foldback = d.foldback|| this.foldback;\n        }\n    });\n\n    /*\n     * Class: Overlays.PlainArrow\n     *\n     * A basic arrow.  This is in fact just one instance of the more generic case in which the tail folds back on itself to some\n     * point along the length of the arrow: in this case, that foldback point is the full length of the arrow.  so it just does\n     * a 'call' to Arrow with foldback set appropriately.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.PlainArrow = function (params) {\n        params = params || {};\n        var p = _jp.extend(params, {foldback: 1});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"PlainArrow\";\n    };\n    _ju.extend(_jp.Overlays.PlainArrow, _jp.Overlays.Arrow);\n\n    /*\n     * Class: Overlays.Diamond\n     * \n     * A diamond. Like PlainArrow, this is a concrete case of the more generic case of the tail points converging on some point...it just\n     * happens that in this case, that point is greater than the length of the the arrow.\n     *\n     *      this could probably do with some help with positioning...due to the way it reuses the Arrow paint code, what Arrow thinks is the\n     *      center is actually 1/4 of the way along for this guy.  but we don't have any knowledge of pixels at this point, so we're kind of\n     *      stuck when it comes to helping out the Arrow class. possibly we could pass in a 'transpose' parameter or something. the value\n     *      would be -l/4 in this case - move along one quarter of the total length.\n     */\n    /*\n     * Function: Constructor\n     * See <Overlays.Arrow> for allowed parameters for this overlay.\n     */\n    _jp.Overlays.Diamond = function (params) {\n        params = params || {};\n        var l = params.length || 40,\n            p = jsPlumb.extend(params, {length: l / 2, foldback: 2});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"Diamond\";\n    };\n    _ju.extend(_jp.Overlays.Diamond, _jp.Overlays.Arrow);\n    \n    _jp.Overlays.SingleLine = function (params) {\n        params = params || {};\n        var l = params.length || 40,\n            p = jsPlumb.extend(params, {length: l / 2, foldback: 2});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"SingleLine\";\n    };\n    _ju.extend(_jp.Overlays.SingleLine, _jp.Overlays.Arrow);\n    \n    _jp.Overlays.DoubleLine = function (params) {\n        params = params || {};\n        var l = params.length || 40,\n            p = jsPlumb.extend(params, {length: l / 2, foldback: 2});\n        _jp.Overlays.Arrow.call(this, p);\n        this.type = \"DoubleLine\";\n    };\n    _ju.extend(_jp.Overlays.DoubleLine, _jp.Overlays.Arrow);\n\n    var _getDimensions = function (component, forceRefresh) {\n        if (component._jsPlumb.cachedDimensions == null || forceRefresh)\n            component._jsPlumb.cachedDimensions = component.getDimensions();\n        return component._jsPlumb.cachedDimensions;\n    };\n\n    // abstract superclass for overlays that add an element to the DOM.\n    var AbstractDOMOverlay = function (params) {\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        AbstractOverlay.apply(this, arguments);\n\n        // hand off fired events to associated component.\n        var _f = this.fire;\n        this.fire = function () {\n            _f.apply(this, arguments);\n            if (this.component) this.component.fire.apply(this.component, arguments);\n        };\n\n        this.detached=false;\n        this.id = params.id;\n        this._jsPlumb.div = null;\n        this._jsPlumb.initialised = false;\n        this._jsPlumb.component = params.component;\n        this._jsPlumb.cachedDimensions = null;\n        this._jsPlumb.create = params.create;\n        this._jsPlumb.initiallyInvisible = params.visible === false;\n\n        this.getElement = function () {\n            if (this._jsPlumb.div == null) {\n                var div = this._jsPlumb.div = jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component));\n                div.style.position = \"absolute\";\n                div.className = this._jsPlumb.instance.overlayClass + \" \" +\n                    (this.cssClass ? this.cssClass :\n                        params.cssClass ? params.cssClass : \"\");\n                this._jsPlumb.instance.appendElement(div);\n                this._jsPlumb.instance.getId(div);\n                this.canvas = div;\n\n                // in IE the top left corner is what it placed at the desired location.  This will not\n                // be fixed. IE8 is not going to be supported for much longer.\n                var ts = \"translate(-50%, -50%)\";\n                div.style.webkitTransform = ts;\n                div.style.mozTransform = ts;\n                div.style.msTransform = ts;\n                div.style.oTransform = ts;\n                div.style.transform = ts;\n\n                // write the related component into the created element\n                div._jsPlumb = this;\n\n                if (params.visible === false)\n                    div.style.display = \"none\";\n            }\n            return this._jsPlumb.div;\n        };\n\n        this.draw = function (component, currentConnectionPaintStyle, absolutePosition) {\n            var td = _getDimensions(this);\n            if (td != null && td.length == 2) {\n                var cxy = { x: 0, y: 0 };\n\n                // absolutePosition would have been set by a call to connection.setAbsoluteOverlayPosition.\n                if (absolutePosition) {\n                    cxy = { x: absolutePosition[0], y: absolutePosition[1] };\n                }\n                else if (component.pointOnPath) {\n                    var loc = this.loc, absolute = false;\n                    if (_ju.isString(this.loc) || this.loc < 0 || this.loc > 1) {\n                        loc = parseInt(this.loc, 10);\n                        absolute = true;\n                    }\n                    cxy = component.pointOnPath(loc, absolute);  // a connection\n                }\n                else {\n                    var locToUse = this.loc.constructor == Array ? this.loc : this.endpointLoc;\n                    cxy = { x: locToUse[0] * component.w,\n                        y: locToUse[1] * component.h };\n                }\n\n                var minx = cxy.x - (td[0] / 2),\n                    miny = cxy.y - (td[1] / 2);\n\n                return {\n                    component: component,\n                    d: { minx: minx, miny: miny, td: td, cxy: cxy },\n                    minX: minx,\n                    maxX: minx + td[0],\n                    minY: miny,\n                    maxY: miny + td[1]\n                };\n            }\n            else return {minX: 0, maxX: 0, minY: 0, maxY: 0};\n        };\n    };\n    _ju.extend(AbstractDOMOverlay, [_jp.jsPlumbUIComponent, AbstractOverlay], {\n        getDimensions: function () {\n            return [1,1];\n        },\n        setVisible: function (state) {\n            if (this._jsPlumb.div) {\n                this._jsPlumb.div.style.display = state ? \"block\" : \"none\";\n                // if initially invisible, dimensions are 0,0 and never get updated\n                if (state && this._jsPlumb.initiallyInvisible) {\n                    _getDimensions(this, true);\n                    this.component.repaint();\n                    this._jsPlumb.initiallyInvisible = false;\n                }\n            }\n        },\n        /*\n         * Function: clearCachedDimensions\n         * Clears the cached dimensions for the label. As a performance enhancement, label dimensions are\n         * cached from 1.3.12 onwards. The cache is cleared when you change the label text, of course, but\n         * there are other reasons why the text dimensions might change - if you make a change through CSS, for\n         * example, you might change the font size.  in that case you should explicitly call this method.\n         */\n        clearCachedDimensions: function () {\n            this._jsPlumb.cachedDimensions = null;\n        },\n        cleanup: function (force) {\n            if (force) {\n                if (this._jsPlumb.div != null) {\n                    this._jsPlumb.div._jsPlumb = null;\n                    this._jsPlumb.instance.removeElement(this._jsPlumb.div);\n                }\n            }\n            else {\n                // if not a forced cleanup, just detach child from parent for now.\n                if (this._jsPlumb && this._jsPlumb.div && this._jsPlumb.div.parentNode)\n                    this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n                this.detached = true;\n            }\n\n        },\n        reattach:function(instance) {\n            if (this._jsPlumb.div != null) instance.getContainer().appendChild(this._jsPlumb.div);\n            this.detached = false;\n        },\n        computeMaxSize: function () {\n            var td = _getDimensions(this);\n            return Math.max(td[0], td[1]);\n        },\n        paint: function (p, containerExtents) {\n            if (!this._jsPlumb.initialised) {\n                this.getElement();\n                p.component.appendDisplayElement(this._jsPlumb.div);\n                this._jsPlumb.initialised = true;\n                if (this.detached) this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div);\n            }\n            this._jsPlumb.div.style.left = (p.component.x + p.d.minx) + \"px\";\n            this._jsPlumb.div.style.top = (p.component.y + p.d.miny) + \"px\";\n        }\n    });\n\n    /*\n     * Class: Overlays.Custom\n     * A Custom overlay. You supply a 'create' function which returns some DOM element, and jsPlumb positions it.\n     * The 'create' function is passed a Connection or Endpoint.\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     *     create - function for jsPlumb to call that returns a DOM element.\n     *     location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     *     id - optional id to use for later retrieval of this overlay.\n     *     \n     */\n    _jp.Overlays.Custom = function (params) {\n        this.type = \"Custom\";\n        AbstractDOMOverlay.apply(this, arguments);\n    };\n    _ju.extend(_jp.Overlays.Custom, AbstractDOMOverlay);\n\n    _jp.Overlays.GuideLines = function () {\n        var self = this;\n        self.length = 50;\n        self.lineWidth = 5;\n        this.type = \"GuideLines\";\n        AbstractOverlay.apply(this, arguments);\n        _jp.jsPlumbUIComponent.apply(this, arguments);\n        this.draw = function (connector, currentConnectionPaintStyle) {\n\n            var head = connector.pointAlongPathFrom(self.loc, self.length / 2),\n                mid = connector.pointOnPath(self.loc),\n                tail = _jg.pointOnLine(head, mid, self.length),\n                tailLine = _jg.perpendicularLineTo(head, tail, 40),\n                headLine = _jg.perpendicularLineTo(tail, head, 20);\n\n            return {\n                connector: connector,\n                head: head,\n                tail: tail,\n                headLine: headLine,\n                tailLine: tailLine,\n                minX: Math.min(head.x, tail.x, headLine[0].x, headLine[1].x),\n                minY: Math.min(head.y, tail.y, headLine[0].y, headLine[1].y),\n                maxX: Math.max(head.x, tail.x, headLine[0].x, headLine[1].x),\n                maxY: Math.max(head.y, tail.y, headLine[0].y, headLine[1].y)\n            };\n        };\n\n        // this.cleanup = function() { };  // nothing to clean up for GuideLines\n    };\n\n    /*\n     * Class: Overlays.Label\n\n     */\n    /*\n     * Function: Constructor\n     * \n     * Parameters:\n     *     cssClass - optional css class string to append to css class. This string is appended \"as-is\", so you can of course have multiple classes\n     *             defined.  This parameter is preferred to using labelStyle, borderWidth and borderStyle.\n     *     label - the label to paint.  May be a string or a function that returns a string.  Nothing will be painted if your label is null or your\n     *         label function returns null.  empty strings _will_ be painted.\n     *     location - distance (as a decimal from 0 to 1 inclusive) marking where the label should sit on the connector. defaults to 0.5.\n     *     id - optional id to use for later retrieval of this overlay.\n     * \n     *     \n     */\n    _jp.Overlays.Label = function (params) {\n        this.labelStyle = params.labelStyle;\n\n        var labelWidth = null, labelHeight = null, labelText = null, labelPadding = null;\n        this.cssClass = this.labelStyle != null ? this.labelStyle.cssClass : null;\n        var p = _jp.extend({\n            create: function () {\n                return jsPlumb.createElement(\"div\");\n            }}, params);\n        _jp.Overlays.Custom.call(this, p);\n        this.type = \"Label\";\n        this.label = params.label || \"\";\n        this.labelText = null;\n        if (this.labelStyle) {\n            var el = this.getElement();\n            this.labelStyle.font = this.labelStyle.font || \"12px sans-serif\";\n            el.style.font = this.labelStyle.font;\n            el.style.color = this.labelStyle.color || \"black\";\n            if (this.labelStyle.fillStyle) el.style.background = this.labelStyle.fillStyle;\n            if (this.labelStyle.borderWidth > 0) {\n                var dStyle = this.labelStyle.borderStyle ? this.labelStyle.borderStyle : \"black\";\n                el.style.border = this.labelStyle.borderWidth + \"px solid \" + dStyle;\n            }\n            if (this.labelStyle.padding) el.style.padding = this.labelStyle.padding;\n        }\n\n    };\n    _ju.extend(_jp.Overlays.Label, _jp.Overlays.Custom, {\n        cleanup: function (force) {\n            if (force) {\n                this.div = null;\n                this.label = null;\n                this.labelText = null;\n                this.cssClass = null;\n                this.labelStyle = null;\n            }\n        },\n        getLabel: function () {\n            return this.label;\n        },\n        /*\n         * Function: setLabel\n         * sets the label's, um, label.  you would think i'd call this function\n         * 'setText', but you can pass either a Function or a String to this, so\n         * it makes more sense as 'setLabel'. This uses innerHTML on the label div, so keep\n         * that in mind if you need escaped HTML.\n         */\n        setLabel: function (l) {\n            this.label = l;\n            this.labelText = null;\n            this.clearCachedDimensions();\n            this.update();\n            this.component.repaint();\n        },\n        getDimensions: function () {\n            this.update();\n            return AbstractDOMOverlay.prototype.getDimensions.apply(this, arguments);\n        },\n        update: function () {\n            if (typeof this.label == \"function\") {\n                var lt = this.label(this);\n                this.getElement().innerHTML = lt.replace(/\\r\\n/g, \"<br/>\");\n            }\n            else {\n                if (this.labelText == null) {\n                    this.labelText = this.label;\n                    this.getElement().innerHTML = this.labelText.replace(/\\r\\n/g, \"<br/>\");\n                }\n            }\n        },\n        updateFrom:function(d) {\n            if(d.label) this.setLabel(d.label);\n        }\n    });\n\n    // ********************************* END OF OVERLAY DEFINITIONS ***********************************************************************\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n *\n * Title:jsPlumb 2.1.1\n *\n * Provides a way to visually connect elements on an HTML page, using SVG.\n *\n * This file contains the base class for library adapters.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n *\n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n *\n * Dual licensed under the MIT and GPL2 licenses.\n */\n;(function() {\n    \"use strict\";\n    var root = this,\n        _jp = root.jsPlumb;\n\n    var _getEventManager = function(instance) {\n        var e = instance._mottle;\n        if (!e) {\n            e = instance._mottle = new root.Mottle();\n        }\n        return e;\n    };\n\n    _jp.extend(root.jsPlumbInstance.prototype, {\n        getEventManager:function() {\n            return _getEventManager(this);\n        },\n        on : function(el, event, callback) {\n            // TODO: here we would like to map the tap event if we know its\n            // an internal bind to a click. we have to know its internal because only\n            // then can we be sure that the UP event wont be consumed (tap is a synthesized\n            // event from a mousedown followed by a mouseup).\n            //event = { \"click\":\"tap\", \"dblclick\":\"dbltap\"}[event] || event;\n            this.getEventManager().on.apply(this, arguments);\n            return this;\n        },\n        off : function(el, event, callback) {\n            this.getEventManager().off.apply(this, arguments);\n            return this;\n        }\n    });\n\n\n}).call(typeof window !== 'undefined' ? window : this);\n;(function() {\n    \"use strict\";\n\n    var root = this,\n        _ju = root.jsPlumbUtil,\n        _jpi = root.jsPlumbInstance;\n\n    var GROUP_COLLAPSED_CLASS = \"jsplumb-group-collapsed\";\n    var GROUP_EXPANDED_CLASS = \"jsplumb-group-expanded\";\n    var GROUP_CONTAINER_SELECTOR = \"[jsplumb-group-content]\";\n    var ELEMENT_DRAGGABLE_EVENT = \"elementDraggable\";\n    var STOP = \"stop\";\n    var REVERT = \"revert\";\n    var GROUP_MANAGER = \"_groupManager\";\n    var GROUP = \"_jsPlumbGroup\";\n    var GROUP_DRAG_SCOPE = \"_jsPlumbGroupDrag\";\n    var EVT_CHILD_ADDED = \"group:addMember\";\n    var EVT_CHILD_REMOVED = \"group:removeMember\";\n    var EVT_GROUP_ADDED = \"group:add\";\n    var EVT_GROUP_REMOVED = \"group:remove\";\n    var EVT_EXPAND = \"group:expand\";\n    var EVT_COLLAPSE = \"group:collapse\";\n\n    var GroupManager = function(_jsPlumb) {\n        var _managedGroups = {}, _connectionSourceMap = {}, _connectionTargetMap = {}, self = this;\n\n        _jsPlumb.bind(\"connection\", function(p) {\n            if (p.source[GROUP] != null && p.target[GROUP] != null && p.source[GROUP] === p.target[GROUP]) {\n                _connectionSourceMap[p.connection.id] = p.source[GROUP];\n                _connectionTargetMap[p.connection.id] = p.source[GROUP];\n            }\n            else {\n                if (p.source[GROUP] != null) {\n                    _ju.suggest(p.source[GROUP].connections.source, p.connection);\n                    _connectionSourceMap[p.connection.id] = p.source[GROUP];\n                }\n                if (p.target[GROUP] != null) {\n                    _ju.suggest(p.target[GROUP].connections.target, p.connection);\n                    _connectionTargetMap[p.connection.id] = p.target[GROUP];\n                }\n            }\n        });\n\n        function _cleanupDetachedConnection(conn) {\n            delete conn.proxies;\n            var group = _connectionSourceMap[conn.id], f;\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionSourceMap[conn.id];\n            }\n\n            group = _connectionTargetMap[conn.id];\n            if (group != null) {\n                f = function(c) { return c.id === conn.id; };\n                _ju.removeWithFunction(group.connections.source, f);\n                _ju.removeWithFunction(group.connections.target, f);\n                delete _connectionTargetMap[conn.id];\n            }\n        }\n\n        _jsPlumb.bind(\"connectionDetached\", function(p) {\n            _cleanupDetachedConnection(p.connection);\n        });\n\n        _jsPlumb.bind(\"connectionMoved\", function(p) {\n            var connMap = p.index === 0 ? _connectionSourceMap : _connectionTargetMap;\n            var group = connMap[p.connection.id];\n            if (group) {\n                var list = group.connections[p.index === 0 ? \"source\" : \"target\"];\n                var idx = list.indexOf(p.connection);\n                if (idx != -1) {\n                    list.splice(idx, 1);\n                }\n            }\n        });\n\n        this.addGroup = function(group) {\n            _jsPlumb.addClass(group.el, GROUP_EXPANDED_CLASS);\n            _managedGroups[group.id] = group;\n            group.manager = this;\n            _updateConnectionsForGroup(group);\n            _jsPlumb.fire(EVT_GROUP_ADDED, { group:group });\n        };\n\n        this.addToGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n                group.add(el, doNotFireEvent);\n            }\n        };\n\n        this.removeFromGroup = function(group, el, doNotFireEvent) {\n            group = this.getGroup(group);\n            if (group) {\n                group.remove(el, null, doNotFireEvent);\n            }\n        };\n\n        this.getGroup = function(groupId) {\n            var group = groupId;\n            if (_ju.isString(groupId)) {\n                group = _managedGroups[groupId];\n                if (group == null) throw new TypeError(\"No such group [\" + groupId + \"]\");\n            }\n            return group;\n        };\n\n        this.getGroups = function() {\n            var o = [];\n            for (var g in _managedGroups) {\n                o.push(_managedGroups[g]);\n            }\n            return o;\n        };\n\n        this.removeGroup = function(group, deleteMembers) {\n            group = this.getGroup(group);\n            this.expandGroup(group, true); // this reinstates any original connections and removes all proxies, but does not fire an event.\n            group[deleteMembers ? \"removeAll\" : \"orphanAll\"]();\n            _jsPlumb.remove(group.getEl());\n            delete _managedGroups[group.id];\n            delete _jsPlumb._groups[group.id];\n            _jsPlumb.fire(EVT_GROUP_REMOVED, { group:group });\n        };\n\n        this.removeAllGroups = function(deleteMembers) {\n            for (var g in _managedGroups) {\n                this.removeGroup(_managedGroups[g], deleteMembers);\n            }\n        };\n\n        function _setVisible(group, state) {\n            var m = group.getMembers();\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb[state ? \"show\" : \"hide\"](m[i], true);\n            }\n        }\n\n        var _collapseConnection = this.collapseConnection = function(c, index, group) {\n\n            var proxyEp, groupEl = group.getEl(), groupElId = _jsPlumb.getId(groupEl),\n                originalElementId = c.endpoints[index].elementId;\n\n            var otherEl = c.endpoints[index === 0 ? 1 : 0].element;\n            if (otherEl[GROUP] && (!otherEl[GROUP].shouldProxy() && otherEl[GROUP].collapsed)) {\n                return;\n            }\n\n            c.proxies = c.proxies || [];\n            if(c.proxies[index]) {\n                proxyEp = c.proxies[index].ep;\n            }else {\n                proxyEp = _jsPlumb.addEndpoint(groupEl, {\n                    endpoint:group.getEndpoint(c, index),\n                    anchor:group.getAnchor(c, index),\n                    parameters:{\n                        isProxyEndpoint:true\n                    }\n                });\n                proxyEp._forceDeleteOnDetach = true;\n            }\n            // for this index, stash proxy info: the new EP, the original EP.\n            c.proxies[index] = { ep:proxyEp, originalEp: c.endpoints[index] };\n\n            // and advise the anchor manager\n            if (index === 0) {\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\n                // connection changed (you give the index), and here's the new element and element id.\"\n                _jsPlumb.anchorManager.sourceChanged(originalElementId, groupElId, c, groupEl);\n            }\n            else {\n                _jsPlumb.anchorManager.updateOtherEndpoint(c.endpoints[0].elementId, originalElementId, groupElId, c);\n                c.target = groupEl;\n                c.targetId = groupElId;\n            }\n\n\n            // detach the original EP from the connection.\n            c.proxies[index].originalEp.detachFromConnection(c, null, true);\n\n            // set the proxy as the new ep\n            proxyEp.connections = [ c ];\n            c.endpoints[index] = proxyEp;\n\n            c.setVisible(true);\n        };\n\n        this.collapseGroup = function(group) {\n            group = this.getGroup(group);\n            if (group == null || group.collapsed) return;\n            var groupEl = group.getEl();\n\n            // todo remove old proxy endpoints first, just in case?\n            //group.proxies.length = 0;\n\n            // hide all connections\n            _setVisible(group, false);\n\n            if (group.shouldProxy()) {\n                // collapses all connections in a group.\n                var _collapseSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _collapseConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _collapseSet(group.connections.source, 0);\n                _collapseSet(group.connections.target, 1);\n            }\n\n            group.collapsed = true;\n            _jsPlumb.removeClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.addClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            _jsPlumb.fire(EVT_COLLAPSE, { group:group  });\n        };\n\n        var _expandConnection = this.expandConnection = function(c, index, group) {\n\n            // if no proxies or none for this end of the connection, abort.\n            if (c.proxies == null || c.proxies[index] == null) return;\n\n            var groupElId = _jsPlumb.getId(group.getEl()),\n                originalElement = c.proxies[index].originalEp.element,\n                originalElementId = c.proxies[index].originalEp.elementId;\n\n            c.endpoints[index] = c.proxies[index].originalEp;\n            // and advise the anchor manager\n            if (index === 0) {\n                // TODO why are there two differently named methods? Why is there not one method that says \"some end of this\n                // connection changed (you give the index), and here's the new element and element id.\"\n                _jsPlumb.anchorManager.sourceChanged(groupElId, originalElementId, c, originalElement);\n            }\n            else {\n                _jsPlumb.anchorManager.updateOtherEndpoint(c.endpoints[0].elementId, groupElId, originalElementId, c);\n                c.target = originalElement;\n                c.targetId = originalElementId;\n            }\n\n            // detach the proxy EP from the connection.\n            c.proxies[index].ep.detachFromConnection(c, null, true);\n\n\n            c.proxies[index].originalEp.addConnection(c);\n\n            // cleanup\n            delete c.proxies[index];\n        };\n\n        this.expandGroup = function(group, doNotFireEvent) {\n\n            group = this.getGroup(group);\n\n            if (group == null || !group.collapsed) return;\n            var groupEl = group.getEl();\n\n            _setVisible(group, true);\n\n            if (group.shouldProxy()) {\n                // collapses all connections in a group.\n                var _expandSet = function (conns, index) {\n                    for (var i = 0; i < conns.length; i++) {\n                        var c = conns[i];\n                        _expandConnection(c, index, group);\n                    }\n                };\n\n                // setup proxies for sources and targets\n                _expandSet(group.connections.source, 0);\n                _expandSet(group.connections.target, 1);\n            }\n\n            group.collapsed = false;\n            _jsPlumb.addClass(groupEl, GROUP_EXPANDED_CLASS);\n            _jsPlumb.removeClass(groupEl, GROUP_COLLAPSED_CLASS);\n            _jsPlumb.revalidate(groupEl);\n            this.repaintGroup(group);\n            if (!doNotFireEvent) {\n                _jsPlumb.fire(EVT_EXPAND, { group: group});\n            }\n        };\n\n        this.repaintGroup = function(group) {\n            group = this.getGroup(group);\n            var m = group.getMembers();\n            for (var i = 0; i < m.length; i++) {\n                _jsPlumb.revalidate(m[i]);\n            }\n        };\n\n        // TODO refactor this with the code that responds to `connection` events.\n        function _updateConnectionsForGroup(group) {\n            var members = group.getMembers();\n            var c1 = _jsPlumb.getConnections({source:members}, true);\n            var c2 = _jsPlumb.getConnections({target:members}, true);\n            var processed = {};\n            group.connections.source.length = 0;\n            group.connections.target.length = 0;\n            var oneSet = function(c) {\n                for (var i = 0; i < c.length; i++) {\n                    if (processed[c[i].id]) continue;\n                    processed[c[i].id] = true;\n                    if (c[i].source._jsPlumbGroup === group) {\n                        if (c[i].target._jsPlumbGroup !== group) {\n                            group.connections.source.push(c[i]);\n                        }\n                        _connectionSourceMap[c[i].id] = group;\n                    }\n                    else if (c[i].target._jsPlumbGroup === group) {\n                        group.connections.target.push(c[i]);\n                        _connectionTargetMap[c[i].id] = group;\n                    }\n                }\n            };\n            oneSet(c1); oneSet(c2);\n        }\n\n        this.updateConnectionsForGroup = _updateConnectionsForGroup;\n        this.refreshAllGroups = function() {\n            for (var g in _managedGroups) {\n                _updateConnectionsForGroup(_managedGroups[g]);\n                _jsPlumb.dragManager.updateOffsets(_jsPlumb.getId(_managedGroups[g].getEl()));\n            }\n        };\n    };\n\n    /**\n     *\n     * @param {jsPlumbInstance} _jsPlumb Associated jsPlumb instance.\n     * @param {Object} params\n     * @param {Element} params.el The DOM element representing the Group.\n     * @param {String} [params.id] Optional ID for the Group. A UUID will be assigned as the Group's ID if you do not provide one.\n     * @param {Boolean} [params.constrain=false] If true, child elements will not be able to be dragged outside of the Group container.\n     * @param {Boolean} [params.revert=true] By default, child elements revert to the container if dragged outside. You can change this by setting `revert:false`. This behaviour is also overridden if you set `orphan` or `prune`.\n     * @param {Boolean} [params.orphan=false] If true, child elements dropped outside of the Group container will be removed from the Group (but not from the DOM).\n     * @param {Boolean} [params.prune=false] If true, child elements dropped outside of the Group container will be removed from the Group and also from the DOM.\n     * @param {Boolean} [params.dropOverride=false] If true, a child element that has been dropped onto some other Group will not be subject to the controls imposed by `prune`, `revert` or `orphan`.\n     * @constructor\n     */\n    var Group = function(_jsPlumb, params) {\n        var self = this;\n        var el = params.el;\n        this.getEl = function() { return el; };\n        this.id = params.id || _ju.uuid();\n        el._isJsPlumbGroup = true;\n        var da = _jsPlumb.getSelector(el, GROUP_CONTAINER_SELECTOR);\n        var dragArea = da && da.length > 0 ? da[0] : el;\n        var ghost = params.ghost === true;\n        var constrain = ghost || (params.constrain === true);\n        var revert = params.revert !== false;\n        var orphan = params.orphan === true;\n        var prune = params.prune === true;\n        var dropOverride = params.dropOverride === true;\n        var proxied = params.proxied !== false;\n        var elements = [];\n        this.connections = { source:[], target:[], internal:[] };\n\n        // this function, and getEndpoint below, are stubs for a future setup in which we can choose endpoint\n        // and anchor based upon the connection and the index (source/target) of the endpoint to be proxied.\n        this.getAnchor = function(conn, endpointIndex) {\n            return params.anchor || \"Continuous\";\n        };\n\n        this.getEndpoint = function(conn, endpointIndex) {\n            return params.endpoint || [ \"Dot\", { radius:10 }];\n        };\n\n        this.collapsed = false;\n        if (params.draggable !== false) {\n            var opts = {\n                stop:function(params) {\n                    _jsPlumb.fire(\"groupDragStop\", jsPlumb.extend(params, {group:self}));\n                },\n                scope:GROUP_DRAG_SCOPE\n            };\n            if (params.dragOptions) {\n                root.jsPlumb.extend(opts, params.dragOptions);\n            }\n            _jsPlumb.draggable(params.el, opts);\n        }\n        if (params.droppable !== false) {\n            _jsPlumb.droppable(params.el, {\n                drop:function(p) {\n                    var groupManager = _jsPlumb.getGroupManager();\n                    var _el = p.drag.el;\n                    if (_el._isJsPlumbGroup) return;\n                    var currentGroup = _el._jsPlumbGroup;\n                    // if already a member of this group, do nothing\n                    if (currentGroup !== self) {\n                        var elpos = _jsPlumb.getOffset(_el, true);\n                        var cpos = self.collapsed ? _jsPlumb.getOffset(el, true) : _jsPlumb.getOffset(dragArea, true);\n\n                        // otherwise, transfer to this group.\n                        if (currentGroup != null) {\n                            if (currentGroup.overrideDrop(_el, self)) {\n                                return;\n                            }\n                            currentGroup.remove(_el, true);\n                            groupManager.updateConnectionsForGroup(currentGroup);\n                        }\n                        self.add(_el, true);\n\n                        var handleDroppedConnections = function(list, index) {\n                            var oidx = index == 0 ? 1 : 0;\n                            list.each(function(c) {\n                                c.setVisible(false);\n                                if (c.endpoints[oidx].element._jsPlumbGroup === self) {\n                                    c.endpoints[oidx].setVisible(false);\n                                    groupManager.expandConnection(c, oidx, self);\n                                }\n                                else {\n                                    c.endpoints[index].setVisible(false);\n                                    groupManager.collapseConnection(c, index, self);\n                                }\n                            });\n                        };\n\n                        if (self.collapsed) {\n                            handleDroppedConnections(_jsPlumb.select({source: _el}), 0);\n                            handleDroppedConnections(_jsPlumb.select({target: _el}), 1);\n                        }\n\n                        var elId = _jsPlumb.getId(_el);\n                        _jsPlumb.dragManager.setParent(_el, elId, el, _jsPlumb.getId(el), elpos);\n                        _jsPlumb.setPosition(_el, {left:elpos.left - cpos.left, top:elpos.top - cpos.top});\n                        _jsPlumb.dragManager.revalidateParent(_el, elId, elpos);\n\n                        groupManager.updateConnectionsForGroup(self);\n\n                        setTimeout(function() {\n                            _jsPlumb.fire(EVT_CHILD_ADDED, {group: self, el: _el});\n                        }, 0);\n                    }\n                }\n            });\n        }\n        var _each = function(_el, fn) {\n            var els = _el.nodeType == null ?  _el : [ _el ];\n            for (var i = 0; i < els.length; i++) {\n                fn(els[i]);\n            }\n        };\n\n        this.overrideDrop = function(_el, targetGroup) {\n            return dropOverride && (revert || prune || orphan);\n        };\n\n        this.add = function(_el, doNotFireEvent) {\n            _each(_el, function(__el) {\n                __el._jsPlumbGroup = self;\n                elements.push(__el);\n                // test if draggable and add handlers if so.\n                if (_jsPlumb.isAlreadyDraggable(__el)) {\n                    _bindDragHandlers(__el);\n                }\n\n                if (__el.parentNode != dragArea) {\n                    dragArea.appendChild(__el);\n                }\n\n                if (!doNotFireEvent) {\n                    _jsPlumb.fire(EVT_CHILD_ADDED, {group: self, el: __el});\n                }\n            });\n        };\n        this.remove = function(el, manipulateDOM, doNotFireEvent) {\n            _each(el, function(__el) {\n                delete __el._jsPlumbGroup;\n                _ju.removeWithFunction(elements, function(e) {\n                    return e === __el;\n                });\n                if (manipulateDOM) {\n                    try { self.getEl().removeChild(__el); }\n                    catch (e) {\n                        jsPlumbUtil.log(\"Could not remove element from Group \" + e);\n                    }\n                }\n                _unbindDragHandlers(__el);\n                if (!doNotFireEvent) {\n                    _jsPlumb.fire(EVT_CHILD_REMOVED, {group: self, el: __el});\n                }\n            });\n        };\n        this.removeAll = function() {\n            for (var i = 0; i < elements.length; i++) {\n                _jsPlumb.remove(elements[i]);\n            }\n            elements.length = 0;\n        };\n        this.orphanAll = function() {\n            for (var i = 0; i < elements.length; i++) {\n                _orphan(elements[i]);\n            }\n            elements.length = 0;\n        };\n        this.getMembers = function() { return elements; };\n\n        el[GROUP] = this;\n\n        _jsPlumb.bind(ELEMENT_DRAGGABLE_EVENT, function(dragParams) {\n            // if its for the current group,\n            if (dragParams.el._jsPlumbGroup == this) {\n                _bindDragHandlers(dragParams.el);\n            }\n        }.bind(this));\n\n        function _findParent(_el) {\n            return _el.offsetParent;\n        }\n\n        function _isInsideParent(_el, pos) {\n            var p = _findParent(_el),\n                s = _jsPlumb.getSize(p),\n                ss = _jsPlumb.getSize(_el),\n                leftEdge = pos[0],\n                rightEdge = leftEdge + ss[0],\n                topEdge = pos[1],\n                bottomEdge = topEdge + ss[1];\n\n            return rightEdge > 0 && leftEdge < s[0] && bottomEdge > 0 && topEdge < s[1];\n        }\n\n        //\n        // orphaning an element means taking it out of the group and adding it to the main jsplumb container.\n        //\n        function _orphan(_el) {\n            var id = _jsPlumb.getId(_el);\n            var pos = _jsPlumb.getOffset(_el);\n            _el.parentNode.removeChild(_el);\n            _jsPlumb.getContainer().appendChild(_el);\n            _jsPlumb.setPosition(_el, pos);\n            delete _el._jsPlumbGroup;\n            _unbindDragHandlers(_el);\n            _jsPlumb.dragManager.clearParent(_el, id);\n        }\n\n        //\n        // remove an element from the group, then either prune it from the jsplumb instance, or just orphan it.\n        //\n        function _pruneOrOrphan(p) {\n            if (!_isInsideParent(p.el, p.pos)) {\n                p.el._jsPlumbGroup.remove(p.el);\n                if (prune) {\n                    _jsPlumb.remove(p.el);\n                } else {\n                    _orphan(p.el);\n                }\n            }\n        }\n\n        //\n        // redraws the element\n        //\n        function _revalidate(_el) {\n            var id = _jsPlumb.getId(_el);\n            _jsPlumb.revalidate(_el);\n            _jsPlumb.dragManager.revalidateParent(_el, id);\n        }\n\n        //\n        // unbind the group specific drag/revert handlers.\n        //\n        function _unbindDragHandlers(_el) {\n            if (prune || orphan) {\n                _el._katavorioDrag.off(STOP, _pruneOrOrphan);\n            }\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.off(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(null);\n            }\n        }\n\n        function _bindDragHandlers(_el) {\n            if (prune || orphan) {\n                _el._katavorioDrag.on(STOP, _pruneOrOrphan);\n            }\n\n            if (constrain) {\n                _el._katavorioDrag.setConstrain(true);\n            }\n\n            if (ghost) {\n                _el._katavorioDrag.setUseGhostProxy(true);\n            }\n\n            if (!prune && !orphan && revert) {\n                _el._katavorioDrag.on(REVERT, _revalidate);\n                _el._katavorioDrag.setRevert(function(__el, pos) {\n                    return !_isInsideParent(__el, pos);\n                });\n            }\n        }\n\n        this.shouldProxy = function() {\n            return proxied;\n        };\n\n        _jsPlumb.getGroupManager().addGroup(this);\n    };\n\n    /**\n     * Adds a group to the jsPlumb instance.\n     * @method addGroup\n     * @param {Object} params\n     * @return {Group} The newly created Group.\n     */\n    _jpi.prototype.addGroup = function(params) {\n        var j = this;\n        j._groups = j._groups || {};\n        if (j._groups[params.id] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; a Group with that ID exists\");\n        }\n        if (params.el[GROUP] != null) {\n            throw new TypeError(\"cannot create Group [\" + params.id + \"]; the given element is already a Group\");\n        }\n        var group = new Group(j, params);\n        j._groups[group.id] = group;\n        return group;\n    };\n\n    /**\n     * Add an element to a group.\n     * @method addToGroup\n     * @param {String} group Group, or ID of the group, to add the element to.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.addToGroup = function(group, el, doNotFireEvent) {\n        this.getGroupManager().addToGroup(group, el, doNotFireEvent);\n    };\n\n    /**\n     * Remove an element from a group.\n     * @method removeFromGroup\n     * @param {String} group Group, or ID of the group, to remove the element from.\n     * @param {Element} el Element to add to the group.\n     */\n    _jpi.prototype.removeFromGroup = function(group, el, doNotFireEvent) {\n        this.getGroupManager().removeFromGroup(group, el, doNotFireEvent);\n    };\n\n    /**\n     * Remove a group, and optionally remove its members from the jsPlumb instance.\n     * @method removeGroup\n     * @param {String|Group} group Group to delete, or ID of Grrup to delete.\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the group. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     */\n    _jpi.prototype.removeGroup = function(group, deleteMembers) {\n        this.getGroupManager().removeGroup(group, deleteMembers);\n    };\n\n    /**\n     * Remove all groups, and optionally remove their members from the jsPlumb instance.\n     * @method removeAllGroup\n     * @param {Boolean} [deleteMembers=false] If true, group members will be removed along with the groups. Otherwise they will\n     * just be 'orphaned' (returned to the main container).\n     */\n    _jpi.prototype.removeAllGroups = function(deleteMembers) {\n        this.getGroupManager().removeAllGroups(deleteMembers);\n    };\n\n    /**\n     * Get a Group\n     * @method getGroup\n     * @param {String} groupId ID of the group to get\n     * @return {Group} Group with the given ID, null if not found.\n     */\n    _jpi.prototype.getGroup = function(groupId) {\n        return this.getGroupManager().getGroup(groupId);\n    };\n\n    /**\n     * Gets all the Groups managed by the jsPlumb instance.\n     * @returns {Group[]} List of Groups. Empty if none.\n     */\n    _jpi.prototype.getGroups = function() {\n        return this.getGroupManager().getGroups();\n    };\n\n    /**\n     * Expands a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to expand a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Hides any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Proxies all connections for which the source or target is a member of the group.\n     * - Hides the proxied connections.\n     * - Adds the jsplumb-group-expanded class to the group's element\n     * - Removes the jsplumb-group-collapsed class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.expandGroup = function(group) {\n        this.getGroupManager().expandGroup(group);\n    };\n\n    /**\n     * Collapses a group element. jsPlumb doesn't do \"everything\" for you here, because what it means to collapse a Group\n     * will vary from application to application. jsPlumb does these things:\n     *\n     * - Shows any connections that are internal to the group (connections between members, and connections from member of\n     * the group to the group itself)\n     * - Removes proxies for all connections for which the source or target is a member of the group.\n     * - Shows the previously proxied connections.\n     * - Adds the jsplumb-group-collapsed class to the group's element\n     * - Removes the jsplumb-group-expanded class from the group's element.\n     *\n     * @method expandGroup\n     * @param {String|Group} group Group to expand, or ID of Group to expand.\n     */\n    _jpi.prototype.collapseGroup = function(groupId) {\n        this.getGroupManager().collapseGroup(groupId);\n    };\n\n\n    _jpi.prototype.repaintGroup = function(group) {\n        this.getGroupManager().repaintGroup(group);\n    };\n\n    /**\n     * Collapses or expands a group element depending on its current state. See notes in the collapseGroup and expandGroup method.\n     *\n     * @method toggleGroup\n     * @param {String|Group} group Group to expand/collapse, or ID of Group to expand/collapse.\n     */\n    _jpi.prototype.toggleGroup = function(group) {\n        group = this.getGroupManager().getGroup(group);\n        if (group != null) {\n            this.getGroupManager()[group.collapsed ? \"expandGroup\" : \"collapseGroup\"](group);\n        }\n    };\n\n    //\n    // lazy init a group manager for the given jsplumb instance.\n    //\n    _jpi.prototype.getGroupManager = function() {\n        var mgr = this[GROUP_MANAGER];\n        if (mgr == null) {\n            mgr = this[GROUP_MANAGER] = new GroupManager(this);\n        }\n        return mgr;\n    };\n\n    _jpi.prototype.removeGroupManager = function() {\n        delete this[GROUP_MANAGER];\n    };\n\n    /**\n     * Gets the Group that the given element belongs to, null if none.\n     * @method getGroupFor\n     * @param {String|Element} el Element, or element ID.\n     * @returns {Group} A Group, if found, or null.\n     */\n    _jpi.prototype.getGroupFor = function(el) {\n        el = this.getElement(el);\n        if (el) {\n            return el[GROUP];\n        }\n    };\n\n}).call(typeof window !== 'undefined' ? window : this);\n\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the 'flowchart' connectors, consisting of vertical and horizontal line segments.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var Flowchart = function (params) {\n        this.type = \"Flowchart\";\n        params = params || {};\n        params.stub = params.stub == null ? 30 : params.stub;\n        var segments,\n            _super = _jp.Connectors.AbstractConnector.apply(this, arguments),\n            midpoint = params.midpoint == null ? 0.5 : params.midpoint,\n            alwaysRespectStubs = params.alwaysRespectStubs === true,\n            lastx = null, lasty = null, lastOrientation,\n            cornerRadius = params.cornerRadius != null ? params.cornerRadius : 0,\n\n            // TODO now common between this and AbstractBezierEditor; refactor into superclass?\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n\n            sgn = function (n) {\n                return n < 0 ? -1 : n === 0 ? 0 : 1;\n            },\n            /**\n             * helper method to add a segment.\n             */\n            addSegment = function (segments, x, y, paintInfo) {\n                if (lastx == x && lasty == y) return;\n                var lx = lastx == null ? paintInfo.sx : lastx,\n                    ly = lasty == null ? paintInfo.sy : lasty,\n                    o = lx == x ? \"v\" : \"h\",\n                    sgnx = sgn(x - lx),\n                    sgny = sgn(y - ly);\n\n                lastx = x;\n                lasty = y;\n                segments.push([lx, ly, x, y, o, sgnx, sgny]);\n            },\n            segLength = function (s) {\n                return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\n            },\n            _cloneArray = function (a) {\n                var _a = [];\n                _a.push.apply(_a, a);\n                return _a;\n            },\n            writeSegments = function (conn, segments, paintInfo) {\n                var current = null, next;\n                for (var i = 0; i < segments.length - 1; i++) {\n\n                    current = current || _cloneArray(segments[i]);\n                    next = _cloneArray(segments[i + 1]);\n                    if (cornerRadius > 0 && current[4] != next[4]) {\n                        var radiusToUse = Math.min(cornerRadius, segLength(current), segLength(next));\n                        // right angle. adjust current segment's end point, and next segment's start point.\n                        current[2] -= current[5] * radiusToUse;\n                        current[3] -= current[6] * radiusToUse;\n                        next[0] += next[5] * radiusToUse;\n                        next[1] += next[6] * radiusToUse;\n                        var ac = (current[6] == next[5] && next[5] == 1) ||\n                                ((current[6] == next[5] && next[5] === 0) && current[5] != next[6]) ||\n                                (current[6] == next[5] && next[5] == -1),\n                            sgny = next[1] > current[3] ? 1 : -1,\n                            sgnx = next[0] > current[2] ? 1 : -1,\n                            sgnEqual = sgny == sgnx,\n                            cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2],\n                            cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\n\n                        _super.addSegment(conn, \"Straight\", {\n                            x1: current[0], y1: current[1], x2: current[2], y2: current[3]\n                        });\n\n                        _super.addSegment(conn, \"Arc\", {\n                            r: radiusToUse,\n                            x1: current[2],\n                            y1: current[3],\n                            x2: next[0],\n                            y2: next[1],\n                            cx: cx,\n                            cy: cy,\n                            ac: ac\n                        });\n                    }\n                    else {\n                        // dx + dy are used to adjust for line width.\n                        var dx = (current[2] == current[0]) ? 0 : (current[2] > current[0]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2),\n                            dy = (current[3] == current[1]) ? 0 : (current[3] > current[1]) ? (paintInfo.lw / 2) : -(paintInfo.lw / 2);\n                        _super.addSegment(conn, \"Straight\", {\n                            x1: current[0] - dx, y1: current[1] - dy, x2: current[2] + dx, y2: current[3] + dy\n                        });\n                    }\n                    current = next;\n                }\n                if (next != null) {\n                    // last segment\n                    _super.addSegment(conn, \"Straight\", {\n                        x1: next[0], y1: next[1], x2: next[2], y2: next[3]\n                    });\n                }\n            };\n\n        this._compute = function (paintInfo, params) {\n\n            segments = [];\n            lastx = null;\n            lasty = null;\n            lastOrientation = null;\n\n            var commonStubCalculator = function () {\n                return [ paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY ];\n            },\n                stubCalculators = {\n                    perpendicular: commonStubCalculator,\n                    orthogonal: commonStubCalculator,\n                    opposite: function (axis) {\n                        var pi = paintInfo,\n                            idx = axis == \"x\" ? 0 : 1,\n                            areInProximity = {\n                                \"x\": function () {\n                                    return ( (pi.so[idx] == 1 && (\n                                        ( (pi.startStubX > pi.endStubX) && (pi.tx > pi.startStubX) ) ||\n                                        ( (pi.sx > pi.endStubX) && (pi.tx > pi.sx))))) ||\n\n                                        ( (pi.so[idx] == -1 && (\n                                            ( (pi.startStubX < pi.endStubX) && (pi.tx < pi.startStubX) ) ||\n                                            ( (pi.sx < pi.endStubX) && (pi.tx < pi.sx)))));\n                                },\n                                \"y\": function () {\n                                    return ( (pi.so[idx] == 1 && (\n                                        ( (pi.startStubY > pi.endStubY) && (pi.ty > pi.startStubY) ) ||\n                                        ( (pi.sy > pi.endStubY) && (pi.ty > pi.sy))))) ||\n\n                                        ( (pi.so[idx] == -1 && (\n                                            ( (pi.startStubY < pi.endStubY) && (pi.ty < pi.startStubY) ) ||\n                                            ( (pi.sy < pi.endStubY) && (pi.ty < pi.sy)))));\n                                }\n                            };\n\n                        if (!alwaysRespectStubs && areInProximity[axis]()) {\n                            return {\n                                \"x\": [(paintInfo.sx + paintInfo.tx) / 2, paintInfo.startStubY, (paintInfo.sx + paintInfo.tx) / 2, paintInfo.endStubY],\n                                \"y\": [paintInfo.startStubX, (paintInfo.sy + paintInfo.ty) / 2, paintInfo.endStubX, (paintInfo.sy + paintInfo.ty) / 2]\n                            }[axis];\n                        }\n                        else {\n                            return [ paintInfo.startStubX, paintInfo.startStubY, paintInfo.endStubX, paintInfo.endStubY ];\n                        }\n                    }\n                };\n\n            // calculate Stubs.\n            var stubs = stubCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis),\n                idx = paintInfo.sourceAxis == \"x\" ? 0 : 1,\n                oidx = paintInfo.sourceAxis == \"x\" ? 1 : 0,\n                ss = stubs[idx],\n                oss = stubs[oidx],\n                es = stubs[idx + 2],\n                oes = stubs[oidx + 2];\n\n            // add the start stub segment. use stubs for loopback as it will look better, with the loop spaced\n            // away from the element.\n            addSegment(segments, stubs[0], stubs[1], paintInfo);\n\n            // if its a loopback and we should treat it differently.\n            if (false &&params.sourcePos[0] == params.targetPos[0] && params.sourcePos[1] == params.targetPos[1]) {\n\n                // we use loopbackRadius here, as statemachine connectors do.\n                // so we go radius to the left from stubs[0], then upwards by 2*radius, to the right by 2*radius,\n                // down by 2*radius, left by radius.\n                addSegment(segments, stubs[0] - loopbackRadius, stubs[1], paintInfo);\n                addSegment(segments, stubs[0] - loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n                addSegment(segments, stubs[0] + loopbackRadius, stubs[1] - (2 * loopbackRadius), paintInfo);\n                addSegment(segments, stubs[0] + loopbackRadius, stubs[1], paintInfo);\n                addSegment(segments, stubs[0], stubs[1], paintInfo);\n\n            }\n            else {\n\n\n                var midx = paintInfo.startStubX + ((paintInfo.endStubX - paintInfo.startStubX) * midpoint),\n                    midy = paintInfo.startStubY + ((paintInfo.endStubY - paintInfo.startStubY) * midpoint);\n\n                var orientations = { x: [ 0, 1 ], y: [ 1, 0 ] },\n                    lineCalculators = {\n                        perpendicular: function (axis) {\n                            var pi = paintInfo,\n                                sis = {\n                                    x: [\n                                        [ [ 1, 2, 3, 4 ], null, [ 2, 1, 4, 3 ] ],\n                                        null,\n                                        [ [ 4, 3, 2, 1 ], null, [ 3, 4, 1, 2 ] ]\n                                    ],\n                                    y: [\n                                        [ [ 3, 2, 1, 4 ], null, [ 2, 3, 4, 1 ] ],\n                                        null,\n                                        [ [ 4, 1, 2, 3 ], null, [ 1, 4, 3, 2 ] ]\n                                    ]\n                                },\n                                stubs = {\n                                    x: [ [ pi.startStubX, pi.endStubX ], null, [ pi.endStubX, pi.startStubX ] ],\n                                    y: [ [ pi.startStubY, pi.endStubY ], null, [ pi.endStubY, pi.startStubY ] ]\n                                },\n                                midLines = {\n                                    x: [ [ midx, pi.startStubY ], [ midx, pi.endStubY ] ],\n                                    y: [ [ pi.startStubX, midy ], [ pi.endStubX, midy ] ]\n                                },\n                                linesToEnd = {\n                                    x: [ [ pi.endStubX, pi.startStubY ] ],\n                                    y: [ [ pi.startStubX, pi.endStubY ] ]\n                                },\n                                startToEnd = {\n                                    x: [ [ pi.startStubX, pi.endStubY ], [ pi.endStubX, pi.endStubY ] ],\n                                    y: [ [ pi.endStubX, pi.startStubY ], [ pi.endStubX, pi.endStubY ] ]\n                                },\n                                startToMidToEnd = {\n                                    x: [ [ pi.startStubX, midy ], [ pi.endStubX, midy ], [ pi.endStubX, pi.endStubY ] ],\n                                    y: [ [ midx, pi.startStubY ], [ midx, pi.endStubY ], [ pi.endStubX, pi.endStubY ] ]\n                                },\n                                otherStubs = {\n                                    x: [ pi.startStubY, pi.endStubY ],\n                                    y: [ pi.startStubX, pi.endStubX ]\n                                },\n                                soIdx = orientations[axis][0], toIdx = orientations[axis][1],\n                                _so = pi.so[soIdx] + 1,\n                                _to = pi.to[toIdx] + 1,\n                                otherFlipped = (pi.to[toIdx] == -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (pi.to[toIdx] == 1 && (otherStubs[axis][1] > otherStubs[axis][0])),\n                                stub1 = stubs[axis][_so][0],\n                                stub2 = stubs[axis][_so][1],\n                                segmentIndexes = sis[axis][_so][_to];\n\n                            if (pi.segment == segmentIndexes[3] || (pi.segment == segmentIndexes[2] && otherFlipped)) {\n                                return midLines[axis];\n                            }\n                            else if (pi.segment == segmentIndexes[2] && stub2 < stub1) {\n                                return linesToEnd[axis];\n                            }\n                            else if ((pi.segment == segmentIndexes[2] && stub2 >= stub1) || (pi.segment == segmentIndexes[1] && !otherFlipped)) {\n                                return startToMidToEnd[axis];\n                            }\n                            else if (pi.segment == segmentIndexes[0] || (pi.segment == segmentIndexes[1] && otherFlipped)) {\n                                return startToEnd[axis];\n                            }\n                        },\n                        orthogonal: function (axis, startStub, otherStartStub, endStub, otherEndStub) {\n                            var pi = paintInfo,\n                                extent = {\n                                    \"x\": pi.so[0] == -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\n                                    \"y\": pi.so[1] == -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\n                                }[axis];\n\n                            return {\n                                \"x\": [\n                                    [ extent, otherStartStub ],\n                                    [ extent, otherEndStub ],\n                                    [ endStub, otherEndStub ]\n                                ],\n                                \"y\": [\n                                    [ otherStartStub, extent ],\n                                    [ otherEndStub, extent ],\n                                    [ otherEndStub, endStub ]\n                                ]\n                            }[axis];\n                        },\n                        opposite: function (axis, ss, oss, es) {\n                            var pi = paintInfo,\n                                otherAxis = {\"x\": \"y\", \"y\": \"x\"}[axis],\n                                dim = {\"x\": \"height\", \"y\": \"width\"}[axis],\n                                comparator = pi[\"is\" + axis.toUpperCase() + \"GreaterThanStubTimes2\"];\n\n                            if (params.sourceEndpoint.elementId == params.targetEndpoint.elementId) {\n                                var _val = oss + ((1 - params.sourceEndpoint.anchor[otherAxis]) * params.sourceInfo[dim]) + _super.maxStub;\n                                return {\n                                    \"x\": [\n                                        [ ss, _val ],\n                                        [ es, _val ]\n                                    ],\n                                    \"y\": [\n                                        [ _val, ss ],\n                                        [ _val, es ]\n                                    ]\n                                }[axis];\n\n                            }\n                            else if (!comparator || (pi.so[idx] == 1 && ss > es) || (pi.so[idx] == -1 && ss < es)) {\n                                return {\n                                    \"x\": [\n                                        [ ss, midy ],\n                                        [ es, midy ]\n                                    ],\n                                    \"y\": [\n                                        [ midx, ss ],\n                                        [ midx, es ]\n                                    ]\n                                }[axis];\n                            }\n                            else if ((pi.so[idx] == 1 && ss < es) || (pi.so[idx] == -1 && ss > es)) {\n                                return {\n                                    \"x\": [\n                                        [ midx, pi.sy ],\n                                        [ midx, pi.ty ]\n                                    ],\n                                    \"y\": [\n                                        [ pi.sx, midy ],\n                                        [ pi.tx, midy ]\n                                    ]\n                                }[axis];\n                            }\n                        }\n                    };\n\n                // compute the rest of the line\n                var p = lineCalculators[paintInfo.anchorOrientation](paintInfo.sourceAxis, ss, oss, es, oes);\n                if (p) {\n                    for (var i = 0; i < p.length; i++) {\n                        addSegment(segments, p[i][0], p[i][1], paintInfo);\n                    }\n                }\n\n                // line to end stub\n                addSegment(segments, stubs[2], stubs[3], paintInfo);\n\n            }\n\n            // end stub to end (common)\n            addSegment(segments, paintInfo.tx, paintInfo.ty, paintInfo);\n\n            // write out the segments.\n            writeSegments(this, segments, paintInfo);\n        };\n\n        /*this.getPath = function () {\n            var _last = null, _lastAxis = null, s = [], segs = segments;\n            for (var i = 0; i < segs.length; i++) {\n                var seg = segs[i], axis = seg[4], axisIndex = (axis == \"v\" ? 3 : 2);\n                if (_last != null && _lastAxis === axis) {\n                    _last[axisIndex] = seg[axisIndex];\n                }\n                else {\n                    if (seg[0] != seg[2] || seg[1] != seg[3]) {\n                        s.push({\n                            start: [ seg[0], seg[1] ],\n                            end: [ seg[2], seg[3] ]\n                        });\n                        _last = seg;\n                        _lastAxis = seg[4];\n                    }\n                }\n            }\n            return s;\n        };*/\n    };\n\n    _ju.extend(Flowchart, _jp.Connectors.AbstractConnector);\n    _jp.registerConnectorType(Flowchart, \"Flowchart\");\n}).call(typeof window !== 'undefined' ? window : this);\n/*\n * This file contains the code for the Bezier connector type.\n *\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    _jp.Connectors.AbstractBezierConnector = function(params) {\n        params = params || {};\n        var showLoopback = params.showLoopback !== false,\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            loopbackRadius = params.loopbackRadius || 25,\n            isLoopbackCurrently = false,\n            _super;\n\n        this.overrideSetEditable = function() { return !isLoopbackCurrently; };\n\n        this._compute = function (paintInfo, p) {\n\n            var sp = p.sourcePos,\n                tp = p.targetPos,\n                _w = Math.abs(sp[0] - tp[0]),\n                _h = Math.abs(sp[1] - tp[1]);\n\n            if (!showLoopback || (p.sourceEndpoint.elementId !== p.targetEndpoint.elementId)) {\n                isLoopbackCurrently = false;\n                this._computeBezier(paintInfo, p, sp, tp, _w, _h);\n            } else {\n                isLoopbackCurrently = true;\n                // a loopback connector.  draw an arc from one anchor to the other.\n                var x1 = p.sourcePos[0], y1 = p.sourcePos[1] - margin,\n                    cx = x1, cy = y1 - loopbackRadius,\n                // canvas sizing stuff, to ensure the whole painted area is visible.\n                    _x = cx - loopbackRadius,\n                    _y = cy - loopbackRadius;\n\n                _w = 2 * loopbackRadius;\n                _h = 2 * loopbackRadius;\n\n                paintInfo.points[0] = _x;\n                paintInfo.points[1] = _y;\n                paintInfo.points[2] = _w;\n                paintInfo.points[3] = _h;\n\n                // ADD AN ARC SEGMENT.\n                _super.addSegment(this, \"Arc\", {\n                    loopback: true,\n                    x1: (x1 - _x) + 4,\n                    y1: y1 - _y,\n                    startAngle: 0,\n                    endAngle: 2 * Math.PI,\n                    r: loopbackRadius,\n                    ac: !clockwise,\n                    x2: (x1 - _x) - 4,\n                    y2: y1 - _y,\n                    cx: cx - _x,\n                    cy: cy - _y\n                });\n            }\n        };\n\n        _super = _jp.Connectors.AbstractConnector.apply(this, arguments);\n        return _super;\n    };\n    _ju.extend(_jp.Connectors.AbstractBezierConnector, _jp.Connectors.AbstractConnector);\n\n    var Bezier = function (params) {\n        params = params || {};\n        this.type = \"Bezier\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            majorAnchor = params.curviness || 150,\n            minorAnchor = 10;\n\n        this.getCurviness = function () {\n            return majorAnchor;\n        };\n\n        this._findControlPoint = function (point, sourceAnchorPosition, targetAnchorPosition, sourceEndpoint, targetEndpoint, soo, too) {\n            // determine if the two anchors are perpendicular to each other in their orientation.  we swap the control\n            // points around if so (code could be tightened up)\n            var perpendicular = soo[0] != too[0] || soo[1] == too[1],\n                p = [];\n\n            if (!perpendicular) {\n                if (soo[0] === 0) // X\n                    p.push(sourceAnchorPosition[0] < targetAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                else p.push(point[0] - (majorAnchor * soo[0]));\n\n                if (soo[1] === 0) // Y\n                    p.push(sourceAnchorPosition[1] < targetAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                else p.push(point[1] + (majorAnchor * too[1]));\n            }\n            else {\n                if (too[0] === 0) // X\n                    p.push(targetAnchorPosition[0] < sourceAnchorPosition[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n                else p.push(point[0] + (majorAnchor * too[0]));\n\n                if (too[1] === 0) // Y\n                    p.push(targetAnchorPosition[1] < sourceAnchorPosition[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n                else p.push(point[1] + (majorAnchor * soo[1]));\n            }\n\n            return p;\n        };\n\n        this._computeBezier = function (paintInfo, p, sp, tp, _w, _h) {\n\n            var geometry = this.getGeometry(), _CP, _CP2,\n                _sx = sp[0] < tp[0] ? _w : 0,\n                _sy = sp[1] < tp[1] ? _h : 0,\n                _tx = sp[0] < tp[0] ? 0 : _w,\n                _ty = sp[1] < tp[1] ? 0 : _h;\n\n            if ((this.hasBeenEdited() || this.isEditing()) && geometry != null && geometry.controlPoints != null && geometry.controlPoints[0] != null && geometry.controlPoints[1] != null) {\n                _CP = geometry.controlPoints[0];\n                _CP2 = geometry.controlPoints[1];\n            }\n            else {\n                _CP = this._findControlPoint([_sx, _sy], sp, tp, p.sourceEndpoint, p.targetEndpoint, paintInfo.so, paintInfo.to);\n                _CP2 = this._findControlPoint([_tx, _ty], tp, sp, p.targetEndpoint, p.sourceEndpoint, paintInfo.to, paintInfo.so);\n            }\n\n            _super.setGeometry({controlPoints:[_CP, _CP2]}, true);\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _sx, y1: _sy, x2: _tx, y2: _ty,\n                cp1x: _CP[0], cp1y: _CP[1], cp2x: _CP2[0], cp2y: _CP2[1]\n            });\n        };\n\n\n    };\n\n    _ju.extend(Bezier, _jp.Connectors.AbstractBezierConnector);\n    _jp.registerConnectorType(Bezier, \"Bezier\");\n\n}).call(typeof window !== 'undefined' ? window : this);\n/*\n * This file contains the state machine connectors, which extend AbstractBezierConnector.\n *\n * Copyright (c) 2010 - 2015 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * https://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var _segment = function (x1, y1, x2, y2) {\n            if (x1 <= x2 && y2 <= y1) return 1;\n            else if (x1 <= x2 && y1 <= y2) return 2;\n            else if (x2 <= x1 && y2 >= y1) return 3;\n            return 4;\n        },\n\n    // the control point we will use depends on the faces to which each end of the connection is assigned, specifically whether or not the\n    // two faces are parallel or perpendicular.  if they are parallel then the control point lies on the midpoint of the axis in which they\n    // are parellel and varies only in the other axis; this variation is proportional to the distance that the anchor points lie from the\n    // center of that face.  if the two faces are perpendicular then the control point is at some distance from both the midpoints; the amount and\n    // direction are dependent on the orientation of the two elements. 'seg', passed in to this method, tells you which segment the target element\n    // lies in with respect to the source: 1 is top right, 2 is bottom right, 3 is bottom left, 4 is top left.\n    //\n    // sourcePos and targetPos are arrays of info about where on the source and target each anchor is located.  their contents are:\n    //\n    // 0 - absolute x\n    // 1 - absolute y\n    // 2 - proportional x in element (0 is left edge, 1 is right edge)\n    // 3 - proportional y in element (0 is top edge, 1 is bottom edge)\n    //\n        _findControlPoint = function (midx, midy, segment, sourceEdge, targetEdge, dx, dy, distance, proximityLimit) {\n            // TODO (maybe)\n            // - if anchor pos is 0.5, make the control point take into account the relative position of the elements.\n            if (distance <= proximityLimit) return [midx, midy];\n\n            if (segment === 1) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                else return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n            }\n            else if (segment === 2) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                else if (sourceEdge[2] >= 1 && targetEdge[2] <= 0) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                else return [ midx + dx, midy + (-1 * dy) ];\n            }\n            else if (segment === 3) {\n                if (sourceEdge[3] >= 1 && targetEdge[3] <= 0) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                else return [ midx + (-1 * dx) , midy + (-1 * dy) ];\n            }\n            else if (segment === 4) {\n                if (sourceEdge[3] <= 0 && targetEdge[3] >= 1) return [ midx + (sourceEdge[2] < 0.5 ? -1 * dx : dx), midy ];\n                else if (sourceEdge[2] <= 0 && targetEdge[2] >= 1) return [ midx, midy + (sourceEdge[3] < 0.5 ? -1 * dy : dy) ];\n                else return [ midx + dx , midy + (-1 * dy) ];\n            }\n\n        };\n\n    var StateMachine = function (params) {\n        params = params || {};\n        this.type = \"StateMachine\";\n\n        var _super = _jp.Connectors.AbstractBezierConnector.apply(this, arguments),\n            curviness = params.curviness || 10,\n            margin = params.margin || 5,\n            proximityLimit = params.proximityLimit || 80,\n            clockwise = params.orientation && params.orientation === \"clockwise\",\n            _controlPoint;\n\n        this._computeBezier = function(paintInfo, params, sp, tp, w, h) {\n            var _sx = params.sourcePos[0] < params.targetPos[0] ? 0 : w,\n                _sy = params.sourcePos[1] < params.targetPos[1] ? 0 : h,\n                _tx = params.sourcePos[0] < params.targetPos[0] ? w : 0,\n                _ty = params.sourcePos[1] < params.targetPos[1] ? h : 0;\n\n            // now adjust for the margin\n            if (params.sourcePos[2] === 0) _sx -= margin;\n            if (params.sourcePos[2] === 1) _sx += margin;\n            if (params.sourcePos[3] === 0) _sy -= margin;\n            if (params.sourcePos[3] === 1) _sy += margin;\n            if (params.targetPos[2] === 0) _tx -= margin;\n            if (params.targetPos[2] === 1) _tx += margin;\n            if (params.targetPos[3] === 0) _ty -= margin;\n            if (params.targetPos[3] === 1) _ty += margin;\n\n            //\n            // these connectors are quadratic bezier curves, having a single control point. if both anchors\n            // are located at 0.5 on their respective faces, the control point is set to the midpoint and you\n            // get a straight line.  this is also the case if the two anchors are within 'proximityLimit', since\n            // it seems to make good aesthetic sense to do that. outside of that, the control point is positioned\n            // at 'curviness' pixels away along the normal to the straight line connecting the two anchors.\n            //\n            // there may be two improvements to this.  firstly, we might actually support the notion of avoiding nodes\n            // in the UI, or at least making a good effort at doing so.  if a connection would pass underneath some node,\n            // for example, we might increase the distance the control point is away from the midpoint in a bid to\n            // steer it around that node.  this will work within limits, but i think those limits would also be the likely\n            // limits for, once again, aesthetic good sense in the layout of a chart using these connectors.\n            //\n            // the second possible change is actually two possible changes: firstly, it is possible we should gradually\n            // decrease the 'curviness' as the distance between the anchors decreases; start tailing it off to 0 at some\n            // point (which should be configurable).  secondly, we might slightly increase the 'curviness' for connectors\n            // with respect to how far their anchor is from the center of its respective face. this could either look cool,\n            // or stupid, and may indeed work only in a way that is so subtle as to have been a waste of time.\n            //\n\n            var _midx = (_sx + _tx) / 2,\n                _midy = (_sy + _ty) / 2,\n                segment = _segment(_sx, _sy, _tx, _ty),\n                distance = Math.sqrt(Math.pow(_tx - _sx, 2) + Math.pow(_ty - _sy, 2)),\n                cp1x, cp2x, cp1y, cp2y,\n                geometry = _super.getGeometry();\n\n            if ((this.hasBeenEdited() || this.isEditing()) && geometry != null) {\n                cp1x = geometry.controlPoints[0][0];\n                cp1y = geometry.controlPoints[0][1];\n                cp2x = geometry.controlPoints[1][0];\n                cp2y = geometry.controlPoints[1][1];\n            }\n            else {\n                // calculate the control point.  this code will be where we'll put in a rudimentary element avoidance scheme; it\n                // will work by extending the control point to force the curve to be, um, curvier.\n                _controlPoint = _findControlPoint(_midx,\n                    _midy,\n                    segment,\n                    params.sourcePos,\n                    params.targetPos,\n                    curviness, curviness,\n                    distance,\n                    proximityLimit);\n\n                cp1x = _controlPoint[0];\n                cp2x = _controlPoint[0];\n                cp1y = _controlPoint[1];\n                cp2y = _controlPoint[1];\n\n                _super.setGeometry({controlPoints:[_controlPoint, _controlPoint]}, true);\n            }\n\n            _super.addSegment(this, \"Bezier\", {\n                x1: _tx, y1: _ty, x2: _sx, y2: _sy,\n                cp1x: cp1x, cp1y: cp1y,\n                cp2x: cp2x, cp2y: cp2y\n            });\n        };\n    };\n\n    _ju.extend(StateMachine, _jp.Connectors.AbstractBezierConnector);\n    _jp.registerConnectorType(StateMachine, \"StateMachine\");\n\n}).call(typeof window !== 'undefined' ? window : this);\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the SVG renderers.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n// ************************** SVG utility methods ********************************************    \n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil;\n\n    var svgAttributeMap = {\n            \"stroke-linejoin\": \"stroke-linejoin\",\n            \"stroke-dashoffset\": \"stroke-dashoffset\",\n            \"stroke-linecap\": \"stroke-linecap\"\n        },\n        STROKE_DASHARRAY = \"stroke-dasharray\",\n        DASHSTYLE = \"dashstyle\",\n        LINEAR_GRADIENT = \"linearGradient\",\n        RADIAL_GRADIENT = \"radialGradient\",\n        DEFS = \"defs\",\n        FILL = \"fill\",\n        STOP = \"stop\",\n        STROKE = \"stroke\",\n        STROKE_WIDTH = \"stroke-width\",\n        STYLE = \"style\",\n        NONE = \"none\",\n        JSPLUMB_GRADIENT = \"jsplumb_gradient_\",\n        LINE_WIDTH = \"lineWidth\",\n        ns = {\n            svg: \"http://www.w3.org/2000/svg\",\n            xhtml: \"http://www.w3.org/1999/xhtml\"\n        },\n        _attr = function (node, attributes) {\n            for (var i in attributes)\n                node.setAttribute(i, \"\" + attributes[i]);\n        },\n        _node = function (name, attributes) {\n            attributes = attributes || {};\n            attributes.version = \"1.1\";\n            attributes.xmlns = ns.xhtml;\n            return jsPlumb.createElementNS(ns.svg, name, null, null, attributes);\n        },\n        _pos = function (d) {\n            return \"position:absolute;left:\" + d[0] + \"px;top:\" + d[1] + \"px\";\n        },\n        _clearGradient = function (parent) {\n            var els = parent.querySelectorAll(\" defs,linearGradient,radialGradient\");\n            for (var i = 0; i < els.length; i++)\n                els[i].parentNode.removeChild(els[i]);\n        },\n        _updateGradient = function (parent, node, style, dimensions, uiComponent) {\n            var id = JSPLUMB_GRADIENT + uiComponent._jsPlumb.instance.idstamp();\n            // first clear out any existing gradient\n            _clearGradient(parent);\n            // this checks for an 'offset' property in the gradient, and in the absence of it, assumes\n            // we want a linear gradient. if it's there, we create a radial gradient.\n            // it is possible that a more explicit means of defining the gradient type would be\n            // better. relying on 'offset' means that we can never have a radial gradient that uses\n            // some default offset, for instance.\n            // issue 244 suggested the 'gradientUnits' attribute; without this, straight/flowchart connectors with gradients would\n            // not show gradients when the line was perfectly horizontal or vertical.\n            var g;\n            if (!style.gradient.offset)\n                g = _node(LINEAR_GRADIENT, {id: id, gradientUnits: \"userSpaceOnUse\"});\n            else\n                g = _node(RADIAL_GRADIENT, { id: id });\n\n            var defs = _node(DEFS);\n            parent.appendChild(defs);\n            defs.appendChild(g);\n\n            // the svg radial gradient seems to treat stops in the reverse\n            // order to how canvas does it.  so we want to keep all the maths the same, but\n            // iterate the actual style declarations in reverse order, if the x indexes are not in order.\n            for (var i = 0; i < style.gradient.stops.length; i++) {\n                var styleToUse = uiComponent.segment == 1 || uiComponent.segment == 2 ? i : style.gradient.stops.length - 1 - i,\n                    //stopColor = _ju.convertStyle(style.gradient.stops[styleToUse][1], true),\n                    stopColor = style.gradient.stops[styleToUse][1],\n                    s = _node(STOP, {\"offset\": Math.floor(style.gradient.stops[i][0] * 100) + \"%\", \"stop-color\": stopColor});\n\n                g.appendChild(s);\n            }\n            var applyGradientTo = style.strokeStyle ? STROKE : FILL;\n            node.setAttribute(applyGradientTo, \"url(#\" + id + \")\");\n        },\n        _applyStyles = function (parent, node, style, dimensions, uiComponent) {\n\n            node.setAttribute(FILL, style.fillStyle ? style.fillStyle : NONE);\n            node.setAttribute(STROKE, style.strokeStyle ? style.strokeStyle : NONE);\n\n            if (style.gradient) {\n                _updateGradient(parent, node, style, dimensions, uiComponent);\n            }\n            else {\n                // make sure we clear any existing gradient\n                _clearGradient(parent);\n                node.setAttribute(STYLE, \"\");\n            }\n\n            if (style.lineWidth) {\n                node.setAttribute(STROKE_WIDTH, style.lineWidth);\n            }\n\n            // in SVG there is a stroke-dasharray attribute we can set, and its syntax looks like\n            // the syntax in VML but is actually kind of nasty: values are given in the pixel\n            // coordinate space, whereas in VML they are multiples of the width of the stroked\n            // line, which makes a lot more sense.  for that reason, jsPlumb is supporting both\n            // the native svg 'stroke-dasharray' attribute, and also the 'dashstyle' concept from\n            // VML, which will be the preferred method.  the code below this converts a dashstyle\n            // attribute given in terms of stroke width into a pixel representation, by using the\n            // stroke's lineWidth.\n            if (style[DASHSTYLE] && style[LINE_WIDTH] && !style[STROKE_DASHARRAY]) {\n                var sep = style[DASHSTYLE].indexOf(\",\") == -1 ? \" \" : \",\",\n                    parts = style[DASHSTYLE].split(sep),\n                    styleToUse = \"\";\n                parts.forEach(function (p) {\n                    styleToUse += (Math.floor(p * style.lineWidth) + sep);\n                });\n                node.setAttribute(STROKE_DASHARRAY, styleToUse);\n            }\n            else if (style[STROKE_DASHARRAY]) {\n                node.setAttribute(STROKE_DASHARRAY, style[STROKE_DASHARRAY]);\n            }\n\n            // extra attributes such as join type, dash offset.\n            for (var i in svgAttributeMap) {\n                if (style[i]) {\n                    node.setAttribute(svgAttributeMap[i], style[i]);\n                }\n            }\n        },\n        _appendAtIndex = function (svg, path, idx) {\n            if (svg.childNodes.length > idx) {\n                svg.insertBefore(path, svg.childNodes[idx]);\n            }\n            else svg.appendChild(path);\n        };\n\n    /**\n     utility methods for other objects to use.\n     */\n    _ju.svg = {\n        node: _node,\n        attr: _attr,\n        pos: _pos\n    };\n\n    // ************************** / SVG utility methods ********************************************\n\n    /*\n     * Base class for SVG components.\n     */\n    var SvgComponent = function (params) {\n        var pointerEventsSpec = params.pointerEventsSpec || \"all\", renderer = {};\n\n        _jp.jsPlumbUIComponent.apply(this, params.originalArgs);\n        this.canvas = null;\n        this.path = null;\n        this.svg = null;\n        this.bgCanvas = null;\n\n        var clazz = params.cssClass + \" \" + (params.originalArgs[0].cssClass || \"\"),\n            svgParams = {\n                \"style\": \"\",\n                \"width\": 0,\n                \"height\": 0,\n                \"pointer-events\": pointerEventsSpec,\n                \"position\": \"absolute\"\n            };\n\n        this.svg = _node(\"svg\", svgParams);\n\n        if (params.useDivWrapper) {\n            this.canvas = jsPlumb.createElement(\"div\", { position : \"absolute\" });\n            _ju.sizeElement(this.canvas, 0, 0, 1, 1);\n            this.canvas.className = clazz;\n        }\n        else {\n            _attr(this.svg, { \"class\": clazz });\n            this.canvas = this.svg;\n        }\n\n        params._jsPlumb.appendElement(this.canvas, params.originalArgs[0].parent);\n        if (params.useDivWrapper) this.canvas.appendChild(this.svg);\n\n        var displayElements = [ this.canvas ];\n        this.getDisplayElements = function () {\n            return displayElements;\n        };\n\n        this.appendDisplayElement = function (el) {\n            displayElements.push(el);\n        };\n\n        this.paint = function (style, anchor, extents) {\n            if (style != null) {\n\n                var xy = [ this.x, this.y ], wh = [ this.w, this.h ], p;\n                if (extents != null) {\n                    if (extents.xmin < 0) xy[0] += extents.xmin;\n                    if (extents.ymin < 0) xy[1] += extents.ymin;\n                    wh[0] = extents.xmax + ((extents.xmin < 0) ? -extents.xmin : 0);\n                    wh[1] = extents.ymax + ((extents.ymin < 0) ? -extents.ymin : 0);\n                }\n\n                if (params.useDivWrapper) {\n                    _ju.sizeElement(this.canvas, xy[0], xy[1], wh[0], wh[1]);\n                    xy[0] = 0;\n                    xy[1] = 0;\n                    p = _pos([ 0, 0 ]);\n                }\n                else\n                    p = _pos([ xy[0], xy[1] ]);\n\n                renderer.paint.apply(this, arguments);\n\n                _attr(this.svg, {\n                    \"style\": p,\n                    \"width\": wh[0] || 0,\n                    \"height\": wh[1] || 0\n                });\n            }\n        };\n\n        return {\n            renderer: renderer\n        };\n    };\n\n    _ju.extend(SvgComponent, _jp.jsPlumbUIComponent, {\n        cleanup: function (force) {\n            if (force || this.typeId == null) {\n                if (this.canvas) this.canvas._jsPlumb = null;\n                if (this.svg) this.svg._jsPlumb = null;\n                if (this.bgCanvas) this.bgCanvas._jsPlumb = null;\n\n                if (this.canvas && this.canvas.parentNode)\n                    this.canvas.parentNode.removeChild(this.canvas);\n                if (this.bgCanvas && this.bgCanvas.parentNode)\n                    this.canvas.parentNode.removeChild(this.canvas);\n\n                this.svg = null;\n                this.canvas = null;\n                this.path = null;\n                this.group = null;\n            }\n            else {\n                // if not a forced cleanup, just detach from DOM for now.\n                if (this.canvas && this.canvas.parentNode) this.canvas.parentNode.removeChild(this.canvas);\n                if (this.bgCanvas && this.bgCanvas.parentNode) this.bgCanvas.parentNode.removeChild(this.bgCanvas);\n            }\n        },\n        reattach:function(instance) {\n            var c = instance.getContainer();\n            if (this.canvas && this.canvas.parentNode == null) c.appendChild(this.canvas);\n            if (this.bgCanvas && this.bgCanvas.parentNode == null) c.appendChild(this.bgCanvas);\n        },\n        setVisible: function (v) {\n            if (this.canvas) {\n                this.canvas.style.display = v ? \"block\" : \"none\";\n            }\n        }\n    });\n\n    /*\n     * Base class for SVG connectors.\n     */\n    _jp.ConnectorRenderers.svg = function (params) {\n        var self = this,\n            _super = SvgComponent.apply(this, [\n                {\n                    cssClass: params._jsPlumb.connectorClass + (this.isEditable() ? \" \" + params._jsPlumb.editableConnectorClass : \"\"),\n                    originalArgs: arguments,\n                    pointerEventsSpec: \"none\",\n                    _jsPlumb: params._jsPlumb\n                }\n            ]);\n\n        var _superSetEditable = this.setEditable;\n        this.setEditable = function(e) {\n            var result = _superSetEditable.apply(this, [e]);\n            jsPlumb[result ? \"addClass\" : \"removeClass\"](this.canvas, this._jsPlumb.instance.editableConnectorClass);\n        };\n\n        _super.renderer.paint = function (style, anchor, extents) {\n\n            var segments = self.getSegments(), p = \"\", offset = [0, 0];\n            if (extents.xmin < 0) offset[0] = -extents.xmin;\n            if (extents.ymin < 0) offset[1] = -extents.ymin;\n\n            if (segments.length > 0) {\n\n                // create path from segments.\n                for (var i = 0; i < segments.length; i++) {\n                    p += _jp.Segments.svg.SegmentRenderer.getPath(segments[i]);\n                    p += \" \";\n                }\n\n                var a = {\n                        d: p,\n                        transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\",\n                        \"pointer-events\": params[\"pointer-events\"] || \"visibleStroke\"\n                    },\n                    outlineStyle = null,\n                    d = [self.x, self.y, self.w, self.h];\n\n                // outline style.  actually means drawing an svg object underneath the main one.\n                if (style.outlineColor) {\n                    var outlineWidth = style.outlineWidth || 1,\n                        outlineStrokeWidth = style.lineWidth + (2 * outlineWidth);\n                    outlineStyle = _jp.extend({}, style);\n                    delete outlineStyle.gradient;\n                    outlineStyle.strokeStyle = style.outlineColor;\n                    outlineStyle.lineWidth = outlineStrokeWidth;\n\n                    if (self.bgPath == null) {\n                        self.bgPath = _node(\"path\", a);\n                        _jp.addClass(self.bgPath, _jp.connectorOutlineClass);\n                        _appendAtIndex(self.svg, self.bgPath, 0);\n                    }\n                    else {\n                        _attr(self.bgPath, a);\n                    }\n\n                    _applyStyles(self.svg, self.bgPath, outlineStyle, d, self);\n                }\n\n                if (self.path == null) {\n                    self.path = _node(\"path\", a);\n                    _appendAtIndex(self.svg, self.path, style.outlineColor ? 1 : 0);\n                }\n                else {\n                    _attr(self.path, a);\n                }\n\n                _applyStyles(self.svg, self.path, style, d, self);\n            }\n        };\n    };\n    _ju.extend(_jp.ConnectorRenderers.svg, SvgComponent);\n\n// ******************************* svg segment renderer *****************************************************    \n\n    _jp.Segments.svg = {\n        SegmentRenderer: {\n            getPath: function (segment) {\n                return ({\n                    \"Straight\": function () {\n                        var d = segment.getCoordinates();\n                        return \"M \" + d.x1 + \" \" + d.y1 + \" L \" + d.x2 + \" \" + d.y2;\n                    },\n                    \"Bezier\": function () {\n                        var d = segment.params;\n                        return \"M \" + d.x1 + \" \" + d.y1 +\n                            \" C \" + d.cp1x + \" \" + d.cp1y + \" \" + d.cp2x + \" \" + d.cp2y + \" \" + d.x2 + \" \" + d.y2;\n                    },\n                    \"Arc\": function () {\n                        var d = segment.params,\n                            laf = segment.sweep > Math.PI ? 1 : 0,\n                            sf = segment.anticlockwise ? 0 : 1;\n\n                        return \"M\" + segment.x1 + \" \" + segment.y1 + \" A \" + segment.radius + \" \" + d.r + \" 0 \" + laf + \",\" + sf + \" \" + segment.x2 + \" \" + segment.y2;\n                    }\n                })[segment.type]();\n            }\n        }\n    };\n\n// ******************************* /svg segments *****************************************************\n\n    /*\n     * Base class for SVG endpoints.\n     */\n    var SvgEndpoint = _jp.SvgEndpoint = function (params) {\n        var _super = SvgComponent.apply(this, [\n            {\n                cssClass: params._jsPlumb.endpointClass,\n                originalArgs: arguments,\n                pointerEventsSpec: \"all\",\n                useDivWrapper: true,\n                _jsPlumb: params._jsPlumb\n            }\n        ]);\n\n        _super.renderer.paint = function (style) {\n            var s = _jp.extend({}, style);\n            if (s.outlineColor) {\n                s.strokeWidth = s.outlineWidth;\n                s.strokeStyle = s.outlineColor;\n            }\n\n            if (this.node == null) {\n                this.node = this.makeNode(s);\n                this.svg.appendChild(this.node);\n            }\n            else if (this.updateNode != null) {\n                this.updateNode(this.node);\n            }\n            _applyStyles(this.svg, this.node, s, [ this.x, this.y, this.w, this.h ], this);\n            _pos(this.node, [ this.x, this.y ]);\n        }.bind(this);\n\n    };\n    _ju.extend(SvgEndpoint, SvgComponent);\n\n    /*\n     * SVG Dot Endpoint\n     */\n    _jp.Endpoints.svg.Dot = function () {\n        _jp.Endpoints.Dot.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"circle\", {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"cx\": this.w / 2,\n                \"cy\": this.h / 2,\n                \"r\": this.radius\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Dot, [_jp.Endpoints.Dot, SvgEndpoint]);\n\n    /*\n     * SVG Rectangle Endpoint\n     */\n    _jp.Endpoints.svg.Rectangle = function () {\n        _jp.Endpoints.Rectangle.apply(this, arguments);\n        SvgEndpoint.apply(this, arguments);\n        this.makeNode = function (style) {\n            return _node(\"rect\", {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n        this.updateNode = function (node) {\n            _attr(node, {\n                \"width\": this.w,\n                \"height\": this.h\n            });\n        };\n    };\n    _ju.extend(_jp.Endpoints.svg.Rectangle, [_jp.Endpoints.Rectangle, SvgEndpoint]);\n\n    /*\n     * SVG Image Endpoint is the default image endpoint.\n     */\n    _jp.Endpoints.svg.Image = _jp.Endpoints.Image;\n    /*\n     * Blank endpoint in svg renderer is the default Blank endpoint.\n     */\n    _jp.Endpoints.svg.Blank = _jp.Endpoints.Blank;\n    /*\n     * Label overlay in svg renderer is the default Label overlay.\n     */\n    _jp.Overlays.svg.Label = _jp.Overlays.Label;\n    /*\n     * Custom overlay in svg renderer is the default Custom overlay.\n     */\n    _jp.Overlays.svg.Custom = _jp.Overlays.Custom;\n\n    var AbstractSvgArrowOverlay = function (superclass, originalArgs) {\n        superclass.apply(this, originalArgs);\n        _jp.jsPlumbUIComponent.apply(this, originalArgs);\n        this.isAppendedAtTopLevel = false;\n        var self = this;\n        this.path = null;\n        this.paint = function (params, containerExtents) {\n            // only draws on connections, not endpoints.\n            if (params.component.svg && containerExtents) {\n                if (this.path == null) {\n                    this.path = _node(\"path\", {\n                        \"pointer-events\": \"all\"\n                    });\n                    params.component.svg.appendChild(this.path);\n                    if (this.elementCreated) {\n                        this.elementCreated(this.path, params.component);\n                    }\n\n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\n                }\n                var clazz = originalArgs && (originalArgs.length == 1) ? (originalArgs[0].cssClass || \"\") : \"\",\n                    offset = [0, 0];\n\n                if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\n                if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\n\n                _attr(this.path, {\n                    \"d\": makePath(params.d),\n                    \"class\": clazz,\n                    stroke: params.strokeStyle ? params.strokeStyle : null,\n                    fill: params.fillStyle ? params.fillStyle : null,\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n                });\n            }\n        };\n        var makePath = function (d) {\n            return (isNaN(d.cxy.x) || isNaN(d.cxy.y)) ? \"\" : \"M\" + d.hxy.x + \",\" + d.hxy.y +\n                \" L\" + d.tail[0].x + \",\" + d.tail[0].y +\n                \" L\" + d.cxy.x + \",\" + d.cxy.y +\n                \" L\" + d.tail[1].x + \",\" + d.tail[1].y +\n                \" L\" + d.hxy.x + \",\" + d.hxy.y;\n        };\n        this.transfer = function(target) {\n            if (target.canvas && this.path && this.path.parentNode) {\n                this.path.parentNode.removeChild(this.path);\n                target.canvas.appendChild(this.path);\n            }\n        };\n    };\n    _ju.extend(AbstractSvgArrowOverlay, [_jp.jsPlumbUIComponent, _jp.Overlays.AbstractOverlay], {\n        cleanup: function (force) {\n            if (this.path != null) {\n                if (force)\n                    this._jsPlumb.instance.removeElement(this.path);\n                else\n                    if (this.path.parentNode)\n                        this.path.parentNode.removeChild(this.path);\n            }\n        },\n        reattach:function(instance) {\n            if (this.path && this.canvas && this.path.parentNode == null)\n                this.canvas.appendChild(this.path);\n        },\n        setVisible: function (v) {\n            if (this.path != null) (this.path.style.display = (v ? \"block\" : \"none\"));\n        }\n    });\n\n    _jp.Overlays.svg.Arrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Arrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Arrow, [ _jp.Overlays.Arrow, AbstractSvgArrowOverlay ]);\n\n    _jp.Overlays.svg.PlainArrow = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.PlainArrow, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.PlainArrow, [ _jp.Overlays.PlainArrow, AbstractSvgArrowOverlay ]);\n\n    _jp.Overlays.svg.Diamond = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.Diamond, arguments]);\n    };\n    _ju.extend(_jp.Overlays.svg.Diamond, [ _jp.Overlays.Diamond, AbstractSvgArrowOverlay ]);\n    \n    _jp.Overlays.svg.SingleLine = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.SingleLine, arguments]);\n        \n        var originalArgs = arguments;\n        \n        this.paint = function (params, containerExtents) {\n            // only draws on connections, not endpoints.\n            if (params.component.svg && containerExtents) {\n                if (this.path == null) {\n                    this.path = _node(\"path\", {\n                        \"pointer-events\": \"all\"\n                    });\n                    params.component.svg.appendChild(this.path);\n                    if (this.elementCreated) {\n                        this.elementCreated(this.path, params.component);\n                    }\n    \n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\n                }\n                var clazz = originalArgs && (originalArgs.length == 1) ? (originalArgs[0].cssClass || \"\") : \"\",\n                    offset = [0, 0];\n    \n                if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\n                if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\n                \n                var makePath = function (d) {\n                    return \"M\" + d.tail[0].x + \",\" + d.tail[0].y + \" L\" + d.tail[1].x + \",\" + d.tail[1].y;\n                };\n    \n                _attr(this.path, {\n                    \"d\": makePath(params.d),\n                    \"class\": clazz,\n                    stroke: params.strokeStyle ? params.strokeStyle : null,\n                    fill: \"none\",\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n                });\n            }\n        };\n    };\n    _ju.extend(_jp.Overlays.svg.SingleLine, [ _jp.Overlays.SingleLine, AbstractSvgArrowOverlay ]);\n    \n    _jp.Overlays.svg.DoubleLine = function () {\n        AbstractSvgArrowOverlay.apply(this, [_jp.Overlays.DoubleLine, arguments]);\n        \n        var originalArgs = arguments;\n        \n        this.paint = function (params, containerExtents) {\n            // only draws on connections, not endpoints.\n            if (params.component.svg && containerExtents) {\n                if (this.path == null) {\n                    this.path = _node(\"path\", {\n                        \"pointer-events\": \"all\"\n                    });\n                    params.component.svg.appendChild(this.path);\n                    if (this.elementCreated) {\n                        this.elementCreated(this.path, params.component);\n                    }\n    \n                    this.canvas = params.component.svg; // for the sake of completeness; this behaves the same as other overlays\n                }\n                var clazz = originalArgs && (originalArgs.length == 1) ? (originalArgs[0].cssClass || \"\") : \"\",\n                    offset = [0, 0];\n    \n                if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\n                if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\n                \n                var makePath = function (d) {\n                    var r;\n                    \n                    if (d.tail[0].x - d.tail[0].x < 5)\n                    {\n                        r = \"M\" + d.tail[0].x + \",\" + d.tail[0].y + \" L\" + d.tail[1].x + \",\" + d.tail[1].y\n                            + \" M\" + (d.tail[0].x) + \",\" + (d.tail[0].y + 5) + \"L\" + (d.tail[1].x) + \",\" + (d.tail[1].y + 5);\n                    }\n                    else\n                    {\n                        r = \"M\" + d.tail[0].x + \",\" + d.tail[0].y + \" L\" + d.tail[1].x + \",\" + d.tail[1].y\n                            + \" M\" + (d.tail[0].x + 5) + \",\" + d.tail[0].y + \"L\" + (d.tail[1].x + 5) + \",\" + d.tail[1].y;\n                    }\n                    \n                    return r;\n                };\n    \n                _attr(this.path, {\n                    \"d\": makePath(params.d),\n                    \"class\": clazz,\n                    stroke: params.strokeStyle ? params.strokeStyle : null,\n                    fill: \"none\",\n                    transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n                });\n            }\n        };\n    };\n    _ju.extend(_jp.Overlays.svg.DoubleLine, [ _jp.Overlays.DoubleLine, AbstractSvgArrowOverlay ]);\n\n    // a test\n    _jp.Overlays.svg.GuideLines = function () {\n        var path = null, self = this, p1_1, p1_2;\n        _jp.Overlays.GuideLines.apply(this, arguments);\n        this.paint = function (params, containerExtents) {\n            if (path == null) {\n                path = _node(\"path\");\n                params.connector.svg.appendChild(path);\n                self.attachListeners(path, params.connector);\n                self.attachListeners(path, self);\n\n                p1_1 = _node(\"path\");\n                params.connector.svg.appendChild(p1_1);\n                self.attachListeners(p1_1, params.connector);\n                self.attachListeners(p1_1, self);\n\n                p1_2 = _node(\"path\");\n                params.connector.svg.appendChild(p1_2);\n                self.attachListeners(p1_2, params.connector);\n                self.attachListeners(p1_2, self);\n            }\n\n            var offset = [0, 0];\n            if (containerExtents.xmin < 0) offset[0] = -containerExtents.xmin;\n            if (containerExtents.ymin < 0) offset[1] = -containerExtents.ymin;\n\n            _attr(path, {\n                \"d\": makePath(params.head, params.tail),\n                stroke: \"red\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_1, {\n                \"d\": makePath(params.tailLine[0], params.tailLine[1]),\n                stroke: \"blue\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n\n            _attr(p1_2, {\n                \"d\": makePath(params.headLine[0], params.headLine[1]),\n                stroke: \"green\",\n                fill: null,\n                transform: \"translate(\" + offset[0] + \",\" + offset[1] + \")\"\n            });\n        };\n\n        var makePath = function (d1, d2) {\n            return \"M \" + d1.x + \",\" + d1.y +\n                \" L\" + d2.x + \",\" + d2.y;\n        };\n    };\n    _ju.extend(_jp.Overlays.svg.GuideLines, _jp.Overlays.GuideLines);\n}).call(typeof window !== 'undefined' ? window : this);\n\n/*\n * jsPlumb\n * \n * Title:jsPlumb 2.1.1\n * \n * Provides a way to visually connect elements on an HTML page, using SVG.\n * \n * This file contains the 'vanilla' adapter - having no external dependencies other than bundled libs.\n *\n * Copyright (c) 2010 - 2016 jsPlumb (hello@jsplumbtoolkit.com)\n * \n * http://jsplumbtoolkit.com\n * http://github.com/sporritt/jsplumb\n * \n * Dual licensed under the MIT and GPL2 licenses.\n */\n;\n(function () {\n\n    \"use strict\";\n    var root = this, _jp = root.jsPlumb, _ju = root.jsPlumbUtil,\n        _jk = root.Katavorio, _jg = root.Biltong;\n\n    var _getDragManager = function (instance, category) {\n\n        category = category || \"main\";\n        var key = \"_katavorio_\" + category;\n        var k = instance[key],\n            e = instance.getEventManager();\n\n        if (!k) {\n            k = new _jk({\n                bind: e.on,\n                unbind: e.off,\n                getSize: jsPlumb.getSize,\n                getPosition: function (el, relativeToRoot) {\n                    // if this is a nested draggable then compute the offset against its own offsetParent, otherwise\n                    // compute against the Container's origin. see also the getUIPosition method below.\n                    var o = instance.getOffset(el, relativeToRoot, el._katavorioDrag ? el.offsetParent : null);\n                    return [o.left, o.top];\n                },\n                setPosition: function (el, xy) {\n                    el.style.left = xy[0] + \"px\";\n                    el.style.top = xy[1] + \"px\";\n                },\n                addClass: jsPlumb.addClass,\n                removeClass: jsPlumb.removeClass,\n                intersects: _jg.intersects,\n                indexOf: function(l, i) { return l.indexOf(i); },\n                css: {\n                    noSelect: instance.dragSelectClass,\n                    droppable: \"jsplumb-droppable\",\n                    draggable: \"jsplumb-draggable\",\n                    drag: \"jsplumb-drag\",\n                    selected: \"jsplumb-drag-selected\",\n                    active: \"jsplumb-drag-active\",\n                    hover: \"jsplumb-drag-hover\",\n                    ghostProxy:\"jsplumb-ghost-proxy\"\n                }\n            });\n            instance[key] = k;\n            instance.bind(\"zoom\", k.setZoom);\n        }\n        return k;\n    };\n\n    var _animProps = function (o, p) {\n        var _one = function (pName) {\n            if (p[pName] != null) {\n                if (_ju.isString(p[pName])) {\n                    var m = p[pName].match(/-=/) ? -1 : 1,\n                        v = p[pName].substring(2);\n                    return o[pName] + (m * v);\n                }\n                else return p[pName];\n            }\n            else\n                return o[pName];\n        };\n        return [ _one(\"left\"), _one(\"top\") ];\n    };\n\n    _jp.extend(root.jsPlumbInstance.prototype, {\n\n        animationSupported:true,\n        getElement: function (el) {\n            if (el == null) return null;\n            // here we pluck the first entry if el was a list of entries.\n            // this is not my favourite thing to do, but previous versions of\n            // jsplumb supported jquery selectors, and it is possible a selector\n            // will be passed in here.\n            el = typeof el === \"string\" ? el : el.length != null && el.enctype == null ? el[0] : el;\n            return typeof el === \"string\" ? document.getElementById(el) : el;\n        },\n        removeElement: function (element) {\n            _getDragManager(this).elementRemoved(element);\n            this.getEventManager().remove(element);\n        },\n        //\n        // this adapter supports a rudimentary animation function. no easing is supported.  only\n        // left/top properties are supported. property delta args are expected to be in the form\n        //\n        // +=x.xxxx\n        //\n        // or\n        //\n        // -=x.xxxx\n        //\n        doAnimate: function (el, properties, options) {\n            options = options || {};\n            var o = this.getOffset(el),\n                ap = _animProps(o, properties),\n                ldist = ap[0] - o.left,\n                tdist = ap[1] - o.top,\n                d = options.duration || 250,\n                step = 15, steps = d / step,\n                linc = (step / d) * ldist,\n                tinc = (step / d) * tdist,\n                idx = 0,\n                _int = setInterval(function () {\n                    jsPlumb.setPosition(el, {\n                        left: o.left + (linc * (idx + 1)),\n                        top: o.top + (tinc * (idx + 1))\n                    });\n                    if (options.step != null) options.step(idx, Math.ceil(steps));\n                    idx++;\n                    if (idx >= steps) {\n                        window.clearInterval(_int);\n                        if (options.complete != null) options.complete();\n                    }\n                }, step);\n        },\n        // DRAG/DROP\n        destroyDraggable: function (el, category) {\n            _getDragManager(this, category).destroyDraggable(el);\n        },\n        destroyDroppable: function (el, category) {\n            _getDragManager(this, category).destroyDroppable(el);\n        },\n        initDraggable: function (el, options, category) {\n            _getDragManager(this, category).draggable(el, options);\n        },\n        initDroppable: function (el, options, category) {\n            _getDragManager(this, category).droppable(el, options);\n        },\n        isAlreadyDraggable: function (el) {\n            return el._katavorioDrag != null;\n        },\n        isDragSupported: function (el, options) {\n            return true;\n        },\n        isDropSupported: function (el, options) {\n            return true;\n        },\n        isElementDraggable: function (el) {\n            el = jsPlumb.getElement(el);\n            return el._katavorioDrag && el._katavorioDrag.isEnabled();\n        },\n        getDragObject: function (eventArgs) {\n            return eventArgs[0].drag.getDragElement();\n        },\n        getDragScope: function (el) {\n            return el._katavorioDrag && el._katavorioDrag.scopes.join(\" \") || \"\";\n        },\n        getDropEvent: function (args) {\n            return args[0].e;\n        },\n        getUIPosition: function (eventArgs, zoom) {\n            // here the position reported to us by Katavorio is relative to the element's offsetParent. For top\n            // level nodes that is fine, but if we have a nested draggable then its offsetParent is actually\n            // not going to be the jsplumb container; it's going to be some child of that element. In that case\n            // we want to adjust the UI position to account for the offsetParent's position relative to the Container\n            // origin.\n            var el = eventArgs[0].el;\n            if (el.offsetParent == null) {\n                return null;\n            }\n            var finalPos = eventArgs[0].finalPos || eventArgs[0].pos;\n            var p = { left:finalPos[0], top:finalPos[1] };\n            if (el._katavorioDrag && el.offsetParent !== this.getContainer()) {\n                var oc = this.getOffset(el.offsetParent);\n                p.left += oc.left;\n                p.top += oc.top;\n            }\n            return p;\n        },\n        setDragFilter: function (el, filter, _exclude) {\n            if (el._katavorioDrag) {\n                el._katavorioDrag.setFilter(filter, _exclude);\n            }\n        },\n        setElementDraggable: function (el, draggable) {\n            el = jsPlumb.getElement(el);\n            if (el._katavorioDrag)\n                el._katavorioDrag.setEnabled(draggable);\n        },\n        setDragScope: function (el, scope) {\n            if (el._katavorioDrag)\n                el._katavorioDrag.k.setDragScope(el, scope);\n        },\n        setDropScope:function(el, scope) {\n            if (el._katavorioDrop && el._katavorioDrop.length > 0) {\n                el._katavorioDrop[0].k.setDropScope(el, scope);\n            }\n        },\n        addToPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            jsPlumb.each(el, function(_el) {\n                _el = [ jsPlumb.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.addToPosse.apply(dm, _el);\n            });\n        },\n        setPosse:function(el, spec) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            jsPlumb.each(el, function(_el) {\n                _el = [ jsPlumb.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.setPosse.apply(dm, _el);\n            });\n        },\n        removeFromPosse:function(el, posseId) {\n            var specs = Array.prototype.slice.call(arguments, 1);\n            var dm = _getDragManager(this);\n            jsPlumb.each(el, function(_el) {\n                _el = [ jsPlumb.getElement(_el) ];\n                _el.push.apply(_el, specs );\n                dm.removeFromPosse.apply(dm, _el);\n            });\n        },\n        removeFromAllPosses:function(el) {\n            var dm = _getDragManager(this);\n            jsPlumb.each(el, function(_el) { dm.removeFromAllPosses(jsPlumb.getElement(_el)); });\n        },\n        setPosseState:function(el, posseId, state) {\n            var dm = _getDragManager(this);\n            jsPlumb.each(el, function(_el) { dm.setPosseState(jsPlumb.getElement(_el), posseId, state); });\n        },\n        dragEvents: {\n            'start': 'start', 'stop': 'stop', 'drag': 'drag', 'step': 'step',\n            'over': 'over', 'out': 'out', 'drop': 'drop', 'complete': 'complete',\n            'beforeStart':'beforeStart'\n        },\n        animEvents: {\n            'step': \"step\", 'complete': 'complete'\n        },\n        stopDrag: function (el) {\n            if (el._katavorioDrag)\n                el._katavorioDrag.abort();\n        },\n        addToDragSelection: function (spec) {\n            _getDragManager(this).select(spec);\n        },\n        removeFromDragSelection: function (spec) {\n            _getDragManager(this).deselect(spec);\n        },\n        clearDragSelection: function () {\n            _getDragManager(this).deselectAll();\n        },\n        trigger: function (el, event, originalEvent, payload) {\n            this.getEventManager().trigger(el, event, originalEvent, payload);\n        },\n        doReset:function() {\n            // look for katavorio instances and reset each one if found.\n            for (var key in this) {\n                if (key.indexOf(\"_katavorio_\") === 0) {\n                    this[key].reset();\n                }\n            }\n        }\n    });\n\n    var ready = function (f) {\n        var _do = function () {\n            if (/complete|loaded|interactive/.test(document.readyState) && typeof(document.body) != \"undefined\" && document.body != null)\n                f();\n            else\n                setTimeout(_do, 9);\n        };\n\n        _do();\n    };\n    ready(_jp.init);\n\n}).call(typeof window !== 'undefined' ? window : this);\n","IG$._baN/*bflowNode*/ = function(tnode) {\r\n\tvar me = this;\r\n\r\n\tif (tnode)\r\n\t{\r\n\t\tme.model = tnode;\r\n\t\tme.p1/*parseXML*/(tnode);\r\n\t}\r\n}\r\n\r\nIG$._baN/*bflowNode*/.prototype = {\r\n\tp1/*parseXML*/: function(tnode) {\r\n\t\tvar node = this,\r\n\t\t\tj, lnode,\r\n\t\t\tpnodes,\r\n\t\t\tcoordinates,\r\n\t\t\tlname, lvalue;\r\n\t\t\r\n\t\t$s.apply(node, {\r\n\t\t\tname: tnode.name,\r\n\t\t\tshape: tnode.shape,\r\n\t\t\tsid: tnode.sid,\r\n\t\t\ttype: tnode.type,\r\n\t\t\trole: tnode.role\r\n\t\t});\r\n\t\t\r\n\t\tcoordinates = tnode.coordinates;\r\n\t\t\r\n\t\tif (coordinates)\r\n\t\t{\r\n\t\t\t$s.apply(node, {\r\n\t\t\t\tx: coordinates.x,\r\n\t\t\t\ty: coordinates.y,\r\n\t\t\t\tw: coordinates.w,\r\n\t\t\t\th: coordinates.h\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tnode.text = tnode.label || node.name;\r\n\t\tlnode = tnode.property;\r\n\t\tif (lnode)\r\n\t\t{\r\n\t\t\t$s.apply(node, {\r\n\t\t\t\tdsname: lnode.dsname,\r\n\t\t\t\tdsignoreeror: lnode.dsignoreerror\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tfor (j=0; j < lnode.length; j++)\r\n\t\t\t{\r\n\t\t\t\tnode[lnode[j].name] = lnode[j].value;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlnode = tnode.comment;\r\n\t\t\r\n\t\tif (lnode)\r\n\t\t{\r\n\t\t\tnode.comment = lnode.comment;\r\n\t\t}\r\n\t\t\r\n\t\t// lnode = tnode.additional_properties;\r\n\t\t// if (lnode)\r\n\t\t// {\r\n\t\t// \tnode.additional_properties = [];\r\n\t\t\t\r\n\t\t// \tfor (j=0; j < lnode.length; j++)\r\n\t\t// \t{\r\n\t\t// \t\tnode.additional_properties.push({\r\n\t\t// \t\t\tname: lnode[j].name,\r\n\t\t// \t\t\tvalue: lnode[j].value\r\n\t\t// \t\t});\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t// lnode = tnode.states;\r\n\t\t// if (lnode)\r\n\t\t// {\r\n\t\t// \tnode.states = [];\r\n\t\t\t\r\n\t\t// \tfor (j=0; j < lnode.length; j++)\r\n\t\t// \t{\r\n\t\t// \t\tnode.states.push({\r\n\t\t// \t\t\tname: lnode[j].name\r\n\t\t// \t\t});\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t// lnode = tnode.precision;\r\n\t\t// if (lnode)\r\n\t\t// {\r\n\t\t// \tnode.precision = lnode;\r\n\t\t// }\r\n\t\t// lnode = tnode.unit;\r\n\t\t// if (lnode)\r\n\t\t// {\r\n\t\t// \tnode.unit = {};\r\n\t\t\t\r\n\t\t// \tfor (j=0; j < lnode.length; j++)\r\n\t\t// \t{\r\n\t\t// \t\tlname = lnode[j].name;\r\n\t\t// \t\tlvalue = lnode[j].value;\r\n\t\t// \t\tnode.unit[lname] = lvalue;\r\n\t\t// \t}\r\n\t\t// }\r\n\t},\r\n\t\r\n\tc1/*clone*/: function(tobj) {\r\n\t\tvar me = this,\r\n\t\t\tp = \"name;shape;x;y;w;h;text;dsname;dsignoreerror;comment;role\".split(\";\"),\r\n\t\t\ti, l;\r\n\r\n\t\tme.model = tobj;\r\n\t\t\r\n\t\tfor (i=0; i < p.length; i++)\r\n\t\t{\r\n\t\t\tme[p[i]] = tobj[p[i]];\r\n\t\t}\r\n\t\t\r\n\t\tif (tobj._cs)\r\n\t\t{\r\n\t\t\tme._cs = [];\r\n\t\t\tfor (i=0; i < tobj._cs.length; i++)\r\n\t\t\t{\r\n\t\t\t\tme._cs.push(tobj._cs[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// if (tobj.additional_properties)\r\n\t\t// {\r\n\t\t// \tl = tobj.additional_properties;\r\n\t\t// \tme.additional_properties = [];\r\n\t\t// \tfor (i=0; i < l.length; i++)\r\n\t\t// \t{\r\n\t\t// \t\tme.additional_properties.push({\r\n\t\t// \t\t\tname: l[i].name,\r\n\t\t// \t\t\tvalue: l[i].value\r\n\t\t// \t\t});\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t\r\n\t\t// if (tobj.states)\r\n\t\t// {\r\n\t\t// \tl = tobj.states;\r\n\t\t\t\r\n\t\t// \tme.states = [];\r\n\t\t\t\r\n\t\t// \tfor (i=0; i < l.length; i++)\r\n\t\t// \t{\r\n\t\t// \t\tme.states.push({\r\n\t\t// \t\t\tname: l[i].name\r\n\t\t// \t\t});\r\n\t\t// \t}\r\n\t\t// }\r\n\t\t\r\n\t\t// me.precision = tobj.precision;\r\n\t\t\r\n\t\t// if (tobj.unit)\r\n\t\t// {\r\n\t\t// \tme.unit = {};\r\n\t\t\t\r\n\t\t// \tfor (l in tobj.unit)\r\n\t\t// \t{\r\n\t\t// \t\tme.unit[l] = tobj.unit[l];\r\n\t\t// \t}\r\n\t\t// }\r\n\t},\r\n\t\r\n\tpaint: function(g, emode) {\r\n\t\tvar me = this,\r\n\t\t\tbox = me.box,\r\n\t\t\tdg = $(\".idv-flw-grp\", box),\r\n\t\t\tdul,\r\n\t\t\tvisualstates = g ? g.visualstates : null,\r\n\t\t\tmw = 102;\r\n\t\t\t\r\n\t\tdg.hide();\r\n\t\tdg.empty();\r\n\t\t\r\n\t\tif (visualstates && emode == 1)\r\n\t\t{\r\n\t\t\tbox.width(150);\r\n\t\t\tdg.show();\r\n\t\t\t\r\n\t\t\tdul = $(\"<ul class='idv-visual-lst'></ul>\").appendTo(dg);\r\n\t\t\t\r\n\t\t\t$.each(visualstates, function(n, states) {\r\n\t\t\t\tvar values = states.values,\r\n\t\t\t\t\ti,\r\n\t\t\t\t\tstatview,\r\n\t\t\t\t\tsviewarea,\r\n\t\t\t\t\tsname,\r\n\t\t\t\t\tsgraph;\r\n\t\t\t\t\r\n\t\t\t\tstatview = $(\"<li class='idv-visual-states'></li>\").appendTo(dul);\r\n\t\t\t\tsviewarea = $(\"<div class='idv-visual-area'></div>\").appendTo(statview);\r\n\t\t\t\tsname = $(\"<div class='idv-visual-statname'><span id='statname'></span></div>\").appendTo(sviewarea);\r\n\t\t\t\t\r\n\t\t\t\t$(\"#statname\", sname).text(states.name);\r\n\r\n\t\t\t\tif (values && values.length)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.each(values, function(i, value) {\r\n\t\t\t\t\t\tvar sgraph = $(\"<div class='idv-visual-graph'><div class='idv-visual-graphval'><span>-</span></div></div>\").appendTo(sviewarea),\r\n\t\t\t\t\t\t\tgval,\r\n\t\t\t\t\t\t\tn = \"\" + value.barlength;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (n.indexOf(\".\") > -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tn = n.substring(0, n.indexOf(\".\") + 3);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tgval = $(\".idv-visual-graphval\", sgraph).css({width: Number(value.barlength) + \"%\"});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$(\"span\", gval).text(n + \" %\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tgval.attr(\"title\", n + \" %\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsgraph.bind(\"click\", function() {\r\n\t\t\t\t\t\t\tme.visualStateClick(g, {\r\n\t\t\t\t\t\t\t\tstates: states,\r\n\t\t\t\t\t\t\t\tvalue: value\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbox.width(100);\r\n\t\t}\r\n\t},\r\n\t\r\n\tvisualStateClick: function(g, value) {\r\n\t\tvar me = this;\r\n\t\tme._bf.container.trigger(\"visual_state_click\", {\r\n\t\t\tgraphic: g,\r\n\t\t\tstate: value\r\n\t\t});\r\n\t},\r\n\r\n\tset_potential: function(potential) {\r\n\t\tvar me = this;\r\n\t\tme.potential = potential;\r\n\t}\r\n}\r\n\r\nIG$._I99/*bflowoption*/ = {\r\n\thoverPaintStyle: { strokeStyle:\"#7ec3d9\" }\r\n};\r\n\r\nIG$._I9a/*flowDiagram*/ = function(container, option) {\r\n\tvar me = this;\r\n\tme.container = container;\r\n\tme.ptype = option.ptype;\r\n}\r\n\r\nIG$._I9a/*flowDiagram*/.prototype = {\r\n\tinit: function() {\r\n\t\tvar me = this,\r\n\t\t\tcontainer = me.container,\r\n\t\t\tdoc = $(document),\r\n\t\t\tmainarea;\r\n\t\t\r\n\t\tme.mwidth = 0;\r\n\t\tme.mheight = 0;\r\n\t\t\r\n\t\tcontainer.empty();\r\n\t\t\r\n\t\tme.sid = 0;\r\n\t\tme.a_boxes = [];\r\n\t\tme.m_boxes = {};\r\n\t\t\r\n\t\tme.mainarea = mainarea = $(\"<div class='idv-flw-mreg'></div>\").appendTo(container);\r\n\t\t\r\n\t\tme.render = $(\"<div id='render'></div>\").appendTo(mainarea);\r\n\t\t\r\n\t\tme.plumb = jsPlumb.getInstance({\r\n\t\t\tConnector: \"Straight\",\r\n\t\t\tEndpoint: [\"Dot\", {radius: 5}],\r\n\t\t\tHoverPaintStyle: {strokeStyle: \"#42a62c\", lineWidth: 4},\r\n\t\t\tConnectionOverlays: [\r\n\t\t\t\t[\"Arrow\", {\r\n\t\t\t\t\tlocation: 1,\r\n\t\t\t\t\tid: \"arrow\",\r\n\t\t\t\t\tlength: 14,\r\n\t\t\t\t\tfoldback: 0.8,\r\n\t\t\t\t\twidth: 8\r\n\t\t\t\t}]\r\n\t\t\t]\r\n\t\t});\r\n\t\t\r\n\t\tme.plumb.bind(\"connection\", function(info, e) {\r\n\t\t\tvar lnk = info.connection,\r\n\t\t\t\tsrc = lnk.source,\r\n\t\t\t\ttgt = lnk.target;\r\n\t\t\t\r\n\t\t\tsrc = me.getBoxObject(src);\r\n\t\t\ttgt = me.getBoxObject(tgt);\r\n\t\t\t\r\n\t\t\tif (src && tgt && e) \r\n\t\t\t{\r\n\t\t\t\tme.container.trigger(\"flow_changed\", {\r\n\t\t\t\t\titem: {\r\n\t\t\t\t\t\tsrc: src,\r\n\t\t\t\t\t\ttgt: tgt,\r\n\t\t\t\t\t\tlink: lnk\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsource: \"link_node\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar overlays = [];\r\n\t\t\t\toverlays.push([\"DoubleLine\", { fillStyle: \"#09098e\", width: 10, length: 10 } ]);\r\n\t\t\t\tif (me.ptype == \"bpmn\")\r\n\t\t\t\t{\r\n\t\t\t\t\toverlays.push([\r\n\t\t\t\t\t\t\"Custom\", {\r\n\t\t\t\t\t\t\tcreate: function(component) {\r\n\t\t\t\t\t\t\t\tvar lvalue = lnk.condition ? lnk.condition.value : \"\";\r\n\t\t\t\t\t\t\t\treturn $(\"<div class='ig-link-container'><div class='ig-link-desc' title='\" + (lvalue || \"\") + \"'>\" + (lvalue || \"-\") + \"</div></div>\");\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tlocation: 0.5\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$.each(overlays, function(i, ov) {\r\n\t\t\t\t\tlnk.addOverlay(ov);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tme.plumb.bind(\"connectionDetached\", function(info, e) {\r\n\t\t\tvar lnk = info.connection,\r\n\t\t\t\tsrc = lnk.source,\r\n\t\t\t\ttgt = lnk.target;\r\n\t\t\t\r\n\t\t\tsrc = me.getBoxObject(src);\r\n\t\t\ttgt = me.getBoxObject(tgt);\r\n\t\t\t\r\n\t\t\tif (src && tgt && e) \r\n\t\t\t{\r\n\t\t\t\tme.container.trigger(\"flow_changed\", {\r\n\t\t\t\t\titem: {\r\n\t\t\t\t\t\tsrc: src.sid,\r\n\t\t\t\t\t\ttgt: tgt.sid\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsource: \"link_detach\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tme.plumb.bind(\"connectionMoved\", function(info, e) {\r\n\t\t\tvar s1 = info.originalSourceId,\r\n\t\t\t\ts2 = info.newSourceId,\r\n\t\t\t\tt1 = info.originalTargetId,\r\n\t\t\t\tt2 = info.newTargetId;\r\n\t\t\t\r\n\t\t\ts1 = me.getBoxObject(s1);\r\n\t\t\ts2 = me.getBoxObject(s2);\r\n\t\t\tt1 = me.getBoxObject(t1);\r\n\t\t\tt2 = me.getBoxObject(t2);\r\n\t\t\t\r\n\t\t\tif (s1 && s2 && t1 && t2 && e)\r\n\t\t\t{\r\n\t\t\t\tme.container.trigger(\"flow_changed\", {\r\n\t\t\t\t\titem: {\r\n\t\t\t\t\t\tsource_0: s1.sid,\r\n\t\t\t\t\t\tsource_1: s2.sid,\r\n\t\t\t\t\t\ttarget_0: t1.sid,\r\n\t\t\t\t\t\ttarget_1: t2.sid\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsource: \"move_link\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tme.plumb.bind(\"click\", function(lnk, e) {\r\n\t\t\tvar src = lnk.source,\r\n\t\t\t\ttgt = lnk.target;\r\n\t\t\t\r\n\t\t\tsrc = me.getBoxObject(src);\r\n\t\t\ttgt = me.getBoxObject(tgt);\r\n\r\n\t\t\tif (src && tgt)\r\n\t\t\t{\r\n\t\t\t\tme.container.trigger(\"link_click\", {\r\n\t\t\t\t\tsource: \"link_click\",\r\n\t\t\t\t\titem: {\r\n\t\t\t\t\t\tlink: lnk,\r\n\t\t\t\t\t\tsource: src,\r\n\t\t\t\t\t\ttarget: tgt\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t\t\t\r\n\t\tvar gpt;\r\n\t\t\r\n\t\tvar gf_mousemove = function(e) {\r\n\t\t\tif (gpt)\r\n\t\t\t{\r\n\t\t\t\tvar mpt = {\r\n\t\t\t\t\tx: e.pageX,\r\n\t\t\t\t\ty: e.pageY\r\n\t\t\t\t}, tx = 0, ty = 0,\r\n\t\t\t\ttw = IG$.j$ext._w(me.container),\r\n\t\t\t\tth = IG$.j$ext._h(me.container),\r\n\t\t\t\tmw = IG$.j$ext._w(me.mainarea),\r\n\t\t\t\tmh = IG$.j$ext._h(me.mainarea),\r\n\t\t\t\tom = gpt.om,\r\n\t\t\t\tot = me.container.offset(),\r\n\t\t\t\tgx = om.left - ot.left,\r\n\t\t\t\tgy = om.top - ot.top,\r\n\t\t\t\tsx, sy;\r\n\t\t\t\t\r\n\t\t\t\tif (mw > tw || mh > th)\r\n\t\t\t\t{\r\n\t\t\t\t\ttx = mpt.x - gpt.x;\r\n\t\t\t\t\tty = mpt.y - gpt.y;\r\n\t\t\t\t\t\r\n\t\t\t\t\tsy = gy + ty;\r\n\t\t\t\t\tsx = gx + tx;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tif (sy < (th - mh))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsy = th - mh;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (sy > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsy = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (sx < (tw - mw))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsx = tw - mw;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (sx > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsx = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tme.mainarea.css({top: sy, left: sx});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tvar gf_mouseup = function(e) {\r\n\t\t\tdoc.unbind(\"mousemove\", gf_mousemove);\r\n\t\t\tdoc.unbind(\"mouseup\", gf_mouseup);\r\n\t\t};\r\n\t\t\r\n\t\tmainarea.bind({\r\n\t\t\tmousedown: function(e) {\r\n\t\t\t\tif (e.srcElement && e.srcElement == mainarea[0])\r\n\t\t\t\t{\r\n\t\t\t\t\tgpt = {\r\n\t\t\t\t\t\tx: e.pageX,\r\n\t\t\t\t\t\ty: e.pageY,\r\n\t\t\t\t\t\tom: me.mainarea.offset()\r\n\t\t\t\t\t};\r\n\t\t\t\t\tdoc.bind(\"mousemove\", gf_mousemove);\r\n\t\t\t\t\tdoc.bind(\"mouseup\", gf_mouseup);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmouseup: function(e) {\r\n\t\t\t\tdoc.unbind(\"mousemove\", gf_mousemove);\r\n\t\t\t\tdoc.unbind(\"mouseup\", gf_mouseup);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t\r\n\tgetID: function(sid) {\r\n\t\tvar me = this;\r\n\t\t\r\n\t\tif (!sid)\r\n\t\t{\r\n\t\t\tsid = \"uid_\" + me.sid++;\r\n\t\t}\r\n\t\t\r\n\t\twhile (me.m_boxes[sid]) {\r\n\t\t\tsid = \"uid_\" + me.sid++;\r\n\t\t}\r\n\t\t\r\n\t\treturn sid;\r\n\t},\r\n\t\r\n\ts1/*setStatus*/: function(stat) {\r\n\t\tvar me = this,\r\n\t\t\titem = me.m_boxes[stat.lid];\r\n\t\t\t\r\n\t\tif (item && item.statdv)\r\n\t\t{\r\n\t\t\titem.statdv.removeClass(\"idv-flw-shp mec-stat-saved\");\r\n\t\t\titem.statdv.removeClass(\"idv-flw-shp mec-stat-on\");\r\n\t\t\titem.statdv.removeClass(\"idv-flw-shp mec-stat-err\");\r\n\t\t\t\r\n\t\t\tswitch (stat.status)\r\n\t\t\t{\r\n\t\t\tcase 1:\r\n\t\t\t\titem.statdv.addClass(\"idv-flw-shp mec-stat-on\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase 10:\r\n\t\t\t\titem.statdv.addClass(\"idv-flw-shp mec-stat-saved\");\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\titem.statdv.addClass(\"idv-flw-shp mec-stat-err\");\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\ts2/*clearStatus*/: function() {\r\n\t\tvar me = this,\r\n\t\t\ta_boxes = me.a_boxes,\r\n\t\t\ti;\r\n\t\t\t\r\n\t\tfor (i=0; i < a_boxes.length; i++)\r\n\t\t{\r\n\t\t\tif (a_boxes[i].statdv)\r\n\t\t\t{\r\n\t\t\t\ta_boxes[i].statdv.removeClass(\"idv-flw-shp mec-stat-saved\");\r\n\t\t\t\ta_boxes[i].statdv.removeClass(\"idv-flw-shp mec-stat-on\");\r\n\t\t\t\ta_boxes[i].statdv.removeClass(\"idv-flw-shp mec-stat-err\");\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\taddBox: function(item, p, isnew) {\r\n\t\tvar me = this;\r\n\t\tme.a_boxes.push(item);\r\n\t\t\r\n\t\tif (IG$.checkUID(item.sid) == false)\r\n\t\t{\r\n\t\t\tvar me = this,\r\n\t\t\t\tlreq = new IG$._rpc$();\r\n\t\t\tlreq.init(me, \r\n\t\t\t\t{\r\n\t\t\t\t\tack: \"helpcontent\",\r\n\t\t\t\t\tpayload: {},\r\n\t\t\t\t\tmbody: {option: \"newid\"}\r\n\t\t\t\t}, me, function(jdoc) {\r\n\t\t\t\t\tvar suid = jdoc && jdoc.nuid && jdoc.nuid.length ? jdoc.nuid[0] : null;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (suid)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titem.sid = suid;\r\n\t\t\t\t\t\tme.rs_addBox(item, p, isnew);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, false);\r\n\t\t\t\t\r\n\t\t\tlreq.send();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.rs_addBox(item, p, isnew);\r\n\t\t}\r\n\t},\r\n\t\r\n\trs_addBox: function(item, p, isnew) {\r\n\t\tvar me = this,\r\n\t\t\tdv, dvc, ep, title, dp, i,\r\n\t\t\tdg;\r\n\t\t\r\n\t\tdv = $(\"<div class='idv-flw-shp'></div>\").appendTo(me.mainarea);\r\n\t\tif (me.ptype == \"bpmn\")\r\n\t\t{\r\n\t\t\titem._app_cls = item._app_cls || [];\r\n\r\n\t\t\t$.each(item._app_cls, function(i, cls) {\r\n\t\t\t\tdv.removeClass(cls);\r\n\t\t\t});\r\n\r\n\t\t\tif (item.name)\r\n\t\t\t{\r\n\t\t\t\tdv.addClass(\"bpmn_\" + item.name);\r\n\t\t\t\titem._app_cls.push(\"bpmn_\" + item.name);\r\n\r\n\t\t\t\tif (item.name == \"start\")\r\n\t\t\t\t{\r\n\t\t\t\t\tp.w = 60;\r\n\t\t\t\t\tp.h = 80;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.dstype)\r\n\t\t\t{\r\n\t\t\t\tdv.addClass(\"bpmn_type_\" + item.dstype);\r\n\t\t\t\titem._app_cls.push(\"bpmn_type_\" + item.dstype);\r\n\t\t\t}\r\n\t\t}\r\n\t\tdv.css({left: p.left, top: p.top});\r\n\t\tif (p.w && p.h)\r\n\t\t{\r\n\t\t\tdv.width(p.w);\r\n\t\t\t// dv.height(p.h);\r\n\t\t}\r\n\t\t\r\n\t\tif (item._cs && item._cs.length)\r\n\t\t{\r\n\t\t\tfor (i=0; i < item._cs.length; i++)\r\n\t\t\t{\r\n\t\t\t\tdv.addClass(item._cs[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tbg = $(\"#bgimg\", dv);\r\n\t\tIG$.j$ext._w(bg, IG$.j$ext._w(dv));\r\n\t\tIG$.j$ext._h(bg, IG$.j$ext._h(dv));\r\n\t\titem.box = dv;\r\n\t\titem._bf = me;\r\n\t\t$(\"<div class='idv-bd-symbol'></div>\").appendTo(dv);\r\n\t\titem.dv_dsname = $(\"<div class='idv-bd-dsnm'>\" + (item.dsname || \"\") + \"</div>\").appendTo(dv);\r\n\t\t\r\n\t\tvar dlayer = $(\"<div class='ba_m_title_container'></div>\").appendTo(dv);\r\n\t\titem.statdv = $(\"<div class='mec-stat'></div>\").appendTo(dlayer);\r\n\t\tdvc = $(\"<div class='ba_m_title_c'></div>\").appendTo(dlayer);\r\n\t\ttitle = $(\"<span class='ba_m_title' title='\" + item.text + \"'>\" + item.text + \"</span>\").appendTo(dvc);\r\n\t\tdp = $(\"<div class='mec-rp'></div>\").appendTo(dlayer);\r\n\t\t$(\"<div class='mec-ep'></div>\").appendTo(dlayer);\r\n\t\t\r\n\t\titem.sid = item.sid || me.getID();\r\n\t\t\r\n\t\titem.__tL/*titleArea*/ = title;\r\n\t\t\r\n\t\ttitle.bind(\"click\", function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\tme.container.trigger(\"boxClicked\", item);\r\n\t\t});\r\n\r\n\t\tdvc.bind(\"click\", function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\tme.container.trigger(\"boxClicked\", item);\r\n\t\t});\r\n\r\n\t\titem.dv_dsname.bind(\"click\", function() {\r\n\t\t\tme.container.trigger(\"boxClicked\", item);\r\n\t\t});\r\n\t\t\r\n\t\tdg = $(\"<div class='idv-flw-grp'></div>\").appendTo(dv).hide();\r\n\t\t\r\n\t\tme.plumb.draggable(dv);\r\n\t\t\r\n\t\tme.plumb.makeSource(dv, {\r\n\t\t\tfilter: \".mec-ep\",\r\n\t\t\t// anchor: \"Continuous\",\r\n\t\t\t// anchor: ['Right', 'Left', \"Top\", \"Bottom\"],\r\n\t\t\tanchor: \"AutoDefault\",\r\n\t\t\tconnector: [\"Straight\", {curviness: 20, stub: [20, 20], cornerRadius: 1}],\r\n\t\t\tconnectorStyle: {strokeStyle: \"#efefef\", lineWidth: 2},\r\n\t\t\tmaxConnections: 30,\r\n\t\t\tonMaxConnections: function(info, e) {\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tme.plumb.makeTarget(dv, {\r\n\t\t\tdropOptions: {hoverClass: \"dragHover\"},\r\n\t\t\t// anchor: \"Continuous\",\r\n\t\t\t// anchor: ['Right', 'Left', \"Top\", \"Bottom\"],\r\n\t\t\tanchor: \"AutoDefault\",\r\n\t\t\tallowLoopback: false\r\n\t\t});\r\n\t\t\r\n\t\tme.m_boxes[item.sid] = item;\r\n\t\t\r\n\t\tdp.bind(\"click\", function() {\r\n\t\t\tme.removeBox(item, true);\r\n\t\t});\r\n\t\t\r\n\t\tif (isnew)\r\n\t\t{\r\n\t\t\tme.container.trigger(\"flow_changed\", {\r\n\t\t\t\titem: item,\r\n\t\t\t\tsource: \"box_add\"\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tme.u1/*updateSize*/();\r\n\t\t\r\n\t\tif (me.rs_loadOption)\r\n\t\t{\r\n\t\t\tme.rs_loadOption.processed = me.rs_loadOption.processed +1;\r\n\t\t\t\r\n\t\t\tif (me.rs_loadOption.processed == me.rs_loadOption.nodelength)\r\n\t\t\t{\r\n\t\t\t\tme.rs_loadOption.callback && me.rs_loadOption.callback.execute();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\ts4/*setTitle*/: function(item, txt) {\r\n\t\tvar me = this,\r\n\t\t\ttitlearea = item.__tL/*titleArea*/;\r\n\t\t\r\n\t\ttitlearea.text(txt);\r\n\t\ttitlearea.attr(\"title\", txt);\r\n\t},\r\n\r\n\tsetDsN: function(item, txt) {\r\n\t\tvar me = this,\r\n\t\t\tdv_dsname = item.dv_dsname;\r\n\r\n\t\tdv_dsname.html(txt);\r\n\t\tdv_dsname.attr(\"title\", txt);\r\n\t},\r\n\t\r\n\tremoveBox: function(item, bconfirm) {\r\n\t\tvar me = this;\r\n\t\t\t\r\n\t\tif (bconfirm == true)\r\n\t\t{\r\n\t\t\tIG$.confirmMessages(ig$.appname, \"Confirm to delete node!\", function(e) {\r\n\t\t\t\tif (e == \"yes\")\r\n\t\t\t\t{\r\n\t\t\t\t\tme.rs_removeBox(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tme.rs_removeBox(item);\r\n\t\t}\r\n\t},\r\n\t\r\n\trs_removeBox: function(item) {\r\n\t\tvar me = this,\r\n\t\t\ti;\r\n\t\t\t\r\n\t\tme.plumb.detachAllConnections(item.box);\r\n\t\titem.box.remove();\r\n\t\t\r\n\t\tfor (i=0; i < me.a_boxes.length; i++)\r\n\t\t{\r\n\t\t\tif (me.a_boxes[i].sid == item.sid)\r\n\t\t\t{\r\n\t\t\t\tme.a_boxes.splice(i, 1);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tdelete me.m_boxes[item.sid];\r\n\t\t\r\n\t\tme.container.trigger(\"flow_changed\", {\r\n\t\t\titem: item,\r\n\t\t\tsource: \"box_delete\"\r\n\t\t});\r\n\t\t\r\n\t\tme.u1/*updateSize*/();\r\n\t},\r\n\t\r\n\tu1/*updateSize*/: function() {\r\n\t\tvar me = this, \r\n\t\t\tmwidth = 0,\r\n\t\t\tmheight = 0,\r\n\t\t\ttwidth = IG$.j$ext._w(me.container),\r\n\t\t\ttheight = IG$.j$ext._h(me.container),\r\n\t\t\ti, boxes = me.a_boxes;\r\n\t\t\t\r\n\t\tfor (i=0; i < boxes.length; i++)\r\n\t\t{\r\n\t\t\tmwidth = Math.max(mwidth, boxes[i].x + boxes[i].w);\r\n\t\t\tmheight = Math.max(mheight, boxes[i].y + boxes[i].h);\r\n\t\t}\r\n\t\t\r\n\t\tmwidth = Math.max(mwidth+20, twidth);\r\n\t\tmheight = Math.max(mheight+20, theight);\r\n\t\t\r\n\t\tIG$.j$ext._w(me.mainarea, mwidth);\r\n\t\tIG$.j$ext._h(me.mainarea, mheight);\r\n\t},\r\n\t\r\n\taddLink: function(lnk) {\r\n\t\tvar me = this,\r\n\t\t\tdid1 = me.m_boxes[lnk.from] ? me.m_boxes[lnk.from].box : null,\r\n\t\t\tdid2 = me.m_boxes[lnk.to] ? me.m_boxes[lnk.to].box : null,\r\n\t\t\tstroke = \"rgb(189,11,11)\";\r\n\t\t\t\r\n\t\tif (!did1 || !did2)\r\n\t\t\treturn;\r\n\r\n\t\tvar overlays = [];\r\n\t\toverlays.push([\"DoubleLine\", { fillStyle: \"#09098e\", width: 10, length: 10 } ]);\r\n\t\tif (me.ptype == \"bpmn\")\r\n\t\t{\r\n\t\t\toverlays.push([\r\n\t\t\t\t\"Custom\", {\r\n\t\t\t\t\tcreate: function(component) {\r\n\t\t\t\t\t\tvar lvalue = lnk.condition ? lnk.condition.value : \"\";\r\n\t\t\t\t\t\treturn $(\"<div class='ig-link-container'><div class='ig-link-desc' title='\" + (lvalue || \"\") + \"'>\" + (lvalue || \"-\") + \"</div></div>\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlocation: 0.5\r\n\t\t\t\t}\r\n\t\t   ]);\r\n\t\t}\r\n\t\tvar mlink = me.plumb.connect(\r\n\t\t\t{\r\n\t\t\t\tsource: did1, \r\n\t\t\t\ttarget: did2, \r\n\t\t\t\tpaintStyle:{ \r\n\t\t\t\t\tlineWidth:8,\r\n\t\t\t\t\tstrokeStyle: stroke,\r\n\t\t\t\t\toutlineColor:\"#666\",\r\n\t\t\t\t\toutlineWidth:1,\r\n\t\t\t\t\tdashstyle: null\r\n\t\t\t\t},\r\n\t\t\t\tdetachable: true,\r\n\t\t\t\thoverPaintStyle: IG$._I99/*bflowoption*/.hoverPaintStyle, \r\n\t\t\t\t// anchors:[ [ 0.3 , 1, 0, 1 ], \"TopCenter\" ], \r\n\t\t\t\t// anchors: ['Right', 'Left', \"Top\", \"Bottom\"],\r\n\t\t\t\tanchor: \"AutoDefault\",\r\n\t\t\t\toverlays: overlays,\r\n\t\t\t\tendpoint: [\r\n\t\t\t\t\t\"Dot\",\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tradius: 5\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tendpointStyles: {fillStyle: \"#456\"}\r\n\t\t\t}\r\n\t\t);\r\n\t\tmlink.ptr_link = lnk;\r\n\t},\r\n\t\r\n\tL1/*loadOption*/: function(itemobj, rs_loadOption) {\r\n\t\tvar me = this,\r\n\t\t\tnode, lnk,\r\n\t\t\ti;\r\n\t\t\t\r\n\t\tme.itemobj = itemobj;\r\n\t\t\r\n\t\tme.init();\r\n\t\t\r\n\t\tme.rs_loadOption = {\r\n\t\t\tnodes: itemobj.nodes.length,\r\n\t\t\tnodelength: itemobj.nodes.length,\r\n\t\t\tprocessed: 0,\r\n\t\t\tcallback: rs_loadOption,\r\n\t\t};\r\n\t\t\r\n\t\tif (itemobj.nodes.length)\r\n\t\t{\r\n\t\t\t$.each(itemobj.nodes, function(i, node) {\r\n\t\t\t\tme.addBox(node, {\r\n\t\t\t\t\tleft: node.x,\r\n\t\t\t\t\ttop: node.y,\r\n\t\t\t\t\tw: node.w,\r\n\t\t\t\t\th: node.h\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tfor (i=0; i < itemobj.links.length; i++)\r\n\t\t\t{\r\n\t\t\t\tlnk = itemobj.links[i];\r\n\t\t\t\tme.addLink(lnk);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\trs_loadOption && rs_loadOption.execute();\r\n\t\t}\r\n\t},\r\n\t\r\n\tm1/*appProperty*/: function(r, box, params) {\r\n\t\tvar i,\r\n\t\t\tpnames = params.split(\";\");\r\n\t\t\r\n\t\tfor (i=0; i < pnames.length; i++)\r\n\t\t{\r\n\t\t\tif (box[pnames[i]])\r\n\t\t\t{\r\n\t\t\t\tr.property.properties.push({\r\n\t\t\t\t\tname: pnames[i],\r\n\t\t\t\t\tvalue: box[pnames[i]]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tl2/*exportContent*/: function(r) {\r\n\t\tvar me = this,\r\n\t\t\tprobnet = r.probnet,\r\n\t\t\tvariables, potentials,\r\n\t\t\tlinks,\r\n\t\t\tvobj, lobj,\r\n\t\t\tvmap = {},\r\n\t\t\ti, j, l, o, box, ab, lnk, ptr_link,\r\n\t\t\ttoffset = me.mainarea.offset(),\r\n\t\t\tptype = me.ptype;\r\n\t\t\r\n\t\tif (ptype == \"bayesmodel\")\r\n\t\t{\r\n\t\t\tvariables = probnet.variables = [];\r\n\t\t\tpotentials = probnet.potentials = [];\r\n\t\t}\r\n\t\telse if (ptype == \"bigdatamodel\")\r\n\t\t{\r\n\t\t\tvariables = r.nodes = [];\r\n\t\t}\r\n\t\t\r\n\t\tfor (i=0; i < me.a_boxes.length; i++)\r\n\t\t{\r\n\t\t\tab = me.a_boxes[i];\r\n\t\t\to = ab.box.offset();\r\n\t\t\tbox = {\r\n\t\t\t\tname: ab.name,\r\n\t\t\t\tshape: ab.shape || \"\",\r\n\t\t\t\tx: o.left - toffset.left,\r\n\t\t\t\ty: o.top - toffset.top,\r\n\t\t\t\tw: IG$.j$ext._w(ab.box),\r\n\t\t\t\th: IG$.j$ext._h(ab.box),\r\n\t\t\t\tsid: ab.sid,\r\n\t\t\t\ttext: ab.text,\r\n\t\t\t\tdsname: ab.dsname,\r\n\t\t\t\tdsdesc: ab.dsdesc,\r\n\t\t\t\tdstype: ab.dstype,\r\n\t\t\t\tdsignoreerror: ab.dsignoreerror,\r\n\t\t\t\tdsmapper: ab.dsmapper,\r\n\t\t\t\tdsreducer: ab.dsreducer,\r\n\t\t\t\tdstname: ab.dstname,\r\n\t\t\t\tdsscript: ab.dsscript,\r\n\t\t\t\tdsfname: ab.dsfname,\r\n\t\t\t\tdsskipexist: ab.dsskipexist,\r\n\t\t\t\tdoctmpl: ab.doctmpl,\r\n\t\t\t\ttype: ab.type,\r\n\t\t\t\trole: ab.role,\r\n\t\t\t\tadditional_properties: ab.additional_properties,\r\n\t\t\t\tstates: ab.states,\r\n\t\t\t\tprecision: ab.precision,\r\n\t\t\t\tunit: ab.unit,\r\n\t\t\t\tcomment: ab.comment\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif (ptype == \"bayesmodel\")\r\n\t\t\t{\r\n\t\t\t\tvobj = ab.model;\r\n\r\n\t\t\t\tif (ab.potential)\r\n\t\t\t\t{\r\n\t\t\t\t\tab.potential.variables = ab.potential.variables || [];\r\n\t\t\t\t\tif (ab.potential.variables.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tab.potential.variables[0].name = box.name;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tab.potential.variables.push(\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: box.name\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpotentials.push(ab.potential);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tvobj = {\r\n\t\t\t\t\ttype: box.type\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$s.apply(vobj, {\r\n\t\t\t\tsid: box.sid,\r\n\t\t\t\tname: box.name,\r\n\t\t\t\tshape: box.shape,\r\n\t\t\t\tcoordinates: {\r\n\t\t\t\t\tx: box.x,\r\n\t\t\t\t\ty: box.y,\r\n\t\t\t\t\tw: box.w,\r\n\t\t\t\t\th: box.h\r\n\t\t\t\t},\r\n\t\t\t\trole: box.role,\r\n\t\t\t\tlabel: box.text\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tvariables.push(vobj);\r\n\t\t\tvmap[vobj.sid] = vobj;\r\n\t\t\t\t\t\t\r\n\t\t\tif (box.comment)\r\n\t\t\t{\r\n\t\t\t\tvobj.comment = {\r\n\t\t\t\t\tcomment: box.comment\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvobj.property = {\r\n\t\t\t\tdsname: ab.dsname,\r\n\t\t\t\tdsignoreerror: ab.dsignoreerror,\r\n\t\t\t\tproperties: []\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tswitch (box.name)\r\n\t\t\t{\r\n\t\t\tcase \"datasource\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;dstype;dsmapper;dsreducer;dsfname;dstname;dsskipexist\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"shell\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;dsscript\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hive\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;dsscript\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"mongoreduce\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;rowregex;rowsample;mrtype;m_delim;cfields\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"mongodoc\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;doctmpl;mrnode;mrdb;mrcol;mrdocname;mrsmode\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"mapreduce\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;dsmapper;dsreducer;confparams\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"output\":\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc;dsfname;dscnames;dsruntype;dsdelim;dsdelimval;dstcube;dstcubeuid;dsmeasuredelim;dsmeasuredelimval;dsmname;dscsdatause;dscsdatafile\");\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tme.m1/*appProperty*/(vobj, ab, \"dsdesc\");\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// l = box.additional_properties;\r\n\t\t\r\n\t\t\t// if (l && l.length)\r\n\t\t\t// {\r\n\t\t\t// \tvobj.additional_properties = [];\r\n\t\t\t\t\r\n\t\t\t// \tfor (j=0; j < l.length; j++)\r\n\t\t\t// \t{\r\n\t\t\t// \t\tvobj.additional_properties.push({\r\n\t\t\t// \t\t\tname: l[j].name,\r\n\t\t\t// \t\t\tvalue: l[j].value\r\n\t\t\t// \t\t});\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\t\r\n\t\t\t// l = box.states;\r\n\t\t\t\r\n\t\t\t// if (l && l.length)\r\n\t\t\t// {\r\n\t\t\t// \tvobj.states = [];\r\n\t\t\t\t\r\n\t\t\t// \tfor (j=0; j < l.length; j++)\r\n\t\t\t// \t{\r\n\t\t\t// \t\tvobj.states.push({\r\n\t\t\t// \t\t\tname: l[j].name\r\n\t\t\t// \t\t});\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\t\r\n\t\t\t// if (box.precision)\r\n\t\t\t// {\r\n\t\t\t// \tvobj.precision = box.precision;\r\n\t\t\t// }\r\n\t\t\t\r\n\t\t\t// if (box.unit)\r\n\t\t\t// {\r\n\t\t\t// \tvobj.unit = [];\r\n\t\t\t\t\r\n\t\t\t// \tfor (j in box.unit)\r\n\t\t\t// \t{\r\n\t\t\t// \t\tvobj.unit.push({\r\n\t\t\t// \t\t\tname: \"\" + j,\r\n\t\t\t// \t\t\tvalue: box.unit[j]\r\n\t\t\t// \t\t});\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t}\r\n\t\t\r\n\t\tvar cons = me.plumb.getConnections(),\r\n\t\t\tsrc, tgt,\r\n\t\t\tlinkname,\r\n\t\t\tlinknodes;\r\n\t\t\t\r\n\t\tif (ptype == \"bayesmodel\")\r\n\t\t{\r\n\t\t\tlinks = probnet.links = [];\r\n\t\t\tlinkname = \"variables\";\r\n\t\t}\r\n\t\telse if (ptype == \"bigdatamodel\")\r\n\t\t{\r\n\t\t\tlinks = r.links = [];\r\n\t\t\tlinkname = \"nodes\";\r\n\t\t}\r\n\t\t\r\n\t\tif (cons && cons.length)\r\n\t\t{\r\n\t\t\tfor (i=0; i < cons.length; i++)\r\n\t\t\t{\r\n\t\t\t\tlnk = cons[i];\r\n\t\t\t\tptr_link = lnk.ptr_link;\r\n\t\t\t\tsrc = lnk.source;\r\n\t\t\t\ttgt = lnk.target;\r\n\t\t\t\t\r\n\t\t\t\tsrc = me.getBoxObject(src);\r\n\t\t\t\ttgt = me.getBoxObject(tgt);\r\n\t\t\t\t\r\n\t\t\t\tif (src && tgt) {\r\n\t\t\t\t\tvar p = lnk.getPaintStyle();\r\n\t\t\t\t\tlobj = {\r\n\t\t\t\t\t\tdashstyle: p.dashstyle,\r\n\t\t\t\t\t\tdirected: ptr_link ? ptr_link.directed : true\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\tlinknodes = lobj[linkname] = [];\r\n\t\t\t\t\t\r\n\t\t\t\t\tlinknodes.push({\r\n\t\t\t\t\t\tsid: src.sid,\r\n\t\t\t\t\t\tname: src.name\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tlinknodes.push({\r\n\t\t\t\t\t\tsid: tgt.sid,\r\n\t\t\t\t\t\tname: tgt.name\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tlinks.push(lobj);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (ptr_link && ptr_link.potential)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// lobj.potential = [ptr_link.potential.p2/*toXMLString*/()]; \r\n\t\t\t\t\t\tlobj.potential = ptr_link.potential;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (ptr_link && ptr_link.revealing_condition)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlobj.revealing_condition = [];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (ptr_link.revealing_condition.states)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar lcond = {states: []};\r\n\t\t\t\t\t\t\tlobj.revealing_condition.push(lcond);\r\n\t\t\t\t\t\t\tfor (j=0; j < ptr_link.revealing_condition.states.length; j++)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlcond.states.push({\r\n\t\t\t\t\t\t\t\t\tname: ptr_link.revealing_condition.states[j].name \r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tgetBoxObject: function(elem) {\r\n\t\tvar me = this,\r\n\t\t\ti, r,\r\n\t\t\tboxes = me.a_boxes,\r\n\t\t\tt = typeof(elem) == \"string\" ? 0 : 1,\r\n\t\t\telem_id = t ? $(elem).attr(\"id\") : null,\r\n\t\t\tbox_id;\r\n\t\t\r\n\t\tfor (i=0; i < boxes.length; i++) \r\n\t\t{\r\n\t\t\tif (!t && boxes[i].sid == elem) \r\n\t\t\t{\r\n\t\t\t\tr = boxes[i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse if (t) \r\n\t\t\t{\r\n\t\t\t\tbox_id = boxes[i].box.attr(\"id\");\r\n\t\t\t\tif (box_id == elem_id)\r\n\t\t\t\t{\r\n\t\t\t\t\tr = boxes[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn r;\r\n\t}\r\n}","IG$.bpmnLinkCon = $s.extend($s.window, {\n\t\n\tmodal: true,\n\tregion:'center',\n\t\n\tlayout: {\n\t\ttype: 'vbox',\n\t\talign: 'stretch'\n\t},\n\t\n\tclosable: true,\n\tresizable:false,\n\t\n\twidth: 380,\n\tautoHeight: true,\n\n\t_init: function() {\n\t\tvar me = this,\n\t\t\tdata = me.data,\n\t\t\tlink = data.item.link,\n\t\t\tptr_link = link.ptr_link,\n\t\t\tformalExpr = me.down(\"[name=formalExpr]\");\n\n\t\tif (ptr_link && ptr_link.condition)\n\t\t{\n\t\t\tformalExpr.setValue(ptr_link.condition.value);\n\t\t}\n\t},\n\n\t_confirm: function() {\n\t\tvar me = this,\n\t\t\tformalExpr = me.down(\"[name=formalExpr]\"),\n\t\t\tcallback = me.callback;\n\n\t\tcallback && callback.execute(formalExpr.getValue());\n\t\tme.close();\n\t},\n\n\t_delete: function() {\n\t\tvar me = this;\n\t\tme.modeler && me.modeler.detachNode(me.data);\n\t\tme.close();\n\t},\n\t\t\n\tinitComponent : function() {\n\t\tvar me = this;\n\n\t\tme.title = IRm$.r1('L_BPMN_LINK_CON');\n\t\t\n\t\t$s.apply(this, {\n\t\t\tpadding: ig$.padding,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"textarea\",\n\t\t\t\t\tfieldLabel: IRm$.r1(\"L_BPMN_FEXPR\"),\n\t\t\t\t\tname: \"formalExpr\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\txtype: \"container\",\n\t\t\t\t\theight: 50\n\t\t\t\t}\n\t\t\t],\n\t\t\tbuttons:[\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_DELETE'),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tme._delete();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t},\n\t\t\t\t\"->\",\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CONFIRM'),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tme._confirm();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}, \n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CLOSE'),\n\t\t\t\t\thandler:function() {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function(ui) {\n\t\t\t\t\tme._init();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnLinkCon.superclass.initComponent.apply(this, arguments);\n\t}\n});\n\nIG$.bpmnFormConfig = $s.extend($s.window, {\n\t\n\tmodal: true,\n\tregion:'center',\n\t\n\tlayout: {\n\t\ttype: 'vbox',\n\t\talign: 'stretch'\n\t},\n\t\n\tclosable: true,\n\tresizable:false,\n\t\n\twidth: 380,\n\tautoHeight: true,\n\n\t_init: function() {\n\t\tvar me = this,\n\t\t\tp_main = me.down(\"[name=p_main]\"),\n\t\t\tform_options_value = me.form_options_value;\n\n\t\tif (form_options_value)\n\t\t{\n\t\t\tform_options_value.form_width = Number(form_options_value.form_width) || 600;\n\t\t\tform_options_value.form_height = Number(form_options_value.form_height) || 550;\n\t\t\tp_main.setAllValues(form_options_value);\n\t\t}\n\t},\n\n\tconfirm: function() {\n\t\tvar me = this,\n\t\t\tp_main = me.down(\"[name=p_main]\"),\n\t\t\tprop = {};\n\t\tif (p_main.getAllValues(prop))\n\t\t\treturn;\n\t\tme.callback && me.callback.execute(prop);\n\t\tme.close();\n\t},\n\t\t\n\tinitComponent : function() {\n\t\tvar me = this;\n\n\t\tme.title = IRm$.r1('T_FORM');\n\t\t\n\t\t$s.apply(this, {\n\t\t\tpadding: ig$.padding,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"fieldset\",\n\t\t\t\t\tname: \"p_main\",\n\t\t\t\t\ttitle: IRm$.r1(\"B_CONFIG\"),\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t},\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"numberfield\",\n\t\t\t\t\t\t\tname: \"form_width\",\n\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_WIDTH\"),\n\t\t\t\t\t\t\tvalue: 600\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"numberfield\",\n\t\t\t\t\t\t\tname: \"form_height\",\n\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_HEIGHT\"),\n\t\t\t\t\t\t\tvalue: 500\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\tbuttons:[\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CONFIRM'),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tthis.confirm();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}, \n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CLOSE'),\n\t\t\t\t\thandler:function() {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function(ui) {\n\t\t\t\t\tthis._init();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnFormConfig.superclass.initComponent.apply(this, arguments);\n\t}\n});\n\nIG$.bpmnProp = $s.extend($s.panel, {\n\t\n\tregion:\"center\",\n\tlayout: \"fit\",\n\t\t\t\n\tautoHeight: true,\n\t\t\n\tcallback: null,\n\t\n\thide_ierr: 1,\n\ts_hist: 0,\n\t\n\tinit_f: function() {\n\t\tvar me = this,\n\t\t\tp_base = me.down(\"[name=p_base]\"),\n\t\t\tp_advanced = me.down(\"[name=p_advanced]\"),\n\t\t\tdstype = me.down(\"[name=dstype]\"),\n\t\t\t_vmode = me._vmode,\n\t\t\tdpanel = me.down(\"[name=dpanel]\"),\n\t\t\tp_dsoption,\n\t\t\tdsoption,\n\t\t\tdp = [{name: IRm$.r1(\"B_SELECT\"), value: \"\"}],\n\t\t\tsdp;\n\t\t\t\n\t\tswitch (_vmode)\n\t\t{\n\t\tcase \"start\":\n\t\t\tsdp = [\n\t\t\t\t{name: \"Start event\", value: \"start_event\"},\n\t\t\t\t{name: \"End event\", value: \"end_event\"},\n\t\t\t\t{name: \"Start timer event\", value: \"start_timer_event\"},\n\t\t\t\t{name: \"Start signal_event\", value: \"start_signal_event\"},\n\t\t\t\t{name: \"Start message event\", value: \"start_message_event\"},\n\t\t\t\t{name: \"Start error event\", value: \"start_error_event\"},\n\t\t\t\t{name: \"Start event registry event\", value: \"start_event_registry_event\"},\n\t\t\t\t{name: \"Start variable listener event\", value: \"start_variable_listener_event\"},\n\t\t\t\t{name: \"Start escalation event\", value: \"start_escalation_event\"},\n\t\t\t\t{name: \"Start conditional event\", value: \"start_conditional_event\"},\n\t\t\t\t{name: \"End error event\", value: \"end_error_event\"},\n\t\t\t\t{name: \"End escalation event\", value: \"end_escalation_event\"},\n\t\t\t\t{name: \"End cancel event\", value: \"end_cancel_event\"},\n\t\t\t\t{name: \"End terminate event\", value: \"end_terminate_event\"}\n\t\t\t];\n\t\t\tbreak;\n\t\tcase \"activities\":\n\t\t\tsdp = [\n\t\t\t\t{name: \"User task\", value: \"user_task\"},\n\t\t\t\t{name: \"Service task\", value: \"service_task\"},\n\t\t\t\t{name: \"Script task\", value: \"script_task\"},\n\t\t\t\t{name: \"Business rule task\", value: \"business_rule_task\"},\n\t\t\t\t{name: \"Receive task\", value: \"receive_task\"},\n\t\t\t\t{name: \"Manual task\", value: \"manual_task\"},\n\t\t\t\t{name: \"Mail task\", value: \"mail_task\"},\n\t\t\t\t{name: \"Camel task\", value: \"camel_task\"},\n\t\t\t\t{name: \"Http task\", value: \"http_task\"},\n\t\t\t\t{name: \"Mule task\", value: \"mule_task\"},\n\t\t\t\t{name: \"Decision task\", value: \"decision_task\"},\n\t\t\t\t{name: \"Send event task\", value: \"send_event_task\"},\n\t\t\t\t{name: \"Receive event task\", value: \"receive_event_task\"},\n\t\t\t\t{name: \"External worker task\", value: \"external_worker_task\"},\n\t\t\t\t{name: \"Shell task\", value: \"shell_task\"}\n\t\t\t];\n\t\t\tbreak;\n\t\t\tcase \"gateways\":\n\t\t\t\tsdp = [\n\t\t\t\t\t{name: \"Exclusive Gateways\", value: \"exclusive_gateways\"},\n\t\t\t\t\t{name: \"Inclusive Gateways\", value: \"inclusive_gateways\"},\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t}\n\n\t\tvar loop_groups = function(groups, dp, p) {\n\t\t\tif (groups && groups.length)\n\t\t\t{\n\t\t\t\tvar i;\n\n\t\t\t\tfor (i=0; i < groups.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (groups[i].active != 1)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tvar m = {\n\t\t\t\t\t\tname: groups[i].name,\n\t\t\t\t\t\tgid: groups[i].gid,\n\t\t\t\t\t\tpath: (p ? p.path + \"/\" : \"/\") + groups[i].name\n\t\t\t\t\t};\n\n\t\t\t\t\tdp.push(m);\n\n\t\t\t\t\tif (groups[i].subgroups)\n\t\t\t\t\t{\n\t\t\t\t\t\tloop_groups(groups[i].subgroups, dp, m);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (!me.pmenu)\n\t\t{\n\t\t\tvar pmenu = new $s.popup({\n\t\t\t\txtype: \"popup\",\n\t\t\t\tname: \"mpopup\",\n\t\t\t\tmargin: \"0 0 10 0\",\n\t\t\t\tfloating: true,\n\t\t\t\tmodal: false,\n\t\t\t\tmove: false,\n\t\t\t\tresize: false,\n\t\t\t\tlayout: {\n\t\t\t\t\ttype: \"card\",\n\t\t\t\t},\n\t\t\t\tposition: \"fixed\",\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\tselType: \"checkboxmodel\",\n\t\t\t\t\t\tselModel:  {\n\t\t\t\t\t\t\tmode: \"MULTI\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\tname: \"grd_users\",\n\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_ID\"),\n\t\t\t\t\t\t\t\tdataIndex: \"userid\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_NAME\"),\n\t\t\t\t\t\t\t\tdataIndex: \"name\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_EMAIL\"),\n\t\t\t\t\t\t\t\tdataIndex: \"email\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_GROUPNAME\"),\n\t\t\t\t\t\t\t\tdataIndex: \"groupname\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\tselType: \"checkboxmodel\",\n\t\t\t\t\t\tselModel:  {\n\t\t\t\t\t\t\tmode: \"MULTI\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\tname: \"grd_groups\",\n\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_PATH\"),\n\t\t\t\t\t\t\t\tdataIndex: \"path\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_NAME\"),\n\t\t\t\t\t\t\t\tdataIndex: \"name\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\tselType: \"checkboxmodel\",\n\t\t\t\t\t\tselModel:  {\n\t\t\t\t\t\t\tmode: \"SINGLE\",\n\t\t\t\t\t\t\ttoggle: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\tname: \"grd_deligates\",\n\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_PATH\"),\n\t\t\t\t\t\t\t\tdataIndex: \"java_class\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_NAME\"),\n\t\t\t\t\t\t\t\tdataIndex: \"name\",\n\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tloadUsers: function(sel) {\n\t\t\t\t\tvar m = this,\n\t\t\t\t\t\tgrd_users = m.down(\"[name=grd_users]\"),\n\t\t\t\t\t\tgrd_groups = m.down(\"[name=grd_groups]\"),\n\t\t\t\t\t\treq = new IG$._rpc$();\n\n\t\t\t\t\tm._vmode = \"users\";\n\n\t\t\t\t\tm.getLayout().setActiveItem(grd_users);\n\t\t\t\t\t\t\n\t\t\t\t\treq.init(me,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tack: \"usercontent\",\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\taddress: \"/user\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmbody: {\n\t\t\t\t\t\t\t\toption: \"get\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\t\t\tvar selusers = {};\n\t\t\t\t\t\t\t$.each(sel, function(i, u) {\n\t\t\t\t\t\t\t\tselusers[u] = 1;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$.each(jdoc, function(i, j) {\n\t\t\t\t\t\t\t\tj.userid = j.id;\n\t\t\t\t\t\t\t\tdelete j[\"id\"];\n\n\t\t\t\t\t\t\t\tif (selusers[j.userid])\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tj.selected = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tgrd_users.store.loadData(jdoc);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\treq.send();\n\t\t\t\t},\n\t\t\t\tloadGroups: function(sel) {\n\t\t\t\t\tvar m = this,\n\t\t\t\t\t\tgrd_users = m.down(\"[name=grd_users]\"),\n\t\t\t\t\t\tgrd_groups = m.down(\"[name=grd_groups]\"),\n\t\t\t\t\t\treq = new IG$._rpc$();\n\t\t\t\t\t\n\t\t\t\t\tm._vmode = \"groups\";\n\n\t\t\t\t\tm.getLayout().setActiveItem(grd_groups);\n\n\t\t\t\t\treq.init(me,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tack: \"usercontent\",\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\taction: \"get\",\n\t\t\t\t\t\t\t\taddress: \"/usergroup\",\n\t\t\t\t\t\t\t\tpid: \"\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmbody: {\n\t\t\t\t\t\t\t\toption: \"standard\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\t\t\tvar selgrps = {};\n\t\t\t\t\t\t\t$.each(sel, function(i, u) {\n\t\t\t\t\t\t\t\tselgrps[u] = 1;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar dp = [];\n\n\t\t\t\t\t\t\tloop_groups(jdoc, dp, null);\n\n\t\t\t\t\t\t\t$.each(dp, function(i, d) {\n\t\t\t\t\t\t\t\tif (selgrps[d.path])\n\t\t\t\t\t\t\t\t\td.selected = true;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tgrd_groups.store.loadData(dp);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\treq.send();\n\t\t\t\t},\n\t\t\t\tloadDeligates: function(sel) {\n\t\t\t\t\tvar m = this,\n\t\t\t\t\t\tgrd_deligates = m.down(\"[name=grd_deligates]\"),\n\t\t\t\t\t\treq = new IG$._rpc$();\n\t\t\t\t\t\n\t\t\t\t\tm._vmode = \"deligates\";\n\n\t\t\t\t\tm.getLayout().setActiveItem(grd_deligates);\n\n\t\t\t\t\treq.init(me,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tack: \"appoption\",\n\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\taddress: \"schedule_config\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmbody: {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\t\t\tvar dp = [];\n\n\t\t\t\t\t\t\t$.each(jdoc.programs, function(i, d) {\n\t\t\t\t\t\t\t\tif (d.mod_type != \"bpmn\")\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tvar di = {\n\t\t\t\t\t\t\t\t\tjava_class: d.java_class,\n\t\t\t\t\t\t\t\t\tname: d.name,\n\t\t\t\t\t\t\t\t\tmod_type: d.mod_type\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (di.java_class == sel)\n\t\t\t\t\t\t\t\t\tdi.selected = true;\n\t\t\t\t\t\t\t\tdp.push(di);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tgrd_deligates.store.loadData(dp);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\treq.send();\n\t\t\t\t},\n\t\t\t\tlisteners: {\n\t\t\t\t\thide: function(m) {\n\t\t\t\t\t\tif (m._vmode == \"users\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar grd_users = m.down(\"[name=grd_users]\"),\n\t\t\t\t\t\t\t\tsel = grd_users.getSelectionModel().selected;\n\t\t\t\t\t\t\tme.setUsers(sel);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (m._vmode == \"groups\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar grd_groups = m.down(\"[name=grd_groups]\"),\n\t\t\t\t\t\t\t\tsel = grd_groups.getSelectionModel().selected;\n\t\t\t\t\t\t\tme.setGroups(sel);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (m._vmode == \"deligates\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar grd_deligates = m.down(\"[name=grd_deligates]\"),\n\t\t\t\t\t\t\t\tsel = grd_deligates.getSelectionModel().selected;\n\t\t\t\t\t\t\tme.setDeligates(sel);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.pmenu = pmenu;\n\t\t}\n\n\t\tif (sdp && sdp.length)\n\t\t{\n\t\t\tdp = dp.concat(sdp);\n\t\t}\n\t\t\n\t\tdstype.store.loadData(dp);\n\t\tme.job.dstype = me.job.dstype || \"\";\n\t\tp_base.setAllValues(me.job, true, true);\n\t\tdsoption = me.job.dsoption = me.job.dsoption || {};\n\t\tp_advanced.setAllValues(dsoption, true, true);\n\t\t\n\t\t$.each(dpanel.items.items, function(i, c) {\n\t\t\tc.hide();\n\t\t});\n\n\t\tme.bind_form = null;\n\n\t\tif (dsoption.bind_form_uid && dsoption.bind_form_name && dsoption.bind_form_type)\n\t\t{\n\t\t\tme.bind_form = {\n\t\t\t\tuid: dsoption.bind_form_uid,\n\t\t\t\tname: dsoption.bind_form_name,\n\t\t\t\ttype: dsoption.bind_form_type\n\t\t\t};\n\t\t}\n\t\t\n\t\tp_dsoption = me.down(\"[name=\" + me.job.dstype + \"]\");\n\t\t\n\t\tif (p_dsoption)\n\t\t{\n\t\t\tp_dsoption.show();\n\t\t\tme.job.dsoption && p_dsoption.setAllValues(me.job.dsoption, true, true);\n\t\t}\n\t},\n\t\n\t_confirm: function(keepview) {\n\t\tvar me = this,\n\t\t\tp_base = me.down(\"[name=p_base]\"),\n\t\t\tp_advanced = me.down(\"[name=p_advanced]\"),\n\t\t\tjob = me.job,\n\t\t\tdpanel = me.down(\"[name=dpanel]\"),\n\t\t\tp_dsoption,\n\t\t\tdsoption = {};\n\t\t\n\t\tif (p_base.getAllValues(job, true))\n\t\t\treturn false;\n\n\t\tif (p_advanced.getAllValues(dsoption, true))\n\t\t\treturn false;\n\t\t\n\t\tif (job.dstype)\n\t\t{\n\t\t\tp_dsoption = dpanel.down(\"[name=\" + job.dstype + \"]\");\n\t\t\tif (p_dsoption)\n\t\t\t{\n\t\t\t\tif (!p_dsoption.getAllValues(dsoption, true))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (me.bind_form)\n\t\t{\n\t\t\tdsoption.bind_form_uid = me.bind_form.uid;\n\t\t\tdsoption.bind_form_name = me.bind_form.name;\n\t\t\tdsoption.bind_form_type = me.bind_form.type;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdsoption.bind_form_name = null;\n\t\t\tdsoption.bind_form_uid = null;\n\t\t\tdsoption.bind_form_type = null;\n\t\t}\n\t\t\n\t\tjob.dsoption = dsoption;\n\t\t\n\t\tif (!me.closedlg(keepview))\n\t\t\treturn true;\n\n\t\treturn true;\n\t},\n\t\n\tclosedlg: function(keepview) {\n\t\tvar me = this;\n\t\t\n\t\tme.callback && me.callback.execute(me.job);\n\t\tkeepview !== true && me.fireEvent(\"close_dlg\", me);\n\t},\n\n\tsetUsers: function(sel) {\n\t\tvar me = this,\n\t\t\tassignee = me.down(\"[name=assignee]\"),\n\t\t\ti, sn = [],\n\t\t\trec;\n\n\t\tfor (i=0; i < sel.items.length; i++)\n\t\t{\n\t\t\trec = sel.items[i];\n\t\t\tsn.push(rec.get(\"userid\"));\n\t\t}\n\n\t\tassignee.setValue(sn.join(\",\"));\n\t},\n\n\tsetGroups: function(sel) {\n\t\tvar me = this,\n\t\t\tcandidate_groups = me.down(\"[name=candidate_groups]\"),\n\t\t\ti, sn = [],\n\t\t\trec;\n\n\t\tfor (i=0; i < sel.items.length; i++)\n\t\t{\n\t\t\trec = sel.items[i];\n\t\t\tsn.push(rec.get(\"path\"));\n\t\t}\n\n\t\tcandidate_groups.setValue(sn.join(\",\"));\n\t},\n\n\tsetDeligates: function(sel) {\n\t\tvar me = this,\n\t\t\tt_deligates_uid = me.down(\"[name=t_deligates_uid]\"),\n\t\t\trec;\n\n\t\tif (sel && sel.length)\n\t\t{\n\t\t\trec = sel.items[0];\n\t\t}\n\n\t\tt_deligates_uid.setValue(rec ? rec.get(\"java_class\") : \"\");\n\t},\n\t\n\tinitComponent : function() {\n\t\tvar me = this,\n\t\t\tlw = 120,\n\t\t\t__m/*mode*/ = me.__m/*mode*/;\n\t\t\n\t\tme.addEvents(\"close_dlg\");\n\t\tme._job_name = IRm$.r1(\"T_BA_1\");\n\t\t\n\t\t$s.apply(this, {\n\t\t\tpadding: ig$.padding,\n\t\t\t\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t},\n\t\t\t\t\tpadding: ig$.padding,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"fieldset\",\n\t\t\t\t\t\t\ttitle: \"Basic Option\",\n\t\t\t\t\t\t\tlayout: \"anchor\",\n\t\t\t\t\t\t\tname: \"p_base\",\n\t\t\t\t\t\t\tdefaults: {\n\t\t\t\t\t\t\t\tanchor: \"100%\",\n\t\t\t\t\t\t\t\tlabelPosition: \"top\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\tname: \"sid\",\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_ID\")\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\tname: \"dsname\",\n\t\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_NAME\")\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"combobox\",\n\t\t\t\t\t\t\t\t\tname: \"dstype\",\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_TYPE\"),\n\t\t\t\t\t\t\t\t\tqueryMode: 'local',\n\t\t\t\t\t\t\t\t\tdisplayField: 'name',\n\t\t\t\t\t\t\t\t\tvalueField: 'value',\n\t\t\t\t\t\t\t\t\teditable: false,\n\t\t\t\t\t\t\t\t\tautoSelect: true,\n\t\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\t\tstore: {\n\t\t\t\t\t\t\t\t\t\txtype: 'store',\n\t\t\t\t\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t\t\t\t\t\"name\", \"value\"\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tlisteners: {\n\t\t\t\t\t\t\t\t\t\tchange: function(tobj, nvalue, ovalue) {\n\t\t\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t\t\tdpanel = me.down(\"[name=dpanel]\"),\n\t\t\t\t\t\t\t\t\t\t\t\tp_dsoption = me.down(\"[name=\" + nvalue + \"]\");\n\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (nvalue != ovalue)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t$.each(dpanel.items.items, function(i, c) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tc.hide();\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tp_dsoption && p_dsoption.show();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"textarea\",\n\t\t\t\t\t\t\t\t\tname: \"comment\",\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"B_DESC\")\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"fieldset\",\n\t\t\t\t\t\t\ttitle: \"Advanced Option\",\n\t\t\t\t\t\t\tlayout: \"anchor\",\n\t\t\t\t\t\t\tname: \"p_advanced\",\n\t\t\t\t\t\t\tdefaults: {\n\t\t\t\t\t\t\t\tanchor: \"100%\",\n\t\t\t\t\t\t\t\tlabelPosition: \"left\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"checkbox\",\n\t\t\t\t\t\t\t\t\tname: \"asynchronous\",\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"L_ASYNC\"),\n\t\t\t\t\t\t\t\t\tboxLabel: IRm$.r1(\"B_ENABLE\")\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"checkbox\",\n\t\t\t\t\t\t\t\t\tname: \"exclusive\",\n\t\t\t\t\t\t\t\t\tfieldLabel: IRm$.r1(\"L_EXCLUSIVE\"),\n\t\t\t\t\t\t\t\t\tboxLabel: IRm$.r1(\"B_ENABLE\")\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"fieldset\",\n\t\t\t\t\t\t\t\t\ttitle: \"Bind Form\",\n\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"bind_form_name\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tfieldLabel: \"Form\",\n\t\t\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"bind_form_uid\",\n\t\t\t\t\t\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"bind_form_type\",\n\t\t\t\t\t\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: \"..\",\n\t\t\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar dlg = new IG$.metaSelectDlg({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinstance: me.instance,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvisibleItems: [\"dashboard\",\"folder\"].join(\";\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttree_options: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcallback: new IG$.callBackObj(me, function(item) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tme.down(\"[name=bind_form_uid]\").setValue(\"\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tme.down(\"[name=bind_form_name]\").setValue(\"\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tme.down(\"[name=bind_form_type]\").setValue(\"\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.type == \"Dashboard\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tme.down(\"[name=bind_form_name]\").setValue(item.name);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tme.bind_form = item;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tIG$.checkLogin(this, dlg);\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"checkbox\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tfieldLabel: \"Popup Dialog\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"ispopup\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t$w: 150\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"form_options\",\n\t\t\t\t\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"form_width\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"form_height\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: IRm$.r1(\"B_CONFIG\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tform_options = me.down(\"[name=form_options]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tform_options_value = {},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdlg;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tform_options.getAllValues(form_options_value);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdlg = new IG$.bpmnFormConfig({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tform_options_value: form_options_value,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcallback: new IG$.callBackObj(me, function(nvalues) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tform_options.setAllValues(nvalues);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tIG$.checkLogin(me, dlg);\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"fieldcontainer\",\n\t\t\t\t\t\t\t\t\tfieldLabel: \"Assignee\",\n\t\t\t\t\t\t\t\t\tname: \"assignee_c\",\n\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\t\t\t\t\t\tname: \"assignee\",\n\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\n\t\t\t\t\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\t\t\t\t\tlisteners: {\n\t\t\t\t\t\t\t\t\t\t\t\titemclick: function(tobj, prev, next, e) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\ttext: \">\",\n\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t\t\t\ttobj = me.down(\"[name=assignee_c]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tassi = me.down(\"[name=assignee]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tpmenu = me.pmenu,\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw, ph,\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\t\t\t\t\t\tel = $(tobj.el.dom),\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset = el.offset()\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw = offset.left,\n\t\t\t\t\t\t\t\t\t\t\t\t\tph = offset.top + el.height();\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.setWidth(el.width());\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.showAt(pw, ph);\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu._adjust(pmenu.$ex, true);\n\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.loadUsers(assi.getValue().split(\",\"));\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"fieldcontainer\",\n\t\t\t\t\t\t\t\t\tfieldLabel: \"Candidate Groups\",\n\t\t\t\t\t\t\t\t\tname: \"candidate_groups_c\",\n\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\n\t\t\t\t\t\t\t\t\t\t\tname: \"candidate_groups\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\ttext: \">\",\n\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t\t\t\ttobj = me.down(\"[name=candidate_groups_c]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tcgrp = me.down(\"[name=candidate_groups]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tpmenu = me.pmenu,\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw, ph,\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\t\t\t\t\t\tel = $(tobj.el.dom),\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset = el.offset()\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw = offset.left,\n\t\t\t\t\t\t\t\t\t\t\t\t\tph = offset.top + el.height();\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.setWidth(el.width());\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.showAt(pw, ph);\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu._adjust(pmenu.$ex, true);\n\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.loadGroups(cgrp.getValue().split(\",\"));\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"fieldcontainer\",\n\t\t\t\t\t\t\t\t\tfieldLabel: \"Delegates\",\n\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tname: \"t_deligates_uid_c\",\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"t_deligates_uid\",\n\t\t\t\t\t\t\t\t\t\t\treadOnly: true,\n\t\t\t\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\ttext: \">\",\n\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t// var dlg = new IG$.metaSelectDlg({\n\t\t\t\t\t\t\t\t\t\t\t\t// \tinstance: me.instance,\n\t\t\t\t\t\t\t\t\t\t\t\t// \tvisibleItems: [\"dashboard\"].join(\";\"),\n\t\t\t\t\t\t\t\t\t\t\t\t// \ttree_options: {\n\t\t\t\t\t\t\t\t\t\t\t\t// \t},\n\t\t\t\t\t\t\t\t\t\t\t\t// \tcallback: new IG$.callBackObj(me, function(item) {\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\tif (item.type == \"Dashboard\")\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t\tme.down(\"[name=t_deligates_uid]\").setValue(item.name);\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t\tme.bind_form = item;\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t// \t})\n\t\t\t\t\t\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t\t\t\t\t\t\t// IG$.checkLogin(this, dlg);\n\n\t\t\t\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t\t\t\ttobj = me.down(\"[name=t_deligates_uid_c]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tcgrp = me.down(\"[name=t_deligates_uid]\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\tpmenu = me.pmenu,\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw, ph,\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\t\t\t\t\t\tel = $(tobj.el.dom),\n\t\t\t\t\t\t\t\t\t\t\t\t\toffset = el.offset()\n\t\t\t\t\t\t\t\t\t\t\t\t\tpw = offset.left,\n\t\t\t\t\t\t\t\t\t\t\t\t\tph = offset.top + el.height();\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.setWidth(el.width());\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.showAt(pw, ph);\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu._adjust(pmenu.$ex, true);\n\n\t\t\t\t\t\t\t\t\t\t\t\tpmenu.loadDeligates(cgrp.getValue());\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\t\t\ttype: \"hbox\",\n\t\t\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Listeners\",\n\t\t\t\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\tname: \"dpanel\",\n\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"fieldset\",\n\t\t\t\t\t\t\t\t\ttitle: \"Mail Options\",\n\t\t\t\t\t\t\t\t\tlayout: \"anchor\",\n\t\t\t\t\t\t\t\t\tname: \"mail_task\",\n\t\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\t\tdefaults: {\n\t\t\t\t\t\t\t\t\t\tanchor: \"100%\",\n\t\t\t\t\t\t\t\t\t\tlabelPosition: \"top\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\tfieldLabel: \"To\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"mail_to\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textfield\",\n\t\t\t\t\t\t\t\t\t\t\tfieldLabel: \"Title\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"mail_title\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"textarea\",\n\t\t\t\t\t\t\t\t\t\t\tfieldLabel: \"Message\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"mail_message\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t\t\n\t\t\t],\n\t\t\tbuttons:[\n\t\t\t\t\"->\",\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1(\"B_CONFIRM\"),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tthis._confirm();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}, {\n\t\t\t\t\ttext: IRm$.r1(\"B_CANCEL\"),\n\t\t\t\t\thandler:function() {\n\t\t\t\t\t\t// this.close();\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tme.fireEvent(\"close_dlg\", me);\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function(ui) {\n\t\t\t\t\tvar panel = this;\n\t\t\t\t\tpanel.init_f();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnProp.superclass.initComponent.apply(this, arguments);\n\t}\n});","IG$.bpmnModeler = $s.extend(IG$.v$pnl, {\n\tscroll: false,\n\tclosable: true,\n\tlayout: \"fit\",\n\t\n\tinit_f: function() {\n\t\tvar me = this;\n\t\t\t\n\t\tme._idr();\n\t\t\t\n\t\tif (me.uid)\n\t\t{\n\t\t\tme._lc();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tme._lcc({content: {}});\n\t\t}\n\t},\n\t\n\t_idr: function() {\n\t\tvar me = this,\n\t\t\ttopmenu = me.topmenu,\n\t\t\tmainarea = me.mainarea,\n\t\t\tdt,\n\t\t\tbf,\n\t\t\tfmenu;\n\t\t\t\n\t\tdt = [\n\t\t\t{\n\t\t\t\tshape: \"circle\",\n\t\t\t\tname: \"start\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_circle\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_START\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"activities\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_ACT\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rhombus\",\n\t\t\t\tname: \"structural\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rhombus\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_STR\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"gateways\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_GW\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"boundary_events\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_BEVTS\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"int_catching_events\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_INT_CAT_EVTS\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"int_throwing_events\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_INT_THR_EVTS\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"swimlanes\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_SWIMLANES\")\n\t\t\t},\n\t\t\t{\n\t\t\t\tshape: \"rect\",\n\t\t\t\tname: \"artifacts\",\n\t\t\t\t_cs: [\"ba_base\", \"ba_rect\"],\n\t\t\t\ttext: IRm$.r1(\"L_BP_ART\")\n\t\t\t}\n\t\t];\n\t\t\n\t\tfarea = me.farea = $(\"<div class='idv-flw-reg'></div>\").appendTo(mainarea);\n\t\t\n\t\tbf = me.bf = new IG$._I9a/*flowDiagram*/(farea, {\n\t\t\tptype: \"bpmn\"\n\t\t});\n\t\tbf.init();\n\t\t\t\n\t\ttopmenu.empty();\n\t\tfmenu = $(\"<div class='idv-flw-mnu idv-bpmn'></div>\").appendTo(topmenu);\n\t\t\n\t\tme.l1/*initFlowMenu*/(fmenu, dt);\n\t\t\n\t\tIG$.setScrRect(fmenu, {axis: \"x\"});\n\t\t\n\t\tbccall = new IG$.callBackObj(me, me.l4/*onBoxUpdate*/);\n\t\t\n\t\tbf.container.bind(\"boxClicked\", function(ev, data) {\n\t\t\tvar dlg,\n\t\t\t\tmoption = me.down(\"[name=moption]\");\n\t\t\t\t\n\t\t\t// moption.removeAll();\n\t\t\t\n\t\t\tdlg = me.__dlg;\n\t\t\t\n\t\t\tif (!dlg)\n\t\t\t{\n\t\t\t\tme.__dlg = dlg = new IG$.bpmnProp({\n\t\t\t\t\tjob: data,\n\t\t\t\t\t_sustain: 1,\n\t\t\t\t\t_vmode: data.name,\n\t\t\t\t\t_p/*editor*/: me,\n\t\t\t\t\tcallback: bccall\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tmoption.add(dlg);\n\t\t\t\t\n\t\t\t\tdlg.on(\"close_dlg\", function(m) {\n\t\t\t\t\t// moption.remove(dlg);\n\t\t\t\t\tmoption.hide();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (dlg.job && dlg._confirm(true) !== true)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdlg.job = data;\n\t\t\t\tdlg._vmode = data.name;\n\t\t\t\tdlg.init_f();\n\t\t\t}\n\t\t\t\n\t\t\tif (dlg)\n\t\t\t{\n\t\t\t\tmoption.show();\n\t\t\t}\n\t\t});\n\t\t\n\t\tbf.container.bind(\"flow_changed\", function(ev, data) {\n\t\t\tswitch(data.source)\n\t\t\t{\n\t\t\tcase \"box_add\":\n\t\t\tcase \"box_delete\":\n\t\t\tcase \"link_node\":\n\t\t\tcase \"move_link\":\n\t\t\tcase \"link_detach\":\n\t\t\t\tme.updateNetwork(data.source, data);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tbf.container.bind(\"link_click\", function(ev, data) {\n\t\t\tif (data.item)\n\t\t\t{\n\t\t\t\tme.setLinkOption(data);\n\t\t\t}\n\t\t});\n\t},\n\n\tdetachNode: function(opt) {\n\t\tvar me = this,\n\t\t\tlink = opt.item.link,\n\t\t\tptr_link = link.ptr_link;\n\n\t\tjsPlumb.detach(link);\n\t\tptr_link && me.updateNetwork(\"link_detach\", {\n\t\t\titem: {\n\t\t\t\tsrc: ptr_link.from,\n\t\t\t\ttgt: ptr_link.to\n\t\t\t}\n\t\t});\n\t},\n\n\tsetLinkOption: function(data) {\n\t\tvar me = this,\n\t\t\tdlg = new IG$.bpmnLinkCon({\n\t\t\t\tdata: data,\n\t\t\t\tmodeler: me,\n\t\t\t\tcallback: new IG$.callBackObj(me, function(nformula) {\n\t\t\t\t\tvar link = data.item.link,\n\t\t\t\t\t\tptr_link = link.ptr_link;\n\t\t\t\t\tptr_link.condition = {\n\t\t\t\t\t\thas_condition: true,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tvalue: nformula\n\t\t\t\t\t};\n\n\t\t\t\t\tvar overlays = link.getOverlays(),\n\t\t\t\t\t\tcoverlay;\n\t\t\t\t\t$.each(overlays, function(k, ov) {\n\t\t\t\t\t\tif (ov.canvas && $(\".ig-link-desc\", ov.canvas).length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcoverlay = ov;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (coverlay)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar d = $(\".ig-link-desc\", coverlay.canvas);\n\t\t\t\t\t\td.html(nformula || \"-\");\n\t\t\t\t\t\td.attr(\"title\", nformula);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\tIG$.checkLogin(me, dlg);\n\t},\n\t\n\tl4/*onBoxUpdate*/: function(job) {\n\t\tvar me = this,\n\t\t\tbf = me.bf;\n\t\t\n\t\tjob.text = job.dsname;\n\t\tbf.s4/*setTitle*/(job, job.name);\n\t\tbf.setDsN(job, job.dsname);\n\n\t\tjob._app_cls = job._app_cls || [];\n\t\t$.each(job._app_cls, function(i, cls) {\n\t\t\tjob.box.removeClass(cls);\n\t\t});\n\n\t\tif (job.name)\n\t\t{\n\t\t\tjob.box.addClass(\"bpmn_\" + job.name);\n\t\t\tjob._app_cls.push(\"bpmn_\" + job.name);\n\t\t}\n\n\t\tif (job.dstype)\n\t\t{\n\t\t\tjob.box.addClass(\"bpmn_type_\" + job.dstype);\n\t\t\tjob._app_cls.push(\"bpmn_type_\" + job.dstype);\n\t\t}\n\t},\n\t\n\tupdateNetwork: function(ptype, data, b_first) {\n\t\tvar me = this,\n\t\t\t_mc = me._mc,\n\t\t\titemobj = _mc.itemobj,\n\t\t\tuid = _mc.uid,\n\t\t\treq = new IG$._rpc$(),\n\t\t\ti, pl;\n\t\t\n\t\tswitch (ptype)\n\t\t{\n\t\tcase \"box_add\":\n\t\t\titemobj.nodes.push(data.item);\n\t\t\tbreak;\n\t\tcase \"box_delete\":\n\t\t\tfor (i=0; i < itemobj.nodes.length; i++)\n\t\t\t{\n\t\t\t\tif (itemobj.nodes[i].sid == data.item.sid)\n\t\t\t\t{\n\t\t\t\t\titemobj.nodes.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tme.down(\"[name=moption]\").hide();\n\t\t\tbreak;\n\t\tcase \"link_node\":\n\t\t\tpl = {\n\t\t\t\tfrom: data.item.src.sid,\n\t\t\t\tto: data.item.tgt.sid\n\t\t\t};\n\t\t\tif (data.item && data.item.link)\n\t\t\t\tdata.item.link.ptr_link = pl;\n\t\t\titemobj.links.push(pl);\n\t\t\tbreak;\n\t\tcase \"move_link\":\n\t\t\t/*\n\t\t\tp1.source_0 = data.item.source_0;\n\t\t\tp1.source_1 = data.item.source_1;\n\t\t\tp1.target_0 = data.item.target_0;\n\t\t\tp1.target_1 = data.item.target_1;\n\t\t\t*/\n\t\t\tbreak;\n\t\tcase \"link_detach\":\n\t\t\tfor (i=0; i < itemobj.links.length; i++)\n\t\t\t{\n\t\t\t\tpl = itemobj.links[i];\n\t\t\t\tif ((pl.from == data.item.src && pl.to == data.item.tgt)\n\t\t\t\t\t|| (pl.to == data.item.src && pl.from == data.item.tgt))\n\t\t\t\t{\n\t\t\t\t\titemobj.links.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t},\n\t\n\tl1/*initFlowMenu*/: function(fmenu, dt) {\n\t\tvar me = this,\n\t\t\ti,\n\t\t\tmul,\n\t\t\tgap = 10,\n\t\t\tsx = gap,\n\t\t\tbf = me.bf;\n\t\t\t\n\t\tfmenu.empty();\n\t\t\n\t\t$.each(dt, function(n, item) {\n\t\t\tvar dv,\n\t\t\t\tbg,\n\t\t\t\ti;\n\t\t\t\n\t\t\tif (!item.hidden)\n\t\t\t{\n\t\t\t\tdv = $(\"<div class='idv-flw-shp-a idv-bpmn'><div>\" + item.text + \"</div></div>\").appendTo(fmenu);\n\t\t\t\t// dv.css({left: sx});\n\t\t\t\t\n\t\t\t\tif (item._cs && item._cs.length)\n\t\t\t\t{\n\t\t\t\t\tfor (i=0; i < item._cs.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tdv.addClass(item._cs[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsx += gap + (IG$.j$ext._w(dv) || 120);\n\t\t\t\tdv.draggable({\n\t\t\t\t\topacity: 0.7, \n\t\t\t\t\thelper: \"clone\",\n\t\t\t\t\tstop: function(event, ui) {\n\t\t\t\t\t\tvar p = ui.position,\n\t\t\t\t\t\t\tfarea = me.farea,\n\t\t\t\t\t\t\tmp = $(farea.parent()).offset(),\n\t\t\t\t\t\t\tmposition = farea.offset(),\n\t\t\t\t\t\t\tmw = IG$.j$ext._w(farea),\n\t\t\t\t\t\t\tmh = IG$.j$ext._h(farea);\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar nitem = new IG$._baN/*bflowNode*/();\n\t\t\t\t\t\tnitem.c1/*clone*/(item);\n\t\t\t\t\t\tnitem.w = 100;\n\t\t\t\t\t\tnitem.h = 28;\n\t\t\t\t\t\t\n\t\t\t\t\t\tmposition.top -= mp.top;\n\t\t\t\t\t\tmposition.left -= mp.left;\n\t\t\t\t\t\t\n\t\t\t\t\t\tp.w = nitem.w;\n\t\t\t\t\t\tp.h = nitem.h;\n\t\t\t\t\t\t\n\t\t\t\t\t\tnitem.$variable = {};\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (mposition.left < p.left && p.left < mposition.left + mw \n\t\t\t\t\t\t\t&& mposition.top < p.top && p.top < mposition.top + mh)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbf.addBox(nitem, p, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\t\n\t_lc: function() {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"content\",\n\t\t\t\tpayload: {uid: me.uid},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tme._lcc(jdoc);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\t_lcc: function(jdoc) {\n\t\tvar me = this;\n\n\t\tme._mc = jdoc;\n\t\tme.down(\"[name=tbobjname]\").setText(jdoc.name);\n\t\t\n\t\tvar itemobj = me._mc.itemobj = {nodes: [], links: []},\n\t\t\tcontent = me._mc.content,\n\t\t\tbf = me.bf;\n\t\t\t\n\t\tcontent.nodes = content.nodes || [];\n\t\tcontent.links = content.links || [];\n\t\t\n\t\t$.each(content.nodes, function(i, node) {\n\t\t\tvar n = {\n\t\t\t\tx: node.x,\n\t\t\t\ty: node.y,\n\t\t\t\tw: node.w,\n\t\t\t\th: node.h,\n\t\t\t\tshape: node.shape,\n\t\t\t\tname: node.name,\n\t\t\t\tdsname: node.dsname,\n\t\t\t\tdstype: node.dstype,\n\t\t\t\tdsoption: node.dsoption,\n\t\t\t\tcomment: node.comment,\n\t\t\t\tsid: node.sid,\n\t\t\t\ttext: node.name\n\t\t\t};\n\t\t\t\n\t\t\titemobj.nodes.push(n);\n\t\t});\n\t\t\n\t\t$.each(content.links, function(i, link) {\n\t\t\tvar n = {\n\t\t\t\tfrom: link.sourceId,\n\t\t\t\tto: link.targetId,\n\t\t\t\tcondition: link.condition\n\t\t\t};\n\t\t\t\n\t\t\titemobj.links.push(n);\n\t\t});\n\t\t\n\t\tbf.L1/*loadOption*/(itemobj);\n\t},\n\t\n\ttoolbarHandler: function(cmd, opt) {\n\t\tvar me = this;\n\t\t\n\t\tswitch(cmd)\n\t\t{\n\t\tcase \"save\":\n\t\t\tif (me.uid)\n\t\t\t{\n\t\t\t\tme._save(opt);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tme._save_as(opt);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"saveas\":\n\t\t\tme._save_as();\n\t\t\tbreak;\n\t\tcase \"activate\":\n\t\t\tme.toolbarHandler(\"save\", 2)\n\t\t\tbreak;\n\t\tcase \"execute\":\n\t\t\tme._execute();\n\t\t\tbreak;\n\t\tcase \"migrate\":\n\t\t\tme._migrate();\n\t\t\tbreak;\n\t\t}\n\t},\n\t\n\t_activate: function() {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$(),\n\t\t\tuid = me.uid;\n\t\t\t\n\t\tif (me.uid)\n\t\t{\n\t\t\tme._update_cnt();\n\t\t\t\n\t\t\treq.init(me,\n\t\t\t\t{\n\t\t\t\t\tack: \"bpmn\",\n\t\t\t\t\tpayload: {uid: uid, option: \"activate\"},\n\t\t\t\t\tmbody: me._mc.content,\n\t\t\t\t\tmeta_type: \"bpmn\"\n\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\treq.send();\n\t\t}\n\t},\n\t\n\t_execute: function() {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$(),\n\t\t\tuid = me.uid;\n\t\t\n\t\tif (me.uid)\n\t\t{\n\t\t\tme._update_cnt();\n\t\t\treq.init(me,\n\t\t\t\t{\n\t\t\t\t\tack: \"bpmn\",\n\t\t\t\t\tpayload: {uid: uid, option: \"execute\"},\n\t\t\t\t\tmbody: me._mc.content,\n\t\t\t\t\tmeta_type: \"bpmn\"\n\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\tIG$.alertmsg(ig$.appname, IRm$.r1(\"M_SUCCESS\"), null, null, 0, \"success\");\n\t\t\t\t});\n\t\t\treq.send();\n\t\t}\n\t},\n\n\t_migrate: function(do_upgrade) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$(),\n\t\t\tuid = me.uid;\n\t\t\n\t\tif (me.uid)\n\t\t{\n\t\t\tme._update_cnt();\n\t\t\treq.init(me,\n\t\t\t\t{\n\t\t\t\t\tack: \"bpmn\",\n\t\t\t\t\tpayload: {uid: uid, option: \"migrate\", do_upgrade: (do_upgrade ? \"T\" : \"F\")},\n\t\t\t\t\tmbody: me._mc.content,\n\t\t\t\t\tmeta_type: \"bpmn\"\n\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\tvar msg;\n\t\t\t\t\tif (do_upgrade)\n\t\t\t\t\t{\n\t\t\t\t\t\tIG$.alertmsg(ig$.appname, IRm$.r1(\"M_SUCCESS\"), null, null, 0, \"success\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (jdoc.cnt_upgradable == 0 && jdoc.invalid_processes & jdoc.invalid_processes.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tmsg = \"Tasks(\" + jdoc.invalid_processes.length + \" / \" + jdoc.cnt_total_processes + \") not able to upgrade to current version!\";\n\t\t\t\t\t}\n\t\t\t\t\telse if (jdoc.cnt_upgradable)\n\t\t\t\t\t{\n\t\t\t\t\t\tmsg = IRm$.r1(\"L_C_MIG\") + \" (\" + ((jdoc.cnt_upgradable) + \" / \" + jdoc.cnt_total_processes) + \")\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmsg = IRm$.r1(\"M_SUCCESS\");\n\t\t\t\t\t\tIG$.alertmsg(ig$.appname, msg, null, null, 0, \"success\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tIG$.confirmMessages(ig$.appname, msg, function(e) {\n\t\t\t\t\t\tif (e == \"yes\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tme._migrate(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\treq.send();\n\t\t}\n\t},\n\t\n\t_update_cnt: function() {\n\t\tvar me = this,\n\t\t\t_mc = me._mc,\n\t\t\tcnt = _mc.content,\n\t\t\titemobj = _mc.itemobj,\n\t\t\ttoffset = me.mainarea.offset(),\n\t\t\tnodemap = {};\n\t\t\t\n\t\tcnt.nodes = [];\n\t\tcnt.links = [];\n\t\t\n\t\t$.each(itemobj.nodes, function(i, node) {\n\t\t\tvar o = node.box.offset(),\n\t\t\t\tl = {\n\t\t\t\t\tx: o.left - toffset.left,\n\t\t\t\t\ty: o.top - toffset.top,\n\t\t\t\t\tw: IG$.j$ext._w(node.box),\n\t\t\t\t\th: IG$.j$ext._h(node.box),\n\t\t\t\t\tshape: node.shape,\n\t\t\t\t\tname: node.name,\n\t\t\t\t\tdsname: node.dsname,\n\t\t\t\t\tcomment: node.comment,\n\t\t\t\t\tsid: node.sid,\n\t\t\t\t\tdstype: node.dstype,\n\t\t\t\t\tdsoption: node.dsoption\n\t\t\t\t};\n\t\t\tnodemap[l.sid] = l;\n\t\t\tcnt.nodes.push(l);\n\t\t});\n\t\t\n\t\t$.each(itemobj.links, function(i, link) {\n\t\t\tif (!link.from || !link.to)\n\t\t\t\treturn;\n\n\t\t\tif (!nodemap[link.from] || !nodemap[link.to])\n\t\t\t\treturn;\n\t\t\t\t\n\t\t\tvar c = {\n\t\t\t\tsourceId: link.from,\n\t\t\t\ttargetId: link.to,\n\t\t\t\tcondition: link.condition\n\t\t\t};\n\t\t\t\n\t\t\tcnt.links.push(c);\n\t\t});\n\t},\n\t\n\t_save: function(after_act) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$(),\n\t\t\tuid = me.uid,\n\t\t\tcnt = me._mc.content;\n\t\t\t\n\t\tme._update_cnt();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"writecontent\",\n\t\t\t\tpayload: {uid: uid},\n\t\t\t\tmbody: cnt,\n\t\t\t\tmeta_type: \"bpmn\"\n\t\t\t}, me, me.rsaveContent, null, [after_act]);\n\t\treq.send();\n\t},\n\t\n\trsaveContent: function(jdoc, opt) {\n\t\tvar me = this,\n\t\t\tafter_act = (opt ? opt[0] : false);\n\t\tif (after_act == 1)\n\t\t{\n\t\t\tme.ignoreclose = true;\n\t\t\tme.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tme.contentchanged = false;\n\t\t\tme.id = jdoc.type.toLowerCase() + \"_\" + jdoc.uid;\n\t\t\tme.down(\"[name=tbobjname]\").setText(jdoc.name);\n\t\t\t\n\t\t\tif (after_act == 2)\n\t\t\t{\n\t\t\t\tme._activate();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tIG$.alertmsg(ig$.appname, IRm$.r1(\"M_SAVED\"), null, null, 0, \"success\");\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_save_as: function(after_act) {\n\t\tvar me = this,\n\t\t\tdlgitemsel = new IG$.metaSelectDlg({\n\t\t\t\tinstance: me.instance,\n\t\t\t\tmode: \"newitem\",\n\t\t\t\tinitpath: me.nodepath\n\t\t\t});\n\t\tdlgitemsel.callback = new IG$.callBackObj(me, me.saveAsNew, after_act);\n\t\tIG$.checkLogin(this, dlgitemsel);\n\t},\n\t\n\tsaveAsNew: function(item, after_act) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\n\t\treq.init(me, \n\t\t\t{\n\t\t\t\tack: \"writecontent\",\n\t\t\t\tpayload: {\n\t\t\t\t\taddress: item.nodepath + \"/\" + item.name,\n\t\t\t\t\tname: item.name,\n\t\t\t\t\ttype: \"BPMN\",\n\t\t\t\t\tpid: item.uid\n\t\t\t\t},\n\t\t\t\tmbody: me._mc.content, //{}\n\t\t\t\tmeta_type: \"bpmn\"\n\t\t\t}, me, me._rs_procMakeItem, me.rs_procMakeItem, [item.name, after_act, item.nodepath, item.uid, me._mc.content]);\n\t\treq.showerror = false;\n\t\treq.send();\n\t},\n\t\n\t_rs_procMakeItem: function(jdoc, opt) {\n\t\tvar me = this,\n\t\t\ti,\n\t\t\t// itemname = opt[0],\n\t\t\tafter_act = opt[1],\n\t\t\treportoption = me._mc.content,\n\t\t\tname = jdoc.name;\n\t\t\t\n\t\tif (after_act == 1)\n\t\t{\n\t\t\tme.ignoreclose = 1;\n\t\t\tme.close();\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tme.contentchanged = false;\n\t\tme.uid = jdoc.uid;\n\t\t\n\t\treportoption.uid = me.uid;\n\t\treportoption.name = name;\n\t\tme.id = jdoc.type.toLowerCase() + \"_\" + jdoc.uid;\n\t\tme.setTitle(name);\n\t\t\n\t\tme.down(\"[name=tbobjname]\").setText(name);\n\t\t\n\t\tif (after_act == 2)\n\t\t{\n\t\t\tme._activate();\n\t\t\treturn;\n\t\t}\n\t},\n\t\n\tinitComponent: function() {\n\t\tvar me = this;\n\t\t\n\t\t$s.apply(this, {\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t},\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tflex: 1,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\tname: \"topmenu\",\n\t\t\t\t\t\t\t\t\theight: 40,\n\t\t\t\t\t\t\t\t\tborder: 1,\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tborderColor: '#efefef',\n\t\t\t\t\t\t\t\t\t\tborderStyle: 'solid'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\t\t\tlayout: \"border\",\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"container\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"mainarea\",\n\t\t\t\t\t\t\t\t\t\t\tregion: \"center\",\n\t\t\t\t\t\t\t\t\t\t\tflex: 1\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\t\t\t\t\t\t\tname: \"moption\",\n\t\t\t\t\t\t\t\t\t\t\ttitle: \"Properties\",\n\t\t\t\t\t\t\t\t\t\t\tsplit: true,\n\t\t\t\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\t\t\t\tcollapsible: true,\n\t\t\t\t\t\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\t\t\t\t\t\tcollapseMode: \"mini\",\n\t\t\t\t\t\t\t\t\t\t\tregion: \"east\",\n\t\t\t\t\t\t\t\t\t\t\twidth: 360,\n\t\t\t\t\t\t\t\t\t\t\tlayout: \"fit\",\n\t\t\t\t\t\t\t\t\t\t\ttools: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: \"collapse\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\txtype: \"displayfield\",\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: \"Click Item to set properties\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\ttbar: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-save\",\n\t\t\t\t\t\t\tname: \"t_save\",\n\t\t\t\t\t\t\ttooltip: IRm$.r1(\"L_SAVE_REPORT\"),\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"save\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-saveas\",\n\t\t\t\t\t\t\tname: \"t_save_as\",\n\t\t\t\t\t\t\ttooltip: IRm$.r1(\"L_SAVE_REPORT_AS\"),\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"saveas\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"-\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-runreport\",\n\t\t\t\t\t\t\tname: \"t_run\",\n\t\t\t\t\t\t\tcls: \"ig_r_run\",\n\t\t\t\t\t\t\ttext: IRm$.r1(\"L_ACTIVATE\"),\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"activate\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-runreport\",\n\t\t\t\t\t\t\tcls: \"ig_r_run\",\n\t\t\t\t\t\t\ttooltip: IRm$.r1(\"L_RUN_REPORT\"),\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"execute\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"->\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: IRm$.r1(\"L_BPMN_MIG\"),\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"migrate\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tbbar: {\n\t\t\t\t\t\txtype: \"toolbar\",\n\t\t\t\t\t\tname: \"_1\",\n\t\t\t\t\t\thidden: me.hiddenstatusbar || false,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\txtype: \"button\",\n\t\t\t\t\t\t\t\ttext: \"\",\n\t\t\t\t\t\t\t\tname: \"tbobjname\",\n\t\t\t\t\t\t\t\ttooltip: IRm$.r1(\"L_SK_RPT\"),\n\t\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\t\t_mc = me._mc,\n\t\t\t\t\t\t\t\t\t\tinstance = me.instance,\n\t\t\t\t\t\t\t\t\t\tapi = instance.m_explorer;\n\t\t\n\t\t\t\t\t\t\t\t\tif (_mc && _mc.nodepath && instance.mainPanel && api)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif (api.vmode != \"tree\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tIG$.changeApp(instance, 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tapi.navigateTree({\n\t\t\t\t\t\t\t\t\t\t\tname: _mc.name,\n\t\t\t\t\t\t\t\t\t\t\tnodepath: _mc.nodepath,\n\t\t\t\t\t\t\t\t\t\t\tuid: _mc.uid\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tscope: me\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"-\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t\n\t\t\t\t\tme.topmenu = $(me.down(\"[name=topmenu]\").el.dom);\n\t\t\t\t\tme.mainarea = $(me.down(\"[name=mainarea]\").el.dom);\n\t\t\t\t\t\n\t\t\t\t\tme.init_f();\n\t\t\t\t},\n\t\t\t\tscope: this\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnModeler.superclass.initComponent.call(this);\n\t}\n});","IG$.bpmnTasks = $s.extend(IG$.v$pnl, {\n\tscroll: false,\n\tclosable: true,\n\tlayout: \"fit\",\n\t\n\tinit_f: function() {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"initialize\"},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tme._lc();\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\t\n\t_lc: function() {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"tasks\"},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tvar grd_tasks = me.down(\"[name=grd_tasks]\");\n\t\t\t\tgrd_tasks.store.loadData(jdoc);\n\n\t\t\t\tIG$._upd_bpmn_task && IG$._upd_bpmn_task(me.instance, jdoc.length);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\tcomplTask: function(rec, task_detail, purpose, variables, callback) {\n        var me = this,\n\t\t\treq = new IG$._rpc$();\n\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"complete_task\", taskid: rec.get(\"taskid\")},\n\t\t\t\tmbody: {\n\t\t\t\t\tvariables: variables || {}\n\t\t\t\t},\n                meta_type: \"bpmn_req\"\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tcallback && callback.execute(jdoc);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n    },\n\n\t_la: function(rec) {\n\t\tvar me = this,\n\t\t\tinstance = me.instance,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"task_detail\"},\n\t\t\t\tmbody: {\n\t\t\t\t\tprocess_def_id: rec.get(\"process_def_id\"),\n\t\t\t\t\ttask_def_key: rec.get(\"task_def_key\"),\n\t\t\t\t\ttaskid: rec.get(\"taskid\")\n\t\t\t\t}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tvar node_option = jdoc.node_option,\n\t\t\t\t\t_ipcnt = {data: []};\n\n\t\t\t\tif (jdoc.variables)\n\t\t\t\t{\n\t\t\t\t\t$.each(jdoc.variables, function(k, v) {\n\t\t\t\t\t\t_ipcnt.data.push({\n\t\t\t\t\t\t\tname: k,\n\t\t\t\t\t\t\tvalue: v\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (node_option.bind_form_uid && node_option.bind_form_type == \"Dashboard\")\n\t\t\t\t{\n\t\t\t\t\tif (node_option.ispopup == \"T\")\n\t\t\t\t\t{\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tdlg = new IG$.DashboardViewDlg({\n\t\t\t\t\t\t\t\tinstance: me.instance,\n\t\t\t\t\t\t\t\tuid: node_option.bind_form_uid,\n\t\t\t\t\t\t\t\ttitle: node_option.bind_form_name,\n\t\t\t\t\t\t\t\tbpmn: true,\n\t\t\t\t\t\t\t\twidth: Number(node_option.form_width) || 600,\n\t\t\t\t\t\t\t\theight: Number(node_option.form_height) || 550,\n\t\t\t\t\t\t\t\tbpmn_task_rec: rec,\n\t\t\t\t\t\t\t\tbpmn_detail: jdoc,\n\t\t\t\t\t\t\t\t_ipcnt: _ipcnt,\n\t\t\t\t\t\t\t\tcallback: new IG$.callBackObj(me, function(dlg) {\n\t\t\t\t\t\t\t\t\t// me._do_next(executeEvents, event_action, callback);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tdlg.on(\"bpmn_proc\", function(params) {\n\t\t\t\t\t\t\t\tvoid 0;\n\t\t\t\t\t\t\t\tvar purpose = params.event_action.event.purpose,\n\t\t\t\t\t\t\t\t\tcondition_params = params.params;\n\n\t\t\t\t\t\t\t\tif (purpose == \"bpmn_confirm\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tme.complTask(rec, jdoc, purpose, condition_params, params.callback)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tme.setLoading(true);\n\t\t\t\t\t\t\n\t\t\t\t\t\tdlg.on(\"close_win\", function(cwin, dlgresult) {\n\t\t\t\t\t\t\tif (dlgresult != \"ID_OK\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tme.setLoading(false);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tIG$.checkLogin(this, dlg);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar mp = instance.mainPanel;\n\t\t\t\t\t\tmp && mp.navigateApp(node_option.bind_form_uid, node_option.bind_form_type.toLowerCase(), node_option.bind_form_name, null, false, false, null, {\n\t\t\t\t\t\t\t_ipcnt: _ipcnt,\n\t\t\t\t\t\t\tbpmn: true,\n\t\t\t\t\t\t\tbpmn_task_rec: rec,\n\t\t\t\t\t\t\tbpmn_detail: jdoc\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar dlg = new IG$.bpmnForm({\n\t\t\t\t\t\trec: rec,\n\t\t\t\t\t\tdetail: jdoc\n\t\t\t\t\t});\n\t\t\t\t\tIG$.checkLogin(me, dlg);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\t\n\ttoolbarHandler: function(cmd, opt) {\n\t\tvar me = this;\n\n\t\tswitch (cmd)\n\t\t{\n\t\tcase \"CMD_REFRESH\":\n\t\t\tme._lc();\n\t\t\tbreak;\n\t\t}\n\t},\n\t\n\t_claim: function(rec) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"claim_task\", taskid: rec.get(\"taskid\")},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tIG$.alertmsg(ig$.appname, \"Claim completed!\", null, null, 0, \"success\");\n\t\t\t\tme._lc();\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\t_unclaim: function(rec) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"unclaim_task\", taskid: rec.get(\"taskid\")},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tIG$.alertmsg(ig$.appname, \"Unclaim completed!\", null, null, 0, \"success\");\n\t\t\t\tme._lc();\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\tinitComponent: function() {\n\t\tvar me = this;\n\t\t\n\t\t$s.apply(this, {\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t},\n\t\t\t\t\tpadding: ig$.padding,\n\t\t\t\t\tflex: 1,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\t\tname: \"grd_tasks\",\n\t\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Name\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"taskname\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Type\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"tasktype\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Created\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"task_created_fm\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Status\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"taskstatus\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Priority\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"taskpriority\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Due End Date\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"due_enddate_fm\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"templatecolumn\",\n\t\t\t\t\t\t\t\t\twidth: 70,\n\t\t\t\t\t\t\t\t\trenderer: function(value, metadata, record) {\n\t\t\t\t\t\t\t\t\t\tif (record.get(\"claim_status\") == \"claimable\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks btn-task-claimable'>Claim</span>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if (record.get(\"claim_status\") == \"unclaimable\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks btn-task-unclaimable'>Unclaim</span>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if (record.get(\"claim_status\") == \"assigned\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks btn-task-assigned'>Assigned</span>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if (record.get(\"claim_status\") == \"unassigned\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks btn-task-unassigned'>Unassigned</span>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tlisteners: {\n\t\t\t\t\t\t\t\tcellclick: function(view, node, c, rec, rindex, e) {\n\t\t\t\t\t\t\t\t\tif (c == 6)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif (rec.get(\"claim_status\") == \"claimable\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis._claim(rec);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if (rec.get(\"claim_status\") == \"unclaimable\")\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis._unclaim(rec);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis._la(rec);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\ttbar: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-refresh\",\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"CMD_REFRESH\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t\n\t\t\t\t\tme.init_f();\n\t\t\t\t},\n\t\t\t\tscope: this\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnTasks.superclass.initComponent.call(this);\n\t}\n});","IG$.bpmnTP = $s.extend($s.window, {\n\t\n\tmodal: true,\n\tregion:'center',\n\t\n\tlayout: {\n\t\ttype: 'vbox',\n\t\talign: 'stretch'\n\t},\n\t\n\tclosable: true,\n\tresizable:false,\n\t\n\twidth: 380,\n\tautoHeight: true,\n\n\t_confirm: function() {\n\t\tvar me = this,\n\t\t\treason = me.down(\"[name=reason]\"),\n\t\t\tcallback = me.callback;\n\n\t\treason.clearInvalid();\n\n\t\tif (!reason.getValue())\n\t\t{\n\t\t\treason.markInvalid(\"required\");\n\t\t\treturn;\n\t\t}\n\n\t\tcallback && callback.execute(reason.getValue());\n\t\tme.close();\n\t},\n\n\tinitComponent : function() {\n\t\tvar me = this;\n\n\t\tme.title = IRm$.r1('L_BPMN_TP');\n\t\t\n\t\t$s.apply(this, {\n\t\t\tpadding: ig$.padding,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"textarea\",\n\t\t\t\t\tfieldLabel: IRm$.r1(\"L_REASON\"),\n\t\t\t\t\trequired: true,\n\t\t\t\t\tname: \"reason\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\txtype: \"container\",\n\t\t\t\t\theight: 50\n\t\t\t\t}\n\t\t\t],\n\t\t\tbuttons:[\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CONFIRM'),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tme._confirm();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}, \n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CLOSE'),\n\t\t\t\t\thandler:function() {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\t\n\t\tIG$.bpmnTP.superclass.initComponent.apply(this, arguments);\n\t}\n});\n\nIG$.bpmnMonitor = $s.extend(IG$.v$pnl, {\n\tscroll: false,\n\tclosable: true,\n\tlayout: \"fit\",\n\t\n\tinit_f: function() {\n\t\tvar me = this,\n\t\t\tprocesses_c = me.down(\"[name=processes_c]\"),\n\t\t\tis_all = (processes_c.getLayout().selectedIndex || 0) == 0 ? false : true,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"initialize\"},\n\t\t\t\tmbody: {}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tme._lc(is_all);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\t\n\t_lc: function(is_all) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\n\t\tvar grd_activity = me.down(\"[name=grd_activity]\");\n\t\tgrd_activity.setVisible(false);\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"processes\"},\n\t\t\t\tmbody: {is_all: is_all ? \"T\" : \"F\"}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tvar grd_processes = me.down(\"[name=\" + (is_all ? \"grd_processes_all\" : \"grd_processes\") + \"]\");\n\t\t\t\tgrd_processes.store.loadData(jdoc);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\t_la: function(rec) {\n\t\tvar me = this,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"activities\"},\n\t\t\t\tmbody: {processdefid: rec.get(\"processdefid\")}\n\t\t\t}, me, function(jdoc) {\n\t\t\t\t$.each(jdoc, function(i, act) {\n\t\t\t\t\tif (act.status)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tif (act.delete_reason)\n\t\t\t\t\t\tact.status = \"DELETED (\" + act.delete_reason + \")\";\n\t\t\t\t});\n\t\t\t\tvar grd_activity = me.down(\"[name=grd_activity]\");\n\t\t\t\tgrd_activity.setVisible(true);\n\t\t\t\tgrd_activity.store.loadData(jdoc);\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n\t},\n\n\t_tp: function(rec) {\n\t\tvar me = this,\n\t\t\tdlg;\n\t\tif (rec.get(\"enddate_fm\"))\n\t\t{\n\t\t\tIG$.alertmsg(ig$.appname, \"Process already ended!\", null, null, 0, \"warning\");\n\t\t\treturn;\n\t\t}\n\t\tdlg = new IG$.bpmnTP({\n\t\t\tcallback: new IG$.callBackObj(me, function(reason) {\n\t\t\t\tvar req = new IG$._rpc$();\n\t\t\t\treq.init(me,\n\t\t\t\t\t{\n\t\t\t\t\t\tack: \"bpmn\",\n\t\t\t\t\t\tpayload: {option: \"terminate\"},\n\t\t\t\t\t\tmbody: {\n\t\t\t\t\t\t\tprocessid: rec.get(\"processid\"),\n\t\t\t\t\t\t\treason: reason\n\t\t\t\t\t\t}\n\t\t\t\t\t}, me, function(jdoc) {\n\t\t\t\t\t\tIG$.alertmsg(ig$.appname, \"Terminated completed!\", null, null, 0, \"success\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treq.send();\n\t\t\t})\n\t\t});\n\t\tIG$.checkLogin(me, dlg);\n\t},\n\t\n\ttoolbarHandler: function(cmd, opt) {\n\t\tvar me = this,\n\t\t\tprocesses_c = me.down(\"[name=processes_c]\"),\n\t\t\tis_all = (processes_c.getLayout().selectedIndex || 0) == 0 ? true : false;\n\n\t\tswitch (cmd)\n\t\t{\n\t\tcase \"CMD_REFRESH\":\n\t\t\tme._lc(is_all);\n\t\t\tbreak;\n\t\t}\n\t},\n\t\n\n\tinitComponent: function() {\n\t\tvar me = this;\n\t\t\n\t\t$s.apply(this, {\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\ttype: \"vbox\",\n\t\t\t\t\t\talign: \"stretch\"\n\t\t\t\t\t},\n\t\t\t\t\tpadding: ig$.padding,\n\t\t\t\t\tflex: 1,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"panel\",\n\t\t\t\t\t\t\tflex: 2,\n\t\t\t\t\t\t\tlayout: {\n\t\t\t\t\t\t\t\ttype: \"card\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tname: \"processes_c\",\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\t\t\t\tname: \"grd_processes\",\n\t\t\t\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Name\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"processdefname\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Version\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"process_def_version\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Created\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"starttime_fm\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Status\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"status\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Due End Date\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"enddate_fm\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"templatecolumn\",\n\t\t\t\t\t\t\t\t\t\t\twidth: 70,\n\t\t\t\t\t\t\t\t\t\t\trenderer: function(value, metadata, record) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (!record.get(\"enddate_fm\"))\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks'>Terminate</span>\"\n\t\t\t\t\t\t\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\tlisteners: {\n\t\t\t\t\t\t\t\t\t\tcellclick: function(view, node, c, rec, rindex, e) {\n\t\t\t\t\t\t\t\t\t\t\tif (c == 5)\n\t\t\t\t\t\t\t\t\t\t\t\tthis._tp(rec);\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\tthis._la(rec);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\t\t\t\tname: \"grd_processes_all\",\n\t\t\t\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Name\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"processdefname\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Started By\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"started_by\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Version\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"process_def_version\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Created\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"starttime_fm\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Status\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"status\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttext: \"Due End Date\",\n\t\t\t\t\t\t\t\t\t\t\tdataIndex: \"enddate_fm\"\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\txtype: \"templatecolumn\",\n\t\t\t\t\t\t\t\t\t\t\twidth: 70,\n\t\t\t\t\t\t\t\t\t\t\trenderer: function(value, metadata, record) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (!record.get(\"enddate_fm\"))\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"<span class='btn-bpmn-tasks'>Terminate</span>\"\n\t\t\t\t\t\t\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\tlisteners: {\n\t\t\t\t\t\t\t\t\t\tcellclick: function(view, node, c, rec, rindex, e) {\n\t\t\t\t\t\t\t\t\t\t\tif (c == 6)\n\t\t\t\t\t\t\t\t\t\t\t\tthis._tp(rec);\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\tthis._la(rec);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\txtype: \"gridpanel\",\n\t\t\t\t\t\t\tname: \"grd_activity\",\n\t\t\t\t\t\t\tstore: {},\n\t\t\t\t\t\t\tflex: 1,\n\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Name\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"activityname\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Type\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"activitytype\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Created\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"starttime_fm\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Status\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"status\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Priority\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"taskpriority\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: \"Due End Date\",\n\t\t\t\t\t\t\t\t\tdataIndex: \"endtime_fm\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\ttbar: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonCls: \"icon-toolbar-refresh\",\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tthis.toolbarHandler(\"CMD_REFRESH\");\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: IRm$.r1(\"L_PROC_ME\"),\n\t\t\t\t\t\t\ttoggleGroup: \"bm\",\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\tprocesses_c = me.down(\"[name=processes_c]\");\n\t\t\t\t\t\t\t\tprocesses_c.getLayout().setActiveItem(0);\n\t\t\t\t\t\t\t\tme.init_f();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: IRm$.r1(\"L_PROC_ALL\"),\n\t\t\t\t\t\t\ttoggleGroup: \"bm\",\n\t\t\t\t\t\t\thandler: function() {\n\t\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\t\tprocesses_c = me.down(\"[name=processes_c]\");\n\t\t\t\t\t\t\t\tprocesses_c.getLayout().setActiveItem(1);\n\t\t\t\t\t\t\t\tme.init_f();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tscope: this\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t\n\t\t\t\t\tme.init_f();\n\t\t\t\t},\n\t\t\t\tscope: this\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnMonitor.superclass.initComponent.call(this);\n\t}\n});","IG$.bpmnForm = $s.extend($s.window, {\n\t\n\tmodal: true,\n\tregion:'center',\n\t\n\tlayout: {\n\t\ttype: 'vbox',\n\t\talign: 'stretch'\n\t},\n\t\n\tclosable: true,\n\tresizable:false,\n\t\n\twidth: 380,\n\tautoHeight: true,\n\n    complTask: function() {\n        var me = this,\n            rec = me.rec,\n            detail = me.detail,\n\t\t\treq = new IG$._rpc$();\n\t\t\t\n\t\treq.init(me,\n\t\t\t{\n\t\t\t\tack: \"bpmn\",\n\t\t\t\tpayload: {option: \"complete_task\", taskid: rec.get(\"taskid\")},\n\t\t\t\tmbody: {\n\t\t\t\t\tvariables: {}\n\t\t\t\t},\n                meta_type: \"bpmn_req\"\n\t\t\t}, me, function(jdoc) {\n\t\t\t\tme.close();\n\t\t\t}\n\t\t);\n\t\t\n\t\treq.send();\n    },\n\t\t\n\tinitComponent : function() {\n\t\tvar me = this;\n\n\t\tme.title = IRm$.r1('T_FORM');\n\t\t\n\t\t$s.apply(this, {\n\t\t\tpadding: ig$.padding,\n\t\t\titems: [\n\t\t\t\t\n\t\t\t\t{\n\t\t\t\t\txtype: \"container\",\n\t\t\t\t\theight: 50\n\t\t\t\t}\n\t\t\t],\n\t\t\tbuttons:[\n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CONFIRM'),\n\t\t\t\t\tbodyCls: \"ig-btn-confirm\",\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tthis.complTask();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}, \n\t\t\t\t{\n\t\t\t\t\ttext: IRm$.r1('B_CLOSE'),\n\t\t\t\t\thandler:function() {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t},\n\t\t\t\t\tscope: this\n\t\t\t\t}\n\t\t\t],\n\t\t\tlisteners: {\n\t\t\t\tafterrender: function(ui) {\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tIG$.bpmnForm.superclass.initComponent.apply(this, arguments);\n\t}\n});"]}